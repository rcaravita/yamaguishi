/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";var e,t,n,r=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},a=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(e){return{isFullscreen:function(){return null!==e.get()}}},o=function(){},c=function(e){return function(){return e}},s=c(!1),l=c(!0),u=function(){return f},f=(e=function(e){return e.isNone()},{fold:function(e){return e()},is:s,isSome:s,isNone:l,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:n,orThunk:t,map:u,each:o,bind:u,exists:s,forall:l,filter:u,equals:e,equals_:e,toArray:function(){return[]},toString:c("none()")}),d=function(e){var t=c(e),n=function(){return a},r=function(t){return t(e)},a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:s,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?a:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(s,function(t){return n(e,t)})}};return a},m={some:d,none:u,from:function(e){return null===e||void 0===e?f:d(e)}},g=function(){return e=function(e){return e.unbind()},t=r(m.none()),n=function(){return t.get().each(e)},{clear:function(){n(),t.set(m.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(m.some(e))}};var e,t,n},h=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},p=function(e){return function(t){return typeof t===e}},y=h("string"),v=h("array"),b=p("boolean"),w=function(e){return!(null===(t=e)||void 0===t);var t},k=p("function"),_=p("number"),C=Array.prototype.push,x=function(e,t){for(var n=e.length,r=new Array(n),a=0;n>a;a++){var i=e[a];r[a]=t(i,a)}return r},z=function(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)},S=function(e,t){for(var n=[],r=0,a=e.length;a>r;r++){var i=e[r];t(i,r)&&n.push(i)}return n},E=function(e,t){return function(e){for(var t=[],n=0,r=e.length;r>n;++n){if(!v(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);C.apply(t,e[n])}return t}(x(e,t))},N=function(e){return t=e,(n=0)<=n&&n<t.length?m.some(t[n]):m.none();var t,n},T=Object.keys,D=function(e){return void 0!==e.style&&k(e.style.getPropertyValue)},A=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},O={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return A(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return A(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return A(n)},fromDom:A,fromPoint:function(e,t,n){return m.from(e.dom.elementFromPoint(t,n)).map(A)}},R=("undefined"!=typeof window||Function("return this;")(),function(e){return function(t){return t.dom.nodeType===e}}),P=R(1),L=R(3),B=R(9),j=R(11),M=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},I=function(e){return O.fromDom(e.dom.ownerDocument)},F=function(e){var t;return t=e,m.from(t.dom.parentNode).map(O.fromDom).map(H).map(function(t){return S(t,function(t){return n=t,e.dom!==n.dom;var n})}).getOr([])},H=function(e){return x(e.dom.childNodes,O.fromDom)},q=k(Element.prototype.attachShadow)&&k(Node.prototype.getRootNode),U=c(q),V=q?function(e){return O.fromDom(e.dom.getRootNode())}:function(e){return B(e)?e:I(e)},$=function(e){var t,n=V(e);return j(t=n)&&w(t.dom.host)?m.some(n):m.none()},W=function(e){return O.fromDom(e.dom.host)},X=function(e){return w(e.dom.shadowRoot)},K=function(e){var t=L(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n,r,a=t.ownerDocument;return $(O.fromDom(t)).fold(function(){return a.body.contains(t)},(n=K,r=W,function(e){return n(r(e))}))},G=function(e,t,n){!function(e,t,n){if(!(y(n)||b(n)||_(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(e.dom,t,n)},Y=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},J=function(e,t){e.dom.removeAttribute(t)},Z=function(e,t){var n=e.dom;!function(e,t){for(var n=T(e),r=0,a=n.length;a>r;r++){var i=n[r];t(e[i],i)}}(t,function(e,t){!function(e,t,n){if(!y(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);D(e)&&e.style.setProperty(t,n)}(n,t,e)})},Q=function(e,t){return D(e)?e.style.getPropertyValue(t):""},ee=function(e){var t,n,r=O.fromDom(function(e){if(U()&&w(e.target)){var t=O.fromDom(e.target);if(P(t)&&X(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return N(n)}}return m.from(e.target)}(e).getOr(e.target)),a=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},o=(t=i,n=a,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return{target:r,x:e.clientX,y:e.clientY,stop:a,prevent:i,kill:o,raw:e}},te=function(e,t,n,r,a){var i,o,c=(i=n,o=r,function(e){i(e)&&o(ee(e))});return e.dom.addEventListener(t,c,a),{unbind:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=t.concat(n);return e.apply(null,a)}}(ne,e,t,c,a)}},ne=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},re=l,ae=function(e,t,n){return te(e,t,re,n,!1)},ie=function(e,t){return{left:e,top:t,translate:function(n,r){return ie(e+n,t+r)}}},oe=ie,ce=function(e){var t=void 0===e?window:e;return m.from(t.visualViewport)},se=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},le=function(e){var t,n,r,a,i=void 0===e?window:e,o=i.document,c=(t=O.fromDom(o),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,a=n.body.scrollTop||n.documentElement.scrollTop,oe(r,a));return ce(i).fold(function(){var e=i.document.documentElement,t=e.clientWidth,n=e.clientHeight;return se(c.left,c.top,t,n)},function(e){return se(Math.max(e.pageLeft,c.left),Math.max(e.pageTop,c.top),e.width,e.height)})},ue=function(e,t,n){return ce(n).map(function(n){var r=function(e){return t(ee(e))};return n.addEventListener(e,r),{unbind:function(){return n.removeEventListener(e,r)}}}).getOrThunk(function(){return{unbind:o}})},fe=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),de=tinymce.util.Tools.resolve("tinymce.Env"),me=tinymce.util.Tools.resolve("tinymce.util.Delay"),ge=function(e,t){e.fire("FullscreenStateChanged",{state:t})},he=function(e){return e.getParam("fullscreen_native",!1,"boolean")},pe=function(e){var t=O.fromDom(e.getElement());return $(t).map(W).getOrThunk(function(){return function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return O.fromDom(t)}(I(t))})},ye=function(e){return e.dom===(void 0!==(t=I(e).dom).fullscreenElement?t.fullscreenElement:void 0!==t.msFullscreenElement?t.msFullscreenElement:void 0!==t.webkitFullscreenElement?t.webkitFullscreenElement:null);var t},ve=function(e,t,n){return S(function(e,t){for(var n=k(t)?t:s,r=e.dom,a=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,o=O.fromDom(i);if(a.push(o),!0===n(o))break;r=i}return a}(e,n),t)},be=function(e){return t=e,a=void 0===n?document:n.dom,1!==(r=a).nodeType&&9!==r.nodeType&&11!==r.nodeType||0===r.childElementCount?[]:x(a.querySelectorAll(t),O.fromDom);var t,n,r,a},we=function(e,t){return n=function(e){return M(e,t)},S(F(e),n);var n},ke="data-ephox-mobile-fullscreen-style",_e="position:absolute!important;",Ce="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",xe=de.os.isAndroid(),ze=function(e){var t,n,r,a,i=(n="background-color",r=(t=e).dom,""!==(a=window.getComputedStyle(r).getPropertyValue(n))||K(t)?a:Q(r,n));return void 0!==i&&""!==i?"background-color:"+i+"!important":"background-color:rgb(255,255,255)!important;"},Se=function(e,t,n){var r,a,i=function(t){return function(n){var r=Y(n,"style"),a=void 0===r?"no-styles":r.trim();a!==t&&(G(n,ke,a),Z(n,e.parseStyle(t)))}},o=(r="*",ve(t,function(e){return M(e,r)},a)),c=E(o,function(e){return we(e,"*:not(.tox-silver-sink)")}),s=ze(n);z(c,i("display:none!important;")),z(o,i(_e+Ce+s)),i((!0===xe?"":_e)+Ce+s)(t)},Ee=fe.DOM,Ne=ce().fold(function(){return{bind:o,unbind:o}},function(e){var t,n=(t=r(m.none()),{clear:function(){return t.set(m.none())},set:function(e){return t.set(m.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}),a=g(),i=g(),o=me.throttle(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(function(){n.on(function(t){return Z(t,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(e){n.set(e),o(),a.set(ue("resize",o)),i.set(ue("scroll",o))},unbind:function(){n.on(function(){a.clear(),i.clear()}),n.clear()}}}),Te=function(e,t){var n,r,a,i,o,c,s,l=document.body,u=document.documentElement,f=e.getContainer(),d=O.fromDom(f),g=pe(e),h=t.get(),p=O.fromDom(e.getBody()),y=de.deviceType.isTouch(),v=f.style,b=e.iframeElement.style,w=function(e){e(l,"tox-fullscreen"),e(u,"tox-fullscreen"),e(f,"tox-fullscreen"),$(d).map(function(e){return W(e).dom}).each(function(t){e(t,"tox-fullscreen"),e(t,"tox-shadowhost")})},k=function(){var n,r;y&&(n=e.dom,r=be("["+ke+"]"),z(r,function(e){var t=Y(e,ke);"no-styles"!==t?Z(e,n.parseStyle(t)):J(e,"style"),J(e,ke)})),w(Ee.removeClass),Ne.unbind(),m.from(t.get()).each(function(e){return e.fullscreenChangeHandler.unbind()})};h?(h.fullscreenChangeHandler.unbind(),he(e)&&ye(g)&&(i=I(g),(o=i.dom).exitFullscreen?o.exitFullscreen():o.msExitFullscreen?o.msExitFullscreen():o.webkitCancelFullScreen&&o.webkitCancelFullScreen()),b.width=h.iframeWidth,b.height=h.iframeHeight,v.width=h.containerWidth,v.height=h.containerHeight,v.top=h.containerTop,v.left=h.containerLeft,a=h.scrollPos,window.scrollTo(a.x,a.y),t.set(null),ge(e,!1),k(),e.off("remove",k)):(n=ae(I(g),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",function(){he(e)&&(ye(g)||null===t.get()||Te(e,t))}),r={scrollPos:{x:(s=le(window)).x,y:s.y},containerWidth:v.width,containerHeight:v.height,containerTop:v.top,containerLeft:v.left,iframeWidth:b.width,iframeHeight:b.height,fullscreenChangeHandler:n},y&&Se(e.dom,d,p),b.width=b.height="100%",v.width=v.height="",w(Ee.addClass),Ne.bind(d),e.on("remove",k),t.set(r),he(e)&&((c=g.dom).requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.webkitRequestFullScreen&&c.webkitRequestFullScreen()),ge(e,!0))},De=function(e,t){return function(n){n.setActive(null!==t.get());var r=function(e){return n.setActive(e.state)};return e.on("FullscreenStateChanged",r),function(){return e.off("FullscreenStateChanged",r)}}};a.add("fullscreen",function(e){var t,n,a,o,c=r(null);return e.inline||(n=c,(t=e).addCommand("mceFullScreen",function(){Te(t,n)}),o=c,(a=e).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return a.execCommand("mceFullScreen")},onSetup:De(a,o)}),a.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return a.execCommand("mceFullScreen")},onSetup:De(a,o)}),e.addShortcut("Meta+Shift+F","","mceFullScreen")),i(c)})}();