!function(){"use strict";function S(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}function c(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var u=arguments[e],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}function o(n,e,t,r,o){return n(t,r)?N.some(t):P(o)&&o(t)?N.none():e(t,r,o)}function n(){return{up:b({selector:_e,closest:qe,predicate:ze,all:xe}),down:b({selector:Le,predicate:Ne}),styles:b({get:et,getRaw:rt,set:Ze,remove:ot}),attrs:b({get:Ge,set:Ue,remove:Xe,copyTo:function(n,e){var t=Ye(n);$e(e,t)}}),insert:b({before:Kt,after:Xt,afterAll:Zt,append:Jt,appendAll:nr,prepend:Yt,wrap:Qt}),remove:b({unwrap:rr,remove:tr}),create:b({nu:Fn.fromTag,clone:function(n){return Fn.fromDom(n.dom.cloneNode(!1))},text:Fn.fromText}),query:b({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:Se,nextSibling:Te}),property:b({children:Re,name:fe,parent:Ce,document:function(n){return ye(n).dom},isText:pe,isComment:me,isElement:ge,isSpecial:function(n){var e=fe(n);return _(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getText:ur,setText:cr,isBoundary:function(n){return!!ge(n)&&("body"===fe(n)||_(ar,fe(n)))},isEmptyTag:function(n){return!!ge(n)&&_(["br","img","hr","input"],fe(n))},isNonEditable:function(n){return ge(n)&&"false"===Ge(n,"contenteditable")}}),eq:Vn,is:Gn}}function M(v,b,n){var w=Wd(ku,function(l,f,s){n.targets().each(function(a){vt(f).each(function(n){var e,t,r,o,u=Tc(v),i=pu(C,Fn.fromDom(v.getDoc()),u),c=Ld(n,a,i);e=l,t=f,r=s,o=c,v.fire("TableSelectionChange",{cells:e,start:t,finish:r,otherCells:o})})})},function(){v.fire("TableSelectionClear")});return v.on("init",function(){var n,e,r,o,u,i,c=v.getWin(),a=wu(v),t=xu(v),l=(n=Md(c),{clearstate:(e=Rd(n,a,t,w)).clearstate,mousedown:e.mousedown,mouseover:e.mouseover,mouseup:e.mouseup}),f=jd(c,a,t,w),s=(r=a,o=t,u=w,i=Md(c),function(n,t){u.clearBeforeUpdate(r),hr(n,t,o).each(function(n){var e=n.boxes.getOr([]);u.selectRange(r,e,n.start,n.finish),i.selectContents(t),i.collapseSelection()})});v.on("TableSelectorChange",function(n){return s(n.start,n.finish)});var d,m,g=function(n,e){!0===n.raw.shiftKey&&(e.kill&&n.kill(),e.selection.each(function(n){var e=jf.relative(n.start,n.finish),t=Vf(c,e);v.selection.setRng(t)}))},p=function(n){return 0===n.button},h=(d=Go(Fn.fromDom(a)),m=Go(0),{touchEnd:function(n){var e,t,r=Fn.fromDom(n.target);"td"!==fe(r)&&"th"!==fe(r)||(e=d.get(),t=m.get(),Vn(e,r)&&n.timeStamp-t<300&&(n.preventDefault(),s(r,r))),d.set(r),m.set(n.timeStamp)}});v.on("dragstart",function(){l.clearstate()}),v.on("mousedown",function(n){p(n)&&zd(n)&&l.mousedown(Ai(n))}),v.on("mouseover",function(n){var e;((e=n).buttons===undefined||yf.browser.isEdge()&&0===e.buttons||0!=(1&e.buttons))&&zd(n)&&l.mouseover(Ai(n))}),v.on("mouseup",function(n){p(n)&&zd(n)&&l.mouseup(Ai(n))}),v.on("touchend",h.touchEnd),v.on("keyup",function(n){var e,t,r,o=Ai(n);o.raw.shiftKey&&Bd(o.raw.which)&&(e=v.selection.getRng(),t=Fn.fromDom(e.startContainer),r=Fn.fromDom(e.endContainer),f.keyup(o,t,e.startOffset,r,e.endOffset).each(function(n){g(o,n)}))}),v.on("keydown",function(n){var e=Ai(n);b().each(function(n){return n.hideBars()});var t=v.selection.getRng(),r=Fn.fromDom(t.startContainer),o=Fn.fromDom(t.endContainer),u=qr(Ed,Pd)(Fn.fromDom(v.selection.getStart()));f.keydown(e,r,t.startOffset,o,t.endOffset,u).each(function(n){g(e,n)}),b().each(function(n){return n.showBars()})}),v.on("NodeChange",function(){var n=v.selection,e=Fn.fromDom(n.getStart()),t=Fn.fromDom(n.getEnd());gr(vt,[e,t]).fold(function(){return w.clear(a)},C)})}),{clear:w.clear}}var e,t,r,u,i,a,l,f,s,d,m,g,C=function(){},b=function(n){return function(){return n}},p=function(n){return n},h=function(e){return function(n){return!e(n)}},v=b(!1),T=b(!0),w=function(){return y},y=(e=function(n){return n.isNone()},{fold:function(n){return n()},is:v,isSome:v,isNone:T,getOr:r=function(n){return n},getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(undefined),or:r,orThunk:t,map:w,each:C,bind:w,exists:v,forall:T,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:b("none()")}),x=function(t){var n=b(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:T,isNone:v,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return x(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:y},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(v,function(n){return e(t,n)})}};return o},N={some:x,none:w,from:function(n){return null===n||n===undefined?y:x(n)}},R=function(r){return function(n){return t=typeof(e=n),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===r;var e,t}},D=function(e){return function(n){return typeof n===e}},O=R("string"),A=R("object"),k=R("array"),I=D("boolean"),B=(u=undefined,function(n){return u===n}),E=function(n){return!(null===(e=n)||e===undefined);var e},P=D("function"),j=D("number"),W=Array.prototype.slice,L=Array.prototype.indexOf,z=Array.prototype.push,_=function(n,e){return t=n,r=e,-1<L.call(t,r);var t,r},F=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},H=function(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t},q=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},V=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},U=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},$=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n){t=e(t,n)}),t},G=function(n,e,t){return V(n,function(n){t=e(t,n)}),t},K=function(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return N.some(u);if(t(u,r))break}return N.none()}(n,e,v)},X=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return N.some(t);return N.none()},Y=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!k(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);z.apply(e,n[t])}return e},J=function(n,e){return Y(q(n,e))},Q=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},Z=function(n,e){for(var t={},r=0,o=n.length;r<o;r++){var u=n[r];t[String(u)]=e(u,r)}return t},nn=function(n){return[n]},en=function(n,e){return 0<=e&&e<n.length?N.some(n[e]):N.none()},tn=function(n){return en(n,0)},rn=function(n){return en(n,n.length-1)},on=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return N.none()},un=function(){return(un=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},cn=function(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}},an=function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}return undefined}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return fn(r(1),r(2))},ln=function(){return fn(0,0)},fn=function(n,e){return{major:n,minor:e}},sn={nu:fn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?ln():an(n,t)},unknown:ln},dn=function(n,e){var t=String(e).toLowerCase();return K(n,function(n){return n.search(t)})},mn=function(n,t){return dn(n,t).map(function(n){var e=sn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},gn=function(n,t){return dn(n,t).map(function(n){var e=sn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},pn=function(n,e,t){return""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},hn=function(n,e){return-1!==n.indexOf(e)},vn=function(n,e){return pn(n,e,0)},bn=function(n,e){return pn(n,e,n.length-e.length)},wn=(i=/^\s+|\s+$/g,function(n){return n.replace(i,"")}),yn=function(n){return 0<n.length},Cn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,xn=function(e){return function(n){return hn(n,e)}},Sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return hn(n,"edge/")&&hn(n,"chrome")&&hn(n,"safari")&&hn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Cn],search:function(n){return hn(n,"chrome")&&!hn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return hn(n,"msie")||hn(n,"trident")}},{name:"Opera",versionRegexes:[Cn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:xn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:xn("firefox")},{name:"Safari",versionRegexes:[Cn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(hn(n,"safari")||hn(n,"mobile/"))&&hn(n,"applewebkit")}}],Tn=[{name:"Windows",search:xn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return hn(n,"iphone")||hn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:xn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:xn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:xn("linux"),versionRegexes:[]},{name:"Solaris",search:xn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:xn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:xn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Rn={browsers:b(Sn),oses:b(Tn)},Dn="Firefox",On=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(Dn),isSafari:r("Safari")}},An={unknown:function(){return On({current:undefined,version:sn.unknown()})},nu:On,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b(Dn),safari:b("Safari")},kn="Windows",In="Android",Bn="Solaris",En="FreeBSD",Pn="ChromeOS",Mn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(kn),isiOS:r("iOS"),isAndroid:r(In),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(Bn),isFreeBSD:r(En),isChromeOS:r(Pn)}},Nn={unknown:function(){return Mn({current:undefined,version:sn.unknown()})},nu:Mn,windows:b(kn),ios:b("iOS"),android:b(In),linux:b("Linux"),osx:b("OSX"),solaris:b(Bn),freebsd:b(En),chromeos:b(Pn)},jn=function(n,e){var t,r,o,u,i,c,a,l,f,s,d,m,g=Rn.browsers(),p=Rn.oses(),h=mn(g,n).fold(An.unknown,An.nu),v=gn(p,n).fold(Nn.unknown,Nn.nu);return{browser:h,os:v,deviceType:(r=h,o=n,u=e,i=(t=v).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),l=a||u("(pointer:coarse)"),f=i||!c&&a&&u("(min-device-width:768px)"),s=c||a&&!f,d=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),m=!s&&!f&&!d,{isiPad:b(i),isiPhone:b(c),isTablet:b(f),isPhone:b(s),isTouch:b(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:b(d),isDesktop:b(m)})}},Wn=function(n){return window.matchMedia(n).matches},Ln=cn(function(){return jn(navigator.userAgent,Wn)}),zn=function(){return Ln()},_n=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:n}},Fn={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return _n(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return _n(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return _n(t)},fromDom:_n,fromPoint:function(n,e,t){return N.from(n.dom.elementFromPoint(e,t)).map(_n)}},Hn=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(r.matches!==undefined)return r.matches(e);if(r.msMatchesSelector!==undefined)return r.msMatchesSelector(e);if(r.webkitMatchesSelector!==undefined)return r.webkitMatchesSelector(e);if(r.mozMatchesSelector!==undefined)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},qn=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Vn=function(n,e){return n.dom===e.dom},Un=function(n,e){return t=n.dom,r=e.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(r)&o);var t,r,o},$n=function(n,e){return zn().browser.isIE()?Un(n,e):(t=e,(r=n.dom)!==(o=t.dom)&&r.contains(o));var t,r,o},Gn=Hn,Kn=Object.keys,Xn=Object.hasOwnProperty,Yn=function(n,e){for(var t=Kn(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},Jn=function(n,t){return Qn(n,function(n,e){return{k:e,v:t(n,e)}})},Qn=function(n,r){var o={};return Yn(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},Zn=function(n,e){var t,r,o,u,i={};return t=e,u=i,r=function(n,e){u[e]=n},o=C,Yn(n,function(n,e){(t(n,e)?r:o)(n,e)}),i},ne=function(n,t){var r=[];return Yn(n,function(n,e){r.push(t(n,e))}),r},ee=function(n){return Kn(n).length},te=function(n,e){return re(n,e)?N.from(n[e]):N.none()},re=function(n,e){return Xn.call(n,e)},oe=function(n,e){return re(n,e)&&n[e]!==undefined&&null!==n[e]},ue=["tfoot","thead","tbody","colgroup"],ie=function(n,e,t){return{element:n,rowspan:e,colspan:t}},ce=function(n,e,t){return{element:n,cells:e,section:t}},ae=function(n,e,t){return{element:n,isNew:e,isLocked:t}},le=function(n,e){return{cells:n,section:e}},fe=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),se=function(n){return n.dom.nodeType},de=function(e){return function(n){return se(n)===e}},me=function(n){return 8===se(n)||"#comment"===fe(n)},ge=de(1),pe=de(3),he=de(9),ve=de(11),be=function(e){return function(n){return ge(n)&&fe(n)===e}},we=function(n){return Fn.fromDom(n.dom.ownerDocument)},ye=function(n){return he(n)?n:we(n)},Ce=function(n){return N.from(n.dom.parentNode).map(Fn.fromDom)},xe=function(n,e){for(var t=P(e)?e:v,r=n.dom,o=[];null!==r.parentNode&&r.parentNode!==undefined;){var u=r.parentNode,i=Fn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},Se=function(n){return N.from(n.dom.previousSibling).map(Fn.fromDom)},Te=function(n){return N.from(n.dom.nextSibling).map(Fn.fromDom)},Re=function(n){return q(n.dom.childNodes,Fn.fromDom)},De=function(n,e){var t=n.dom.childNodes;return N.from(t[e]).map(Fn.fromDom)},Oe=P(Element.prototype.attachShadow)&&P(Node.prototype.getRootNode),Ae=b(Oe),ke=Oe?function(n){return Fn.fromDom(n.dom.getRootNode())}:ye,Ie=function(n){var e,t=ke(n);return ve(e=t)&&E(e.dom.host)?N.some(t):N.none()},Be=function(n){return Fn.fromDom(n.dom.host)},Ee=function(n){return E(n.dom.shadowRoot)},Pe=function(n){var e=pe(n)?n.dom.parentNode:n.dom;if(e===undefined||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return Ie(Fn.fromDom(e)).fold(function(){return o.body.contains(e)},(t=Pe,r=Be,function(n){return t(r(n))}))},Me=function(n){var e=n.dom.body;if(null===e||e===undefined)throw new Error("Body is not available yet");return Fn.fromDom(e)},Ne=function(n,e){var t=[];return V(Re(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(Ne(n,e))}),t},je=function(n,e,t){return r=function(n){return Hn(n,e)},U(xe(n,t),r);var r},We=function(n,e){return t=function(n){return Hn(n,e)},U(Re(n),t);var t},Le=function(n,e){return t=e,o=(r=n)===undefined?document:r.dom,qn(o)?[]:q(o.querySelectorAll(t),Fn.fromDom);var t,r,o},ze=function(n,e,t){for(var r=n.dom,o=P(t)?t:v;r.parentNode;){r=r.parentNode;var u=Fn.fromDom(r);if(e(u))return N.some(u);if(o(u))break}return N.none()},_e=function(n,e,t){return ze(n,function(n){return Hn(n,e)},t)},Fe=function(n,e){return t=function(n){return Hn(n,e)},K(n.dom.childNodes,function(n){return t(Fn.fromDom(n))}).map(Fn.fromDom);var t},He=function(n,e){return t=e,o=(r=n)===undefined?document:r.dom,qn(o)?N.none():N.from(o.querySelector(t)).map(Fn.fromDom);var t,r,o},qe=function(n,e,t){return o(Hn,_e,n,e,t)},Ve=function(n,e,t){if(!(O(t)||I(t)||j(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},Ue=function(n,e,t){Ve(n.dom,e,t)},$e=function(n,e){var t=n.dom;Yn(e,function(n,e){Ve(t,e,n)})},Ge=function(n,e){var t=n.dom.getAttribute(e);return null===t?undefined:t},Ke=function(n,e){return N.from(Ge(n,e))},Xe=function(n,e){n.dom.removeAttribute(e)},Ye=function(n){return G(n.dom.attributes,function(n,e){return n[e.name]=e.value,n},{})},Je=function(n){return n.style!==undefined&&P(n.style.getPropertyValue)},Qe=function(n,e,t){if(!O(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Je(n)&&n.style.setProperty(e,t)},Ze=function(n,e,t){var r=n.dom;Qe(r,e,t)},nt=function(n,e){var t=n.dom;Yn(e,function(n,e){Qe(t,e,n)})},et=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||Pe(n)?r:tt(t,e)},tt=function(n,e){return Je(n)?n.style.getPropertyValue(e):""},rt=function(n,e){var t=n.dom,r=tt(t,e);return N.from(r).filter(function(n){return 0<n.length})},ot=function(n,e){var t,r,o=n.dom;r=e,Je(t=o)&&t.style.removeProperty(r),Ke(n,"style").map(wn).is("")&&Xe(n,"style")},ut=function(n,e,t){return void 0===t&&(t=0),Ke(n,e).map(function(n){return parseInt(n,10)}).getOr(t)},it=function(n,e){return ut(n,e,1)},ct=function(n){return 1<it(n,"colspan")},at=function(n){return 1<it(n,"rowspan")},lt=function(n,e){return parseInt(et(n,e),10)},ft=b(10),st=b(10),dt=function(n,e){return mt(n,e,T)},mt=function(n,e,t){return J(Re(n),function(n){return Hn(n,e)?t(n)?[n]:[]:mt(n,e,t)})},gt=function(n,e){return t=["td","th"],void 0===(o=e)&&(o=v),o(r=n)?N.none():_(t,fe(r))?N.some(r):_e(r,t.join(","),function(n){return Hn(n,"table")||o(n)});var t,r,o},pt=function(n){return dt(n,"th,td")},ht=function(n){return Hn(n,"colgroup")?We(n,"col"):J(wt(n),function(n){return We(n,"col")})},vt=function(n,e){return qe(n,"table",e)},bt=function(n){return dt(n,"tr")},wt=function(n){return vt(n).fold(b([]),function(n){return We(n,"colgroup")})},yt=function(n,t){return q(n,function(n){if("colgroup"!==fe(n))return e=q(pt(n),function(n){var e=ut(n,"rowspan",1),t=ut(n,"colspan",1);return ie(n,e,t)}),ce(n,e,t(n));var e=q(ht(n),function(n){var e=ut(n,"span",1);return ie(n,1,e)});return ce(n,e,"colgroup")})},Ct=function(n){return Ce(n).map(function(n){var e=fe(n);return _(ue,e)?e:"tbody"}).getOr("tbody")},xt=function(n){var e=bt(n),t=c(wt(n),e);return yt(t,Ct)},St=function(n,e,t){var r=n.cells,o=r.slice(0,e),u=r.slice(e),i=o.concat(t).concat(u);return Dt(n,i)},Tt=function(n,e,t){return St(n,e,[t])},Rt=function(n,e,t){n.cells[e]=t},Dt=function(n,e){return le(e,n.section)},Ot=function(n,e){var t=n.cells,r=q(t,e);return le(r,n.section)},At=function(n,e){return n.cells[e]},kt=function(n,e){return At(n,e).element},It=function(n){return n.cells.length},Bt=function(n){var e=function(n,e){for(var t=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(e(i,o)?t:r).push(i)}return{pass:t,fail:r}}(n,function(n){return"colgroup"===n.section});return{rows:e.fail,cols:e.pass}},Et="data-snooker-locked-cols",Pt=function(n){return Ke(n,Et).bind(function(n){return N.from(n.match(/\d+/g))}).map(function(n){return Z(n,T)})},Mt=function(n){var e,t,r,o=G(Bt(n).rows,function(t,n){return V(n.cells,function(n,e){n.isLocked&&(t[e]=!0)}),t},{});return e=ne(o,function(n,e){return parseInt(e,10)}),(r=W.call(e,0)).sort(t),r},Nt=function(n,e){return n+","+e},jt=function(n,e){var t=J(n.all,function(n){return n.cells});return U(t,e)},Wt=function(n){var l={},e=[],t={},f=tn(n).map(function(n){return n.element}).bind(vt).bind(Pt).getOr({}),r=0,s=0,d=0;return V(n,function(n){var a,o,u;"colgroup"===n.section?(o={},u=0,V(n.cells,function(t){var r=t.colspan;H(r,function(n){var e=u+n;o[e]={element:t.element,colspan:r,column:e}}),u+=r}),t=o):(a=[],V(n.cells,function(n){for(var e=0;l[Nt(d,e)]!==undefined;)e++;for(var t=oe(f,e.toString()),r={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:d,column:e,isLocked:t},o=0;o<n.colspan;o++)for(var u=0;u<n.rowspan;u++){var i=e+o,c=Nt(d+u,i);l[c]=r,s=Math.max(s,i+1)}a.push(r)}),r++,e.push(ce(n.element,a,n.section)),d++)}),{grid:{rows:r,columns:s},access:l,all:e,columns:t}},Lt={fromTable:function(n){var e=xt(n);return Wt(e)},generate:Wt,getAt:function(n,e,t){var r=n.access[Nt(e,t)];return r!==undefined?N.some(r):N.none()},findItem:function(n,e,t){var r=jt(n,function(n){return t(e,n.element)});return 0<r.length?N.some(r[0]):N.none()},filterItems:jt,justCells:function(n){return J(n.all,function(n){return n.cells})},justColumns:function(n){return e=n.columns,ne(e,function(n){return n});var e},hasColumns:function(n){return 0<Kn(n.columns).length},getColumnAt:function(n,e){return N.from(n.columns[e])}},zt=function(n,e){var t=e.column,r=e.column+e.colspan-1,o=e.row,u=e.row+e.rowspan-1;return t<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},_t=function(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow},Ft=function(n,e,t){var r=Lt.findItem(n,e,Vn),o=Lt.findItem(n,t,Vn);return r.bind(function(r){return o.map(function(n){return e=r,t=n,{startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)};var e,t})})},Ht=function(e,n,t){return Ft(e,n,t).bind(function(n){return function(n,e){for(var t=!0,r=S(_t,e),o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)t=t&&Lt.getAt(n,o,u).exists(r);return t?N.some(e):N.none()}(e,n)})},qt=function(t,n,e){return Ft(t,n,e).map(function(n){var e=Lt.filterItems(t,S(zt,n));return q(e,function(n){return n.element})})},Vt=function(n,e){return Lt.findItem(n,e,function(n,e){return $n(e,n)}).map(function(n){return n.element})},Ut=function(i,c,a){return vt(i).bind(function(n){var r,e,o,u,t=Gt(n);return r=t,e=i,o=c,u=a,Lt.findItem(r,e,Vn).bind(function(n){var e=0<o?n.row+n.rowspan-1:n.row,t=0<u?n.column+n.colspan-1:n.column;return Lt.getAt(r,e+o,t+u).map(function(n){return n.element})})})},$t=function(n,e,t,r,o){var u=Gt(n),i=Vn(n,t)?N.some(e):Vt(u,e),c=Vn(n,o)?N.some(r):Vt(u,r);return i.bind(function(e){return c.bind(function(n){return qt(u,e,n)})})},Gt=Lt.fromTable,Kt=function(e,t){Ce(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Xt=function(n,e){Te(n).fold(function(){Ce(n).each(function(n){Jt(n,e)})},function(n){Kt(n,e)})},Yt=function(e,t){De(e,0).fold(function(){Jt(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},Jt=function(n,e){n.dom.appendChild(e.dom)},Qt=function(n,e){Kt(n,e),Jt(e,n)},Zt=function(r,o){V(o,function(n,e){var t=0===e?r:o[e-1];Xt(t,n)})},nr=function(e,n){V(n,function(n){Jt(e,n)})},er=function(n){n.dom.textContent="",V(Re(n),function(n){tr(n)})},tr=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},rr=function(n){var e,t=Re(n);0<t.length&&(e=n,V(t,function(n){Kt(e,n)})),tr(n)},or=(a=pe,l="text",{get:function(n){if(!a(n))throw new Error("Can only get "+l+" value of a "+l+" node");return f(n).getOr("")},getOption:f=function(n){return a(n)?N.from(n.dom.nodeValue):N.none()},set:function(n,e){if(!a(n))throw new Error("Can only set raw "+l+" value of a "+l+" node");n.dom.nodeValue=e}}),ur=function(n){return or.get(n)},ir=function(n){return or.getOption(n)},cr=function(n,e){return or.set(n,e)},ar=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lr=function(r,o,n,e){var t=o(r,n);return $(e,function(n,e){var t=o(r,e);return fr(r,n,t)},t)},fr=function(e,n,t){return n.bind(function(n){return t.filter(S(e.eq,n))})},sr=function(n,e,t){return 0<t.length?lr(n,e,(r=t)[0],r.slice(1)):N.none();var r},dr=function(t,n,e,r){void 0===r&&(r=v);var o=[n].concat(t.up().all(n)),u=[e].concat(t.up().all(e)),i=function(e){return X(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},c=i(o),a=i(u),l=K(c,function(n){return F(a,(e=n,S(t.eq,e)));var e});return{firstpath:c,secondpath:a,shared:l}},mr=n(),gr=function(t,n){return sr(mr,function(n,e){return t(e)},n)},pr=function(n){return _e(n,"table")},hr=function(l,f,s){var d=function(e){return function(n){return s!==undefined&&s(n)||Vn(n,e)}};return Vn(l,f)?N.some({boxes:N.some([l]),start:l,finish:f}):pr(l).bind(function(a){return pr(f).bind(function(u){if(Vn(a,u))return N.some({boxes:(o=l,i=f,c=Gt(a),qt(c,o,i)),start:l,finish:f});if($n(a,u)){var n=0<(e=je(f,"td,th",d(a))).length?e[e.length-1]:f;return N.some({boxes:$t(a,l,a,f,u),start:l,finish:n})}if($n(u,a)){var e,t=0<(e=je(l,"td,th",d(u))).length?e[e.length-1]:l;return N.some({boxes:$t(u,l,a,f,u),start:l,finish:t})}return dr(mr,l,f,r).shared.bind(function(n){return qe(n,"table",s).bind(function(n){var e=je(f,"td,th",d(n)),t=0<e.length?e[e.length-1]:f,r=je(l,"td,th",d(n)),o=0<r.length?r[r.length-1]:l;return N.some({boxes:$t(n,l,a,f,u),start:o,finish:t})})});var r,o,i,c})})},vr=function(n,e){var t=Le(n,e);return 0<t.length?N.some(t):N.none()},br=function(n,e,r){return He(n,e).bind(function(t){return He(n,r).bind(function(e){return gr(pr,[t,e]).map(function(n){return{first:t,last:e,table:n}})})})},wr=function(n,e,t,r,o){return u=o,K(n,function(n){return Hn(n,u)}).bind(function(n){return Ut(n,e,t).bind(function(n){return t=r,_e(e=n,"table").bind(function(n){return He(n,t).bind(function(n){return hr(n,e).bind(function(e){return e.boxes.map(function(n){return{boxes:n,start:e.start,finish:e.finish}})})})});var e,t})});var u},yr=vr,Cr=function(o,n,e){return br(o,n,e).bind(function(i){var n=function(n){return Vn(o,n)},e="thead,tfoot,tbody,table",t=_e(i.first,e,n),r=_e(i.last,e,n);return t.bind(function(u){return r.bind(function(n){return Vn(u,n)?(e=i.table,t=i.first,r=i.last,o=Gt(e),Ht(o,t,r)):N.none();var e,t,r,o})})})},xr=function(i){if(!k(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return V(i,function(n,r){var e=Kn(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(t[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!k(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.length;if(e!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+e);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+n.length);return n[r].apply(null,t)},match:function(n){var e=Kn(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!Q(c,function(n){return _(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},Sr=xr([{none:[]},{multiple:["elements"]},{single:["element"]}]),Tr=function(n,e,t,r){return n.fold(e,t,r)},Rr=Sr.none,Dr=Sr.multiple,Or=Sr.single,Ar=tinymce.util.Tools.resolve("tinymce.PluginManager"),kr=function(n,e){return Fn.fromDom(n.dom.cloneNode(e))},Ir=function(n){return kr(n,!1)},Br=function(n){return kr(n,!0)},Er=function(n,e){var t,r,o,u,i=(t=n,r=e,o=Fn.fromTag(r),u=Ye(t),$e(o,u),o),c=Re(Br(n));return nr(i,c),i},Pr=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Mr=function(n,e){return n?N.some(e):N.none()},Nr=function(r,o){var n=function(n){var e=o(n);if(e<=0||null===e){var t=et(n,r);return parseFloat(t)||0}return e},u=function(o,n){return G(n,function(n,e){var t=et(o,e),r=t===undefined?0:parseInt(t,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!j(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom;Je(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:u,max:function(n,e,t){var r=u(n,t);return r<e?e-r:0}}},jr=Nr("width",function(n){return n.dom.offsetWidth}),Wr=function(n){return jr.get(n)},Lr=function(n){return jr.getOuter(n)},zr=function(t,r){void 0===r&&(r=T);var n=t.grid,e=H(n.columns,p),o=H(n.rows,p);return q(e,function(e){return _r(function(){return J(o,function(n){return Lt.getAt(t,n,e).filter(function(n){return n.column===e}).toArray()})},function(n){return 1===n.colspan&&r(n.element)},function(){return Lt.getAt(t,0,e)})})},_r=function(n,e,t){var r=n();return K(r,e).orThunk(function(){return N.from(r[0]).orThunk(t)}).map(function(n){return n.element})},Fr=function(t){var n=t.grid,e=H(n.rows,p),r=H(n.columns,p);return q(e,function(e){return _r(function(){return J(r,function(n){return Lt.getAt(t,e,n).filter(function(n){return n.row===e}).fold(b([]),function(n){return[n]})})},function(n){return 1===n.rowspan},function(){return Lt.getAt(t,e,0)})})},Hr=function(r,o){if(o<0||o>=r.length-1)return N.none();var n=r[o].fold(function(){var n,e,t=(n=r.slice(0,o),(e=W.call(n,0)).reverse(),e);return on(t,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return N.some({value:n,delta:0})}),e=r[o+1].fold(function(){var n=r.slice(o+1);return on(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return N.some({value:n,delta:1})});return n.bind(function(t){return e.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},qr=function(e,t){return function(n){return"rtl"===Vr(n)?t:e}},Vr=function(n){return"rtl"===et(n,"direction")?"rtl":"ltr"},Ur=Nr("height",function(n){var e=n.dom;return Pe(n)?e.getBoundingClientRect().height:e.offsetHeight}),$r=function(n){return Ur.get(n)},Gr=function(n){return Ur.getOuter(n)},Kr=function(t,r){return{left:t,top:r,translate:function(n,e){return Kr(t+n,r+e)}}},Xr=Kr,Yr=function(n,e){return n!==undefined?n:e!==undefined?e:0},Jr=function(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return Xr(t.offsetLeft,t.offsetTop);var u=Yr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Yr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Yr(o.clientTop,t.clientTop),a=Yr(o.clientLeft,t.clientLeft);return Qr(n).translate(i-a,u-c)},Qr=function(n){var e,t=n.dom,r=t.ownerDocument.body;return r===t?Xr(r.offsetLeft,r.offsetTop):Pe(n)?(e=t.getBoundingClientRect(),Xr(e.left,e.top)):Xr(0,0)},Zr=function(n,e){return{row:n,y:e}},no=function(n,e){return{col:n,x:e}},eo=function(n){return Jr(n).left+Lr(n)},to=function(n){return Jr(n).left},ro=function(n,e){return no(n,to(e))},oo=function(n,e){return no(n,eo(e))},uo=function(n){return Jr(n).top},io=function(n,e){return Zr(n,uo(e))},co=function(n,e){return Zr(n,uo(e)+Gr(e))},ao=function(t,e,r){if(0===r.length)return[];var n=q(r.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=r[r.length-1].map(function(n){return e(r.length-1,n)});return n.concat([o])},lo={delta:p,positions:function(n){return ao(io,co,n)},edge:uo},fo=qr({delta:p,edge:to,positions:function(n){return ao(ro,oo,n)}},{delta:function(n){return-n},edge:eo,positions:function(n){return ao(oo,ro,n)}}),so={delta:function(n,e){return fo(e).delta(n,e)},positions:function(n,e){return fo(e).positions(n,e)},edge:function(n){return fo(n).edge(n)}},mo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},go=(d="[eE][+-]?[0-9]+",g=["Infinity",(s="[0-9]+")+"\\."+(m=function(n){return"(?:"+n+")?"})(s)+m(d),"\\."+s+m(d),s+m(d)].join("|"),new RegExp("^([+-]?(?:"+g+"))(.*)$")),po=function(n,o){return N.from(go.exec(n)).bind(function(n){var e,t=Number(n[1]),r=n[2];return e=r,F(o,function(n){return F(mo[n],function(n){return e===n})})?N.some({value:t,unit:r}):N.none()})},ho=function(){var n=zn().browser;return n.isIE()||n.isEdge()},vo=function(n,e,t){return r=et(n,e),o=t,u=parseFloat(r),isNaN(u)?o:u;var r
,o,u},bo=function(n){return ho()?(t=(e=n).dom.getBoundingClientRect().height,"border-box"===et(e,"box-sizing")?t:t-vo(e,"padding-top",0)-vo(e,"padding-bottom",0)-(vo(e,"border-top-width",0)+vo(e,"border-bottom-width",0))):vo(n,"height",$r(n));var e,t},wo=function(n){return ho()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===et(e,"box-sizing")?t:t-vo(e,"padding-left",0)-vo(e,"padding-right",0)-(vo(e,"border-left-width",0)+vo(e,"border-right-width",0))):vo(n,"width",Wr(n));var e,t},yo=/(\d+(\.\d+)?)%/,Co=/(\d+(\.\d+)?)px|em/,xo=function(n,e){var t,r=(t=n,N.from(t.dom.offsetParent).map(Fn.fromDom).getOr(Me(we(n))));return e(n)/e(r)*100},So=function(n,e){Ze(n,"width",e+"px")},To=function(n,e){Ze(n,"width",e+"%")},Ro=function(n,e){Ze(n,"height",e+"px")},Do=function(n,e,t,r){var o,u,i,c,a=parseInt(n,10);return bn(n,"%")&&"table"!==fe(e)?(u=a,i=t,r(o,c=vt(o=e).map(function(n){var e=i(n);return Math.floor(u/100*e)}).getOr(u)),c):a},Oo=function(n){var e,t=rt(e=n,"height").getOrThunk(function(){return bo(e)+"px"});return t?Do(t,n,$r,Ro):$r(n)},Ao=function(n){return rt(n,"width").fold(function(){return N.from(Ge(n,"width"))},function(n){return N.some(n)})},ko=function(n,e){return n/e.pixelWidth()*100},Io=function(e,t){return Ao(e).fold(function(){var n=Wr(e);return ko(n,t)},function(n){return function(n,e,t){var r=yo.exec(e);if(null!==r)return parseFloat(r[1]);var o=wo(n);return ko(o,t)}(e,n,t)})},Bo=function(e,t){return Ao(e).fold(function(){return wo(e)},function(n){return function(n,e,t){var r=Co.exec(e);if(null!==r)return parseInt(r[1],10);var o=yo.exec(e);return null===o?wo(n):parseFloat(o[1])/100*t.pixelWidth()}(e,n,t)})},Eo=function(n){return t="rowspan",Oo(e=n)/it(e,t);var e,t},Po=function(n,e,t){Ze(n,"width",e+t)},Mo=function(n){return xo(n,Wr)+"%"},No=b(yo),jo=b(Co),Wo=be("col"),Lo=function(n,e,t){return rt(n,e).fold(function(){return t(n)+"px"},function(n){return n})},zo=function(n,e){return Lo(n,"width",function(n){return Wo(n)?Wr(n):Bo(n,e)})},_o=function(n){return Lo(n,"height",Eo)},Fo=function(n,e){return rt(n,e).isSome()},Ho=function(n,e,t,r,o,u){return n.filter(r).fold(function(){return u(Hr(t,e))},function(n){return o(n)})},qo=function(n,e,u,i,c){var t,a=zr(n,function(n){return Fo(n,"width")}),r=Lt.hasColumns(n)?(t=n,q(Lt.justColumns(t),function(n){return N.from(n.element)})):a,l=[N.some(so.edge(e))].concat(q(so.positions(a,e),function(n){return n.map(function(n){return n.x})})),f=h(ct);return q(r,function(n,o){return Ho(n,o,l,f,function(n){if(!Wo(t=n)||Fo(t,"width"))return u(n,c);var e,t,r=(e=a[o])!==undefined&&null!==e?p(e):N.none();return Ho(r,o,l,f,function(n){return i(N.some(Wr(n)))},i)},i)})},Vo=function(n){return n.map(function(n){return n+"px"}).getOr("")},Uo=function(n,e,t){return qo(n,e,Bo,function(n){return n.getOrThunk(t.minCellWidth)},t)},$o=function(n,e,t,r,o){var u=Fr(n),i=[N.some(t.edge(e))].concat(q(t.positions(u,e),function(n){return n.map(function(n){return n.y})}));return q(u,function(n,e){return Ho(n,e,i,h(at),r,o)})},Go=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},Ko=function(t){var n=function(){return Wr(t)},e=b(0);return{width:n,pixelWidth:n,getWidths:function(n,e){return Uo(n,t,e)},getCellDelta:e,singleColumnWidth:b([0]),minCellWidth:e,setElementWidth:C,adjustTableWidth:C,isRelative:!0,label:"none"}},Xo=function(n,r){var o=Go(parseFloat(n)),u=Go(Wr(r));return{width:o.get,pixelWidth:u.get,getWidths:function(n,e){return qo(n,r,Io,function(n){return n.fold(function(){return t.minCellWidth()},function(n){return n/t.pixelWidth()*100})},t=e);var t},getCellDelta:function(n){return n/u.get()*100},singleColumnWidth:function(n){return[100-n]},minCellWidth:function(){return ft()/u.get()*100},setElementWidth:To,adjustTableWidth:function(n){var e=o.get(),t=e+n/100*e;To(r,t),o.set(t),u.set(Wr(r))},isRelative:!0,label:"percent"}},Yo=function(n,t){var r=Go(n),o=r.get;return{width:o,pixelWidth:o,getWidths:function(n,e){return Uo(n,t,e)},getCellDelta:p,singleColumnWidth:function(n,e){return[Math.max(ft(),n+e)-n]},minCellWidth:ft,setElementWidth:So,adjustTableWidth:function(n){var e=o()+n;So(t,e),r.set(e)},isRelative:!1,label:"pixel"}},Jo=function(e){return Ao(e).fold(function(){return Ko(e)},function(n){return function(n,e){var t=No().exec(e);if(null!==t)return Xo(t[1],n);var r=jo().exec(e);if(null!==r){var o=parseInt(r[1],10);return Yo(o,n)}var u=Wr(n);return Yo(u,n)}(e,n)})},Qo=Yo,Zo=Xo,nu=function(n,e,t,r){for(var o,u,i,c=e.grid.columns,a=e.grid.rows,l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<t.minRow||l>t.maxRow||s<t.minCol||s>t.maxCol||(Lt.getAt(e,l,s).filter(r).isNone()?(o=f,u=n[l].element,i=Fn.fromTag("td"),Jt(i,Fn.fromTag("br")),(o?Jt:Yt)(u,i)):f=!0)},eu=function(n,e){var t,u,r,i,c,a,l,f,s,o=function(n){return Hn(n.element,e)},d=Br(n),m=xt(d),g=Jo(n),p=Lt.generate(m),h=(u=o,r=(t=p).grid.columns,i=t.grid.rows,c=r,l=a=0,f=[],s=[],Yn(t.access,function(n){var e,t,r,o;f.push(n),u(n)&&(s.push(n),t=(e=n.row)+n.rowspan-1,o=(r=n.column)+n.colspan-1,e<i?i=e:a<t&&(a=t),r<c?c=r:l<o&&(l=o))}),{minRow:i,minCol:c,maxRow:a,maxCol:l,allCells:f,selectedCells:s}),v="th:not("+e+"),td:not("+e+")",b=mt(d,"th,td",function(n){return Hn(n,v)});return V(b,tr),nu(m,p,h,o),function(n,e,t,r){Yn(t.columns,function(n){(n.column<e.minCol||n.column>e.maxCol)&&tr(n.element)});var o=U(dt(n,"tr"),function(n){return 0===n.dom.childElementCount});V(o,tr),e.minCol!==e.maxCol&&e.minRow!==e.maxRow||V(dt(n,"th,td"),function(n){Xe(n,"rowspan"),Xe(n,"colspan")}),Xe(n,Et),Xe(n,"data-snooker-col-series"),Jo(n).adjustTableWidth(r)}(d,h,p,function(n,e,t,r){if(0===r.minCol&&e.grid.columns===r.maxCol+1)return 0;var o=Uo(e,n,t),u=G(o,function(n,e){return n+e},0),i=G(o.slice(r.minCol,r.maxCol+1),function(n,e){return n+e},0)/u*t.pixelWidth()-t.pixelWidth();return t.getCellDelta(i)}(n,Lt.fromTable(n),g,h)),d},tu=function(n){return"img"===fe(n)?1:ir(n).fold(function(){return Re(n).length},function(n){return n.length})},ru=["img","br"],ou=function(n){return ir(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()||_(ru,fe(n))},uu=function(n){return o=ou,(u=function(n){for(var e=0;e<n.childNodes.length;e++){var t=Fn.fromDom(n.childNodes[e]);if(o(t))return N.some(t);var r=u(n.childNodes[e]);if(r.isSome())return r}return N.none()})(n.dom);var o,u},iu=function(n){return cu(n,ou)},cu=function(n,u){var i=function(n){for(var e=Re(n),t=e.length-1;0<=t;t--){var r=e[t];if(u(r))return N.some(r);var o=i(r);if(o.isSome())return o}return N.none()};return i(n)},au={scope:["row","col"]},lu=function(){var n=Fn.fromTag("td");return Jt(n,Fn.fromTag("br")),n},fu=function(){return Fn.fromTag("col")},su=function(){return Fn.fromTag("colgroup")},du=function(n,e,t){var r=Er(n,e);return Yn(t,function(n,e){null===n?Xe(r,e):Ue(r,e,n)}),r},mu=function(n){return n},gu=function(n){return function(){return Fn.fromTag("tr",n.dom)}},pu=function(f,n,s){var d=function(n,e){var t,r,o;t=e,r=n.element.dom,o=t.dom,Je(r)&&Je(o)&&(o.style.cssText=r.style.cssText),ot(e,"height"),1!==n.colspan&&ot(e,"width")};return{col:function(n){var e=we(n.element),t=Fn.fromTag(fe(n.element),e.dom);return d(n,t),f(n.element,t),t},colgroup:su,row:gu(n),cell:function(n){var r,o,u,i,c,e=we(n.element),t=Fn.fromTag(fe(n.element),e.dom),a=s.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),l=0<a.length?(r=n.element,o=t,u=a,uu(r).map(function(n){var e=u.join(","),t=je(n,e,function(n){return Vn(n,r)});return $(t,function(n,e){var t=Ir(e);return Xe(t,"contenteditable"),Jt(n,t),t},o)}).getOr(o)):t;return Jt(l,Fn.fromTag("br")),d(n,t),i=n.element,c=t,Yn(au,function(e,t){return Ke(i,t).filter(function(n){return _(e,n)}).each(function(n){return Ue(c,t,n)})}),f(n.element,t),t},replace:du,gap:lu}},hu=function(n){return{col:fu,colgroup:su,row:gu(n),cell:lu,replace:mu,gap:lu}},vu=function(n){return q(n,Fn.fromDom)},bu=function(n){return n.nodeName.toLowerCase()},wu=function(n){return Fn.fromDom(n.getBody())},yu=function(n){return n.getBoundingClientRect().width},Cu=function(n){return n.getBoundingClientRect().height},xu=function(e){return function(n){return Vn(n,wu(e))}},Su=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Tu=function(n){Xe(n,"data-mce-style");var e=function(n){return Xe(n,"data-mce-style")};V(pt(n),e),V(ht(n),e)},Ru=function(n,e){var t=n.dom.getStyle(e,"width")||n.dom.getAttrib(e,"width");return N.from(t).filter(yn)},Du=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},Ou=function(n){return Fn.fromDom(n.selection.getStart())},Au=function(n){return Tr(n.get(),b([]),p,nn)},ku={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Iu=function(n){return{element:n,mergable:N.none(),unmergable:N.none(),selection:[n]}},Bu=function(n,e,t){return{element:t,mergable:(u=e,i=ku,Tr(n.get(),N.none,function(e){return e.length<=1?N.none():Cr(u,i.firstSelectedSelector,i.lastSelectedSelector).map(function(n){return{bounds:n,cells:e}})},N.none)),unmergable:(r=function(n,e){return Ke(n,e).exists(function(n){return 1<parseInt(n,10)})},0<(o=Au(n)).length&&Q(o,function(n){return r(n,"rowspan")||r(n,"colspan")})?N.some(o):N.none()),selection:Au(n)};var r,o,u,i},Eu=function(s,n,d,m){s.on("BeforeGetContent",function(t){!0===t.selection&&Tr(n.get(),C,function(n){t.preventDefault(),vt(n[0]).map(function(n){var e=eu(n,"[data-mce-selected]");return Tu(e),[e]}).each(function(n){var e;t.content="text"===t.format?q(n,function(n){return n.dom.innerText}).join(""):(e=s,q(n,function(n){return e.selection.serializer.serialize(n.dom,{})}).join(""))})},C)}),s.on("BeforeSetContent",function(f){!0===f.selection&&!0===f.paste&&N.from(s.dom.getParent(s.selection.getStart(),"th,td")).each(function(n){var l=Fn.fromDom(n);vt(l).each(function(e){var n,t,r,o,u,i,c,a=U((n=f.content,(r=(t||document).createElement("div")).innerHTML=n,Re(Fn.fromDom(r))),function(n){return"meta"!==fe(n)});1===a.length&&(c=a[0],"table"===fe(c))&&(f.preventDefault(),o=Fn.fromDom(s.getDoc()),u=hu(o),i={element:l,clipboard:a[0],generators:u},d.pasteCells(e,i).each(function(n){s.selection.setRng(n.rng),s.focus(),m.clear(e)}))})})})},Pu=xr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Mu=un({},Pu),Nu=function(n,e,r,o,u){var t,i,c=n.slice(0),a=(i=e,0===(t=n).length?Mu.none():1===t.length?Mu.only(0):0===i?Mu.left(0,1):i===t.length-1?Mu.right(i-1,i):0<i&&i<t.length-1?Mu.middle(i-1,i,i+1):Mu.none()),l=b(q(c,b(0)));return a.fold(l,function(n){return o.singleColumnWidth(c[n],r)},function(n,e){return u.calcLeftEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)},function(n,e,t){return u.calcMiddleDeltas(c,n,e,t,r,o.minCellWidth(),o.isRelative)},function(n,e){return u.calcRightEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)})},ju=function(n,e,t){for(var r=0,o=n;o<e;o++)r+=t[o]!==undefined?t[o]:0;return r},Wu=function(n,e){return Lt.hasColumns(n)?(u=n,i=e,c=Lt.justColumns(u),q(c,function(n,e){return{element:n.element,width:i[e],colspan:n.colspan}})):(t=n,r=e,o=Lt.justCells(t),q(o,function(n){var e=ju(n.column,n.column+n.colspan,r);return{element:n.element,width:e,colspan:n.colspan}}));var t,r,o,u,i,c},Lu=function(n,e,t){var r=Wu(n,e);V(r,function(n){t.setElementWidth(n.element,n.width)})},zu=function(n,e,t,r,o){var u=Lt.fromTable(n),i=o.getCellDelta(e),c=o.getWidths(u,o),a=t===u.grid.columns-1,l=r.clampTableDelta(c,t,i,o.minCellWidth(),a),f=Nu(c,t,l,o,r),s=q(f,function(n,e){return n+c[e]});Lu(u,s,o),r.resizeTable(o.adjustTableWidth,l,a)},_u=function(n,t,r,e){var o,u,i,c,a=Lt.fromTable(n),l=$o(a,n,e,Eo,function(n){return n.getOrThunk(st)}),f=q(l,function(n,e){return r===e?Math.max(t+n,st()):n}),s=(o=a,u=f,i=Lt.justCells(o),q(i,function(n){var e=ju(n.row,n.row+n.rowspan,u);return{element:n.element,height:e,rowspan:n.rowspan}})),d=(c=f,q(a.all,function(n,e){return{element:n.element,height:c[e]}}));V(d,function(n){Ro(n.element,n.height)}),V(s,function(n){Ro(n.element,n.height)});var m=$(f,function(n,e){return n+e},0);Ro(n,m)},Fu=function(n){return q(n,b(0))},Hu=function(n,e,t,r,o){return o(n.slice(0,e)).concat(r).concat(o(n.slice(t)))},qu=function(i){return function(n,e,t,r){if(i(t)){var o=Math.max(r,n[e]-Math.abs(t)),u=Math.abs(o-n[e]);return 0<=t?u:-u}return t}},Vu=qu(function(n){return n<0}),Uu=qu(T),$u=function(){var f=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return q(n,function(n,e){return(e===t?u:n/o)-n})},c=function(n,e,t,r,o,u){return u?f(n,e,r,o):(a=t,l=Vu(i=n,c=e,r,o),Hu(i,c,a+1,[l,0],Fu));var i,c,a,l};return{resizeTable:function(n,e){return n(e)},clampTableDelta:Vu,calcLeftEdgeDeltas:c,calcMiddleDeltas:function(n,e,t,r,o,u,i){return c(n,t,r,o,u,i)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return f(n,t,r,o);var i=Vu(n,t,r,o);return Fu(n.slice(0,t)).concat([i])},calcRedestributedWidths:function(n,e,t,r){if(r){var o=(e+t)/e,u=q(n,function(n){return n/o});return{delta:100*o-100,newSizes:u}}return{delta:t,newSizes:n}}}},Gu=function(){var i=function(n,e,t,r,o){var u=Uu(n,0<=r?t:e,r,o);return Hu(n,e,t+1,[u,-u],Fu)};return{resizeTable:function(n,e,t){t&&n(e)},clampTableDelta:function(n,e,t,r,o){if(o){if(0<=t)return t;var u=G(n,function(n,e){return n+e-r},0);return Math.max(-u,t)}return Vu(n,e,t,r)},calcLeftEdgeDeltas:i,calcMiddleDeltas:function(n,e,t,r,o,u){return i(n,t,r,o,u)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return Fu(n);var i=r/n.length;return q(n,b(i))},calcRedestributedWidths:function(n){return{delta:0,newSizes:n}}}},Ku=function(n,e){var t=N.from(n.dom.documentElement).map(Fn.fromDom).getOr(n);return{parent:b(t),view:b(n),origin:b(Xr(0,0)),isResizable:e}},Xu=function(n,e,t){return{parent:b(e),view:b(n),origin:b(Xr(0,0)),isResizable:t}},Yu=xr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Ju=function(n,e,t){var r=t.substring(0,t.length-n.length),o=parseFloat(r);return r===o.toString()?e(o):Yu.invalid(t)},Qu=un(un({},Yu),{from:function(n){return bn(n,"%")?Ju("%",Yu.percent,n):bn(n,"px")?Ju("px",Yu.pixels,n):Yu.invalid(n)}}),Zu=function(n,r,o){return n.fold(function(){return r},function(n){return t=(e=n)/o,q(r,function(n){return Qu.from(n).fold(function(){return n},function(n){return n*t+"px"},function(n){return n/100*e+"px"})});var e,t},function(){return e=o,q(r,function(n){return Qu.from(n).fold(function(){return n},function(n){return n/e*100+"%"},function(n){return n+"%"})});var e})},ni=function(n,e,t){var r,o,u,i=Qu.from(t),c=Q(n,function(n){return"0px"===n})?(r=i,o=n.length,u=r.fold(function(){return b("")},function(n){return b(n/o+"px")},function(){return b(100/o+"%")}),H(o,u)):Zu(i,n,e);return ti(c)},ei=function(n,e){return 0===n.length?e:$(n,function(n,e){return Qu.from(e).fold(b(0),p,p)+n},0)},ti=function(n){if(0===n.length)return n;var e,t,r=$(n,function(n,e){var t=Qu.from(e).fold(function(){return{value:e,remainder:0}},function(n){return e=n,t="px",{value:(r=Math.floor(e))+t,remainder:e-r};var e,t,r},function(n){return{value:n+"%",remainder:0}});return{output:[t.value].concat(n.output),remainder:n.remainder+t.remainder}},{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(e=o[o.length-1],t=Math.round(r.remainder),Qu.from(e).fold(b(e),function(n){return n+t+"px"},function(n){return n+t+"%"}))])},ri=Qu.from,oi=function(n){return ri(n).fold(b("px"),b("px"),b("%"))},ui=function(l,n,e,f){var s=Lt.fromTable(l),a=s.all,d=Lt.justCells(s),m=Lt.justColumns(s);n.each(function(n){var r,o,u,i,e=oi(n),t=Wr(l),c=qo(s,l,zo,Vo,f),a=ni(c,t,n);Lt.hasColumns(s)?(u=a,i=e,V(m,function(n,e){var t=ei([u[e]],ft());Ze(n.element,"width",t+i)})):(r=a,o=e,V(d,function(n){var e=r.slice(n.column,n.colspan+n.column),t=ei(e,ft());Ze(n.element,"width",t+o)})),Ze(l,"width",n)}),e.each(function(n){var r,e,o,t=oi(n),u=$r(l),i=$o(s,l,lo,_o,Vo),c=ni(i,u,n);r=c,e=a,o=t,V(d,function(n){var e=r.slice(n.row,n.rowspan+n.row),t=ei(e,st());Ze(n.element,"height",t+o)}),V(e,function(n,e){Ze(n.element,"height",r[e])}),Ze(l,"height",n)})},ii=function(n){return Ao(n).exists(function(n){return yo.test(n)})},ci=function(n){return Ao(n).exists(function(n){return Co.test(n)})},ai=function(n){return Ao(n).isNone()},li=Mo,fi=function(n){return Lt.fromTable(n).grid},si=function(e){var o=[];return{bind:function(n){if(n===undefined)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=U(o,function(n){return n!==e})},trigger:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r={};V(e,function(n,e){r[n]=t[e]}),V(o,function(n){n(r)})}}},di=function(n){return{registry:Jn(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:Jn(n,function(n){return n.trigger})}},mi=function(n){return n.slice(0).sort()},gi=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");var t;return function(e,n){if(!k(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");V(n,function(n){if(!O(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})}("required",o),t=mi(o),K(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=Kn(e);Q(o,function(n){return _(t,n)})||function(n,e){throw new Error("All required keys ("+mi(o).join(", ")+") were not specified. Specified keys were: "+mi(e).join(", ")+".")}(0,t),r(o,t);var n=U(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+mi(n).join(", ")+") were not.")}(n,u.label),e}},pi=function(e,n){var t=U(n,function(n){return!_(e,n)});0<t.length&&function(){throw new Error("Unsupported keys for object: "+mi(t).join(", "))}()},hi=function(n){return gi(pi,n,{validate:P,label:"function"})},vi=hi(["compare","extract","mutate","sink"]),bi=hi(["element","start","stop","destroy"]),wi=hi(["forceDrop","drop","move","delayDrop"]),yi=function(){var u=N.none(),i=di({move:si(["info"])});return{onEvent:function(n,o){o.extract(n).each(function(n){var e,t,r;(e=o,t=n,r=u.map(function(n){return e.compare(n,t)}),u=N.some(t),r).each(function(n){i.trigger.move(n)})})},reset:function(){u=N.none()},events:i.registry}},Ci=function(){var n,e=(n=di({move:si(["info"])}),{onEvent:C,reset:C,events:n.registry}),t=yi(),r=e;return{on:function(){r.reset(),r=t},off:function(){r.reset(),r=e},isOn:function(){return r===t},onEvent:function(n,e){r.onEvent(n,e)},events:t.events}},xi=function(e,t,n){var r,o,u,i=!1,c=di({start:si([]),stop:si([])}),a=Ci(),l=function(){d.stop(),a.isOn()&&(a.off(),c.trigger.stop())},f=(r=l,o=200,u=null,{cancel:function(){null!==u&&(clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&clearTimeout(u),u=setTimeout(function(){r.apply(null,n),u=null},o)}});a.events.move.bind(function(n){t.mutate(e,n.info)});var s=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i&&t.apply(null,n)}},d=t.sink(wi({forceDrop:l,drop:s(l),move:s(function(n){f.cancel(),a.onEvent(n,t)}),delayDrop:s(f.throttle)}),n);return{element:d.element,go:function(n){d.start(n),a.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}},Si=function(n){var t,r,e=Fn.fromDom(function(n){if(Ae()&&E(n.target)){var e=Fn.fromDom(n.target);if(ge(e)&&Ee(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return tn(t)}}return N.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,r=o,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))});return{target:e,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},Ti=function(n,e,t,r,o){var u,i,c=(u=t,i=r,function(n){u(n)&&i(Si(n))});return n.dom.addEventListener(e,c,o),{unbind:S(Ri,n,e,c,o)}},Ri=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},Di=T,Oi=function(n,e,t){return Ti(n,e,Di,t,!1)},Ai=Si,ki=function(n,e){var t=Ge(n,e);return t===undefined||""===t?[]:t.split(" ")},Ii=function(n){return n.dom.classList!==undefined},Bi=function(n,e){return o=e,u=ki(t=n,r="class").concat([o]),Ue(t,r,u.join(" ")),!0;var t,r,o,u},Ei=function(n,e){Ii(n)?n.dom.classList.add(e):Bi(n,e)},Pi=function(n,e){return Ii(n)&&n.dom.classList.contains(e)},Mi=function(n){var e=n.replace(/\./g,"-");return{resolve:function(n){return e+"-"+n}}},Ni=Mi("ephox-dragster").resolve,ji=vi({compare:function(n,e){return Xr(e.left-n.left,e.top-n.top)},extract:function(n){return N.some(Xr(n.x,n.y))},sink:function(n,e){var t,r,o,u=(t=e,r=un({layerClass:Ni("blocker")},t),o=Fn.fromTag("div"),Ue(o,"role","presentation"),nt(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Ei(o,Ni("blocker")),Ei(o,r.layerClass),{element:function(){return o},destroy:function(){tr(o)}}),i=Oi(u.element(),"mousedown",n.forceDrop),c=Oi(u.element(),"mouseup",n.drop),a=Oi(u.element(),"mousemove",n.move),l=Oi(u.element(),"mouseout",n.delayDrop);return bi({element:u.element,start:function(n){Jt(n,u.element())},stop:function(){tr(u.element())},destroy:function(){u.destroy(),c.unbind(),a.unbind(),l.unbind(),i.unbind()}})},mutate:function(n,e){n.mutate(e.left,e.top)}}),Wi=function(n){return"true"===Ge(n,"contenteditable")},Li=Mi("ephox-snooker").resolve,zi=function(){var t,r=di({drag:si(["xDelta","yDelta","target"])}),o=N.none(),n={mutate:function(n,e){t.trigger.drag(n,e)},events:(t=di({drag:si(["xDelta","yDelta"])})).registry};return n.events.drag.bind(function(e){o.each(function(n){r.trigger.drag(e.xDelta,e.yDelta,n)})}),{assign:function(n){o=N.some(n)},get:function(){return o},mutate:n.mutate,events:r.registry}},_i=Li("resizer-bar"),Fi=Li("resizer-rows"),Hi=Li("resizer-cols"),qi=function(n){var e=Le(n.parent(),"."+_i);V(e,tr)},Vi=function(t,n,r){var o=t.origin();V(n,function(n){n.each(function(n){var e=r(o,n);Ei(e,_i),Jt(t.parent(),e)})})},Ui=function(n,e,l,f){Vi(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.col,r=e.x-n.left,o=l.top-n.top,u=7,i=f,c=Fn.fromTag("div"),nt(c,{position:"absolute",left:r-u/2+"px",top:o+"px",height:i+"px",width:u+"px"}),$e(c,{"data-column":t,role:"presentation"}),c);return Ei(a,Hi),a})},$i=function(n,e,l,f){Vi(n,e,function(n,e){var t,r,o,u,i,c,a=(t=e.row,r=l.left-n.left,o=e.y-n.top,u=f,i=7,c=Fn.fromTag("div"),nt(c,{position:"absolute",left:r+"px",top:o-i/2+"px",height:i+"px",width:u+"px"}),$e(c,{"data-row":t,role:"presentation"}),c);return Ei(a,Fi),a})},Gi=function(n,e,t,r,o){var u,i=Jr(t),c=e.isResizable,a=0<r.length?lo.positions(r,t):[],l=0<a.length?(u=c,J(n.all,function(n,e){return u(n.element)?[e]:[]})):[],f=U(a,function(n,e){return F(l,function(n){return e===n})});$i(e,f,i,Lr(t));var s,d,m,g=0<o.length?so.positions(o,t):[],p=0<g.length?(d=c,m=[],H((s=n).grid.columns,function(n){Lt.getColumnAt(s,n).map(function(n){return n.element}).forall(d)&&m.push(n)}),U(m,function(e){var n=Lt.filterItems(s,function(n){return n.column===e});return Q(n,function(n){return d(n.element)})})):[],h=U(g,function(n,e){return F(p,function(n){return e===n})});Ui(e,h,i,Gr(t))},Ki=function(n,e){var t,r,o;qi(n),n.isResizable(e)&&(t=Lt.fromTable(e),r=Fr(t),o=zr(t),Gi(t,n,e,r,o))},Xi=function(n,e){var t=Le(n.parent(),"."+_i);V(t,e)},Yi=function(n){Xi(n,function(n){Ze(n,"display","none")})},Ji=function(n){Xi(n,function(n){Ze(n,"display","block")})},Qi=Li("resizer-bar-dragging"),Zi=function(o){var t=zi(),r=function(n,e){void 0===e&&(e={});var t=e.mode!==undefined?e.mode:ji;return xi(n,t,e)}(t,{}),e=N.none(),n=function(n,e){return N.from(Ge(n,e))};t.events.drag.bind(function(e){n(e.target,"data-row").each(function(){var n=lt(e.target,"top");Ze(e.target,"top",n+e.yDelta+"px")}),n(e.target,"data-column").each(function(){var n=lt(e.target,"left");Ze(e.target,"left",n+e.xDelta+"px")})});var u=function(n,e){return lt(n,e)-ut(n,"data-initial-"+e,0)};r.events.stop.bind(function(){t.get().each(function(r){e.each(function(t){n(r,"data-row").each(function(n){var e=u(r,"top");Xe(r,"data-initial-top"),s.trigger.adjustHeight(t,e,parseInt(n,10))}),n(r,"data-column").each(function(n){var e=u(r,"left");Xe(r,"data-initial-left"),s.trigger.adjustWidth(t,e,parseInt(n,10))}),Ki(o,t)})})});var i=function(n,e){s.trigger.startAdjust(),t.assign(n),Ue(n,"data-initial-"+e,lt(n,e)),Ei(n,Qi),Ze(n,"opacity","0.2"),r.go(o.parent())},c=Oi(o.parent(),"mousedown",function(n){var e,t;e=n.target,Pi(e,Fi)&&i(n.target,"top"),t=n.target,Pi(t,Hi)&&i(n.target,"left")}),a=function(n){return Vn(n,o.view())},l=function(n){return qe(n,"table",a).filter(function(n){return qe(n,"[contenteditable]",a).exists(Wi)})},f=Oi(o.view(),"mouseover",function(n){l(n.target).fold(function(){Pe(n.target)&&qi(o)},function(n){e=N.some(n),Ki(o,n)})}),s=di({adjustHeight:si(["table","delta","row"]),adjustWidth:si(["table","delta","column"]),startAdjust:si([])});return{destroy:function(){c.unbind(),f.unbind(),r.destroy(),qi(o)},refresh:function(n){Ki(o,n)},on:r.on,off:r.off,hideBars:S(Yi,o),showBars:S(Ji,o),events:s.registry}},nc=function(n,o,u){var r=lo,i=so,e=Zi(n),c=di({beforeResize:si(["table","type"]),afterResize:si(["table","type"]),startDrag:si([])});return e.events.adjustHeight.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"row");var t=r.delta(n.delta,e);_u(e,t,n.row,r),c.trigger.afterResize(e,"row")}),e.events.startAdjust.bind(function(){c.trigger.startDrag()}),e.events.adjustWidth.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"col");var t=i.delta(n.delta,e),r=u(e);zu(e,t,n.column,o,r),c.trigger.afterResize(e,"col")}),{on:e.on,off:e.off,hideBars:e.hideBars,showBars:e.showBars,destroy:e.destroy,events:c.registry}},ec=function(n,e){return n.fire("newrow",{node:e})},tc=function(n,e){return n.fire("newcell",{node:e})},rc=function(n,e,t){n.fire("TableModified",un(un({},t),{table:e}))},oc={structure:!1,style:!0},uc={structure:!0,style:!1},ic={"border-collapse":"collapse",width:"100%"},cc={border:"1"},ac="preservetable",lc=function(n){return n.getParam("table_sizing_mode","auto")},fc=function(n){return n.getParam("table_responsive_width")},sc=function(n){return n.getParam("table_default_attributes",cc,"object")},dc=function(n){return n.getParam("table_default_styles",function(n){if(bc(n)){var e=n.getBody().offsetWidth;return un(un({},ic),{width:e+"px"})}return wc(n)?Zn(ic,function(n,e){return"width"!==e}):ic}(n),"object")},mc=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},gc=function(n){return n.getParam("table_row_advtab",!0,"boolean")},pc=function(n){return n.getParam("table_advtab",!0,"boolean")},hc=function(n){return n.getParam("table_style_by_css",!1,"boolean")},vc=function(n){return"relative"===lc(n)||!0===fc(n)},bc=function(n){return"fixed"===lc(n)||!1===fc(n)},wc=function(n){return"responsive"===lc(n)},yc=function(n){var e="section",t=n.getParam("table_header_type",e,"string");return _(["section","cells","sectionCells","auto"],t)?t:e},Cc=function(n){var e=n.getParam("table_column_resizing",ac,"string");return K(["preservetable","resizetable"],function(n){return n===e}).getOr(ac)},xc=function(n){return"preservetable"===Cc(n)},Sc=function(n){return"resizetable"===Cc(n)},Tc=function(n){var e=n.getParam("table_clone_elements");return O(e)?N.some(e.split(/[ ,]/)):Array.isArray(e)?N.some(e):N.none()},Rc=function(n,e){if(vc(n)){var t=Ru(n,e.dom).filter(Du).getOrThunk(function(){return li(e)});return Zo(t,e)}return bc(n)?Qo(Wr(e),e):Jo(e)},Dc=function(n){Xe(n,"width")},Oc=function(n,e){var t=Wr(n)+"px";ui(n,N.some(t),N.none(),e),Dc(n)},Ac=function(n,e){var t,r,o;r=Rc(n,e),o=Mo(t=e),ui(t,N.some(o),N.none(),r),Dc(t)},kc=function(n,e){var t=Rc(n,e);Oc(e,t)},Ic=function(n){ot(n,"width");var e=ht(n),t=0<e.length?e:pt(n);V(t,function(n){ot(n,"width"),Dc(n)}),Dc(n)},Bc=function(){var n=Fn.fromTag("div");return nt(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Jt(Me(Fn.fromDom(document)),n),n},Ec="bar-",Pc=function(n){return"false"!==Ge(n,"data-mce-resize")},Mc=function(f){var s,d,a=N.none(),i=N.none(),c=N.none(),o=function(n){return"TABLE"===n.nodeName},n=function(){return i},m=function(n){return Rc(f,n)},g=function(){return(xc(f)?Gu:$u)()},u=function(n,e,t){var r,o,u,i,c,a,l=bn(e,"e");""===d&&Ac(f,n),t!==s&&""!==d?(Ze(n,"width",d),r=g(),o=m(n),u=xc(f)||l?fi(n).columns-1:0,zu(n,t-s,u,r,o)):Du(d)&&(i=parseFloat(d.replace("%","")),Ze(n,"width",t*i/s+"%")),/^(\d+(\.\d+)?)px$/.test(d)&&(c=n,a=Lt.fromTable(c),Lt.hasColumns(a)||V(pt(c),function(n){var e=et(n,"width");Ze(n,"width",e),Xe(n,"width")}))};return f.on("init",function(){var n,e,t,r,o,u=(e=Pc,(n=f).inline?Xu(wu(n),Bc(),e):Ku(Fn.fromDom(n.getDoc()),e));c=N.some(u),o=f.getParam("object_resizing",!0),(O(o)?"table"===o:o)&&f.getParam("table_resize_bars",!0,"boolean")&&(t=g(),(r=nc(u,t,m)).on(),r.events.startDrag.bind(function(){a=N.some(f.selection.getRng())}),r.events.beforeResize.bind(function(n){var e,t,r,o,u,i=n.table.dom;e=f,r=yu(t=i),o=Cu(i),u=Ec+n.type,e.fire("ObjectResizeStart",{target:t,width:r,height:o,origin:u})}),r.events.afterResize.bind(function(n){var e,t,r,o,u,i=n.table,c=i.dom;Tu(i),a.each(function(n){f.selection.setRng(n),f.focus()}),e=f,r=yu(t=c),o=Cu(c),u=Ec+n.type,e.fire("ObjectResized",{target:t,width:r,height:o,origin:u}),f.undoManager.add()}),i=N.some(r))}),f.on("ObjectResizeStart",function(n){var e,t=n.target;o(t)&&(e=Fn.fromDom(t),V(f.dom.select(".mce-clonedresizable"),function(n){f.dom.addClass(n,"mce-"+Cc(f)+"-columns")}),!ci(e)&&bc(f)?kc(f,e):!ii(e)&&vc(f)&&Ac(f,e),ai(e)&&vn(n.origin,Ec)&&Ac(f,e),s=n.width,d=wc(f)?"":Ru(f,t).getOr(""))}),f.on("ObjectResized",function(n){var e,t,r=n.target;o(r)&&(e=Fn.fromDom(r),t=n.origin,vn(t,"corner-")&&u(e,t,n.width),Tu(e),rc(f,e.dom,oc))}),f.on("SwitchMode",function(){i.each(function(n){f.mode.isReadOnly()?n.hideBars():n.showBars()})}),{lazyResize:n,lazyWire:function(){return c.getOr(Ku(Fn.fromDom(f.getBody()),Pc))},destroy:function(){i.each(function(n){n.destroy()}),c.each(function(n){var e;e=n,f.inline&&tr(e.parent())})}}},Nc=function(n,e){return{element:n,offset:e}},jc=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind(function(n){return jc(e,n,t).orThunk(function(){return N.some(n)})}):N.none()},Wc=function(n,e){return n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length},Lc=function(n,e){var t=jc(n,e,n.query().prevSibling).getOr(e);if(n.property().isText(t))return Nc(t,Wc(n,t));var r=n.property().children(t);return 0<r.length?Lc(n,r[r.length-1]):Nc(t,Wc(n,t))},zc=Lc,_c=n(),Fc=function(t,r){1===it(t,"colspan")&&Ao(t).bind(function(n){return po(n,["fixed","relative","empty"])}).each(function(n){var e=n.value/2;Po(t,e,n.unit),Po(r,e,n.unit)})},Hc=function(n,e,t,r){t===r?Xe(n,e):Ue(n,e,t)},qc=function(n,e,t){rn(We(n,e)).fold(function(){return Yt(n,t)},function(n){return Xt(n,t)})},Vc=function(c,n){var t=[],r=[],a=function(n){return q(n,function(n){n.isNew&&t.push(n.element);var e=n.element;return er(e),V(n.cells,function(n){n.isNew&&r.push(n.element),Hc(n.element,"colspan",n.colspan,1),Hc(n.element,"rowspan",n.rowspan,1),Jt(e,n.element)}),e})},l=function(n){return J(n,function(n){return q(n.cells,function(n){return Hc(n.element,"span",n.colspan,1),n.element})})},o=function(n,e){var t,r,o,u=(o=Fe(t=c,r=e).getOrThunk(function(){var n=Fn.fromTag(r,we(t).dom);return"thead"===r?qc(t,"caption,colgroup",n):"colgroup"===r?qc(t,"caption",n):Jt(t,n),n}),er(o),o),i=("colgroup"===e?l:a)(n);nr(u,i)},e=function(n,e){0<n.length?o(n,e):Fe(c,e).each(tr)},u=[],i=[],f=[],s=[];return V(n,function(n){switch(n.section){case"thead":u.push(n);break;case"tbody":i.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}}),e(s,"colgroup"),e(u,"thead"),e(i,"tbody"),e(f,"tfoot"),{newRows:t,newCells:r}},Uc=function(n,e){if(0===n.length)return 0;var t=n[0];return X(n,function(n){return!e(t.element,n.element)}).fold(function(){return n.length},function(n){return n})},$c=function(n,e,t,r){var o,u=n[e].cells.slice(t),i=Uc(u,r),c=(o=t,q(n,function(n){return At(n,o)}).slice(e));return{colspan:i,rowspan:Uc(c,r)}},Gc=function(o,u){var i=q(o,function(n){return q(n.cells,v)});return q(o,function(n,r){return{details:J(n.cells,function(n,e){if(!1!==i[r][e])return[];var t=$c(o,r,e,u);return function(n,e,t,r){for(var o=n;o<n+t;o++)for(var u=e;u<e+r;u++)i[o][u]=!0}(r,e,t.rowspan,t.colspan),[{element:n.element,rowspan:t.rowspan,colspan:t.colspan,isNew:n.isNew}]}),section:n.section}})},Kc=function(n,e,t){var r,o=[];Lt.hasColumns(n)&&(r=q(Lt.justColumns(n),function(n){return ae(n.element,t,!1)}),
o.push(le(r,"colgroup")));for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=Lt.getAt(n,u,c).map(function(n){return ae(n.element,t,n.isLocked)}).getOrThunk(function(){return ae(e.gap(),!0,!1)});i.push(a)}var l=le(i,n.all[u].section);o.push(l)}return o},Xc=function(n,r){return q(n,function(n){var e,t=(e=n.details,on(e,function(n){return Ce(n.element).map(function(n){var e=Ce(n).isNone();return ae(n,e,!1)})}).getOrThunk(function(){return ae(r.row(),!0,!1)}));return{element:t.element,cells:n.details,section:n.section,isNew:t.isNew}})},Yc=function(n,e){var t=Gc(n,Vn);return Xc(t,e)},Jc=function(n,e){return on(n.all,function(n){return K(n.cells,function(n){return Vn(e,n.element)})})},Qc=function(e,n,t){var r=q(n.selection,function(n){return gt(n).bind(function(n){return Jc(e,n)}).filter(t)}),o=Pr(r);return Mr(0<o.length,o)},Zc=function(f,e,s,d,m){return function(o,u,n,i,c,a){var l=Lt.fromTable(u);return e(l,n).map(function(n){var e=Kc(l,i,!1),t=f(e,n,Vn,m(i)),r=Mt(t.grid);return{info:n,grid:Yc(t.grid,i),cursor:t.cursor,lockedColumns:r}}).bind(function(n){var e=Vc(u,n.grid),t=N.from(c).getOrThunk(function(){return Jo(u)}),r=N.from(a).getOrThunk(Gu);return s(u,n.grid,n.info,t,r),d(u),Ki(o,u),Xe(u,Et),0<n.lockedColumns.length&&Ue(u,Et,n.lockedColumns.join(",")),N.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}},na=function(e,n){return gt(n.element).bind(function(n){return Jc(e,n)})},ea=function(n,e){return Qc(n,e,T).map(function(n){return{cells:n,generators:e.generators,clipboard:e.clipboard}})},ta=function(n,e){return Qc(n,e,T)},ra=function(n,e){return na(n,e).filter(function(n){return!n.isLocked})},oa=function(n,e){return Qc(n,e,function(n){return!n.isLocked})},ua=function(e,n){return Q(n,function(n){return Jc(e,n).exists(function(n){return!n.isLocked})})},ia=function(e,n){return n.mergable.filter(function(n){return ua(e,n.cells)})},ca=function(e,n){return n.unmergable.filter(function(n){return ua(e,n)})},aa=function(n,e,t,r){for(var o=Bt(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<It(o[0]);c++){var a=o[i],l=At(a,c),f=t(l.element,e);!0===f&&!1===u?Rt(a,c,ae(r(),!0,l.isLocked)):!0===f&&(u=!1)}return n},la=function(n,t,i,c){var e,r,o,a=Bt(n).rows;return 0<t&&t<a.length&&(e=a[t-1].cells,o=i,r=G(e,function(n,e){return F(n,function(n){return o(n.element,e.element)})?n:n.concat([e])},[]),V(r,function(n){for(var o=N.none(),u=t;u<a.length;u++)for(var e=0;e<It(a[0]);e++)!function(e){var t=a[u],r=At(t,e);i(r.element,n.element)&&(o.isNone()&&(o=N.some(c())),o.each(function(n){Rt(t,e,ae(n,!0,r.isLocked))}))}(e)})),n},fa=function(t){return{is:function(n){return t===n},isValue:T,isError:v,getOr:b(t),getOrThunk:b(t),getOrDie:b(t),or:function(){return fa(t)},orThunk:function(){return fa(t)},fold:function(n,e){return e(t)},map:function(n){return fa(n(t))},mapError:function(){return fa(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return N.some(t)}}},sa=function(e){return{is:v,isValue:v,isError:T,getOr:p,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(e),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n){return n(e)},map:function(){return sa(e)},mapError:function(n){return sa(n(e))},each:C,bind:function(){return sa(e)},exists:v,forall:T,toOptional:N.none}},da={value:fa,error:sa,fromOption:function(n,e){return n.fold(function(){return sa(e)},fa)}},ma=function(n,e){return{rowDelta:0,colDelta:It(n[0])-It(e[0])}},ga=function(n,e){return{rowDelta:n.length-e.length,colDelta:0}},pa=function(n,e,t,r){var o="colgroup"===e.section?t.col:t.cell;return H(n,function(n){return ae(o(),!0,r(n))})},ha=function(t,n,r,o){return t.concat(H(n,function(){var n=t[t.length-1],e=pa(n.cells.length,n,r,function(n){return re(o,n.toString())});return Dt(n,e)}))},va=function(n,t,r,o){return q(n,function(n){var e=pa(t,n,r,v);return St(n,o,e)})},ba=function(n,e,t){var r=e.colDelta<0?va:p,o=e.rowDelta<0?ha:p,u=Mt(n),i=It(n[0]),c=F(u,function(n){return n===i-1}),a=r(n,Math.abs(e.colDelta),t,c?i-1:i),l=Mt(a);return o(a,Math.abs(e.rowDelta),t,Z(l,T))},wa=function(n,e,t,r,o,u){for(var i,c,a,l,f,s=n.row,d=n.column,m=s+t.length,g=d+It(t[0])+u.length,p=Z(u,T),h=s;h<m;h++)for(var v,b,w,y,C=0,x=d;x<g;x++)p[x]?C++:(a=x,l=void 0,l=S(o,At((i=e)[c=h],a).element),f=i[c],1<i.length&&1<It(f)&&(0<a&&l(kt(f,a-1))||a<f.cells.length-1&&l(kt(f,a+1))||0<c&&l(kt(i[c-1],a))||c<i.length-1&&l(kt(i[c+1],a)))&&aa(e,kt(e[h],x),o,r.cell),v=x-d-C,w=(b=At(t[h-s],v)).element,y=r.replace(w),Rt(e[h],x,ae(y,!0,b.isLocked)));return e},ya=function(e,t,n){return U(n,function(n){return n>=e.column&&n<=It(t[0])+e.column})},Ca=function(n,u,i,c,a){var e,t,r,o,l,f=Mt(u),s=(e=n,t=f,r=It(u[0]),o=H(r-e.column,function(n){return n+e.column}),l=K(o,function(e){return Q(t,function(n){return n!==e})}).getOr(r-1),un(un({},e),{column:l})),d=ya(s,i,f);return function(n,e,t){if(n.row>=e.length||n.column>It(e[0]))return da.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=e.slice(n.row),o=r[0].cells.slice(n.column),u=It(t[0]),i=t.length;return da.value({rowDelta:r.length-i,colDelta:o.length-u})}(s,u,i).map(function(n){var e=un(un({},n),{colDelta:n.colDelta-d.length}),t=ba(u,e,c),r=Mt(t),o=ya(s,i,r);return wa(s,t,i,c,a,o)})},xa=function(t,n,e,r,o){var u,i,c,a;u=n,i=t,c=o,a=r.cell,0<i&&i<u[0].cells.length&&V(u,function(n){var e=n.cells[i-1],t=n.cells[i];c(t.element,e.element)&&Rt(n,i,ae(a(),!0,t.isLocked))});var l=ga(e,n),f=ba(e,l,r),s=ga(n,f),d=ba(n,s,r);return q(d,function(n,e){return St(n,t,f[e].cells)})},Sa=function(n,e,t,r,o){la(e,n,o,r.cell);var u,i,c=Mt(e),a=ma(e,t),l=un(un({},a),{colDelta:a.colDelta-c.length}),f=ba(e,l,r),s=Bt(f),d=s.cols,m=s.rows,g=Mt(f),p=ma(t,e),h=un(un({},p),{colDelta:p.colDelta+g.length}),v=(u=r,i=g,q(t,function(r){return G(i,function(n,e){var t=pa(1,r,u,T)[0];return Tt(n,e,t)},r)})),b=ba(v,h,r);return d.concat(m.slice(0,n)).concat(b).concat(m.slice(n,m.length))},Ta=function(n,t,e,r,o){var u=Bt(n),i=u.rows,c=u.cols,a=i.slice(0,t),l=i.slice(t),f=Ot(i[e],function(n,e){return 0<t&&t<i.length&&r(kt(i[t-1],e),kt(i[t],e))?At(i[t],e):ae(o(n.element,r),!0,n.isLocked)});return c.concat(a).concat([f]).concat(l)},Ra=function(n,t,r,o,u){return q(n,function(n){var a=0<t&&t<It(n)&&o(kt(n,t-1),kt(n,t)),e=function(n,e,t,r,o,u,i){if("colgroup"!==t&&a)return At(n,e);var c=At(n,o);return ae(i(c.element,u),!0,!1)}(n,t,n.section,0,r,o,u);return Tt(n,t,e)})},Da=function(n,t,r,o){return q(n,function(n){return Ot(n,function(n){return e=n,F(t,function(n){return r(e.element,n.element)})?ae(o(n.element,r),!0,n.isLocked):n;var e})})},Oa=function(n,e,t,r){return kt(n[e],t)!==undefined&&0<e&&r(kt(n[e-1],t),kt(n[e],t))},Aa=function(n,e,t){return 0<e&&t(kt(n,e-1),kt(n,e))},ka=function(t,r,o,n){var e=Bt(t).rows,u=J(e,function(n,e){return Oa(t,e,r,o)||Aa(n,r,o)?[]:[At(n,r)]});return Da(t,u,o,n)},Ia=function(n,t,r,e){var o=Bt(n).rows,u=o[t],i=J(u.cells,function(n,e){return Oa(o,t,e,r)||Aa(u,e,r)?[]:[n]});return Da(n,i,r,e)},Ba=function(n){return G(n,function(n,e){return F(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})},Ea=function(n){return{element:n,colspan:ut(n,"colspan",1),rowspan:ut(n,"rowspan",1)}},Pa=function(n){return Ke(n,"scope").map(function(n){return n.substr(0,3)})},Ma=function(e,t){void 0===t&&(t=Ea);var r=Go(N.none()),o=function(n){return function(n){switch(fe(n.element)){case"col":return e.col(n);default:return e.cell(n)}}(t(n))},u=function(n){var e=o(n);return r.get().isNone()&&r.set(N.some(e)),i=N.some({item:n,replacement:e}),e},i=N.none();return{getOrInit:function(e,t){return i.fold(function(){return u(e)},function(n){return t(e,n.item)?n.replacement:u(e)})},cursor:r.get}},Na=function(c,a){return function(r){var o=Go(N.none()),u=[],i=function(n){var e={scope:c},t=r.replace(n,a,e);return u.push({item:n,sub:t}),o.get().isNone()&&o.set(N.some(t)),t};return{replaceOrInit:function(e,t){return"col"===fe(e)?e:(r=e,o=t,K(u,function(n){return o(n.item,r)}).fold(function(){return i(e)},function(n){return t(e,n.item)?n.sub:i(e)}));var r,o},cursor:o.get}}},ja=function(r){var e=Go(N.none());return{unmerge:function(t){e.get().isNone()&&e.set(N.some(t));var n=Pa(t);return n.each(function(n){return Ue(t,"scope",n)}),function(){var e=r.cell({element:t,colspan:1,rowspan:1});return ot(e,"width"),ot(t,"width"),n.each(function(n){return Ue(e,"scope",n)}),e}},merge:function(r){return ot(r[0],"width"),function(){var n=Pr(q(r,Pa));if(0===n.length)return N.none();var e=n[0],t=["row","col"];return F(n,function(n){return n!==e&&_(t,n)})?N.none():N.from(e)}().fold(function(){return Xe(r[0],"scope")},function(n){return Ue(r[0],"scope",n+"group")}),b(r[0])},cursor:e.get}},Wa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],La=n(),za=function(n){return e=n,t=La.property().name(e),_(Wa,t);var e,t},_a=function(n){return e=n,t=La.property().name(e),_(["ol","ul"],t);var e,t},Fa=function(n){return e=n,_(["br","img","hr","input"],La.property().name(e));var e},Ha=function(n){var e,u=function(n){return"br"===fe(n)},t=function(o){return iu(o).bind(function(t){var r=Te(t).map(function(n){return!!za(n)||!!Fa(n)&&"img"!==fe(n)}).getOr(!1);return Ce(t).map(function(n){return!0===r||"li"===fe(e=n)||ze(e,_a).isSome()||u(t)||za(n)&&!Vn(o,n)?[]:[Fn.fromTag("br")];var e})}).getOr([])},r=0===(e=J(n,function(n){var e=Re(n);return Q(e,function(n){return u(n)||pe(n)&&0===ur(n).trim().length})?[]:e.concat(t(n))})).length?[Fn.fromTag("br")]:e;er(n[0]),nr(n[0],r)},qa=function(n){0===pt(n).length&&tr(n)},Va=function(n,e){return{grid:n,cursor:e}},Ua=function(n,e,t){var r=Bt(n).rows;return $a(r,e,t).orThunk(function(){return $a(r,0,0)})},$a=function(n,e,t){return N.from(n[e]).bind(function(n){return N.from(n.cells[t]).bind(function(n){return N.from(n.element)})})},Ga=function(n,e,t){var r=Bt(n).rows;return Va(n,$a(r,e,t))},Ka=function(n){return G(n,function(n,e){return F(n,function(n){return n.row===e.row})?n:n.concat([e])},[]).sort(function(n,e){return n.row-e.row})},Xa=function(n,e,t){var r,o,u=(r=n,o=t.section,yt(r,function(){return o})),i=Lt.generate(u);return Kc(i,e,!0)},Ya=function(n,e){var t=U(n,e);return 0===t.length?N.some("td"):t.length===n.length?N.some("th"):N.none()},Ja=function(n,e,t,r){var o=Lt.generate(e),u=r.getWidths(o,r);Lu(o,u,r)},Qa=function(n,e,t,r,o){var u=Lt.generate(e),i=r.getWidths(u,r),c=r.pixelWidth(),a=o.calcRedestributedWidths(i,c,t.pixelDelta,r.isRelative),l=a.newSizes,f=a.delta;Lu(u,l,r),r.adjustTableWidth(f)},Za=function(n,e){return F(e,function(n){return 0===n.column&&n.isLocked})},nl=function(e,n){return F(n,function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked})},el=function(n,e){var t=zr(n),r=Ba(e);return G(r,function(n,e){return n+t[e.column].map(Lr).getOr(0)},0)},tl=function(t){return function(e,n){return ta(e,n).filter(function(n){return!(t?Za:nl)(e,n)}).map(function(n){return{details:n,pixelDelta:el(e,n)}})}},rl=function(t){return function(e,n){return ea(e,n).filter(function(n){return!(t?Za:nl)(e,n.cells)})}},ol=Zc(function(n,e,t,r){var o=e[0].row,u=Ka(e),i=$(u,function(n,e){return{grid:Ta(n.grid,o,e.row+n.delta,t,r.getOrInit),delta:n.delta+1}},{grid:n,delta:0}).grid;return Ga(i,o,e[0].column)},ta,C,C,Ma),ul=Zc(function(n,e,t,r){var o=Ka(e),u=o[o.length-1],i=u.row+u.rowspan,c=$(o,function(n,e){return Ta(n,i,e.row,t,r.getOrInit)},n);return Ga(c,i,e[0].column)},ta,C,C,Ma),il=Zc(function(n,e,t,r){var o=e.details,u=Ba(o),i=u[0].column,c=$(u,function(n,e){return{grid:Ra(n.grid,i,e.column+n.delta,t,r.getOrInit),delta:n.delta+1}},{grid:n,delta:0}).grid;return Ga(c,o[0].row,i)},tl(!0),Qa,C,Ma),cl=Zc(function(n,e,t,r){var o=e.details,u=o[o.length-1],i=u.column+u.colspan,c=Ba(o),a=$(c,function(n,e){return Ra(n,i,e.column,t,r.getOrInit)},n);return Ga(a,o[0].row,i)},tl(!1),Qa,C,Ma),al=Zc(function(n,e){var t,r,o=Ba(e.details),u=(t=n,r=q(o,function(n){return n.column}),J(t,function(n){var e=n.cells,t=$(r,function(n,e){return 0<=e&&e<n.length?n.slice(0,e).concat(n.slice(e+1)):n},e);return 0<t.length?[le(t,n.section)]:[]})),i=Ua(u,o[0].row,o[0].column);return Va(u,i)},function(e,n){return oa(e,n).map(function(n){return{details:n,pixelDelta:-el(e,n)}})},Qa,qa,Ma),ll=Zc(function(n,e){var t,r,o,u,i,c=Ka(e),a=(t=n,r=c[0].row,o=c[c.length-1].row,i=(u=Bt(t)).rows,u.cols.concat(i.slice(0,r)).concat(i.slice(o+1))),l=Ua(a,e[0].row,e[0].column);return Va(a,l)},ta,C,qa,Ma),fl=(Zc(function(n,e,t,r){var o=ka(n,e.column,t,r.replaceOrInit);return Ga(o,e.row,e.column)},ra,C,C,Na("row","th")),Zc(function(n,e,t,r){var o=Ba(e),u=G(o,function(n,e){return ka(n,e.column,t,r.replaceOrInit)},n);return Ga(u,e[0].row,e[0].column)},oa,C,C,Na("row","th"))),sl=(Zc(function(n,e,t,r){var o=ka(n,e.column,t,r.replaceOrInit);return Ga(o,e.row,e.column)},ra,C,C,Na(null,"td")),Zc(function(n,e,t,r){var o=Ba(e),u=G(o,function(n,e){return ka(n,e.column,t,r.replaceOrInit)},n);return Ga(u,e[0].row,e[0].column)},oa,C,C,Na(null,"td"))),dl=(Zc(function(n,e,t,r){var o=Ia(n,e.row,t,r.replaceOrInit);return Ga(o,e.row,e.column)},na,C,C,Na("col","th")),Zc(function(n,e,t,r){var o=Ka(e),u=G(o,function(n,e){return Ia(n,e.row,t,r.replaceOrInit)},n);return Ga(u,e[0].row,e[0].column)},ta,C,C,Na("col","th")),Zc(function(n,e,t,r){var o=Ia(n,e.row,t,r.replaceOrInit);return Ga(o,e.row,e.column)},na,C,C,Na(null,"td")),Zc(function(n,e,t,r){var o=Ka(e),u=G(o,function(n,e){return Ia(n,e.row,t,r.replaceOrInit)},n);return Ga(u,e[0].row,e[0].column)},ta,C,C,Na(null,"td")),Zc(function(n,e,t,r){var o=e.cells;Ha(o);var u=function(n,e,t){var r=Bt(n).rows;if(0===r.length)return n;for(var o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++){var i=r[o],c=At(i,u).isLocked;Rt(i,u,ae(t(),!1,c))}return n}(n,e.bounds,r.merge(o));return Va(u,N.from(o[0]))},ia,Ja,C,ja)),ml=Zc(function(n,e,t,r){var o=$(e,function(n,e){return aa(n,e,t,r.unmerge(e))},n);return Va(o,N.from(e[0]))},ca,Ja,C,ja),gl=Zc(function(n,t,e){var r,o,u,i=(r=t.clipboard,o=t.generators,u=Lt.fromTable(r),Kc(u,o,!0)),c={row:t.row,column:t.column};return Ca(c,n,i,t.generators,e).fold(function(){return Va(n,N.some(t.element))},function(n){var e=Ua(n,t.row,t.column);return Va(n,e)})},function(e,t){return gt(t.element).bind(function(n){return Jc(e,n).map(function(n){return un(un({},n),{generators:t.generators,clipboard:t.clipboard})})})},Ja,C,Ma),pl=Zc(function(n,e,t){var r=Bt(n).rows,o=e.cells[0].column,u=r[e.cells[0].row],i=Xa(e.clipboard,e.generators,u),c=xa(o,n,i,e.generators,t),a=Ua(c,e.cells[0].row,e.cells[0].column);return Va(c,a)},rl(!0),C,C,Ma),hl=Zc(function(n,e,t){var r=Bt(n).rows,o=e.cells[e.cells.length-1].column+e.cells[e.cells.length-1].colspan,u=r[e.cells[0].row],i=Xa(e.clipboard,e.generators,u),c=xa(o,n,i,e.generators,t),a=Ua(c,e.cells[0].row,e.cells[0].column);return Va(c,a)},rl(!1),C,C,Ma),vl=Zc(function(n,e,t){var r=Bt(n).rows,o=e.cells[0].row,u=r[o],i=Xa(e.clipboard,e.generators,u),c=Sa(o,n,i,e.generators,t),a=Ua(c,e.cells[0].row,e.cells[0].column);return Va(c,a)},ea,C,C,Ma),bl=Zc(function(n,e,t){var r=Bt(n).rows,o=e.cells[e.cells.length-1].row+e.cells[e.cells.length-1].rowspan,u=r[e.cells[0].row],i=Xa(e.clipboard,e.generators,u),c=Sa(o,n,i,e.generators,t),a=Ua(c,e.cells[0].row,e.cells[0].column);return Va(c,a)},ea,C,C,Ma),wl=function(n,e){var u=Lt.fromTable(n);return ta(u,e).bind(function(n){var e=n[n.length-1],t=n[0].column,r=e.column+e.colspan,o=Y(q(u.all,function(n){return U(n.cells,function(n){return n.column>=t&&n.column<r})}));return Ya(o,function(n){return"th"===fe(n.element)})}).getOr("")},yl=function(n){return bu(n.parentNode)},Cl=function(n,e){var t="thead"===yl(e),r=!F(e.cells,function(n){return"th"!==bu(n)});return t||r?N.some({thead:t,ths:r}):N.none()},xl=function(n,e){return"thead"===(t=Cl(0,e).fold(function(){return yl(e)},function(){return"thead"}))?"header":"tfoot"===t?"footer":"body";var t},Sl=function(e,n,t){var r,o,u=e.getParent(n,"table"),i=n.parentNode,c=bu(i);t!==c&&((r=e.select(t,u)[0])||(r=e.create(t),o=u.firstChild,"thead"===t?rn(We(Fn.fromDom(u),"caption,colgroup")).fold(function(){return u.insertBefore(r,o)},function(n){return e.insertAfter(r,n.dom)}):u.appendChild(r)),"tbody"===t&&"thead"===c&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),i.hasChildNodes()||e.remove(i))},Tl=function(n,e,t,r){var o=n.dom,u=function(n,e,t){if(E(t)&&bu(e)!==t){var r=n.dom.rename(e,t);return tc(n,r),r}return e}(n,e,t);return B(r)||o.setAttrib(u,"scope",r),u},Rl=function(e,n,t,r){return V(n,function(n){return Tl(e,n,t,r)})},Dl=function(n,e,t){var r,o,u,i=n.dom;"header"===t?(o="auto"===(r=yc(n))?(u=vt(Fn.fromDom(e.cells[0])).map(bt).getOr([]),on(u,function(n){return Cl(0,n.dom)}).map(function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"}).getOr("section")):r,Rl(n,e.cells,"section"===o?"td":"th","col"),Sl(i,e,"cells"===o?"tbody":"thead")):(Rl(n,e.cells,"td",null),Sl(i,e,"footer"===t?"tfoot":"tbody"))},Ol=function(o){return function(n){var e,t=fe(n),r="col"===t||"colgroup"===t?vt(e=n).bind(function(n){return yr(n,ku.firstSelectedSelector)}).fold(function(){return e},function(n){return n[0]}):n;return qe(r,o)}},Al=Ol("th,td"),kl=Ol("th,td,caption"),Il=function(n,e){return Al(n).map(function(){return Au(e)}).getOr([])},Bl=function(n,t){var e,r,o,u=Al(n);return r=u.bind(function(n){return vt(n)}).map(bt),o=function(e,n){return U(n,function(n){return F(vu(n.dom.cells),function(n){return"1"===Ge(n,t)||Vn(n,e)})})},((e=u).isSome()&&r.isSome()?N.some(o(e.getOrDie(),r.getOrDie())):N.none()).getOr([])},El=function(d,n,r){var e=function(n){return"table"===fe(wu(n))},m=Tc(d),t=Sc(d)?C:Fc,o=function(c,a,l,f,s){return function(n,e){Tu(n);var t=f(),r=Fn.fromDom(d.getDoc()),o=pu(l,r,m),u=Rc(d,n),i=(Sc(d)?$u:Gu)();return a(n)?c(t,n,e,o,u,i).bind(function(n){return V(n.newRows,function(n){ec(d,n.dom)}),V(n.newCells,function(n){tc(d,n.dom)}),n.cursor.map(function(n){var e=zc(_c,n),t=d.dom.createRng();return t.setStart(e.element.dom,e.offset),t.setEnd(e.element.dom,e.offset),{rng:t,effect:s}})}):N.none()}},u=o(ll,function(n){return!1===e(d)||1<fi(n).rows},C,n,uc),i=o(al,function(n){return!1===e(d)||1<fi(n).columns},C,n,uc),c=o(ol,T,C,n,uc),a=o(ul,T,C,n,uc),l=o(il,T,t,n,uc),f=o(cl,T,t,n,uc),s=o(dl,T,C,n,uc),g=o(ml,T,C,n,uc),p=o(pl,T,C,n,uc),h=o(hl,T,C,n,uc),v=o(vl,T,C,n,uc),b=o(bl,T,C,n,uc),w=o(gl,T,C,n,uc),y=function(n,e){return te(n,"type").filter(function(n){return _(e,n)})};return{deleteRow:u,deleteColumn:i,insertRowsBefore:c,insertRowsAfter:a,insertColumnsBefore:l,insertColumnsAfter:f,mergeCells:s,unmergeCells:g,pasteColsBefore:p,pasteColsAfter:h,pasteRowsBefore:v,pasteRowsAfter:b,pasteCells:w,setTableCellType:function(t,n){return y(n,["td","th"]).each(function(n){var e=q(Il(Ou(t),r),function(n){return n.dom});Rl(t,e,n,null)})},setTableRowType:function(t,n){return y(n,["header","body","footer"]).each(function(e){q(Bl(Ou(t),ku.selected),function(n){return Dl(t,n.dom,e)})})},makeColumnsHeader:o(fl,T,C,n,uc),unmakeColumnsHeader:o(sl,T,C,n,uc),getTableRowType:function(n){var e=Bl(Ou(n),ku.selected);if(0<e.length){var t=q(e,function(n){return xl(0,n.dom)}),r=_(t,"header"),o=_(t,"footer");if(r||o){var u=_(t,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return Ya(Il(Ou(n),r),function(n){return"th"===fe(n)}).getOr("")},getTableColType:wl}},Pl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Ml=function(n,e,t,r){for(var o=Fn.fromTag("tr"),u=0;u<n;u++){var i=r<e||u<t?Fn.fromTag("th"):Fn.fromTag("td");u<t&&Ue(i,"scope","row"),r<e&&Ue(i,"scope","col"),Jt(i,Fn.fromTag("br")),Jt(o,i)}return o},Nl=function(n){var e=Fn.fromTag("colgroup");return H(n,function(){return Jt(e,Fn.fromTag("col"))}),e},jl=function(n,e,t,r){return H(n,function(n){return Ml(e,t,r,n)})},Wl=function(n,e){n.selection.select(e.dom,!0),n.selection.collapse(!0)},Ll=function(u,i,c,a,l){var o=dc(u),f={styles:o,attributes:sc(u),colGroups:u.getParam("table_use_colgroups",!1,"boolean")};return u.undoManager.ignore(function(){var n=function(n,e,t,r,o,u){void 0===u&&(u=Pl);var i=Fn.fromTag("table"),c="cells"!==o;nt(i,u.styles),$e(i,u.attributes),u.colGroups&&Jt(i,Nl(e));var a,l,f=Math.min(n,t);c&&0<t&&(a=Fn.fromTag("thead"),Jt(i,a),l=jl(t,e,"sectionCells"===o?f:0,r),nr(a,l));var s=Fn.fromTag("tbody");Jt(i,s);var d=jl(c?n-f:n,e,c?0:t,r);return nr(s,d),i}(c,i,l,a,yc(u),f);Ue(n,"data-mce-id","__mce");var e,t,r,o=(e=n,t=Fn.fromTag("div"),r=Fn.fromDom(e.dom.cloneNode(!0)),Jt(t,r),t.dom.innerHTML);u.insertContent(o),u.addVisual()}),He(wu(u),'table[data-mce-id="__mce"]').map(function(n){var e,t,r;return bc(u)?kc(u,n):wc(u)?Ic(n):(vc(u)||(e=o.width,O(e)&&-1!==e.indexOf("%")))&&Ac(u,n),Tu(n),Xe(n,"data-mce-id"),t=u,V(Le(n,"tr"),function(n){ec(t,n.dom),V(Le(n,"th,td"),function(n){tc(t,n.dom)})}),r=u,He(n,"td,th").each(S(Wl,r)),n.dom}).getOr(null)},zl=function(n,e,t,r,o){void 0===r&&(r={});var u=function(n){return j(n)&&0<n};if(u(e)&&u(t)){var i=r.headerRows||0,c=r.headerColumns||0;return Ll(n,t,e,c,i)}return console.error(o),null},_l=function(n){return function(){return n().fold(function(){return[]},function(n){return q(n,function(n){return n.dom})})}},Fl=function(t){return function(n){var e=0<n.length?N.some(vu(n)):N.none();t(e)}},Hl=function(n,e,t,r){return{insertTable:(o=n,function(n,e,t){void 0===t&&(t={});var r=zl(o,e,n,t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return o.undoManager.add(),r}),setClipboardRows:Fl(e.setRows),getClipboardRows:_l(e.getRows),setClipboardCols:Fl(e.setColumns),getClipboardCols:_l(e.getColumns),resizeHandler:t,selectionTargets:r};var o},ql=function(n,e,t){var r=ut(n,e,1);1===t||r<=1?Xe(n,e):Ue(n,e,Math.min(t,r))},Vl=function(n,e){var i=Lt.fromTable(n);return oa(i,e).map(function(n){var o,u,e=n[n.length-1],t=n[0].column,r=e.column+e.colspan;return c(function(n,t,r){if(Lt.hasColumns(n)){var e=U(Lt.justColumns(n),function(n){return n.column>=t&&n.column<r}),o=q(e,function(n){var e=Br(n.element);return ql(e,"span",r-t),e}),u=Fn.fromTag("colgroup");return nr(u,o),[u]}return[]}(i,t,r),(o=t,u=r,q(i.all,function(n){var e=U(n.cells,function(n){return n.column>=o&&n.column<u}),t=q(e,function(n){var e=Br(n.element);return ql(e,"colspan",u-o),e}),r=Fn.fromTag("tr");return nr(r,t),r})))})},Ul=function(n,e,u){var i=Lt.fromTable(n);return ta(i,e).bind(function(n){var e=Kc(i,u,!1),t=Bt(e).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),r=J(t,function(n){var e=U(n.cells,function(n){return!n.isLocked});return 0<e.length?[un(un({},n),{cells:e})]:[]}),o=Yc(r,u);return Mr(0<o.length,o)}).map(function(n){return q(n,function(n){var t=Ir(n.element);return V(n.cells,function(n){var e=Br(n.element);Hc(e,"colspan",n.colspan,1),Hc(e,"rowspan",n.rowspan,1),Jt(t,e)}),t})})},$l=tinymce.util.Tools.resolve("tinymce.util.Tools"),Gl=function(o,n,u){return function(n,e){for(var t=0;t<e.length;t++){var r=o.getStyle(e[t],u);if(void 0===n&&(n=r),n!==r)return""}return n}(void 0,o.select("td,th",n))},Kl=function(n,e,t){t&&n.formatter.apply("align"+t,{},e)},Xl=function(e,t){$l.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},Yl=function(n,e){return(e||[]).concat(q(n,function(n){var e=n.text||n.title;return oe(n,"menu")?{text:e,items:Yl(n.menu)}:{text:e,value:n.value}}))},Jl=function(e){return function(n){return vn(n,"rgb")?e.toHex(n):n}},Ql=function(n,e){var t=Fn.fromDom(e);return{borderwidth:rt(t,"border-width").getOr(""),borderstyle:rt(t,"border-style").getOr(""),bordercolor:rt(t,"border-color").map(Jl(n)).getOr(""),backgroundcolor:rt(t,"background-color").map(Jl(n)).getOr("")}},Zl=function(n){var o=n[0],e=n.slice(1);return V(e,function(n){V(Kn(o),function(r){Yn(n,function(n,e){var t=o[r];""!==t&&r===e&&t!==n&&(o[r]="")})})}),o},nf=function(n){var e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},ef=function(n,e,t,r){return K(n,function(n){return t.formatter.matchNode(r,e+n)}).getOr("")},tf=S(ef,["left","center","right"],"align"),rf=S(ef,["top","middle","bottom"],"valign"),of=function(n,e){var t,r,o,u,i=dc(n),c=sc(n),a=e?(t=n.dom,{borderstyle:te(i,"border-style").getOr(""),bordercolor:Jl(t)(te(i,"border-color").getOr("")),backgroundcolor:Jl(t)(te(i,"background-color").getOr(""))}):{};return un(un(un(un(un(un({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,"class":"",align:"",border:""}),i),c),a),(u=i["border-width"],hc(n)&&u?{border:u}:te(c,"border").fold(function(){return{}},function(n){return{border:n}}))),(r=te(i,"border-spacing").or(te(c,"cellspacing")).fold(function(){return{}},function(n){return{cellspacing:n}}),o=te(i,"border-padding").or(te(c,"cellpadding")).fold(function(){return{}},function(n){return{cellpadding:n}}),un(un({},r),o)))},uf=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],cf=function(n){return uf.concat((0<(e=Yl(n.getParam("table_cell_class_list",[],"array"))).length?N.some({name:"class",type:"listbox",label:"Class",items:e}):N.none()).toArray());var e},af=function(u){return function(t,r){var o=t.dom;return{setAttrib:function(n,e){u&&!e||o.setAttrib(r,n,e)},setStyle:function(n,e){u&&!e||o.setStyle(r,n,e)},setFormat:function(n,e){u&&!e||(""===e?t.formatter.remove(n,{value:null},r,!0):t.formatter.apply(n,{value:e},r))}}}},lf={normal:af(!1),ifTruthy:af(!0)},ff=function(o){return vt(o[0]).map(function(n){var e=Lt.fromTable(n),t=Lt.justCells(e),r=U(t,function(e){return F(o,function(n){return Vn(e.element,n)})});return q(r,function(n){return{element:n.element.dom,column:Lt.getColumnAt(e,n.column).map(function(n){return n.element.dom})}})})},sf=function(m,n,t,g){var e,r,p=1===n.length,o=Zn(g,function(n,e){return t[e]!==n});0<ee(o)&&1<=n.length&&(e=vt(n[0]),ff(n).each(function(n){V(n,function(n){var e,t,r,o,u,i,c,a,l,f,s=Tl(m,n.element,g.celltype),d=p?lf.normal(m,s):lf.ifTruthy(m,s);t=n.column.map(function(n){return p?lf.normal(m,n):lf.ifTruthy(m,n)}).getOr(d),r=g,(e=d).setAttrib("scope",r.scope),e.setAttrib("class",r["class"]),e.setStyle("height",Su(r.height)),t.setStyle("width",Su(r.width)),mc(m)&&(u=g,(o=d).setFormat("tablecellbackgroundcolor",u.backgroundcolor),o.setFormat("tablecellbordercolor",u.bordercolor),o.setFormat("tablecellborderstyle",u.borderstyle),o.setFormat("tablecellborderwidth",Su(u.borderwidth))),p&&(Xl(m,s),i=m,c=s,$l.each("top middle bottom".split(" "),function(n){i.formatter.remove("valign"+n,{},c)})),g.halign&&Kl(m,s,g.halign),g.valign&&(a=m,l=s,(f=g.valign)&&a.formatter.apply("valign"+f,{},l))})}),r=0<ee(Zn(o,function(n,e){return"scope"!==e&&"celltype"!==e})),e.each(function(n){return rc(m,n.dom,{structure:re(o,"celltype"),style:r})}))},df=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact(function(){sf(n,e,t,o),n.focus()})},mf=function(a,n){var e=ff(n).map(function(n){return q(n,function(n){return e=a,t=n.element,r=mc(a),o=n.column,u=e.dom,i=o.getOr(t),un({width:(c=function(n,e){return u.getStyle(n,e)||u.getAttrib(n,e)})(i,"width"),height:c(t,"height"),scope:u.getAttrib(t,"scope"),celltype:bu(t),"class":u.getAttrib(t,"class",""),halign:tf(e,t),valign:rf(e,t)},r?Ql(u,t):{});var e,t,r,o,u,i,c})});return Zl(e.getOrDie())},gf=function(n,e){var t,r,o,u=Il(Ou(n),e);0!==u.length&&(t=mf(n,u),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:cf(n)},nf("cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:cf(n)}]},n.windowManager.open({title:"Cell Properties",size:"normal",body:mc(n)?r:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:S(df,n,u,t)}))},pf=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],hf=function(n){return pf.concat((0<(e=Yl(n.getParam("table_row_class_list",[],"array"))).length?N.some({name:"class",type:"listbox",label:"Class",items:e}):N.none()).toArray());var e},vf=function(i,n,c,a){var e,t,l=1===n.length,r=Zn(a,function(n,e){return c[e]!==n});0<ee(r)&&(V(n,function(n){a.type!==bu(n.parentNode)&&Dl(i,n,a.type);var e,t,r,o,u=l?lf.normal(i,n):lf.ifTruthy(i,n);t=a,(e=u).setAttrib("class",t["class"]),e.setStyle("height",Su(t.height)),gc(i)&&(o=a,(r=u).setStyle("background-color",o.backgroundcolor),r.setStyle("border-color",o.bordercolor),r.setStyle("border-style",o.borderstyle)),a.align!==c.align&&(Xl(i,n),Kl(i,n,a.align))}),e=re(r,"type"),t=!e||1<ee(r),vt(Fn.fromDom(n[0])).each(function(n){return rc(i,n.dom,{structure:e,style:t})}))},bf=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact(function(){vf(n,e,t,o),n.focus()})},wf=function(u){var n,e,t,r,o=Bl(Ou(u),ku.selected);0!==o.length&&(n=q(o,function(n){return e=u,t=n.dom,r=gc(u),o=e.dom,un({height:o.getStyle(t,"height")||o.getAttrib(t,"height"),"class":o.getAttrib(t,"class",""),type:xl(0,t),align:tf(e,t)},r?Ql(o,t):{});var e,t,r,o}),e=Zl(n),t={type:"tabpanel",tabs:[{title:"General",name:"general",items:hf(u)},nf("row")]},r={type:"panel",items:[{type:"grid",columns:2,items:hf(u)}]},u.windowManager.open({title:"Row Properties",size:"normal",body:gc(u)?t:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:S(bf,u,q(o,function(n){return n.dom}),e)}))},yf=tinymce.util.Tools.resolve("tinymce.Env"),Cf=function(n,e,t,r){if("TD"===e.tagName||"TH"===e.tagName)O(t)?n.setStyle(e,t,r):n.setStyle(e,t);else if(e.children)for(var o=0;o<e.children.length;o++)Cf(n,e.children[o],t,r)},xf=function(o,u,t,n){var i,c=o.dom,a=n.getData(),l=Zn(a,function(n,e){return t[e]!==n});n.close(),""===a["class"]&&delete a["class"],o.undoManager.transact(function(){var n,e,t,r;u||(n=parseInt(a.cols,10)||1,e=parseInt(a.rows,10)||1,u=Ll(o,n,e,0,0)),0<ee(l)&&(function(n,e,t){var r,o=n.dom,u={},i={};if(u["class"]=t["class"],i.height=Su(t.height),o.getAttrib(e,"width")&&!hc(n)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=Su(t.width),hc(n)?(i["border-width"]=Su(t.border),i["border-spacing"]=Su(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),hc(n)&&e.children)for(var c=0;c<e.children.length;c++)Cf(o,e.children[c],{"border-width":Su(t.border),padding:Su(t.cellpadding)}),pc(n)&&Cf(o,e.children[c],{"border-color":t.bordercolor});pc(n)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(un(un({},dc(n)),i)),o.setAttribs(e,un(un({},sc(n)),u))}(o,u,a),(i=c.select("caption",u)[0])&&!a.caption&&c.remove(i),!i&&a.caption&&((i=c.create("caption")).innerHTML=yf.ie?"\xa0":'<br data-mce-bogus="1"/>',u.insertBefore(i,u.firstChild)),""===a.align?Xl(o,u):Kl(o,u,a.align)),o.focus(),o.addVisual(),0<ee(l)&&(r=!(t=re(l,"caption"))||1<ee(l),rc(o,u,{structure:t,style:r}))})},Sf=function(n,e){var t,r,o,u,i,c,a,l,f=n.dom,s=of(n,pc(n));!1===e?(t=f.getParent(n.selection.getStart(),"table"))?(o=t,u=pc(r=n),l=r.dom,s=un({width:l.getStyle(o,"width")||l.getAttrib(o,"width"),height:l.getStyle(o,"height")||l.getAttrib(o,"height"),
cellspacing:l.getStyle(o,"border-spacing")||l.getAttrib(o,"cellspacing"),cellpadding:l.getAttrib(o,"cellpadding")||Gl(r.dom,o,"padding"),border:(i=l,c=o,a=rt(Fn.fromDom(c),"border-width"),hc(r)&&a.isSome()?a.getOr(""):i.getAttrib(c,"border")||Gl(r.dom,c,"border-width")||Gl(r.dom,c,"border")),caption:!!l.select("caption",o)[0],"class":l.getAttrib(o,"class",""),align:tf(r,o)},u?Ql(l,o):{})):pc(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""):(s.cols="1",s.rows="1",pc(n)&&(s.borderstyle="",s.bordercolor="",s.backgroundcolor=""));var d=Yl(n.getParam("table_class_list",[],"array"));0<d.length&&s["class"]&&(s["class"]=s["class"].replace(/\s*mce\-item\-table\s*/g,""));var m,g,p,h,v={type:"grid",columns:2,items:(m=d,g=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],p=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],h=0<m.length?[{type:"listbox",name:"class",label:"Class",items:m}]:[],g.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(p).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(h))},b=pc(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[v]},nf("table")]}:{type:"panel",items:[v]};n.windowManager.open({title:"Table Properties",size:"normal",body:b,onSubmit:S(xf,n,t,s),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:s})},Tf=function(n){return kl(Ou(n))},Rf=function(n){return Al(Ou(n))},Df=function(c,r,t,a,e){var o=xu(c),l=function(n){return vt(n,o)},f=function(e){return function(n){c.selection.setRng(n.rng),c.focus(),t.clear(e),Tu(e),rc(c,e.dom,n.effect)}},u=function(r){return Rf(c).each(function(t){l(t).each(function(n){var e=Bu(a,n,t);r(n,e).each(f(n))})})},n=function(){return Rf(c).map(function(r){return l(r).bind(function(n){var e=Bu(a,n,r),t=pu(C,Fn.fromDom(c.getDoc()),N.none());return Ul(n,e,t)})})},i=function(){return Rf(c).map(function(t){return l(t).bind(function(n){var e=Bu(a,n,t);return Vl(n,e)})})},s=function(i,n){return n().each(function(n){var u=q(n,Br);Rf(c).each(function(n){return l(n).each(function(n){var e,t,r=hu(Fn.fromDom(c.getDoc())),o=(e=u,t=r,{selection:Au(a),clipboard:e,generators:t});i(n,o).each(f(n))})})})};Yn({mceTableSplitCells:function(){return u(r.unmergeCells)},mceTableMergeCells:function(){return u(r.mergeCells)},mceTableInsertRowBefore:function(){return u(r.insertRowsBefore)},mceTableInsertRowAfter:function(){return u(r.insertRowsAfter)},mceTableInsertColBefore:function(){return u(r.insertColumnsBefore)},mceTableInsertColAfter:function(){return u(r.insertColumnsAfter)},mceTableDeleteCol:function(){return u(r.deleteColumn)},mceTableDeleteRow:function(){return u(r.deleteRow)},mceTableCutCol:function(){return i().each(function(n){e.setColumns(n),u(r.deleteColumn)})},mceTableCutRow:function(){return n().each(function(n){e.setRows(n),u(r.deleteRow)})},mceTableCopyCol:function(){return i().each(function(n){return e.setColumns(n)})},mceTableCopyRow:function(){return n().each(function(n){return e.setRows(n)})},mceTablePasteColBefore:function(){return s(r.pasteColsBefore,e.getColumns)},mceTablePasteColAfter:function(){return s(r.pasteColsAfter,e.getColumns)},mceTablePasteRowBefore:function(){return s(r.pasteRowsBefore,e.getRows)},mceTablePasteRowAfter:function(){return s(r.pasteRowsAfter,e.getRows)},mceTableDelete:function(){return Tf(c).each(function(n){vt(n,o).filter(h(o)).each(function(n){var e,t=Fn.fromText("");Xt(n,t),tr(n),c.dom.isEmpty(c.getBody())?(c.setContent(""),c.selection.setCursorLocation()):((e=c.dom.createRng()).setStart(t.dom,0),e.setEnd(t.dom,0),c.selection.setRng(e),c.nodeChanged())})})},mceTableSizingMode:function(n,e){return t=e,Tf(c).each(function(n){wc(c)||bc(c)||vc(c)||vt(n,o).each(function(n){"relative"!==t||ii(n)?"fixed"!==t||ci(n)?"responsive"!==t||ai(n)||Ic(n):kc(c,n):Ac(c,n),Tu(n),rc(c,n.dom,uc)})});var t}},function(n,e){return c.addCommand(e,n)});var d=function(e,n){n.each(function(n){rc(e,n.dom,uc)})};Yn({mceTableCellType:function(n,e){var t=vt(Ou(c),o);r.setTableCellType(c,e),d(c,t)},mceTableRowType:function(n,e){var t=vt(Ou(c),o);r.setTableRowType(c,e),d(c,t)}},function(n,e){return c.addCommand(e,n)}),c.addCommand("mceTableColType",function(n,e){return te(e,"type").each(function(n){return u("th"===n?r.makeColumnsHeader:r.unmakeColumnsHeader)})}),Yn({mceTableProps:S(Sf,c,!1),mceTableRowProps:S(wf,c),mceTableCellProps:S(gf,c,a)},function(n,e){return c.addCommand(e,function(){return n()})}),c.addCommand("mceInsertTable",function(n,e){A(e)&&0<Kn(e).length?zl(c,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Sf(c,!0)}),c.addCommand("mceTableApplyCellStyle",function(n,e){var r,t,o=function(n){return"tablecell"+n.toLowerCase().replace("-","")};!A(e)||0!==(r=Il(Ou(c),a)).length&&(function(n){for(var e in n)if(Xn.call(n,e))return!1;return!0}(t=Zn(e,function(n,e){return c.formatter.has(o(e))&&O(n)}))||(Yn(t,function(e,t){V(r,function(n){lf.normal(c,n.dom).setFormat(o(t),e)})}),l(r[0]).each(function(n){return rc(c,n.dom,oc)})))})},Of=function(t,r,o){var n=xu(t);Yn({mceTableRowType:function(){return r.getTableRowType(t)},mceTableCellType:function(){return r.getTableCellType(t)},mceTableColType:function(){return Al(Ou(t)).bind(function(t){return vt(t,n).map(function(n){var e=Bu(o,n,t);return r.getTableColType(n,e)})}).getOr("")}},function(n,e){return t.addQueryValueHandler(e,n)})},Af={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},kf=xr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),If=un(un({},kf),{none:function(n){return void 0===n&&(n=undefined),kf.none(n)}}),Bf=function(t,n){return vt(t,n).bind(function(n){var e=pt(n);return X(e,function(n){return Vn(t,n)}).map(function(n){return{index:n,all:e}})})},Ef=function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}},Pf=xr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Mf={before:Pf.before,on:Pf.on,after:Pf.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(p,p,p)}},Nf=xr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),jf={domRange:Nf.domRange,relative:Nf.relative,exact:Nf.exact,exactFromRange:function(n){return Nf.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e;return e=n.match({domRange:function(n){return Fn.fromDom(n.startContainer)},relative:function(n){return Mf.getStart(n)},exact:function(n){return n}}),Fn.fromDom(ye(e).dom.defaultView)},range:Ef},Wf=function(n,e){return n.selectNodeContents(e.dom)},Lf=function(n,e,t){var r,o,u=n.document.createRange();return r=u,e.fold(function(n){r.setStartBefore(n.dom)},function(n,e){r.setStart(n.dom,e)},function(n){r.setStartAfter(n.dom)}),o=u,t.fold(function(n){o.setEndBefore(n.dom)},function(n,e){o.setEnd(n.dom,e)},function(n){o.setEndAfter(n.dom)}),u},zf=function(n,e,t,r,o){var u=n.document.createRange();return u.setStart(e.dom,t),u.setEnd(r.dom,o),u},_f=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Ff=xr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Hf=function(n,e,t){return e(Fn.fromDom(t.startContainer),t.startOffset,Fn.fromDom(t.endContainer),t.endOffset)},qf=function(n,e){var o,t,r,u=(o=n,e.match({domRange:function(n){return{ltr:b(n),rtl:N.none}},relative:function(n,e){return{ltr:cn(function(){return Lf(o,n,e)}),rtl:cn(function(){return N.some(Lf(o,e,n))})}},exact:function(n,e,t,r){return{ltr:cn(function(){return zf(o,n,e,t,r)}),rtl:cn(function(){return N.some(zf(o,t,r,n,e))})}}}));return(r=(t=u).ltr()).collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return Ff.rtl(Fn.fromDom(n.endContainer),n.endOffset,Fn.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Hf(0,Ff.ltr,r)}):Hf(0,Ff.ltr,r)},Vf=function(u,n){return qf(u,n).match({ltr:function(n,e,t,r){var o=u.document.createRange();return o.setStart(n.dom,e),o.setEnd(t.dom,r),o},rtl:function(n,e,t,r){var o=u.document.createRange();return o.setStart(t.dom,r),o.setEnd(n.dom,e),o}})},Uf=(Ff.ltr,Ff.rtl,function(n,e,t){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}),$f=function(t,r,n,e,o){var u=function(n){var e=t.dom.createRange();return e.setStart(r.dom,n),e.collapse(!0),e},i=ur(r).length,c=function(n,e,t,r,o){if(0===o)return 0;if(e===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(e-c.left);if(t<=c.bottom){if(t<c.top||u<a)return i-1;u=a}}return 0}(function(n){return u(n).getBoundingClientRect()},n,e,o.right,i);return u(c)},Gf=function(n,e,t,r){return pe(e)?function(e,t,r,o){var n=e.dom.createRange();n.selectNode(t.dom);var u=n.getClientRects();return on(u,function(n){return Uf(n,r,o)?N.some(n):N.none()}).map(function(n){return $f(e,t,r,o,n)})}(n,e,t,r):(u=e,i=t,c=r,a=(o=n).dom.createRange(),l=Re(u),on(l,function(n){return a.selectNode(n.dom),Uf(a.getBoundingClientRect(),i,c)?Gf(o,n,i,c):N.none()}));var o,u,i,c,a,l},Kf=function(n,e){return e-n.left<n.right-e},Xf=function(n,e,t){var r=n.dom.createRange();return r.selectNode(e.dom),r.collapse(t),r},Yf=function(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var o=r.getBoundingClientRect(),u=Kf(o,t);return(!0===u?uu:iu)(n).map(function(n){return Xf(e,n,u)})},Jf=function(n,e,t){var r=e.dom.getBoundingClientRect(),o=Kf(r,t);return N.some(Xf(n,e,o))},Qf=function(t,n,e){return N.from(t.dom.caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return N.none();var e=t.dom.createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),N.some(e)})},Zf=function(n,e,t){return N.from(n.dom.caretRangeFromPoint(e,t))},ns=function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect();return function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return Gf(n,e,i,c)}(n,e,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))},es=function(o,u,e){return Fn.fromPoint(o,u,e).bind(function(r){var n=function(){return n=o,t=u,(0===Re(e=r).length?Jf:Yf)(n,e,t);var n,e,t};return 0===Re(r).length?n():ns(o,r,u,e).orThunk(n)})},ts=document.caretPositionFromPoint?Qf:document.caretRangeFromPoint?Zf:es,rs=function(n,e){var t=fe(n);return"input"===t?Mf.after(n):_(["br","img"],t)?0===e?Mf.before(n):Mf.after(n):Mf.on(n,e)},os=function(n,e){var t=n.fold(Mf.before,rs,Mf.after),r=e.fold(Mf.before,rs,Mf.after);return jf.relative(t,r)},us=function(n,e,t,r){var o=rs(n,e),u=rs(t,r);return jf.relative(o,u)},is=function(n,e,t,r){var o,u,i,c,a,l=(u=e,i=t,c=r,(a=we(o=n).dom.createRange()).setStart(o.dom,u),a.setEnd(i.dom,c),a),f=Vn(n,t)&&e===r;return l.collapsed&&!f},cs=function(n){return N.from(n.getSelection())},as=function(n,e){cs(n).each(function(n){n.removeAllRanges(),n.addRange(e)})},ls=function(n,e,t,r,o){var u=zf(n,e,t,r,o);as(n,u)},fs=function(f,n){return qf(f,n).match({ltr:function(n,e,t,r){ls(f,n,e,t,r)},rtl:function(i,c,a,l){cs(f).each(function(n){if(n.setBaseAndExtent)n.setBaseAndExtent(i.dom,c,a.dom,l);else if(n.extend)try{t=i,r=c,o=a,u=l,(e=n).collapse(t.dom,r),e.extend(o.dom,u)}catch(x){ls(f,a,l,i,c)}else ls(f,a,l,i,c);var e,t,r,o,u})}})},ss=function(n,e,t,r,o){var u=us(e,t,r,o);fs(n,u)},ds=function(n,e,t){var r=os(e,t);fs(n,r)},ms=function(n){var o=jf.getWin(n).dom,e=function(n,e,t,r){return zf(o,n,e,t,r)},t=n.match({domRange:function(n){var e=Fn.fromDom(n.startContainer),t=Fn.fromDom(n.endContainer);return us(e,n.startOffset,t,n.endOffset)},relative:os,exact:us});return qf(o,t).match({ltr:e,rtl:e})},gs=function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return N.some(Ef(Fn.fromDom(e.startContainer),e.startOffset,Fn.fromDom(t.endContainer),t.endOffset))}return N.none()},ps=function(n){if(null===n.anchorNode||null===n.focusNode)return gs(n);var e=Fn.fromDom(n.anchorNode),t=Fn.fromDom(n.focusNode);return is(e,n.anchorOffset,t,n.focusOffset)?N.some(Ef(e,n.anchorOffset,t,n.focusOffset)):gs(n)},hs=function(n,e){var t,r,o=(t=e,r=n.document.createRange(),Wf(r,t),r);as(n,o)},vs=function(n){return cs(n).filter(function(n){return 0<n.rangeCount}).bind(ps).map(function(n){return jf.exact(n.start,n.soffset,n.finish,n.foffset)})},bs=function(n,e){var t,r,o;return 0<(o=0<(r=(t=Vf(n,e)).getClientRects()).length?r[0]:t.getBoundingClientRect()).width||0<o.height?N.some(o).map(_f):N.none()},ws=function(n,e,t){return r=n,o=e,u=t,i=Fn.fromDom(r.document),ts(i,o,u).map(function(n){return Ef(Fn.fromDom(n.startContainer),n.startOffset,Fn.fromDom(n.endContainer),n.endOffset)});var r,o,u,i},ys=tinymce.util.Tools.resolve("tinymce.util.VK"),Cs=function(n,e,t,r){return Ts(n,e,Bf(o=t,u).fold(function(){return If.none(o)},function(n){return n.index+1<n.all.length?If.middle(o,n.all[n.index+1]):If.last(o)}),r);var o,u},xs=function(n,e,t,r){return Ts(n,e,Bf(o=t,u).fold(function(){return If.none()},function(n){return 0<=n.index-1?If.middle(o,n.all[n.index-1]):If.first(o)}),r);var o,u},Ss=function(n,e){var t=jf.exact(e,0,e,0);return ms(t)},Ts=function(o,n,e,u){return e.fold(N.none,N.none,function(n,e){return uu(e).map(function(n){return Ss(0,n)})},function(r){return vt(r,n).bind(function(n){var e,t=Iu(r);return o.undoManager.transact(function(){u.insertRowsAfter(n,t)}),e=Le(n,"tr"),rn(e).bind(function(n){return He(n,"td,th").map(function(n){return Ss(0,n)})})})})},Rs=["table","li","dl"],Ds=function(n,e){return{selection:n,kill:e}},Os=function(n,e,t,r){return{start:Mf.on(n,e),finish:Mf.on(t,r)}},As=function(n,e){var t=Vf(n,e);return Ef(Fn.fromDom(t.startContainer),t.startOffset,Fn.fromDom(t.endContainer),t.endOffset)},ks=Os,Is=function(t,n,r,e,o){return Vn(r,e)?N.none():hr(r,e,n).bind(function(n){var e=n.boxes.getOr([]);return 0<e.length?(o(t,e,n.start,n.finish),N.some(Ds(N.some(ks(r,0,r,tu(r))),!0))):N.none()})},Bs=function(n,e){return{item:n,mode:e}},Es=function(n,e,t,r){return void 0===r&&(r=Ps),n.property().parent(e).map(function(n){return Bs(n,r)})},Ps=function(n,e,t,r){return void 0===r&&(r=Ms),t.sibling(n,e).map(function(n){return Bs(n,r)})},Ms=function(n,e,t,r){void 0===r&&(r=Ms);var o=n.property().children(e);return t.first(o).map(function(n){return Bs(n,r)})},Ns=[{current:Es,next:Ps,fallback:N.none()},{current:Ps,next:Ms,fallback:N.some(Es)},{current:Ms,next:Ms,fallback:N.some(Ps)}],js=function(e,t,r,o,n){return void 0===n&&(n=Ns),K(n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return js(e,t,n,o)})})})},Ws=function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?N.some(n[n.length-1]):N.none()}}},Ls=function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?N.some(n[0]):N.none()}}},zs=function(e,n,t,r,o,u){return js(e,n,r,o).bind(function(n){return u(n.item)?N.none():t(n.item)?N.some(n.item):zs(e,n.item,t,n.mode,o,u)})},_s=function(e){return function(n){return 0===e.property().children(n).length}},Fs=function(n,e,t,r){return zs(n,e,t,Ps,Ws(),r)},Hs=function(n,e,t,r){return zs(n,e,t,Ps,Ls(),r)},qs=n(),Vs=function(n,e){return Fs(t=qs,n,_s(t),e);var t},Us=function(n,e){return Hs(t=qs,n,_s(t),e);var t},$s=xr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Gs=function(n){return qe(n,"tr")},Ks=un(un({},$s),{verify:function(c,n,e,t,r,a,o){return qe(t,"td,th",o).bind(function(i){return qe(n,"td,th",o).map(function(u){return Vn(i,u)?Vn(t,i)&&tu(i)===r?a(u):$s.none("in same cell"):gr(Gs,[i,u]).fold(function(){return e=u,t=i,r=(n=c).getRect(e),(o=n.getRect(t)).right>r.left&&o.left<r.right?$s.success():a(u);var n,e,t,r,o},function(){return a(u)})})}).getOr($s.none("default"))},cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}}),Xs=function(n,e){return X(n,S(Vn,e))},Ys=function(n){return"br"===fe(n)},Js=function(n,e,t){return e(n,t).bind(function(n){return pe(n)&&0===ur(n).trim().length?Js(n,e,t):N.some(n)})},Qs=function(e,n,t,r){return De(o=n,u=t).filter(Ys).orThunk(function(){return De(o,u-1).filter(Ys)}).bind(function(n){return r.traverse(n).fold(function(){return Js(n,r.gather,e).map(r.relative)},function(n){return Ce(r=n).bind(function(e){var t=Re(e);return Xs(t,r).map(function(n){return{parent:e,children:t,element:r,index:n}})}).map(function(n){return Mf.on(n.parent,n.index)});var r})});var o,u},Zs=function(n,e,t,r){var o,u,i;return(Ys(e)?(o=n,u=e,(i=r).traverse(u).orThunk(function(){return Js(u,i.gather,o)}).map(i.relative)):Qs(n,e,t,r)).map(function(n){return{start:n,finish:n}})},nd=function(n,e){return{left:n.left,top:n.top+e,right:n.right,bottom:n.bottom+e}},ed=function(n,e){return{left:n.left,top:n.top-e,right:n.right,bottom:n.bottom-e}},td=function(n,e,t){return{left:n.left+e,top:n.top+t,right:n.right+e,bottom:n.bottom+t}},rd=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},od=function(n,e){return N.some(n.getRect(e))},ud=function(n,e,t){return ge(e)?od(n,e).map(rd):pe(e)?(r=n,o=e,(0<=(u=t)&&u<tu(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):N.none()).map(rd)):N.none();var r,o,u},id=function(n,e){return ge(e)?od(n,e).map(rd):pe(e)?n.getRangedRect(e,0,e,tu(e)).map(rd):N.none()},cd=xr([{none:[]},{retry:["caret"]}]),ad=function(e,n,r){return o(function(n,e){return e(n)},ze,n,za,t).fold(v,function(n){return id(e,n).exists(function(n){return t=n,(e=r).left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right;var e,t})});var t},ld={point:function(n){return n.bottom},adjuster:function(n,e,t,r,o){var u=nd(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?cd.retry(u):t.top===o.bottom?cd.retry(nd(o,1)):ad(n,e,o)?cd.retry(td(u,5,0)):cd.none()},move:nd,gather:Us},fd=function(t,r,o,u,i){return 0===i?N.some(u):(a=t,l=u.left,f=r.point(u),a.elementFromPoint(l,f).filter(function(n){return"table"===fe(n)}).isSome()?(e=u,c=i-1,fd(t,n=r,o,n.move(e,5),c)):t.situsFromPoint(u.left,r.point(u)).bind(function(n){return n.start.fold(N.none,function(e){return id(t,e).bind(function(n){return r.adjuster(t,e,n,o,u).fold(N.none,function(n){return fd(t,r,o,n,i-1)})}).orThunk(function(){return N.some(u)})},N.none)}));var n,e,c,a,l,f},sd=function(e,t,n){var r,o,u,i=e.move(n,5),c=fd(t,e,n,i,100).getOr(i);return o=c,u=t,((r=e).point(o)>u.getInnerHeight()?N.some(r.point(o)-u.getInnerHeight()):r.point(o)<0?N.some(-r.point(o)):N.none()).fold(function(){return t.situsFromPoint(c.left,e.point(c))},function(n){return t.scrollBy(0,n),t.situsFromPoint(c.left,e.point(c)-n)})},dd={tryUp:S(sd,{point:function(n){return n.top},adjuster:function(n,e,t,r,o){var u=ed(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?cd.retry(u):t.bottom===o.top?cd.retry(ed(o,1)):ad(n,e,o)?cd.retry(td(u,5,0)):cd.none()},move:ed,gather:Vs}),tryDown:S(sd,ld),ieTryUp:function(n,e){return n.situsFromPoint(e.left,e.top-5)},ieTryDown:function(n,e){return n.situsFromPoint(e.left,e.bottom+5)},getJumpSize:b(5)},md=function(o,u,i){return o.getSelection().bind(function(r){return Zs(u,r.finish,r.foffset,i).fold(function(){return N.some(Nc(r.finish,r.foffset))},function(n){var e,t=o.fromSitus(n);return e=Ks.verify(o,r.finish,r.foffset,t.finish,t.foffset,i.failure,u),Ks.cata(e,function(){return N.none()},function(){return N.none()},function(n){return N.some(Nc(n,0))},function(n){return N.some(Nc(n,tu(n)))})})})},gd=function(r,o,u,i,c,a){return 0===a?N.none():vd(r,o,u,i,c).bind(function(n){var e=r.fromSitus(n),t=Ks.verify(r,u,i,e.finish,e.foffset,c.failure,o);return Ks.cata(t,function(){return N.none()},function(){return N.some(n)},function(n){return Vn(u,n)&&0===i?pd(r,u,i,ed,c):gd(r,o,n,0,c,a-1)},function(n){return Vn(u,n)&&i===tu(n)?pd(r,u,i,nd,c):gd(r,o,n,tu(n),c,a-1)})})},pd=function(e,n,t,r,o){return ud(e,n,t).bind(function(n){return hd(e,o,r(n,dd.getJumpSize()))})},hd=function(n,e,t){var r=zn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?e.otherRetry(n,t):r.isIE()?e.ieRetry(n,t):N.none()},vd=function(e,n,t,r,o){return ud(e,t,r).bind(function(n){return hd(e,o,n)})},bd=function(n,e){return ze(n,function(n){return Ce(n).exists(function(n){return Vn(n,e)})},t).isSome();var t},wd=function(u,i,c,n,a){return qe(n,"td,th",i).bind(function(o){return qe(o,"table",i).bind(function(n){return bd(a,n)?md(e=u,t=i,r=c).bind(function(n){return gd(e,t,n.element,n.offset,r,20).map(e.fromSitus)}).bind(function(e){return qe(e.finish,"td,th",i).map(function(n){return{start:o,finish:n,range:e}})}):N.none();var e,t,r})})},yd=function(n,e,t,r,o,u){return zn().browser.isIE()?N.none():u(r,e).orThunk(function(){return wd(n,e,t,r,o).map(function(n){var e=n.range;return Ds(N.some(ks(e.start,e.soffset,e.finish,e.foffset)),!0)})})},Cd=function(n,r){return qe(n,"tr",r).bind(function(t){return qe(t,"table",r).bind(function(n){var e=Le(n,"tr");return Vn(t,e[0])?Fs(qs,n,function(n){return iu(n).isSome()},r).map(function(n){var e=tu(n);return Ds(N.some(ks(n,e,n,e)),!0)}):N.none()})})},xd=function(n,r){return qe(n,"tr",r).bind(function(t){return qe(t,"table",r).bind(function(n){var e=Le(n,"tr");return Vn(t,e[e.length-1])?Hs(qs,n,function(n){return uu(n).isSome()},r).map(function(n){return Ds(N.some(ks(n,0,n,0)),!0)}):N.none()})})},Sd=function(n,e,t,r,o,u,i){return wd(n,t,r,o,u).bind(function(n){return Is(e,t,n.start,n.finish,i)})},Td=function(n,e){return qe(n,"td,th",e)},Rd=function(o,u,e,i){var t,r=(t=Go(N.none()),{clear:function(){return t.set(N.none())},set:function(n){return t.set(N.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),c=r.clear,a=function(n){r.on(function(r){i.clearBeforeUpdate(u),Td(n.target,e).each(function(t){hr(r,t,e).each(function(n){var e=n.boxes.getOr([]);(1<e.length||1===e.length&&!Vn(r,t))&&(i.selectRange(u,e,n.start,n.finish),o.selectContents(t))})})})};return{clearstate:c,mousedown:function(n){i.clear(u),Td(n.target,e).each(r.set)},mouseover:function(n){a(n)},mouseup:function(n){a(n),c()}}},Dd={traverse:Te,gather:Us,relative:Mf.before,otherRetry:dd.tryDown,ieRetry:dd.ieTryDown,failure:Ks.failedDown},Od={traverse:Se,gather:Vs,relative:Mf.before,otherRetry:dd.tryUp,ieRetry:dd.ieTryUp,failure:Ks.failedUp},Ad=function(e){return function(n){return n===e}},kd=Ad(38),Id=Ad(40),Bd=function(n){return 37<=n&&n<=40},Ed={isBackward:Ad(37),isForward:Ad(39)},Pd={isBackward:Ad(39),isForward:Ad(37)},Md=function(c){return{elementFromPoint:function(n,e){return Fn.fromPoint(Fn.fromDom(c.document),n,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(n,e,t,r){var o=jf.exact(n,e,t,r);return bs(c,o)},getSelection:function(){return vs(c).map(function(n){return As(c,n)})},fromSitus:function(n){var e=jf.relative(n.start,n.finish);return As(c,e)},situsFromPoint:function(n,e){return ws(c,n,e).map(function(n){return Os(n.start,n.soffset,n.finish,n.foffset)})},clearSelection:function(){cs(c).each(function(n){return n.removeAllRanges()})},collapseSelection:function(i){void 0===i&&(i=!1),vs(c).each(function(n){return n.fold(function(n){return n.collapse(i)},function(n,e){var t=i?n:e;ds(c,t,t)},function(n,e,t,r){var o=i?n:t,u=i?e:r;ss(c,o,u,o,u)})})},setSelection:function(n){ss(c,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,e){ds(c,n,e)},selectContents:function(n){hs(c,n)},getInnerHeight:function(){return c.innerHeight},getScrollY:function(){var n,e,t,r;return(n=Fn.fromDom(c.document),e=n!==undefined?n.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop,Xr(t,r)).top},scrollBy:function(n,e){var t,r,o,u;t=n,r=e,(u=((o=Fn.fromDom(c.document))!==undefined?o.dom:document).defaultView)&&u.scrollBy(t,r)}}},Nd=function(n,e){return{rows:n,cols:e}},jd=function(n,g,p,h){var l=Md(n),f=function(){return h.clear(g),N.none()};return{keydown:function(n,e,t,r,o,i){var u=n.raw,c=u.which,a=!0===u.shiftKey;return vr(g,h.selectedSelector).fold(function(){return Id(c)&&a?S(Sd,l,g,p,Dd,r,e,h.selectRange):kd(c)&&a?S(Sd,l,g,p,Od,r,e,h.selectRange):Id(c)?S(yd,l,p,Dd,r,e,xd):kd(c)?S(yd,l,p,Od,r,e,Cd):N.none},function(u){var n=function(n){return function(){return on(n,function(n){return e=n.rows,t=n.cols,r=g,wr(u,e,t,(o=h).firstSelectedSelector,o.lastSelectedSelector).map(function(n){return o.clearBeforeUpdate(r),o.selectRange(r,n.boxes,n.start,n.finish),n.boxes});var e,t,r,o}).fold(function(){return br(g,h.firstSelectedSelector,h.lastSelectedSelector).map(function(n){var e=Id(c)||i.isForward(c)?Mf.after:Mf.before;return l.setRelativeSelection(Mf.on(n.first,0),e(n.table)),h.clear(g),Ds(N.none(),!0)})},function(){return N.some(Ds(N.none(),!0))})}};return Id(c)&&a?n([Nd(1,0)]):kd(c)&&a?n([Nd(-1,0)]):i.isBackward(c)&&a?n([Nd(0,-1),Nd(-1,0)]):i.isForward(c)&&a?n([Nd(0,1),Nd(1,0)]):Bd(c)&&0==a?f:N.none})()},keyup:function(l,f,s,d,m){return vr(g,h.selectedSelector).fold(function(){var t,r,n,e,o,u,i,c=l.raw,a=c.which;return 0!=(!0===c.shiftKey)&&Bd(a)?(t=g,r=p,n=f,e=s,o=d,u=m,i=h.selectRange,Vn(n,o)&&e===u?N.none():qe(n,"td,th",r).bind(function(e){return qe(o,"td,th",r).bind(function(n){return Is(t,r,e,n,i)})})):N.none()},N.none)}}},Wd=function(o,u,e){var t=function(n){Xe(n,o.selected),Xe(n,o.firstSelected),Xe(n,o.lastSelected)},i=function(n){Ue(n,o.selected,"1")},c=function(n){r(n),e()},r=function(n){var e=Le(n,o.selectedSelector);V(e,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,e,t,r){c(n),V(e,i),Ue(t,o.firstSelected,"1"),Ue(r,o.lastSelected,"1"),u(e,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},Ld=function(n,e,s){var d=Lt.fromTable(n);return ta(d,e).map(function(n){var t,e,r,o,u,i,c,a,l,f=Kc(d,s,!1);return{upOrLeftCells:(t=n,e=s,r=f.slice(0,t[t.length-1].row+1),o=Yc(r,e),J(o,function(n){var e=n.cells.slice(0,t[t.length-1].column+1);return q(e,function(n){return n.element})})),downOrRightCells:(i=n,c=s,a=(u=f).slice(i[0].row+i[0].rowspan-1,u.length),l=Yc(a,c),J(l,function(n){var e=n.cells.slice(i[0].column+i[0].colspan-1,n.cells.length);return q(e,function(n){return n.element})}))}})},zd=function(n){return!1===Pi(Fn.fromDom(n.target),"ephox-snooker-resizer-bar")},_d=function(a){var n,e,t,r,o,u,i,c,l,f,s,d,m,g,p,h,v,b,w,y,C,x,S,T,R,D,O,A=(n=function(){return wu(a)},e=function(){return kl(Ou(a))},t=ku.selectedSelector,{get:function(){return yr(n(),t).fold(function(){return e().map(Or).getOrThunk(Rr)},function(n){return Dr(n)})}}),k=(r=a,o=A,u=Go(N.none()),i=Go([]),c=N.none(),l=be("caption"),f=function(e){return c.forall(function(n){return!n[e]})},s=function(){return kl(Ou(r)).bind(function(e){return vt(e).map(function(n){return l(e)?Iu(e):Bu(o,n,e)})})},d=function(o){return vt(o.element).map(function(n){var t=Lt.fromTable(n),e=ta(t,o).getOr([]),r=G(e,function(n,e){return e.isLocked&&(n.onAny=!0,0===e.column?n.onFirst=!0:e.column+e.colspan>=t.grid.columns&&(n.onLast=!0)),n},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ia(t,o).isSome(),unmergeable:ca(t,o).isSome(),locked:r}})},m=function(){u.set(cn(s)()),c=u.get().bind(d),V(i.get(),function(n){return n()})},g=function(e,t){var r=function(){return u.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})};return r(),i.set(i.get().concat([r])),function(){i.set(U(i.get(),function(n){return n!==r}))}},p=function(e){return c.exists(function(n){return n.locked[e]})},r.on("NodeChange ExecCommand TableSelectorChange",m),{onSetupTable:function(n){return g(n,function(){return!1})},onSetupCellOrRow:function(n){return g(n,function(n){return l(n.element)})},onSetupColumn:function(e){return function(n){return g(n,function(n){return l(n.element)||p(e)})}},onSetupPasteable:function(e){return function(n){return g(n,function(n){return l(n.element)||e().isNone()})}},onSetupPasteableColumn:function(e,t){return function(n){return g(n,function(n){return l(n.element)||e().isNone()||p(t)})}},onSetupMergeable:function(n){return g(n,function(){return f("mergeable")})},onSetupUnmergeable:function(n){return g(n,function(){return f("unmergeable")})},resetTargets:m,targets:function(){return u.get()}}),I=Mc(a),B=M(a,I.lazyResize,k),E=El(a,I.lazyWire,A),P=(h=Go(N.none()),v=Go(N.none()),b=function(n){n.set(N.none())},{getRows:h.get,setRows:function(n){h.set(n),b(v)},clearRows:function(){return b(h)},getColumns:v.get,setColumns:function(n){v.set(n),b(h)},clearColumns:function(){return b(v)}});return Df(a,E,B,A,P),Of(a,E,A),Eu(a,A,E,B),C=a,S=P,T=function(n){return function(){return C.execCommand(n)}},R=function(n){C.execCommand("mceInsertTable",!1,{rows:n.numRows,columns:n.numColumns})},D={text:"Table properties",onSetup:(x=k).onSetupTable,onAction:T("mceTableProps")},O={text:"Delete table",icon:"table-delete-table",onSetup:x.onSetupTable,onAction:T("mceTableDelete")},C.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:T("mceTableInsertRowBefore"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:T("mceTableInsertRowAfter"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:T("mceTableDeleteRow"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:T("mceTableRowProps"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:T("mceTableCutRow"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:T("mceTableCopyRow"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:T("mceTablePasteRowBefore"),onSetup:x.onSetupPasteable(S.getRows)}),C.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:T("mceTablePasteRowAfter"),onSetup:x.onSetupPasteable(S.getRows)}),C.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:T("mceTableInsertColBefore"),onSetup:x.onSetupColumn("onFirst")}),C.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:T("mceTableInsertColAfter"),onSetup:x.onSetupColumn("onLast")}),C.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:T("mceTableDeleteCol"),onSetup:x.onSetupColumn("onAny")}),C.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:T("mceTableCutCol"),onSetup:x.onSetupColumn("onAny")}),C.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:T("mceTableCopyCol"),onSetup:x.onSetupColumn("onAny")}),C.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:T("mceTablePasteColBefore"),onSetup:x.onSetupPasteableColumn(S.getColumns,"onFirst")}),C.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:T("mceTablePasteColAfter"),onSetup:x.onSetupPasteableColumn(S.getColumns,"onLast")}),C.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:T("mceTableCellProps"),onSetup:x.onSetupCellOrRow}),C.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:T("mceTableMergeCells"),onSetup:x.onSetupMergeable}),C.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:T("mceTableSplitCells"),onSetup:x.onSetupUnmergeable}),!1===C.getParam("table_grid",!0,"boolean")?C.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:T("mceInsertTable")}
):C.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:R}]}}),C.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:T("mceInsertTable")}),C.ui.registry.addMenuItem("tableprops",D),C.ui.registry.addMenuItem("deletetable",O),C.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),C.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),C.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),C.ui.registry.addContextMenu("table",{update:function(){return x.resetTargets(),x.targets().fold(function(){return""},function(n){return"caption"===fe(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}}),function(e,n,t){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(n){return function(){return e.execCommand(n)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(a,k,P),0<(y=(w=a).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&w.ui.registry.addContextToolbar("table",{predicate:function(n){return w.dom.is(n,"table")&&w.getBody().contains(n)},items:y,scope:"node",position:"node"}),a.on("PreInit",function(){a.serializer.addTempAttr(ku.firstSelected),a.serializer.addTempAttr(ku.lastSelected),a.formatter.register(Af)}),a.getParam("table_tab_navigation",!0,"boolean")&&a.on("keydown",function(n){var e,t,r,o,u,i,c;t=a,r=E,(e=n).keyCode===ys.TAB&&(o=wu(t),u=function(n){var e=fe(n);return Vn(n,o)||_(Rs,e)},(i=t.selection.getRng()).collapsed&&(c=Fn.fromDom(i.startContainer),gt(c,u).each(function(n){e.preventDefault(),(e.shiftKey?xs:Cs)(t,u,n,r).each(function(n){t.selection.setRng(n)})})))}),a.on("remove",function(){I.destroy()}),Hl(a,P,I,k)};Ar.add("table",_d)}();