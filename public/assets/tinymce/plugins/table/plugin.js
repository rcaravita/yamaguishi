/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=t.concat(n);return e.apply(null,a)}}function t(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;n>t;t++)for(var o=arguments[t],i=0,c=o.length;c>i;i++,a++)r[a]=o[i];return r}function n(e,t,n,r,a){return e(n,r)?S.some(n):L(a)&&a(n)?S.none():t(n,r,a)}function r(){return{up:v({selector:It,closest:qt,predicate:jt,all:kt}),down:v({selector:Mt,predicate:Pt}),styles:v({get:en,getRaw:nn,set:Zt,remove:rn}),attrs:v({get:Wt,set:Vt,remove:Kt,copyTo:function(e,t){var n=Gt(e);$t(t,n)}}),insert:v({before:Kn,after:Gn,afterAll:Qn,append:Jn,appendAll:er,prepend:Yn,wrap:Zn}),remove:v({unwrap:rr,remove:nr}),create:v({nu:Fe.fromTag,clone:function(e){return Fe.fromDom(e.dom.cloneNode(!1))},text:Fe.fromText}),query:v({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:_t,nextSibling:Ct}),property:v({children:xt,name:lt,parent:wt,document:function(e){return bt(e).dom},isText:gt,isComment:dt,isElement:mt,isSpecial:function(e){var t=lt(e);return F(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getText:or,setText:cr,isBoundary:function(e){return!!mt(e)&&("body"===lt(e)||F(sr,lt(e)))},isEmptyTag:function(e){return!!mt(e)&&F(["br","img","hr","input"],lt(e))},isNonEditable:function(e){return mt(e)&&"false"===Wt(e,"contenteditable")}}),eq:Ue,is:We}}function a(e,t,n){var r=Fd(Oo,function(t,r,a){n.targets().each(function(n){yn(r).each(function(o){var i,c,s,l,u=Tc(e),f=ho(y,Fe.fromDom(e.getDoc()),u),d=Hd(o,n,f);i=t,c=r,s=a,l=d,e.fire("TableSelectionChange",{cells:i,start:c,finish:s,otherCells:l})})})},function(){e.fire("TableSelectionClear")});return e.on("init",function(){var n,a,o,i,c,s,l=e.getWin(),u=bo(e),f=_o(e),d=(n=Md(l),{clearstate:(a=Nd(n,u,f,r)).clearstate,mousedown:a.mousedown,mouseover:a.mouseover,mouseup:a.mouseup}),m=Id(l,u,f,r),g=(o=u,i=f,c=r,s=Md(l),function(e,t){c.clearBeforeUpdate(o),pr(e,t,i).each(function(e){var n=e.boxes.getOr([]);c.selectRange(o,n,e.start,e.finish),s.selectContents(t),s.collapseSelection()})});e.on("TableSelectorChange",function(e){return g(e.start,e.finish)});var h,p,v=function(t,n){!0===t.raw.shiftKey&&(n.kill&&t.kill(),n.selection.each(function(t){var n=ju.relative(t.start,t.finish),r=Wu(l,n);e.selection.setRng(r)}))},b=function(e){return 0===e.button},w=(h=Wa(Fe.fromDom(u)),p=Wa(0),{touchEnd:function(e){var t,n,r=Fe.fromDom(e.target);"td"!==lt(r)&&"th"!==lt(r)||(t=h.get(),n=p.get(),Ue(t,r)&&e.timeStamp-n<300&&(e.preventDefault(),g(r,r))),h.set(r),p.set(e.timeStamp)}});e.on("dragstart",function(){d.clearstate()}),e.on("mousedown",function(e){b(e)&&qd(e)&&d.mousedown(Ai(e))}),e.on("mouseover",function(e){var t;(void 0===(t=e).buttons||_u.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&qd(e)&&d.mouseover(Ai(e))}),e.on("mouseup",function(e){b(e)&&qd(e)&&d.mouseup(Ai(e))}),e.on("touchend",w.touchEnd),e.on("keyup",function(t){var n,r,a,o=Ai(t);o.raw.shiftKey&&Pd(o.raw.which)&&(n=e.selection.getRng(),r=Fe.fromDom(n.startContainer),a=Fe.fromDom(n.endContainer),m.keyup(o,r,n.startOffset,a,n.endOffset).each(function(e){v(o,e)}))}),e.on("keydown",function(n){var r=Ai(n);t().each(function(e){return e.hideBars()});var a=e.selection.getRng(),o=Fe.fromDom(a.startContainer),i=Fe.fromDom(a.endContainer),c=Ur(Ld,Bd)(Fe.fromDom(e.selection.getStart()));m.keydown(r,o,a.startOffset,i,a.endOffset,c).each(function(e){v(r,e)}),t().each(function(e){return e.showBars()})}),e.on("NodeChange",function(){var t=e.selection,n=Fe.fromDom(t.getStart()),a=Fe.fromDom(t.getEnd());gr(yn,[n,a]).fold(function(){return r.clear(u)},y)})}),{clear:r.clear}}var o,i,c,s,l,u,f,d,m,g,h,p,y=function(){},v=function(e){return function(){return e}},b=function(e){return e},w=function(e){return function(t){return!e(t)}},k=v(!1),_=v(!0),C=function(){return x},x=(o=function(e){return e.isNone()},{fold:function(e){return e()},is:k,isSome:k,isNone:_,getOr:c=function(e){return e},getOrThunk:i=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:v(null),getOrUndefined:v(void 0),or:c,orThunk:i,map:C,each:y,bind:C,exists:k,forall:_,filter:C,equals:o,equals_:o,toArray:function(){return[]},toString:v("none()")}),z=function(e){var t=v(e),n=function(){return a},r=function(t){return t(e)},a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:_,isNone:k,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return z(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?a:x},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(k,function(t){return n(e,t)})}};return a},S={some:z,none:C,from:function(e){return null===e||void 0===e?x:z(e)}},T=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},N=function(e){return function(t){return typeof t===e}},E=T("string"),D=T("object"),A=T("array"),O=N("boolean"),R=(s=void 0,function(e){return s===e}),P=function(e){return!(null===(t=e)||void 0===t);var t},L=N("function"),B=N("number"),M=Array.prototype.slice,j=Array.prototype.indexOf,I=Array.prototype.push,F=function(e,t){return n=e,r=t,-1<j.call(n,r);var n,r},H=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return!0;return!1},q=function(e,t){for(var n=[],r=0;e>r;r++)n.push(t(r));return n},U=function(e,t){for(var n=e.length,r=new Array(n),a=0;n>a;a++){var o=e[a];r[a]=t(o,a)}return r},V=function(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)},$=function(e,t){for(var n=[],r=0,a=e.length;a>r;r++){var o=e[r];t(o,r)&&n.push(o)}return n},W=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n)}(e,function(e){n=t(n,e)}),n},X=function(e,t,n){return V(e,function(e){n=t(n,e)}),n},K=function(e,t){return function(e,t,n){for(var r=0,a=e.length;a>r;r++){var o=e[r];if(t(o,r))return S.some(o);if(n(o,r))break}return S.none()}(e,t,k)},G=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return S.some(n);return S.none()},Y=function(e){for(var t=[],n=0,r=e.length;r>n;++n){if(!A(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);I.apply(t,e[n])}return t},J=function(e,t){return Y(U(e,t))},Z=function(e,t){for(var n=0,r=e.length;r>n;++n)if(!0!==t(e[n],n))return!1;return!0},Q=function(e,t){for(var n={},r=0,a=e.length;a>r;r++){var o=e[r];n[String(o)]=t(o,r)}return n},ee=function(e){return[e]},te=function(e,t){return t>=0&&t<e.length?S.some(e[t]):S.none()},ne=function(e){return te(e,0)},re=function(e){return te(e,e.length-1)},ae=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return S.none()},oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ie=function(e){var t,n=!1;return function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return n||(n=!0,t=e.apply(null,r)),t}},ce=function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return le(r(1),r(2))},se=function(){return le(0,0)},le=function(e,t){return{major:e,minor:t}},ue={nu:le,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?se():ce(e,n)},unknown:se},fe=function(e,t){var n=String(t).toLowerCase();return K(e,function(e){return e.search(n)})},de=function(e,t){return fe(e,t).map(function(e){var n=ue.detect(e.versionRegexes,t);return{current:e.name,version:n}})},me=function(e,t){return fe(e,t).map(function(e){var n=ue.detect(e.versionRegexes,t);return{current:e.name,version:n}})},ge=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},he=function(e,t){return-1!==e.indexOf(t)},pe=function(e,t){return ge(e,t,0)},ye=function(e,t){return ge(e,t,e.length-t.length)},ve=(l=/^\s+|\s+$/g,function(e){return e.replace(l,"")}),be=function(e){return 0<e.length},we=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ke=function(e){return function(t){return he(t,e)}},_e=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return he(e,"edge/")&&he(e,"chrome")&&he(e,"safari")&&he(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,we],search:function(e){return he(e,"chrome")&&!he(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return he(e,"msie")||he(e,"trident")}},{name:"Opera",versionRegexes:[we,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ke("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ke("firefox")},{name:"Safari",versionRegexes:[we,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(he(e,"safari")||he(e,"mobile/"))&&he(e,"applewebkit")}}],Ce=[{name:"Windows",search:ke("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return he(e,"iphone")||he(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ke("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ke("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ke("linux"),versionRegexes:[]},{name:"Solaris",search:ke("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ke("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ke("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],xe={browsers:v(_e),oses:v(Ce)},ze="Firefox",Se=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(ze),isSafari:r("Safari")}},Te={unknown:function(){return Se({current:void 0,version:ue.unknown()})},nu:Se,edge:v("Edge"),chrome:v("Chrome"),ie:v("IE"),opera:v("Opera"),firefox:v(ze),safari:v("Safari")},Ne="Windows",Ee="Android",De="Solaris",Ae="FreeBSD",Oe="ChromeOS",Re=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(Ne),isiOS:r("iOS"),isAndroid:r(Ee),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(De),isFreeBSD:r(Ae),isChromeOS:r(Oe)}},Pe={unknown:function(){return Re({current:void 0,version:ue.unknown()})},nu:Re,windows:v(Ne),ios:v("iOS"),android:v(Ee),linux:v("Linux"),osx:v("OSX"),solaris:v(De),freebsd:v(Ae),chromeos:v(Oe)},Le=function(e,t){var n,r,a,o,i,c,s,l,u,f,d,m,g=xe.browsers(),h=xe.oses(),p=de(g,e).fold(Te.unknown,Te.nu),y=me(h,e).fold(Pe.unknown,Pe.nu);return{browser:p,os:y,deviceType:(r=p,a=e,o=t,i=(n=y).isiOS()&&!0===/ipad/i.test(a),c=n.isiOS()&&!i,s=n.isiOS()||n.isAndroid(),l=s||o("(pointer:coarse)"),u=i||!c&&s&&o("(min-device-width:768px)"),f=c||s&&!u,d=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(a),m=!f&&!u&&!d,{isiPad:v(i),isiPhone:v(c),isTablet:v(u),isPhone:v(f),isTouch:v(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:v(d),isDesktop:v(m)})}},Be=function(e){return window.matchMedia(e).matches},Me=ie(function(){return Le(navigator.userAgent,Be)}),je=function(){return Me()},Ie=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},Fe={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Ie(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return Ie(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return Ie(n)},fromDom:Ie,fromPoint:function(e,t,n){return S.from(e.dom.elementFromPoint(t,n)).map(Ie)}},He=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},qe=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Ue=function(e,t){return e.dom===t.dom},Ve=function(e,t){return n=e.dom,r=t.dom,a=n,o=r,i=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(a.compareDocumentPosition(o)&i);var n,r,a,o,i},$e=function(e,t){return je().browser.isIE()?Ve(e,t):(n=t,r=e.dom,a=n.dom,r!==a&&r.contains(a));var n,r,a},We=He,Xe=Object.keys,Ke=Object.hasOwnProperty,Ge=function(e,t){for(var n=Xe(e),r=0,a=n.length;a>r;r++){var o=n[r];t(e[o],o)}},Ye=function(e,t){return Je(e,function(e,n){return{k:n,v:t(e,n)}})},Je=function(e,t){var n={};return Ge(e,function(e,r){var a=t(e,r);n[a.k]=a.v}),n},Ze=function(e,t){var n,r,a,o,i={};return n=t,o=i,r=function(e,t){o[t]=e},a=y,Ge(e,function(e,t){(n(e,t)?r:a)(e,t)}),i},Qe=function(e,t){var n=[];return Ge(e,function(e,r){n.push(t(e,r))}),n},et=function(e){return Xe(e).length},tt=function(e,t){return nt(e,t)?S.from(e[t]):S.none()},nt=function(e,t){return Ke.call(e,t)},rt=function(e,t){return nt(e,t)&&void 0!==e[t]&&null!==e[t]},at=["tfoot","thead","tbody","colgroup"],ot=function(e,t,n){return{element:e,rowspan:t,colspan:n}},it=function(e,t,n){return{element:e,cells:t,section:n}},ct=function(e,t,n){return{element:e,isNew:t,isLocked:n}},st=function(e,t){return{cells:e,section:t}},lt=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),ut=function(e){return e.dom.nodeType},ft=function(e){return function(t){return ut(t)===e}},dt=function(e){return 8===ut(e)||"#comment"===lt(e)},mt=ft(1),gt=ft(3),ht=ft(9),pt=ft(11),yt=function(e){return function(t){return mt(t)&&lt(t)===e}},vt=function(e){return Fe.fromDom(e.dom.ownerDocument)},bt=function(e){return ht(e)?e:vt(e)},wt=function(e){return S.from(e.dom.parentNode).map(Fe.fromDom)},kt=function(e,t){for(var n=L(t)?t:k,r=e.dom,a=[];null!==r.parentNode&&void 0!==r.parentNode;){var o=r.parentNode,i=Fe.fromDom(o);if(a.push(i),!0===n(i))break;r=o}return a},_t=function(e){return S.from(e.dom.previousSibling).map(Fe.fromDom)},Ct=function(e){return S.from(e.dom.nextSibling).map(Fe.fromDom)},xt=function(e){return U(e.dom.childNodes,Fe.fromDom)},zt=function(e,t){var n=e.dom.childNodes;return S.from(n[t]).map(Fe.fromDom)},St=L(Element.prototype.attachShadow)&&L(Node.prototype.getRootNode),Tt=v(St),Nt=St?function(e){return Fe.fromDom(e.dom.getRootNode())}:bt,Et=function(e){var t,n=Nt(e);return pt(t=n)&&P(t.dom.host)?S.some(n):S.none()},Dt=function(e){return Fe.fromDom(e.dom.host)},At=function(e){return P(e.dom.shadowRoot)},Ot=function(e){var t=gt(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n,r,a=t.ownerDocument;return Et(Fe.fromDom(t)).fold(function(){return a.body.contains(t)},(n=Ot,r=Dt,function(e){return n(r(e))}))},Rt=function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return Fe.fromDom(t)},Pt=function(e,t){var n=[];return V(xt(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(Pt(e,t))}),n},Lt=function(e,t,n){return r=function(e){return He(e,t)},$(kt(e,n),r);var r},Bt=function(e,t){return n=function(e){return He(e,t)},$(xt(e),n);var n},Mt=function(e,t){return n=t,a=void 0===(r=e)?document:r.dom,qe(a)?[]:U(a.querySelectorAll(n),Fe.fromDom);var n,r,a},jt=function(e,t,n){for(var r=e.dom,a=L(n)?n:k;r.parentNode;){r=r.parentNode;var o=Fe.fromDom(r);if(t(o))return S.some(o);if(a(o))break}return S.none()},It=function(e,t,n){return jt(e,function(e){return He(e,t)},n)},Ft=function(e,t){return n=function(e){return He(e,t)},K(e.dom.childNodes,function(e){return n(Fe.fromDom(e))}).map(Fe.fromDom);var n},Ht=function(e,t){return n=t,a=void 0===(r=e)?document:r.dom,qe(a)?S.none():S.from(a.querySelector(n)).map(Fe.fromDom);var n,r,a},qt=function(e,t,r){return n(He,It,e,t,r)},Ut=function(e,t,n){if(!(E(n)||O(n)||B(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Vt=function(e,t,n){Ut(e.dom,t,n)},$t=function(e,t){var n=e.dom;Ge(t,function(e,t){Ut(n,t,e)})},Wt=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Xt=function(e,t){return S.from(Wt(e,t))},Kt=function(e,t){e.dom.removeAttribute(t)},Gt=function(e){return X(e.dom.attributes,function(e,t){return e[t.name]=t.value,e},{})},Yt=function(e){return void 0!==e.style&&L(e.style.getPropertyValue)},Jt=function(e,t,n){if(!E(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Yt(e)&&e.style.setProperty(t,n)},Zt=function(e,t,n){var r=e.dom;Jt(r,t,n)},Qt=function(e,t){var n=e.dom;Ge(t,function(e,t){Jt(n,t,e)})},en=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Ot(e)?r:tn(n,t)},tn=function(e,t){return Yt(e)?e.style.getPropertyValue(t):""},nn=function(e,t){var n=e.dom,r=tn(n,t);return S.from(r).filter(function(e){return 0<e.length})},rn=function(e,t){var n,r,a=e.dom;r=t,Yt(n=a)&&n.style.removeProperty(r),Xt(e,"style").map(ve).is("")&&Kt(e,"style")},an=function(e,t,n){return void 0===n&&(n=0),Xt(e,t).map(function(e){return parseInt(e,10)}).getOr(n)},on=function(e,t){return an(e,t,1)},cn=function(e){return 1<on(e,"colspan")},sn=function(e){return 1<on(e,"rowspan")},ln=function(e,t){return parseInt(en(e,t),10)},un=v(10),fn=v(10),dn=function(e,t){return mn(e,t,_)},mn=function(e,t,n){return J(xt(e),function(e){return He(e,t)?n(e)?[e]:[]:mn(e,t,n)})},gn=function(e,t){return function(e,t,n){return void 0===n&&(n=k),n(t)?S.none():F(e,lt(t))?S.some(t):It(t,e.join(","),function(e){return He(e,"table")||n(e)})}(["td","th"],e,t)},hn=function(e){return dn(e,"th,td")},pn=function(e){return He(e,"colgroup")?Bt(e,"col"):J(bn(e),function(e){return Bt(e,"col")})},yn=function(e,t){return qt(e,"table",t)},vn=function(e){return dn(e,"tr")},bn=function(e){return yn(e).fold(v([]),function(e){return Bt(e,"colgroup")})},wn=function(e,t){return U(e,function(e){if("colgroup"===lt(e)){var n=U(pn(e),function(e){var t=an(e,"span",1);return ot(e,1,t)});return it(e,n,"colgroup")}return n=U(hn(e),function(e){var t=an(e,"rowspan",1),n=an(e,"colspan",1);return ot(e,t,n)}),it(e,n,t(e))})},kn=function(e){return wt(e).map(function(e){var t=lt(e);return F(at,t)?t:"tbody"}).getOr("tbody")},_n=function(e){var n=vn(e),r=t(bn(e),n);return wn(r,kn)},Cn=function(e,t,n){var r=e.cells,a=r.slice(0,t),o=r.slice(t),i=a.concat(n).concat(o);return Sn(e,i)},xn=function(e,t,n){return Cn(e,t,[n])},zn=function(e,t,n){e.cells[t]=n},Sn=function(e,t){return st(t,e.section)},Tn=function(e,t){var n=e.cells,r=U(n,t);return st(r,e.section)},Nn=function(e,t){return e.cells[t]},En=function(e,t){return Nn(e,t).element},Dn=function(e){return e.cells.length},An=function(e){var t=function(e,t){for(var n=[],r=[],a=0,o=e.length;o>a;a++){var i=e[a];(t(i,a)?n:r).push(i)}return{pass:n,fail:r}}(e,function(e){return"colgroup"===e.section});return{rows:t.fail,cols:t.pass}},On="data-snooker-locked-cols",Rn=function(e){return Xt(e,On).bind(function(e){return S.from(e.match(/\d+/g))}).map(function(e){return Q(e,_)})},Pn=function(e){var t,n,r,a=X(An(e).rows,function(e,t){return V(t.cells,function(t,n){t.isLocked&&(e[n]=!0)}),e},{}),o=Qe(a,function(e,t){return parseInt(t,10)});return t=o,(r=M.call(t,0)).sort(n),r},Ln=function(e,t){return e+","+t},Bn=function(e,t){var n=J(e.all,function(e){return e.cells});return $(n,t)},Mn=function(e){var t={},n=[],r={},a=ne(e).map(function(e){return e.element}).bind(yn).bind(Rn).getOr({}),o=0,i=0,c=0;return V(e,function(e){var s,l,u;"colgroup"===e.section?(l={},u=0,V(e.cells,function(e){var t=e.colspan;q(t,function(n){var r=u+n;l[r]={element:e.element,colspan:t,column:r}}),u+=t}),r=l):(s=[],V(e.cells,function(e){for(var n=0;void 0!==t[Ln(c,n)];)n++;for(var r=rt(a,n.toString()),o={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:c,column:n,isLocked:r},l=0;l<e.colspan;l++)for(var u=0;u<e.rowspan;u++){var f=n+l,d=Ln(c+u,f);t[d]=o,i=Math.max(i,f+1)}s.push(o)}),o++,n.push(it(e.element,s,e.section)),c++)}),{grid:{rows:o,columns:i},access:t,all:n,columns:r}},jn={fromTable:function(e){var t=_n(e);return Mn(t)},generate:Mn,getAt:function(e,t,n){var r=e.access[Ln(t,n)];return void 0!==r?S.some(r):S.none()},findItem:function(e,t,n){var r=Bn(e,function(e){return n(t,e.element)});return 0<r.length?S.some(r[0]):S.none()},filterItems:Bn,justCells:function(e){return J(e.all,function(e){return e.cells})},justColumns:function(e){return t=e.columns,Qe(t,function(e){return e});var t},hasColumns:function(e){return 0<Xe(e.columns).length},getColumnAt:function(e,t){return S.from(e.columns[t])}},In=function(e,t){var n=t.column,r=t.column+t.colspan-1,a=t.row,o=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&a<=e.finishRow&&o>=e.startRow},Fn=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},Hn=function(e,t,n){var r=jn.findItem(e,t,Ue),a=jn.findItem(e,n,Ue);return r.bind(function(e){return a.map(function(t){return n=e,r=t,{startRow:Math.min(n.row,r.row),startCol:Math.min(n.column,r.column),finishRow:Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,r.column+r.colspan-1)};var n,r})})},qn=function(t,n,r){return Hn(t,n,r).bind(function(n){return function(t,n){for(var r=!0,a=e(Fn,n),o=n.startRow;o<=n.finishRow;o++)for(var i=n.startCol;i<=n.finishCol;i++)r=r&&jn.getAt(t,o,i).exists(a);return r?S.some(n):S.none()}(t,n)})},Un=function(t,n,r){return Hn(t,n,r).map(function(n){var r=jn.filterItems(t,e(In,n));return U(r,function(e){return e.element})})},Vn=function(e,t){return jn.findItem(e,t,function(e,t){return $e(t,e)}).map(function(e){return e.element})},$n=function(e,t,n){return yn(e).bind(function(r){var a,o,i,c,s=Xn(r);return a=s,o=e,i=t,c=n,jn.findItem(a,o,Ue).bind(function(e){var t=i>0?e.row+e.rowspan-1:e.row,n=c>0?e.column+e.colspan-1:e.column;return jn.getAt(a,t+i,n+c).map(function(e){return e.element})})})},Wn=function(e,t,n,r,a){var o=Xn(e),i=Ue(e,n)?S.some(t):Vn(o,t),c=Ue(e,a)?S.some(r):Vn(o,r);return i.bind(function(e){return c.bind(function(t){return Un(o,e,t)})})},Xn=jn.fromTable,Kn=function(e,t){wt(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Gn=function(e,t){Ct(e).fold(function(){wt(e).each(function(e){Jn(e,t)})},function(e){Kn(e,t)})},Yn=function(e,t){zt(e,0).fold(function(){Jn(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},Jn=function(e,t){e.dom.appendChild(t.dom)},Zn=function(e,t){Kn(e,t),Jn(t,e)},Qn=function(e,t){V(t,function(n,r){var a=0===r?e:t[r-1];Gn(a,n)})},er=function(e,t){V(t,function(t){Jn(e,t)})},tr=function(e){e.dom.textContent="",V(xt(e),function(e){nr(e)})},nr=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},rr=function(e){var t,n=xt(e);0<n.length&&(t=e,V(n,function(e){Kn(t,e)})),nr(e)},ar=(u=gt,f="text",{get:function(e){if(!u(e))throw new Error("Can only get "+f+" value of a "+f+" node");return d(e).getOr("")},getOption:d=function(e){return u(e)?S.from(e.dom.nodeValue):S.none()},set:function(e,t){if(!u(e))throw new Error("Can only set raw "+f+" value of a "+f+" node");e.dom.nodeValue=t}}),or=function(e){return ar.get(e)},ir=function(e){return ar.getOption(e)},cr=function(e,t){return ar.set(e,t)},sr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lr=function(e,t,n,r){var a=t(e,n);return W(r,function(n,r){var a=t(e,r);return ur(e,n,a)},a)},ur=function(t,n,r){return n.bind(function(n){return r.filter(e(t.eq,n))})},fr=function(e,t,n){return 0<n.length?lr(e,t,(r=n)[0],r.slice(1)):S.none();var r},dr=function(t,n,r,a){void 0===a&&(a=k);var o=[n].concat(t.up().all(n)),i=[r].concat(t.up().all(r)),c=function(e){return G(e,a).fold(function(){return e},function(t){return e.slice(0,t+1)})},s=c(o),l=c(i),u=K(s,function(n){return H(l,(r=n,e(t.eq,r)));var r});return{firstpath:s,secondpath:l,shared:u}},mr=r(),gr=function(e,t){return fr(mr,function(t,n){return e(n)},t)},hr=function(e){return It(e,"table")},pr=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||Ue(t,e)}};return Ue(e,t)?S.some({boxes:S.some([e]),start:e,finish:t}):hr(e).bind(function(a){return hr(t).bind(function(o){if(Ue(a,o))return S.some({boxes:(u=e,f=t,d=Xn(a),Un(d,u,f)),start:e,finish:t});if($e(a,o)){var i=0<(c=Lt(t,"td,th",r(a))).length?c[c.length-1]:t;return S.some({boxes:Wn(a,e,a,t,o),start:e,finish:i})}if($e(o,a)){var c,s=0<(c=Lt(e,"td,th",r(o))).length?c[c.length-1]:e;return S.some({boxes:Wn(o,e,a,t,o),start:e,finish:s})}return dr(mr,e,t,l).shared.bind(function(i){return qt(i,"table",n).bind(function(n){var i=Lt(t,"td,th",r(n)),c=0<i.length?i[i.length-1]:t,s=Lt(e,"td,th",r(n)),l=0<s.length?s[s.length-1]:e;return S.some({boxes:Wn(n,e,a,t,o),start:l,finish:c})})});var l,u,f,d})})},yr=function(e,t){var n=Mt(e,t);return 0<n.length?S.some(n):S.none()},vr=function(e,t,n){return Ht(e,t).bind(function(t){return Ht(e,n).bind(function(e){return gr(hr,[t,e]).map(function(n){return{first:t,last:e,table:n}})})})},br=function(e,t,n,r,a){return o=a,K(e,function(e){return He(e,o)}).bind(function(e){return $n(e,t,n).bind(function(e){return n=r,It(t=e,"table").bind(function(e){return Ht(e,n).bind(function(e){return pr(e,t).bind(function(e){return e.boxes.map(function(t){return{boxes:t,start:e.start,finish:e.finish}})})})});var t,n})});var o},wr=yr,kr=function(e,t,n){return vr(e,t,n).bind(function(t){var n=function(t){return Ue(e,t)},r="thead,tfoot,tbody,table",a=It(t.first,r,n),o=It(t.last,r,n);return a.bind(function(e){return o.bind(function(n){return Ue(e,n)?(r=t.table,a=t.first,o=t.last,i=Xn(r),qn(i,a,o)):S.none();var r,a,o,i})})})},_r=function(e){if(!A(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return V(e,function(r,a){var o=Xe(r);if(1!==o.length)throw new Error("one and only one name per case");var i=o[0],c=r[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!A(c))throw new Error("case arguments must be an array");t.push(i),n[i]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+o);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[a].apply(null,n)},match:function(e){var r=Xe(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!Z(t,function(e){return F(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},Cr=_r([{none:[]},{multiple:["elements"]},{single:["element"]}]),xr=function(e,t,n,r){return e.fold(t,n,r)},zr=Cr.none,Sr=Cr.multiple,Tr=Cr.single,Nr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Er=function(e,t){return Fe.fromDom(e.dom.cloneNode(t))},Dr=function(e){return Er(e,!1)},Ar=function(e){return Er(e,!0)},Or=function(e,t){var n,r,a,o,i=(n=e,r=t,a=Fe.fromTag(r),o=Gt(n),$t(a,o),a),c=xt(Ar(e));return er(i,c),i},Rr=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Pr=function(e,t){return e?S.some(t):S.none()},Lr=function(e,t){var n=function(n){var r=t(n);if(0>=r||null===r){var a=en(n,e);return parseFloat(a)||0}return r},r=function(e,t){return X(t,function(t,n){var r=en(e,n),a=void 0===r?0:parseInt(r,10);return isNaN(a)?t:t+a},0)};return{set:function(t,n){if(!B(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Yt(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var a=r(e,n);return t>a?t-a:0}}},Br=Lr("width",function(e){return e.dom.offsetWidth}),Mr=function(e){return Br.get(e)},jr=function(e){return Br.getOuter(e)},Ir=function(e,t){void 0===t&&(t=_);var n=e.grid,r=q(n.columns,b),a=q(n.rows,b);return U(r,function(n){return Fr(function(){return J(a,function(t){return jn.getAt(e,t,n).filter(function(e){return e.column===n}).toArray()})},function(e){return 1===e.colspan&&t(e.element)},function(){return jn.getAt(e,0,n)})})},Fr=function(e,t,n){var r=e();return K(r,t).orThunk(function(){return S.from(r[0]).orThunk(n)}).map(function(e){return e.element})},Hr=function(e){var t=e.grid,n=q(t.rows,b),r=q(t.columns,b);return U(n,function(t){return Fr(function(){return J(r,function(n){return jn.getAt(e,t,n).filter(function(e){return e.row===t}).fold(v([]),function(e){return[e]})})},function(e){return 1===e.rowspan},function(){return jn.getAt(e,t,0)})})},qr=function(e,t){if(0>t||t>=e.length-1)return S.none();var n=e[t].fold(function(){var n,r,a=(n=e.slice(0,t),(r=M.call(n,0)).reverse(),r);return ae(a,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return S.some({value:e,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return ae(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return S.some({value:e,delta:1})});return n.bind(function(e){return r.map(function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n})})},Ur=function(e,t){return function(n){return"rtl"===Vr(n)?t:e}},Vr=function(e){return"rtl"===en(e,"direction")?"rtl":"ltr"},$r=Lr("height",function(e){var t=e.dom;return Ot(e)?t.getBoundingClientRect().height:t.offsetHeight}),Wr=function(e){return $r.get(e)},Xr=function(e){return $r.getOuter(e)},Kr=function(e,t){return{left:e,top:t,translate:function(n,r){return Kr(e+n,t+r)}}},Gr=Kr,Yr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Jr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,a=t.documentElement;if(n===e.dom)return Gr(n.offsetLeft,n.offsetTop);var o=Yr(null==r?void 0:r.pageYOffset,a.scrollTop),i=Yr(null==r?void 0:r.pageXOffset,a.scrollLeft),c=Yr(a.clientTop,n.clientTop),s=Yr(a.clientLeft,n.clientLeft);return Zr(e).translate(i-s,o-c)},Zr=function(e){var t,n=e.dom,r=n.ownerDocument.body;return r===n?Gr(r.offsetLeft,r.offsetTop):Ot(e)?(t=n.getBoundingClientRect(),Gr(t.left,t.top)):Gr(0,0)},Qr=function(e,t){return{row:e,y:t}},ea=function(e,t){return{col:e,x:t}},ta=function(e){return Jr(e).left+jr(e)},na=function(e){return Jr(e).left},ra=function(e,t){return ea(e,na(t))},aa=function(e,t){return ea(e,ta(t))},oa=function(e){return Jr(e).top},ia=function(e,t){return Qr(e,oa(t))},ca=function(e,t){return Qr(e,oa(t)+Xr(t))},sa=function(e,t,n){if(0===n.length)return[];var r=U(n.slice(1),function(t,n){return t.map(function(t){return e(n,t)})}),a=n[n.length-1].map(function(e){return t(n.length-1,e)});return r.concat([a])},la={delta:b,positions:function(e){return sa(ia,ca,e)},edge:oa},ua=Ur({delta:b,edge:na,positions:function(e){return sa(ra,aa,e)}},{delta:function(e){return-e},edge:ta,positions:function(e){return sa(aa,ra,e)}}),fa={delta:function(e,t){return ua(t).delta(e,t)},positions:function(e,t){return ua(t).positions(e,t)},edge:function(e){return ua(e).edge(e)}},da={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ma=(g="[eE][+-]?[0-9]+",p=["Infinity",(m="[0-9]+")+"\\."+(h=function(e){return"(?:"+e+")?"})(m)+h(g),"\\."+m+h(g),m+h(g)].join("|"),new RegExp("^([+-]?(?:"+p+"))(.*)$")),ga=function(e,t){return S.from(ma.exec(e)).bind(function(e){var n,r=Number(e[1]),a=e[2];return n=a,H(t,function(e){return H(da[e],function(e){return n===e})})?S.some({value:r,unit:a}):S.none()})},ha=function(){var e=je().browser;return e.isIE()||e.isEdge()},pa=function(e,t,n){return r=en(e,t),a=n,o=parseFloat(r),isNaN(o)?a:o;var r,a,o},ya=function(e){return ha()?(n=(t=e).dom.getBoundingClientRect().height,
"border-box"===en(t,"box-sizing")?n:n-pa(t,"padding-top",0)-pa(t,"padding-bottom",0)-(pa(t,"border-top-width",0)+pa(t,"border-bottom-width",0))):pa(e,"height",Wr(e));var t,n},va=function(e){return ha()?(n=(t=e).dom.getBoundingClientRect().width,"border-box"===en(t,"box-sizing")?n:n-pa(t,"padding-left",0)-pa(t,"padding-right",0)-(pa(t,"border-left-width",0)+pa(t,"border-right-width",0))):pa(e,"width",Mr(e));var t,n},ba=/(\d+(\.\d+)?)%/,wa=/(\d+(\.\d+)?)px|em/,ka=function(e,t){var n,r=(n=e,S.from(n.dom.offsetParent).map(Fe.fromDom).getOr(Rt(vt(e))));return t(e)/t(r)*100},_a=function(e,t){Zt(e,"width",t+"px")},Ca=function(e,t){Zt(e,"width",t+"%")},xa=function(e,t){Zt(e,"height",t+"px")},za=function(e,t,n,r){var a,o,i,c,s,l=parseInt(e,10);return ye(e,"%")&&"table"!==lt(t)?(o=l,i=n,c=r,s=yn(a=t).map(function(e){var t=i(e);return Math.floor(o/100*t)}).getOr(o),c(a,s),s):l},Sa=function(e){var t,n=nn(t=e,"height").getOrThunk(function(){return ya(t)+"px"});return n?za(n,e,Wr,xa):Wr(e)},Ta=function(e){return nn(e,"width").fold(function(){return S.from(Wt(e,"width"))},function(e){return S.some(e)})},Na=function(e,t){return e/t.pixelWidth()*100},Ea=function(e,t){return Ta(e).fold(function(){var n=Mr(e);return Na(n,t)},function(n){return function(e,t,n){var r=ba.exec(t);if(null!==r)return parseFloat(r[1]);var a=va(e);return Na(a,n)}(e,n,t)})},Da=function(e,t){return Ta(e).fold(function(){return va(e)},function(n){return function(e,t,n){var r=wa.exec(t);if(null!==r)return parseInt(r[1],10);var a=ba.exec(t);if(null===a)return va(e);var o=parseFloat(a[1]);return o/100*n.pixelWidth()}(e,n,t)})},Aa=function(e){return n="rowspan",Sa(t=e)/on(t,n);var t,n},Oa=function(e,t,n){Zt(e,"width",t+n)},Ra=function(e){return ka(e,Mr)+"%"},Pa=v(ba),La=v(wa),Ba=yt("col"),Ma=function(e,t,n){return nn(e,t).fold(function(){return n(e)+"px"},function(e){return e})},ja=function(e,t){return Ma(e,"width",function(e){return Ba(e)?Mr(e):Da(e,t)})},Ia=function(e){return Ma(e,"height",Aa)},Fa=function(e,t){return nn(e,t).isSome()},Ha=function(e,t,n,r,a,o){return e.filter(r).fold(function(){return o(qr(n,t))},function(e){return a(e)})},qa=function(e,t,n,r,a){var o,i=Ir(e,function(e){return Fa(e,"width")}),c=jn.hasColumns(e)?(o=e,U(jn.justColumns(o),function(e){return S.from(e.element)})):i,s=[S.some(fa.edge(t))].concat(U(fa.positions(i,t),function(e){return e.map(function(e){return e.x})})),l=w(cn);return U(c,function(e,t){return Ha(e,t,s,l,function(e){if(!Ba(u=e)||Fa(u,"width"))return n(e,a);var o,c,u,f=(o=i[t],c=b,void 0!==o&&null!==o?c(o):S.none());return Ha(f,t,s,l,function(e){return r(S.some(Mr(e)))},r)},r)})},Ua=function(e){return e.map(function(e){return e+"px"}).getOr("")},Va=function(e,t,n){return qa(e,t,Da,function(e){return e.getOrThunk(n.minCellWidth)},n)},$a=function(e,t,n,r,a){var o=Hr(e),i=[S.some(n.edge(t))].concat(U(n.positions(o,t),function(e){return e.map(function(e){return e.y})}));return U(o,function(e,t){return Ha(e,t,i,w(sn),r,a)})},Wa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Xa=function(e){var t=function(){return Mr(e)},n=v(0);return{width:t,pixelWidth:t,getWidths:function(t,n){return Va(t,e,n)},getCellDelta:n,singleColumnWidth:v([0]),minCellWidth:n,setElementWidth:y,adjustTableWidth:y,isRelative:!0,label:"none"}},Ka=function(e,t){var n=Wa(parseFloat(e)),r=Wa(Mr(t));return{width:n.get,pixelWidth:r.get,getWidths:function(e,n){return qa(e,t,Ea,function(e){return e.fold(function(){return r.minCellWidth()},function(e){return e/r.pixelWidth()*100})},r=n);var r},getCellDelta:function(e){return e/r.get()*100},singleColumnWidth:function(e){return[100-e]},minCellWidth:function(){return un()/r.get()*100},setElementWidth:Ca,adjustTableWidth:function(e){var a=n.get(),o=a+e/100*a;Ca(t,o),n.set(o),r.set(Mr(t))},isRelative:!0,label:"percent"}},Ga=function(e,t){var n=Wa(e),r=n.get;return{width:r,pixelWidth:r,getWidths:function(e,n){return Va(e,t,n)},getCellDelta:b,singleColumnWidth:function(e,t){return[Math.max(un(),e+t)-e]},minCellWidth:un,setElementWidth:_a,adjustTableWidth:function(e){var a=r()+e;_a(t,a),n.set(a)},isRelative:!1,label:"pixel"}},Ya=function(e){return Ta(e).fold(function(){return Xa(e)},function(t){return function(e,t){var n=Pa().exec(t);if(null!==n)return Ka(n[1],e);var r=La().exec(t);if(null!==r){var a=parseInt(r[1],10);return Ga(a,e)}var o=Mr(e);return Ga(o,e)}(e,t)})},Ja=Ga,Za=Ka,Qa=function(e,t,n,r){for(var a,o,i,c=t.grid.columns,s=t.grid.rows,l=0;s>l;l++)for(var u=!1,f=0;c>f;f++)l<n.minRow||l>n.maxRow||f<n.minCol||f>n.maxCol||(jn.getAt(t,l,f).filter(r).isNone()?(a=u,o=e[l].element,i=Fe.fromTag("td"),Jn(i,Fe.fromTag("br")),(a?Jn:Yn)(o,i)):u=!0)},eo=function(e,t){var n,r,a,o,i,c,s,l,u,f=function(e){return He(e.element,t)},d=Ar(e),m=_n(d),g=Ya(e),h=jn.generate(m),p=(r=f,a=(n=h).grid.columns,o=n.grid.rows,i=a,s=c=0,l=[],u=[],Ge(n.access,function(e){var t,n,a,f;l.push(e),r(e)&&(u.push(e),n=(t=e.row)+e.rowspan-1,f=(a=e.column)+e.colspan-1,o>t?o=t:n>c&&(c=n),i>a?i=a:f>s&&(s=f))}),{minRow:o,minCol:i,maxRow:c,maxCol:s,allCells:l,selectedCells:u}),y="th:not("+t+"),td:not("+t+")",v=mn(d,"th,td",function(e){return He(e,y)});return V(v,nr),Qa(m,h,p,f),function(e,t,n,r){Ge(n.columns,function(e){(e.column<t.minCol||e.column>t.maxCol)&&nr(e.element)});var a=$(dn(e,"tr"),function(e){return 0===e.dom.childElementCount});V(a,nr),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||V(dn(e,"th,td"),function(e){Kt(e,"rowspan"),Kt(e,"colspan")}),Kt(e,On),Kt(e,"data-snooker-col-series"),Ya(e).adjustTableWidth(r)}(d,p,h,function(e,t,n,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var a=Va(t,e,n),o=X(a,function(e,t){return e+t},0),i=X(a.slice(r.minCol,r.maxCol+1),function(e,t){return e+t},0)/o*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(i)}(e,jn.fromTable(e),g,p)),d},to=function(e){return"img"===lt(e)?1:ir(e).fold(function(){return xt(e).length},function(e){return e.length})},no=["img","br"],ro=function(e){return ir(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf("\xa0")}).isSome()||F(no,lt(e))},ao=function(e){return t=ro,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var a=Fe.fromDom(e.childNodes[r]);if(t(a))return S.some(a);var o=n(e.childNodes[r]);if(o.isSome())return o}return S.none()})(e.dom);var t,n},oo=function(e){return io(e,ro)},io=function(e,t){var n=function(e){for(var r=xt(e),a=r.length-1;a>=0;a--){var o=r[a];if(t(o))return S.some(o);var i=n(o);if(i.isSome())return i}return S.none()};return n(e)},co={scope:["row","col"]},so=function(){var e=Fe.fromTag("td");return Jn(e,Fe.fromTag("br")),e},lo=function(){return Fe.fromTag("col")},uo=function(){return Fe.fromTag("colgroup")},fo=function(e,t,n){var r=Or(e,t);return Ge(n,function(e,t){null===e?Kt(r,t):Vt(r,t,e)}),r},mo=function(e){return e},go=function(e){return function(){return Fe.fromTag("tr",e.dom)}},ho=function(e,t,n){var r=function(e,t){var n,r,a,o;n=e.element,r=t,a=n.dom,o=r.dom,Yt(a)&&Yt(o)&&(o.style.cssText=a.style.cssText),rn(t,"height"),1!==e.colspan&&rn(t,"width")};return{col:function(t){var n=vt(t.element),a=Fe.fromTag(lt(t.element),n.dom);return r(t,a),e(t.element,a),a},colgroup:uo,row:go(t),cell:function(t){var a,o,i,c,s,l=vt(t.element),u=Fe.fromTag(lt(t.element),l.dom),f=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<f.length?(a=t.element,o=u,i=f,ao(a).map(function(e){var t=i.join(","),n=Lt(e,t,function(e){return Ue(e,a)});return W(n,function(e,t){var n=Dr(t);return Kt(n,"contenteditable"),Jn(e,n),n},o)}).getOr(o)):u;return Jn(d,Fe.fromTag("br")),r(t,u),c=t.element,s=u,Ge(co,function(e,t){return Xt(c,t).filter(function(t){return F(e,t)}).each(function(e){return Vt(s,t,e)})}),e(t.element,u),u},replace:fo,gap:so}},po=function(e){return{col:lo,colgroup:uo,row:go(e),cell:so,replace:mo,gap:so}},yo=function(e){return U(e,Fe.fromDom)},vo=function(e){return e.nodeName.toLowerCase()},bo=function(e){return Fe.fromDom(e.getBody())},wo=function(e){return e.getBoundingClientRect().width},ko=function(e){return e.getBoundingClientRect().height},_o=function(e){return function(t){return Ue(t,bo(e))}},Co=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},xo=function(e){Kt(e,"data-mce-style");var t=function(e){return Kt(e,"data-mce-style")};V(hn(e),t),V(pn(e),t)},zo=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return S.from(n).filter(be)},So=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},To=function(e){return Fe.fromDom(e.selection.getStart())},No=function(e){return xr(e.get(),v([]),b,ee)},Eo="data-mce-selected",Do="data-mce-first-selected",Ao="data-mce-last-selected",Oo={selected:Eo,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:Do,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:Ao,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ro=function(e){return{element:e,mergable:S.none(),unmergable:S.none(),selection:[e]}},Po=function(e,t,n){return{element:n,mergable:(o=t,i=Oo,xr(e.get(),S.none,function(e){return e.length<=1?S.none():kr(o,i.firstSelectedSelector,i.lastSelectedSelector).map(function(t){return{bounds:t,cells:e}})},S.none)),unmergable:(r=function(e,t){return Xt(e,t).exists(function(e){return 1<parseInt(e,10)})},0<(a=No(e)).length&&Z(a,function(e){return r(e,"rowspan")||r(e,"colspan")})?S.some(a):S.none()),selection:No(e)};var r,a,o,i},Lo=function(e,t,n,r){e.on("BeforeGetContent",function(n){!0===n.selection&&xr(t.get(),y,function(t){n.preventDefault(),yn(t[0]).map(function(e){var t=eo(e,"[data-mce-selected]");return xo(t),[t]}).each(function(t){var r;n.content="text"===n.format?U(t,function(e){return e.dom.innerText}).join(""):(r=e,U(t,function(e){return r.selection.serializer.serialize(e.dom,{})}).join(""))})},y)}),e.on("BeforeSetContent",function(t){!0===t.selection&&!0===t.paste&&S.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(a){var o=Fe.fromDom(a);yn(o).each(function(a){var i,c,s,l,u,f,d,m=$((i=t.content,(s=(c||document).createElement("div")).innerHTML=i,xt(Fe.fromDom(s))),function(e){return"meta"!==lt(e)});1===m.length&&(d=m[0],"table"===lt(d))&&(t.preventDefault(),l=Fe.fromDom(e.getDoc()),u=po(l),f={element:o,clipboard:m[0],generators:u},n.pasteCells(a,f).each(function(t){e.selection.setRng(t.rng),e.focus(),r.clear(a)}))})})})},Bo=_r([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Mo=oe({},Bo),jo=function(e,t,n,r,a){var o,i,c=e.slice(0),s=(i=t,0===(o=e).length?Mo.none():1===o.length?Mo.only(0):0===i?Mo.left(0,1):i===o.length-1?Mo.right(i-1,i):i>0&&i<o.length-1?Mo.middle(i-1,i,i+1):Mo.none()),l=v(U(c,v(0)));return s.fold(l,function(e){return r.singleColumnWidth(c[e],n)},function(e,t){return a.calcLeftEdgeDeltas(c,e,t,n,r.minCellWidth(),r.isRelative)},function(e,t,o){return a.calcMiddleDeltas(c,e,t,o,n,r.minCellWidth(),r.isRelative)},function(e,t){return a.calcRightEdgeDeltas(c,e,t,n,r.minCellWidth(),r.isRelative)})},Io=function(e,t,n){for(var r=0,a=e;t>a;a++)r+=void 0!==n[a]?n[a]:0;return r},Fo=function(e,t){return jn.hasColumns(e)?(o=e,i=t,c=jn.justColumns(o),U(c,function(e,t){return{element:e.element,width:i[t],colspan:e.colspan}})):(n=e,r=t,a=jn.justCells(n),U(a,function(e){var t=Io(e.column,e.column+e.colspan,r);return{element:e.element,width:t,colspan:e.colspan}}));var n,r,a,o,i,c},Ho=function(e,t,n){var r=Fo(e,t);V(r,function(e){n.setElementWidth(e.element,e.width)})},qo=function(e,t,n,r,a){var o=jn.fromTable(e),i=a.getCellDelta(t),c=a.getWidths(o,a),s=n===o.grid.columns-1,l=r.clampTableDelta(c,n,i,a.minCellWidth(),s),u=jo(c,n,l,a,r),f=U(u,function(e,t){return e+c[t]});Ho(o,f,a),r.resizeTable(a.adjustTableWidth,l,s)},Uo=function(e,t,n,r){var a,o,i,c,s=jn.fromTable(e),l=$a(s,e,r,Aa,function(e){return e.getOrThunk(fn)}),u=U(l,function(e,r){return n===r?Math.max(t+e,fn()):e}),f=(a=s,o=u,i=jn.justCells(a),U(i,function(e){var t=Io(e.row,e.row+e.rowspan,o);return{element:e.element,height:t,rowspan:e.rowspan}})),d=(c=u,U(s.all,function(e,t){return{element:e.element,height:c[t]}}));V(d,function(e){xa(e.element,e.height)}),V(f,function(e){xa(e.element,e.height)});var m=W(u,function(e,t){return e+t},0);xa(e,m)},Vo=function(e){return U(e,v(0))},$o=function(e,t,n,r,a){return a(e.slice(0,t)).concat(r).concat(a(e.slice(n)))},Wo=function(e){return function(t,n,r,a){if(e(r)){var o=Math.max(a,t[n]-Math.abs(r)),i=Math.abs(o-t[n]);return r>=0?i:-i}return r}},Xo=Wo(function(e){return 0>e}),Ko=Wo(_),Go=function(){var e=function(e,t,n,r){var a=(100+n)/100,o=Math.max(r,(e[t]+n)/a);return U(e,function(e,n){return(n===t?o:e/a)-e})},t=function(t,n,r,a,o,i){return i?e(t,n,a,o):(l=r,u=Xo(c=t,s=n,a,o),$o(c,s,l+1,[u,0],Vo));var c,s,l,u};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Xo,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,a,o,i,c){return t(e,r,a,o,i,c)},calcRightEdgeDeltas:function(t,n,r,a,o,i){if(i)return e(t,r,a,o);var c=Xo(t,r,a,o);return Vo(t.slice(0,r)).concat([c])},calcRedestributedWidths:function(e,t,n,r){if(r){var a=(t+n)/t,o=U(e,function(e){return e/a});return{delta:100*a-100,newSizes:o}}return{delta:n,newSizes:e}}}},Yo=function(){var e=function(e,t,n,r,a){var o=Ko(e,r>=0?n:t,r,a);return $o(e,t,n+1,[o,-o],Vo)};return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,a){if(a){if(n>=0)return n;var o=X(e,function(e,t){return e+t-r},0);return Math.max(-o,n)}return Xo(e,t,n,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,a,o,i){return e(t,r,a,o,i)},calcRightEdgeDeltas:function(e,t,n,r,a,o){if(o)return Vo(e);var i=r/e.length;return U(e,v(i))},calcRedestributedWidths:function(e){return{delta:0,newSizes:e}}}},Jo=function(e,t){var n=S.from(e.dom.documentElement).map(Fe.fromDom).getOr(e);return{parent:v(n),view:v(e),origin:v(Gr(0,0)),isResizable:t}},Zo=function(e,t,n){return{parent:v(t),view:v(e),origin:v(Gr(0,0)),isResizable:n}},Qo=_r([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),ei=function(e,t,n){var r=n.substring(0,n.length-e.length),a=parseFloat(r);return r===a.toString()?t(a):Qo.invalid(n)},ti=oe(oe({},Qo),{from:function(e){return ye(e,"%")?ei("%",Qo.percent,e):ye(e,"px")?ei("px",Qo.pixels,e):Qo.invalid(e)}}),ni=function(e,t,n){return e.fold(function(){return t},function(e){return a=(r=e)/n,U(t,function(e){return ti.from(e).fold(function(){return e},function(e){return e*a+"px"},function(e){return e/100*r+"px"})});var r,a},function(){return e=n,U(t,function(t){return ti.from(t).fold(function(){return t},function(t){return t/e*100+"%"},function(e){return e+"%"})});var e})},ri=function(e,t,n){var r,a,o,i=ti.from(n),c=Z(e,function(e){return"0px"===e})?(r=i,a=e.length,o=r.fold(function(){return v("")},function(e){return v(e/a+"px")},function(){return v(100/a+"%")}),q(a,o)):ni(i,e,t);return oi(c)},ai=function(e,t){return 0===e.length?t:W(e,function(e,t){return ti.from(t).fold(v(0),b,b)+e},0)},oi=function(e){if(0===e.length)return e;var t,n,r=W(e,function(e,t){var n=ti.from(t).fold(function(){return{value:t,remainder:0}},function(e){return t=e,n="px",{value:(r=Math.floor(t))+n,remainder:t-r};var t,n,r},function(e){return{value:e+"%",remainder:0}});return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}},{output:[],remainder:0}),a=r.output;return a.slice(0,a.length-1).concat([(t=a[a.length-1],n=Math.round(r.remainder),ti.from(t).fold(v(t),function(e){return e+n+"px"},function(e){return e+n+"%"}))])},ii=ti.from,ci=function(e){return ii(e).fold(v("px"),v("px"),v("%"))},si=function(e,t,n,r){var a=jn.fromTable(e),o=a.all,i=jn.justCells(a),c=jn.justColumns(a);t.each(function(t){var n,o,s,l,u=ci(t),f=Mr(e),d=qa(a,e,ja,Ua,r),m=ri(d,f,t);jn.hasColumns(a)?(s=m,l=u,V(c,function(e,t){var n=ai([s[t]],un());Zt(e.element,"width",n+l)})):(n=m,o=u,V(i,function(e){var t=n.slice(e.column,e.colspan+e.column),r=ai(t,un());Zt(e.element,"width",r+o)})),Zt(e,"width",t)}),n.each(function(t){var n,r,c,s=ci(t),l=Wr(e),u=$a(a,e,la,Ia,Ua),f=ri(u,l,t);n=f,r=o,c=s,V(i,function(e){var t=n.slice(e.row,e.rowspan+e.row),r=ai(t,fn());Zt(e.element,"height",r+c)}),V(r,function(e,t){Zt(e.element,"height",n[t])}),Zt(e,"height",t)})},li=function(e){return Ta(e).exists(function(e){return ba.test(e)})},ui=function(e){return Ta(e).exists(function(e){return wa.test(e)})},fi=function(e){return Ta(e).isNone()},di=Ra,mi=function(e){return jn.fromTable(e).grid},gi=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=$(t,function(t){return t!==e})},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a={};V(e,function(e,t){a[e]=n[t]}),V(t,function(e){e(a)})}}},hi=function(e){return{registry:Ye(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:Ye(e,function(e){return e.trigger})}},pi=function(e){return e.slice(0).sort()},yi=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(e,t){if(!A(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");V(t,function(t){if(!E(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})}("required",t),r=pi(t),K(r,function(e,t){return t<r.length-1&&e===r[t+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")}),function(r){var a=Xe(r);Z(t,function(e){return F(a,e)})||function(e,t){throw new Error("All required keys ("+pi(e).join(", ")+") were not specified. Specified keys were: "+pi(t).join(", ")+".")}(t,a),e(t,a);var o=$(t,function(e){return!n.validate(r[e],e)});return 0<o.length&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+pi(e).join(", ")+") were not.")}(o,n.label),r}},vi=function(e,t){var n=$(t,function(t){return!F(e,t)});0<n.length&&function(e){throw new Error("Unsupported keys for object: "+pi(e).join(", "))}(n)},bi=function(e){return yi(vi,e,{validate:L,label:"function"})},wi=bi(["compare","extract","mutate","sink"]),ki=bi(["element","start","stop","destroy"]),_i=bi(["forceDrop","drop","move","delayDrop"]),Ci=function(){var e=S.none(),t=hi({move:gi(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){var a,o,i;(a=r,o=n,i=e.map(function(e){return a.compare(e,o)}),e=S.some(o),i).each(function(e){t.trigger.move(e)})})},reset:function(){e=S.none()},events:t.registry}},xi=function(){var e,t=(e=hi({move:gi(["info"])}),{onEvent:y,reset:y,events:e.registry}),n=Ci(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}},zi=function(e,t,n){var r,a,o,i=!1,c=hi({start:gi([]),stop:gi([])}),s=xi(),l=function(){d.stop(),s.isOn()&&(s.off(),c.trigger.stop())},u=(r=l,a=200,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==o&&clearTimeout(o),o=setTimeout(function(){r.apply(null,e),o=null},a)}});s.events.move.bind(function(n){t.mutate(e,n.info)});var f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i&&e.apply(null,t)}},d=t.sink(_i({forceDrop:l,drop:f(l),move:f(function(e){u.cancel(),s.onEvent(e,t)}),delayDrop:f(u.throttle)}),n);return{element:d.element,go:function(e){d.start(e),s.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}},Si=function(e){var t,n,r=Fe.fromDom(function(e){if(Tt()&&P(e.target)){var t=Fe.fromDom(e.target);if(mt(t)&&At(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ne(n)}}return S.from(e.target)}(e).getOr(e.target)),a=function(){return e.stopPropagation()},o=function(){return e.preventDefault()},i=(t=o,n=a,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return{target:r,x:e.clientX,y:e.clientY,stop:a,prevent:o,kill:i,raw:e}},Ti=function(t,n,r,a,o){var i,c,s=(i=r,c=a,function(e){i(e)&&c(Si(e))});return t.dom.addEventListener(n,s,o),{unbind:e(Ni,t,n,s,o)}},Ni=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Ei=_,Di=function(e,t,n){return Ti(e,t,Ei,n,!1)},Ai=Si,Oi=function(e,t){var n=Wt(e,t);return void 0===n||""===n?[]:n.split(" ")},Ri=function(e){return void 0!==e.dom.classList},Pi=function(e,t){return a=t,o=Oi(n=e,r="class").concat([a]),Vt(n,r,o.join(" ")),!0;var n,r,a,o},Li=function(e,t){Ri(e)?e.dom.classList.add(t):Pi(e,t)},Bi=function(e,t){return Ri(e)&&e.dom.classList.contains(t)},Mi=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},ji=Mi("ephox-dragster").resolve,Ii=wi({compare:function(e,t){return Gr(t.left-e.left,t.top-e.top)},extract:function(e){return S.some(Gr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=oe({layerClass:ji("blocker")},e),n=Fe.fromTag("div");return Vt(n,"role","presentation"),Qt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Li(n,ji("blocker")),Li(n,t.layerClass),{element:function(){return n},destroy:function(){nr(n)}}}(t),r=Di(n.element(),"mousedown",e.forceDrop),a=Di(n.element(),"mouseup",e.drop),o=Di(n.element(),"mousemove",e.move),i=Di(n.element(),"mouseout",e.delayDrop);return ki({element:n.element,start:function(e){Jn(e,n.element())},stop:function(){nr(n.element())},destroy:function(){n.destroy(),a.unbind(),o.unbind(),i.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),Fi=function(e){return"true"===Wt(e,"contenteditable")},Hi=Mi("ephox-snooker").resolve,qi=function(){var e,t=hi({drag:gi(["xDelta","yDelta","target"])}),n=S.none(),r={mutate:function(t,n){e.trigger.drag(t,n)},events:(e=hi({drag:gi(["xDelta","yDelta"])})).registry};return r.events.drag.bind(function(e){n.each(function(n){t.trigger.drag(e.xDelta,e.yDelta,n)})}),{assign:function(e){n=S.some(e)},get:function(){return n},mutate:r.mutate,events:t.registry}},Ui=Hi("resizer-bar"),Vi=Hi("resizer-rows"),$i=Hi("resizer-cols"),Wi=function(e){var t=Mt(e.parent(),"."+Ui);V(t,nr)},Xi=function(e,t,n){var r=e.origin();V(t,function(t){t.each(function(t){var a=n(r,t);Li(a,Ui),Jn(e.parent(),a)})})},Ki=function(e,t,n,r){Xi(e,t,function(e,t){var a,o,i,c,s,l,u=(a=t.col,o=t.x-e.left,i=n.top-e.top,c=7,s=r,l=Fe.fromTag("div"),Qt(l,{position:"absolute",left:o-c/2+"px",top:i+"px",height:s+"px",width:c+"px"}),$t(l,{"data-column":a,role:"presentation"}),l);return Li(u,$i),u})},Gi=function(e,t,n,r){Xi(e,t,function(e,t){var a,o,i,c,s,l,u=(a=t.row,o=n.left-e.left,i=t.y-e.top,c=r,s=7,l=Fe.fromTag("div"),Qt(l,{position:"absolute",left:o+"px",top:i-s/2+"px",height:s+"px",width:c+"px"}),$t(l,{"data-row":a,role:"presentation"}),l);return Li(u,Vi),u})},Yi=function(e,t,n,r,a){var o,i=Jr(n),c=t.isResizable,s=0<r.length?la.positions(r,n):[],l=0<s.length?(o=c,J(e.all,function(e,t){return o(e.element)?[t]:[]})):[],u=$(s,function(e,t){return H(l,function(e){return t===e})});Gi(t,u,i,jr(n));var f,d,m,g=0<a.length?fa.positions(a,n):[],h=0<g.length?(d=c,m=[],q((f=e).grid.columns,function(e){jn.getColumnAt(f,e).map(function(e){return e.element}).forall(d)&&m.push(e)}),$(m,function(e){var t=jn.filterItems(f,function(t){return t.column===e});return Z(t,function(e){return d(e.element)})})):[],p=$(g,function(e,t){return H(h,function(e){return t===e})});Ki(t,p,i,Xr(n))},Ji=function(e,t){var n,r,a;Wi(e),e.isResizable(t)&&(n=jn.fromTable(t),r=Hr(n),a=Ir(n),Yi(n,e,t,r,a))},Zi=function(e,t){var n=Mt(e.parent(),"."+Ui);V(n,t)},Qi=function(e){Zi(e,function(e){Zt(e,"display","none")})},ec=function(e){Zi(e,function(e){Zt(e,"display","block")})},tc=Hi("resizer-bar-dragging"),nc=function(t){var n=qi(),r=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:Ii;return zi(e,n,t)}(n,{}),a=S.none(),o=function(e,t){return S.from(Wt(e,t))};n.events.drag.bind(function(e){o(e.target,"data-row").each(function(){var t=ln(e.target,"top");Zt(e.target,"top",t+e.yDelta+"px")}),o(e.target,"data-column").each(function(){var t=ln(e.target,"left");Zt(e.target,"left",t+e.xDelta+"px")})});var i=function(e,t){return ln(e,t)-an(e,"data-initial-"+t,0)};r.events.stop.bind(function(){n.get().each(function(e){a.each(function(n){o(e,"data-row").each(function(t){var r=i(e,"top");Kt(e,"data-initial-top"),d.trigger.adjustHeight(n,r,parseInt(t,10))}),o(e,"data-column").each(function(t){var r=i(e,"left");Kt(e,"data-initial-left"),d.trigger.adjustWidth(n,r,parseInt(t,10))}),Ji(t,n)})})});var c=function(e,a){d.trigger.startAdjust(),n.assign(e),Vt(e,"data-initial-"+a,ln(e,a)),Li(e,tc),Zt(e,"opacity","0.2"),r.go(t.parent())},s=Di(t.parent(),"mousedown",function(e){var t,n;t=e.target,Bi(t,Vi)&&c(e.target,"top"),n=e.target,Bi(n,$i)&&c(e.target,"left")}),l=function(e){return Ue(e,t.view())},u=function(e){return qt(e,"table",l).filter(function(e){return qt(e,"[contenteditable]",l).exists(Fi)})},f=Di(t.view(),"mouseover",function(e){u(e.target).fold(function(){Ot(e.target)&&Wi(t)},function(e){a=S.some(e),Ji(t,e)})}),d=hi({adjustHeight:gi(["table","delta","row"]),adjustWidth:gi(["table","delta","column"]),startAdjust:gi([])});return{destroy:function(){s.unbind(),f.unbind(),r.destroy(),Wi(t)},refresh:function(e){Ji(t,e)},on:r.on,off:r.off,hideBars:e(Qi,t),showBars:e(ec,t),events:d.registry}},rc=function(e,t,n){var r=la,a=fa,o=nc(e),i=hi({beforeResize:gi(["table","type"]),afterResize:gi(["table","type"]),startDrag:gi([])});return o.events.adjustHeight.bind(function(e){var t=e.table;i.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);Uo(t,n,e.row,r),i.trigger.afterResize(t,"row")}),o.events.startAdjust.bind(function(){i.trigger.startDrag()}),o.events.adjustWidth.bind(function(e){var r=e.table;i.trigger.beforeResize(r,"col");var o=a.delta(e.delta,r),c=n(r);qo(r,o,e.column,t,c),i.trigger.afterResize(r,"col")}),{on:o.on,off:o.off,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:i.registry}},ac=function(e,t){return e.fire("newrow",{node:t})},oc=function(e,t){return e.fire("newcell",{node:t})},ic=function(e,t,n){e.fire("TableModified",oe(oe({},n),{table:t}))},cc={structure:!1,style:!0},sc={structure:!0,style:!1},lc={"border-collapse":"collapse",width:"100%"},uc={border:"1"},fc="preservetable",dc=function(e){return e.getParam("table_sizing_mode","auto")},mc=function(e){return e.getParam("table_responsive_width")},gc=function(e){return e.getParam("table_default_attributes",uc,"object")},hc=function(e){return e.getParam("table_default_styles",function(e){if(kc(e)){var t=e.getBody().offsetWidth;return oe(oe({},lc),{width:t+"px"})}return _c(e)?Ze(lc,function(e,t){return"width"!==t}):lc}(e),"object")},pc=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},yc=function(e){return e.getParam("table_row_advtab",!0,"boolean")},vc=function(e){return e.getParam("table_advtab",!0,"boolean")},bc=function(e){return e.getParam("table_style_by_css",!1,"boolean")},wc=function(e){return"relative"===dc(e)||!0===mc(e)},kc=function(e){return"fixed"===dc(e)||!1===mc(e)},_c=function(e){return"responsive"===dc(e)},Cc=function(e){var t="section",n=e.getParam("table_header_type",t,"string");return F(["section","cells","sectionCells","auto"],n)?n:t},xc=function(e){var t=e.getParam("table_column_resizing",fc,"string");return K(["preservetable","resizetable"],function(e){return e===t}).getOr(fc)},zc=function(e){return"preservetable"===xc(e)},Sc=function(e){return"resizetable"===xc(e)},Tc=function(e){var t=e.getParam("table_clone_elements");return E(t)?S.some(t.split(/[ ,]/)):Array.isArray(t)?S.some(t):S.none()},Nc=function(e,t){if(wc(e)){var n=zo(e,t.dom).filter(So).getOrThunk(function(){return di(t)});return Za(n,t)}return kc(e)?Ja(Mr(t),t):Ya(t)},Ec=function(e){Kt(e,"width")},Dc=function(e,t){var n=Mr(e)+"px";si(e,S.some(n),S.none(),t),Ec(e)},Ac=function(e,t){var n,r,a,o=Nc(e,t);r=o,a=Ra(n=t),si(n,S.some(a),S.none(),r),Ec(n)},Oc=function(e,t){var n=Nc(e,t);Dc(t,n)},Rc=function(e){rn(e,"width");var t=pn(e),n=0<t.length?t:hn(e);V(n,function(e){rn(e,"width"),Ec(e)}),Ec(e)},Pc=function(){var e=Fe.fromTag("div");return Qt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Jn(Rt(Fe.fromDom(document)),e),e},Lc="bar-",Bc=function(e){return"false"!==Wt(e,"data-mce-resize")},Mc=function(e){var t,n,r=S.none(),a=S.none(),o=S.none(),i=function(e){return"TABLE"===e.nodeName},c=function(){return a},s=function(t){return Nc(e,t)},l=function(){return(zc(e)?Yo:Go)()},u=function(r,a,o){var i,c,u,f,d,m,g=ye(a,"e");""===n&&Ac(e,r),o!==t&&""!==n?(Zt(r,"width",n),i=l(),c=s(r),u=zc(e)||g?mi(r).columns-1:0,qo(r,o-t,u,i,c)):So(n)&&(f=parseFloat(n.replace("%","")),Zt(r,"width",o*f/t+"%")),/^(\d+(\.\d+)?)px$/.test(n)&&(d=r,m=jn.fromTable(d),jn.hasColumns(m)||V(hn(d),function(e){var t=en(e,"width");Zt(e,"width",t),Kt(e,"width")}))};return e.on("init",function(){var t,n,i,c,u,f=(n=Bc,(t=e).inline?Zo(bo(t),Pc(),n):Jo(Fe.fromDom(t.getDoc()),n));o=S.some(f),u=e.getParam("object_resizing",!0),(E(u)?"table"===u:u)&&e.getParam("table_resize_bars",!0,"boolean")&&(i=l(),(c=rc(f,i,s)).on(),c.events.startDrag.bind(function(){r=S.some(e.selection.getRng())}),c.events.beforeResize.bind(function(t){var n,r,a,o,i,c=t.table.dom;n=e,a=wo(r=c),o=ko(c),i=Lc+t.type,n.fire("ObjectResizeStart",{target:r,width:a,height:o,origin:i})}),c.events.afterResize.bind(function(t){var n,a,o,i,c,s=t.table,l=s.dom;xo(s),r.each(function(t){e.selection.setRng(t),e.focus()}),n=e,o=wo(a=l),i=ko(l),c=Lc+t.type,n.fire("ObjectResized",{target:a,width:o,height:i,origin:c}),e.undoManager.add()}),a=S.some(c))}),e.on("ObjectResizeStart",function(r){var a,o=r.target;i(o)&&(a=Fe.fromDom(o),V(e.dom.select(".mce-clonedresizable"),function(t){e.dom.addClass(t,"mce-"+xc(e)+"-columns")}),!ui(a)&&kc(e)?Oc(e,a):!li(a)&&wc(e)&&Ac(e,a),fi(a)&&pe(r.origin,Lc)&&Ac(e,a),t=r.width,n=_c(e)?"":zo(e,o).getOr(""))}),e.on("ObjectResized",function(t){var n,r,a=t.target;i(a)&&(n=Fe.fromDom(a),r=t.origin,pe(r,"corner-")&&u(n,r,t.width),xo(n),ic(e,n.dom,cc))}),e.on("SwitchMode",function(){a.each(function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()})}),{lazyResize:c,lazyWire:function(){return o.getOr(Jo(Fe.fromDom(e.getBody()),Bc))},destroy:function(){a.each(function(e){e.destroy()}),o.each(function(t){var n;n=t,e.inline&&nr(n.parent())})}}},jc=function(e,t){return{element:e,offset:t}},Ic=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind(function(t){return Ic(e,t,n).orThunk(function(){return S.some(t)})}):S.none()},Fc=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},Hc=function(e,t){var n=Ic(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return jc(n,Fc(e,n));var r=e.property().children(n);return 0<r.length?Hc(e,r[r.length-1]):jc(n,Fc(e,n))},qc=Hc,Uc=r(),Vc=function(e,t){1===on(e,"colspan")&&Ta(e).bind(function(e){return ga(e,["fixed","relative","empty"])}).each(function(n){var r=n.value/2;Oa(e,r,n.unit),Oa(t,r,n.unit)})},$c=function(e,t,n,r){n===r?Kt(e,t):Vt(e,t,n)},Wc=function(e,t,n){re(Bt(e,t)).fold(function(){return Yn(e,n)},function(e){return Gn(e,n)})},Xc=function(e,t){var n=[],r=[],a=function(e){return U(e,function(e){e.isNew&&n.push(e.element);var t=e.element;return tr(t),V(e.cells,function(e){e.isNew&&r.push(e.element),$c(e.element,"colspan",e.colspan,1),$c(e.element,"rowspan",e.rowspan,1),Jn(t,e.element)}),t})},o=function(e){return J(e,function(e){return U(e.cells,function(e){return $c(e.element,"span",e.colspan,1),e.element})})},i=function(t,n){var r,i,c,s=(c=Ft(r=e,i=n).getOrThunk(function(){var e=Fe.fromTag(i,vt(r).dom);return"thead"===i?Wc(r,"caption,colgroup",e):"colgroup"===i?Wc(r,"caption",e):Jn(r,e),e}),tr(c),c),l=("colgroup"===n?o:a)(t);er(s,l)},c=function(t,n){0<t.length?i(t,n):Ft(e,n).each(nr)},s=[],l=[],u=[],f=[];return V(t,function(e){switch(e.section){case"thead":s.push(e);break;case"tbody":l.push(e);break;case"tfoot":u.push(e);break;case"colgroup":f.push(e)}}),c(f,"colgroup"),c(s,"thead"),c(l,"tbody"),c(u,"tfoot"),{newRows:n,newCells:r}},Kc=function(e,t){if(0===e.length)return 0;var n=e[0];return G(e,function(e){return!t(n.element,e.element)}).fold(function(){return e.length},function(e){return e})},Gc=function(e,t,n,r){var a,o=e[t].cells.slice(n),i=Kc(o,r),c=(a=n,U(e,function(e){return Nn(e,a)}).slice(t));return{colspan:i,rowspan:Kc(c,r)}},Yc=function(e,t){var n=U(e,function(e){return U(e.cells,k)});return U(e,function(r,a){return{details:J(r.cells,function(r,o){if(!1!==n[a][o])return[];var i=Gc(e,a,o,t);return function(e,t,r,a){for(var o=e;e+r>o;o++)for(var i=t;t+a>i;i++)n[o][i]=!0}(a,o,i.rowspan,i.colspan),[{element:r.element,rowspan:i.rowspan,colspan:i.colspan,isNew:r.isNew}]}),section:r.section}})},Jc=function(e,t,n){var r,a=[];jn.hasColumns(e)&&(r=U(jn.justColumns(e),function(e){return ct(e.element,n,!1)}),a.push(st(r,"colgroup")));
for(var o=0;o<e.grid.rows;o++){for(var i=[],c=0;c<e.grid.columns;c++){var s=jn.getAt(e,o,c).map(function(e){return ct(e.element,n,e.isLocked)}).getOrThunk(function(){return ct(t.gap(),!0,!1)});i.push(s)}var l=st(i,e.all[o].section);a.push(l)}return a},Zc=function(e,t){return U(e,function(e){var n,r=(n=e.details,ae(n,function(e){return wt(e.element).map(function(e){var t=wt(e).isNone();return ct(e,t,!1)})}).getOrThunk(function(){return ct(t.row(),!0,!1)}));return{element:r.element,cells:e.details,section:e.section,isNew:r.isNew}})},Qc=function(e,t){var n=Yc(e,Ue);return Zc(n,t)},es=function(e,t){return ae(e.all,function(e){return K(e.cells,function(e){return Ue(t,e.element)})})},ts=function(e,t,n){var r=U(t.selection,function(t){return gn(t).bind(function(t){return es(e,t)}).filter(n)}),a=Rr(r);return Pr(0<a.length,a)},ns=function(e,t,n,r,a){return function(o,i,c,s,l,u){var f=jn.fromTable(i);return t(f,c).map(function(t){var n=Jc(f,s,!1),r=e(n,t,Ue,a(s)),o=Pn(r.grid);return{info:t,grid:Qc(r.grid,s),cursor:r.cursor,lockedColumns:o}}).bind(function(e){var t=Xc(i,e.grid),a=S.from(l).getOrThunk(function(){return Ya(i)}),c=S.from(u).getOrThunk(Yo);return n(i,e.grid,e.info,a,c),r(i),Ji(o,i),Kt(i,On),0<e.lockedColumns.length&&Vt(i,On,e.lockedColumns.join(",")),S.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},rs=function(e,t){return gn(t.element).bind(function(t){return es(e,t)})},as=function(e,t){return ts(e,t,_).map(function(e){return{cells:e,generators:t.generators,clipboard:t.clipboard}})},os=function(e,t){return ts(e,t,_)},is=function(e,t){return rs(e,t).filter(function(e){return!e.isLocked})},cs=function(e,t){return ts(e,t,function(e){return!e.isLocked})},ss=function(e,t){return Z(t,function(t){return es(e,t).exists(function(e){return!e.isLocked})})},ls=function(e,t){return t.mergable.filter(function(t){return ss(e,t.cells)})},us=function(e,t){return t.unmergable.filter(function(t){return ss(e,t)})},fs=function(e,t,n,r){for(var a=An(e).rows,o=!0,i=0;i<a.length;i++)for(var c=0;c<Dn(a[0]);c++){var s=a[i],l=Nn(s,c),u=n(l.element,t);!0===u&&!1===o?zn(s,c,ct(r(),!0,l.isLocked)):!0===u&&(o=!1)}return e},ds=function(e,t,n,r){var a,o,i,c=An(e).rows;return t>0&&t<c.length&&(a=c[t-1].cells,i=n,o=X(a,function(e,t){return H(e,function(e){return i(e.element,t.element)})?e:e.concat([t])},[]),V(o,function(e){for(var a=S.none(),o=t;o<c.length;o++)for(var i=0;i<Dn(c[0]);i++)!function(t){var i=c[o],s=Nn(i,t);n(s.element,e.element)&&(a.isNone()&&(a=S.some(r())),a.each(function(e){zn(i,t,ct(e,!0,s.isLocked))}))}(i)})),e},ms=function(e){return{is:function(t){return e===t},isValue:_,isError:k,getOr:v(e),getOrThunk:v(e),getOrDie:v(e),or:function(){return ms(e)},orThunk:function(){return ms(e)},fold:function(t,n){return n(e)},map:function(t){return ms(t(e))},mapError:function(){return ms(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return S.some(e)}}},gs=function(e){return{is:k,isValue:k,isError:_,getOr:b,getOrThunk:function(e){return e()},getOrDie:function(){return t=String(e),function(){throw new Error(t)}();var t},or:function(e){return e},orThunk:function(e){return e()},fold:function(t){return t(e)},map:function(){return gs(e)},mapError:function(t){return gs(t(e))},each:y,bind:function(){return gs(e)},exists:k,forall:_,toOptional:S.none}},hs={value:ms,error:gs,fromOption:function(e,t){return e.fold(function(){return gs(t)},ms)}},ps=function(e,t){return{rowDelta:0,colDelta:Dn(e[0])-Dn(t[0])}},ys=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},vs=function(e,t,n,r){var a="colgroup"===t.section?n.col:n.cell;return q(e,function(e){return ct(a(),!0,r(e))})},bs=function(e,t,n,r){return e.concat(q(t,function(){var t=e[e.length-1],a=vs(t.cells.length,t,n,function(e){return nt(r,e.toString())});return Sn(t,a)}))},ws=function(e,t,n,r){return U(e,function(e){var a=vs(t,e,n,k);return Cn(e,r,a)})},ks=function(e,t,n){var r=t.colDelta<0?ws:b,a=t.rowDelta<0?bs:b,o=Pn(e),i=Dn(e[0]),c=H(o,function(e){return e===i-1}),s=r(e,Math.abs(t.colDelta),n,c?i-1:i),l=Pn(s);return a(s,Math.abs(t.rowDelta),n,Q(l,_))},_s=function(t,n,r,a,o,i){for(var c,s,l,u,f,d=t.row,m=t.column,g=d+r.length,h=m+Dn(r[0])+i.length,p=Q(i,_),y=d;g>y;y++)for(var v,b,w,k,C=0,x=m;h>x;x++)p[x]?C++:(l=x,u=void 0,u=e(o,Nn((c=n)[s=y],l).element),f=c[s],1<c.length&&1<Dn(f)&&(l>0&&u(En(f,l-1))||l<f.cells.length-1&&u(En(f,l+1))||s>0&&u(En(c[s-1],l))||s<c.length-1&&u(En(c[s+1],l)))&&fs(n,En(n[y],x),o,a.cell),v=x-m-C,w=(b=Nn(r[y-d],v)).element,k=a.replace(w),zn(n[y],x,ct(k,!0,b.isLocked)));return n},Cs=function(e,t,n){return $(n,function(n){return n>=e.column&&n<=Dn(t[0])+e.column})},xs=function(e,t,n,r,a){var o,i,c,s,l,u=Pn(t),f=(o=e,i=u,c=Dn(t[0]),s=q(c-o.column,function(e){return e+o.column}),l=K(s,function(e){return Z(i,function(t){return t!==e})}).getOr(c-1),oe(oe({},o),{column:l})),d=Cs(f,n,u);return function(e,t,n){if(e.row>=t.length||e.column>Dn(t[0]))return hs.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),a=r[0].cells.slice(e.column),o=Dn(n[0]),i=n.length;return hs.value({rowDelta:r.length-i,colDelta:a.length-o})}(f,t,n).map(function(e){var o=oe(oe({},e),{colDelta:e.colDelta-d.length}),i=ks(t,o,r),c=Pn(i),s=Cs(f,n,c);return _s(f,i,n,r,a,s)})},zs=function(e,t,n,r,a){var o,i,c,s;o=t,i=e,c=a,s=r.cell,i>0&&i<o[0].cells.length&&V(o,function(e){var t=e.cells[i-1],n=e.cells[i];c(n.element,t.element)&&zn(e,i,ct(s(),!0,n.isLocked))});var l=ys(n,t),u=ks(n,l,r),f=ys(t,u),d=ks(t,f,r);return U(d,function(t,n){return Cn(t,e,u[n].cells)})},Ss=function(e,t,n,r,a){ds(t,e,a,r.cell);var o,i,c=Pn(t),s=ps(t,n),l=oe(oe({},s),{colDelta:s.colDelta-c.length}),u=ks(t,l,r),f=An(u),d=f.cols,m=f.rows,g=Pn(u),h=ps(n,t),p=oe(oe({},h),{colDelta:h.colDelta+g.length}),y=(o=r,i=g,U(n,function(e){return X(i,function(t,n){var r=vs(1,e,o,_)[0];return xn(t,n,r)},e)})),v=ks(y,p,r);return d.concat(m.slice(0,e)).concat(v).concat(m.slice(e,m.length))},Ts=function(e,t,n,r,a){var o=An(e),i=o.rows,c=o.cols,s=i.slice(0,t),l=i.slice(t),u=Tn(i[n],function(e,n){return t>0&&t<i.length&&r(En(i[t-1],n),En(i[t],n))?Nn(i[t],n):ct(a(e.element,r),!0,e.isLocked)});return c.concat(s).concat([u]).concat(l)},Ns=function(e,t,n,r,a){return U(e,function(e){var o=t>0&&t<Dn(e)&&r(En(e,t-1),En(e,t)),i=function(e,t,n,r,a,o,i){if("colgroup"!==n&&r)return Nn(e,t);var c=Nn(e,a);return ct(i(c.element,o),!0,!1)}(e,t,e.section,o,n,r,a);return xn(e,t,i)})},Es=function(e,t,n,r){return U(e,function(e){return Tn(e,function(e){return a=e,H(t,function(e){return n(a.element,e.element)})?ct(r(e.element,n),!0,e.isLocked):e;var a})})},Ds=function(e,t,n,r){return void 0!==En(e[t],n)&&t>0&&r(En(e[t-1],n),En(e[t],n))},As=function(e,t,n){return t>0&&n(En(e,t-1),En(e,t))},Os=function(e,t,n,r){var a=An(e).rows,o=J(a,function(r,a){return Ds(e,a,t,n)||As(r,t,n)?[]:[Nn(r,t)]});return Es(e,o,n,r)},Rs=function(e,t,n,r){var a=An(e).rows,o=a[t],i=J(o.cells,function(e,r){return Ds(a,t,r,n)||As(o,r,n)?[]:[e]});return Es(e,i,n,r)},Ps=function(e){return X(e,function(e,t){return H(e,function(e){return e.column===t.column})?e:e.concat([t])},[]).sort(function(e,t){return e.column-t.column})},Ls=function(e){return{element:e,colspan:an(e,"colspan",1),rowspan:an(e,"rowspan",1)}},Bs=function(e){return Xt(e,"scope").map(function(e){return e.substr(0,3)})},Ms=function(e,t){void 0===t&&(t=Ls);var n=Wa(S.none()),r=function(n){return function(t){switch(lt(t.element)){case"col":return e.col(t);default:return e.cell(t)}}(t(n))},a=function(e){var t=r(e);return n.get().isNone()&&n.set(S.some(t)),o=S.some({item:e,replacement:t}),t},o=S.none();return{getOrInit:function(e,t){return o.fold(function(){return a(e)},function(n){return t(e,n.item)?n.replacement:a(e)})},cursor:n.get}},js=function(e,t){return function(n){var r=Wa(S.none()),a=[],o=function(o){var i={scope:e},c=n.replace(o,t,i);return a.push({item:o,sub:c}),r.get().isNone()&&r.set(S.some(c)),c};return{replaceOrInit:function(e,t){return"col"===lt(e)?e:(n=e,r=t,K(a,function(e){return r(e.item,n)}).fold(function(){return o(e)},function(n){return t(e,n.item)?n.sub:o(e)}));var n,r},cursor:r.get}}},Is=function(e){var t=Wa(S.none());return{unmerge:function(n){t.get().isNone()&&t.set(S.some(n));var r=Bs(n);return r.each(function(e){return Vt(n,"scope",e)}),function(){var t=e.cell({element:n,colspan:1,rowspan:1});return rn(t,"width"),rn(n,"width"),r.each(function(e){return Vt(t,"scope",e)}),t}},merge:function(e){return rn(e[0],"width"),function(){var t=Rr(U(e,Bs));if(0===t.length)return S.none();var n=t[0],r=["row","col"];return H(t,function(e){return e!==n&&F(r,e)})?S.none():S.from(n)}().fold(function(){return Kt(e[0],"scope")},function(t){return Vt(e[0],"scope",t+"group")}),v(e[0])},cursor:t.get}},Fs=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Hs=r(),qs=function(e){return t=e,n=Hs.property().name(t),F(Fs,n);var t,n},Us=function(e){return t=e,n=Hs.property().name(t),F(["ol","ul"],n);var t,n},Vs=function(e){return t=e,F(["br","img","hr","input"],Hs.property().name(t));var t},$s=function(e){var t,n=function(e){return"br"===lt(e)},r=function(e){return oo(e).bind(function(t){var r=Ct(t).map(function(e){return!!qs(e)||!!Vs(e)&&"img"!==lt(e)}).getOr(!1);return wt(t).map(function(a){return!0===r||"li"===lt(o=a)||jt(o,Us).isSome()||n(t)||qs(a)&&!Ue(e,a)?[]:[Fe.fromTag("br")];var o})}).getOr([])},a=0===(t=J(e,function(e){var t=xt(e);return Z(t,function(e){return n(e)||gt(e)&&0===or(e).trim().length})?[]:t.concat(r(e))})).length?[Fe.fromTag("br")]:t;tr(e[0]),er(e[0],a)},Ws=function(e){0===hn(e).length&&nr(e)},Xs=function(e,t){return{grid:e,cursor:t}},Ks=function(e,t,n){var r=An(e).rows;return Gs(r,t,n).orThunk(function(){return Gs(r,0,0)})},Gs=function(e,t,n){return S.from(e[t]).bind(function(e){return S.from(e.cells[n]).bind(function(e){return S.from(e.element)})})},Ys=function(e,t,n){var r=An(e).rows;return Xs(e,Gs(r,t,n))},Js=function(e){return X(e,function(e,t){return H(e,function(e){return e.row===t.row})?e:e.concat([t])},[]).sort(function(e,t){return e.row-t.row})},Zs=function(e,t,n){var r,a,o=(r=e,a=n.section,wn(r,function(){return a})),i=jn.generate(o);return Jc(i,t,!0)},Qs=function(e,t){var n=$(e,t);return 0===n.length?S.some("td"):n.length===e.length?S.some("th"):S.none()},el=function(e,t,n,r){var a=jn.generate(t),o=r.getWidths(a,r);Ho(a,o,r)},tl=function(e,t,n,r,a){var o=jn.generate(t),i=r.getWidths(o,r),c=r.pixelWidth(),s=a.calcRedestributedWidths(i,c,n.pixelDelta,r.isRelative),l=s.newSizes,u=s.delta;Ho(o,l,r),r.adjustTableWidth(u)},nl=function(e,t){return H(t,function(e){return 0===e.column&&e.isLocked})},rl=function(e,t){return H(t,function(t){return t.column+t.colspan>=e.grid.columns&&t.isLocked})},al=function(e,t){var n=Ir(e),r=Ps(t);return X(r,function(e,t){return e+n[t.column].map(jr).getOr(0)},0)},ol=function(e){return function(t,n){return os(t,n).filter(function(n){return!(e?nl:rl)(t,n)}).map(function(e){return{details:e,pixelDelta:al(t,e)}})}},il=function(e){return function(t,n){return as(t,n).filter(function(n){return!(e?nl:rl)(t,n.cells)})}},cl=ns(function(e,t,n,r){var a=t[0].row,o=Js(t),i=W(o,function(e,t){return{grid:Ts(e.grid,a,t.row+e.delta,n,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid;return Ys(i,a,t[0].column)},os,y,y,Ms),sl=ns(function(e,t,n,r){var a=Js(t),o=a[a.length-1],i=o.row+o.rowspan,c=W(a,function(e,t){return Ts(e,i,t.row,n,r.getOrInit)},e);return Ys(c,i,t[0].column)},os,y,y,Ms),ll=ns(function(e,t,n,r){var a=t.details,o=Ps(a),i=o[0].column,c=W(o,function(e,t){return{grid:Ns(e.grid,i,t.column+e.delta,n,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid;return Ys(c,a[0].row,i)},ol(!0),tl,y,Ms),ul=ns(function(e,t,n,r){var a=t.details,o=a[a.length-1],i=o.column+o.colspan,c=Ps(a),s=W(c,function(e,t){return Ns(e,i,t.column,n,r.getOrInit)},e);return Ys(s,a[0].row,i)},ol(!1),tl,y,Ms),fl=ns(function(e,t){var n,r,a=Ps(t.details),o=(n=e,r=U(a,function(e){return e.column}),J(n,function(e){var t=e.cells,n=W(r,function(e,t){return t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e},t);return 0<n.length?[st(n,e.section)]:[]})),i=Ks(o,a[0].row,a[0].column);return Xs(o,i)},function(e,t){return cs(e,t).map(function(t){return{details:t,pixelDelta:-al(e,t)}})},tl,Ws,Ms),dl=ns(function(e,t){var n,r,a,o,i,c=Js(t),s=(n=e,r=c[0].row,a=c[c.length-1].row,o=An(n),i=o.rows,o.cols.concat(i.slice(0,r)).concat(i.slice(a+1))),l=Ks(s,t[0].row,t[0].column);return Xs(s,l)},os,y,Ws,Ms),ml=(ns(function(e,t,n,r){var a=Os(e,t.column,n,r.replaceOrInit);return Ys(a,t.row,t.column)},is,y,y,js("row","th")),ns(function(e,t,n,r){var a=Ps(t),o=X(a,function(e,t){return Os(e,t.column,n,r.replaceOrInit)},e);return Ys(o,t[0].row,t[0].column)},cs,y,y,js("row","th"))),gl=(ns(function(e,t,n,r){var a=Os(e,t.column,n,r.replaceOrInit);return Ys(a,t.row,t.column)},is,y,y,js(null,"td")),ns(function(e,t,n,r){var a=Ps(t),o=X(a,function(e,t){return Os(e,t.column,n,r.replaceOrInit)},e);return Ys(o,t[0].row,t[0].column)},cs,y,y,js(null,"td"))),hl=(ns(function(e,t,n,r){var a=Rs(e,t.row,n,r.replaceOrInit);return Ys(a,t.row,t.column)},rs,y,y,js("col","th")),ns(function(e,t,n,r){var a=Js(t),o=X(a,function(e,t){return Rs(e,t.row,n,r.replaceOrInit)},e);return Ys(o,t[0].row,t[0].column)},os,y,y,js("col","th")),ns(function(e,t,n,r){var a=Rs(e,t.row,n,r.replaceOrInit);return Ys(a,t.row,t.column)},rs,y,y,js(null,"td")),ns(function(e,t,n,r){var a=Js(t),o=X(a,function(e,t){return Rs(e,t.row,n,r.replaceOrInit)},e);return Ys(o,t[0].row,t[0].column)},os,y,y,js(null,"td")),ns(function(e,t,n,r){var a=t.cells;$s(a);var o=function(e,t,n){var r=An(e).rows;if(0===r.length)return e;for(var a=t.startRow;a<=t.finishRow;a++)for(var o=t.startCol;o<=t.finishCol;o++){var i=r[a],c=Nn(i,o).isLocked;zn(i,o,ct(n(),!1,c))}return e}(e,t.bounds,r.merge(a));return Xs(o,S.from(a[0]))},ls,el,y,Is)),pl=ns(function(e,t,n,r){var a=W(t,function(e,t){return fs(e,t,n,r.unmerge(t))},e);return Xs(a,S.from(t[0]))},us,el,y,Is),yl=ns(function(e,t,n){var r,a,o,i=(r=t.clipboard,a=t.generators,o=jn.fromTable(r),Jc(o,a,!0)),c={row:t.row,column:t.column};return xs(c,e,i,t.generators,n).fold(function(){return Xs(e,S.some(t.element))},function(e){var n=Ks(e,t.row,t.column);return Xs(e,n)})},function(e,t){return gn(t.element).bind(function(n){return es(e,n).map(function(e){return oe(oe({},e),{generators:t.generators,clipboard:t.clipboard})})})},el,y,Ms),vl=ns(function(e,t,n){var r=An(e).rows,a=t.cells[0].column,o=r[t.cells[0].row],i=Zs(t.clipboard,t.generators,o),c=zs(a,e,i,t.generators,n),s=Ks(c,t.cells[0].row,t.cells[0].column);return Xs(c,s)},il(!0),y,y,Ms),bl=ns(function(e,t,n){var r=An(e).rows,a=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,o=r[t.cells[0].row],i=Zs(t.clipboard,t.generators,o),c=zs(a,e,i,t.generators,n),s=Ks(c,t.cells[0].row,t.cells[0].column);return Xs(c,s)},il(!1),y,y,Ms),wl=ns(function(e,t,n){var r=An(e).rows,a=t.cells[0].row,o=r[a],i=Zs(t.clipboard,t.generators,o),c=Ss(a,e,i,t.generators,n),s=Ks(c,t.cells[0].row,t.cells[0].column);return Xs(c,s)},as,y,y,Ms),kl=ns(function(e,t,n){var r=An(e).rows,a=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,o=r[t.cells[0].row],i=Zs(t.clipboard,t.generators,o),c=Ss(a,e,i,t.generators,n),s=Ks(c,t.cells[0].row,t.cells[0].column);return Xs(c,s)},as,y,y,Ms),_l=function(e,t){var n=jn.fromTable(e);return os(n,t).bind(function(e){var t=e[e.length-1],r=e[0].column,a=t.column+t.colspan,o=Y(U(n.all,function(e){return $(e.cells,function(e){return e.column>=r&&e.column<a})}));return Qs(o,function(e){return"th"===lt(e.element)})}).getOr("")},Cl=function(e){return vo(e.parentNode)},xl=function(e,t){var n="thead"===Cl(t),r=!H(t.cells,function(e){return"th"!==vo(e)});return n||r?S.some({thead:n,ths:r}):S.none()},zl=function(e,t){return"thead"===(n=xl(0,t).fold(function(){return Cl(t)},function(){return"thead"}))?"header":"tfoot"===n?"footer":"body";var n},Sl=function(e,t,n){var r,a,o=e.getParent(t,"table"),i=t.parentNode,c=vo(i);n!==c&&((r=e.select(n,o)[0])||(r=e.create(n),a=o.firstChild,"thead"===n?re(Bt(Fe.fromDom(o),"caption,colgroup")).fold(function(){return o.insertBefore(r,a)},function(t){return e.insertAfter(r,t.dom)}):o.appendChild(r)),"tbody"===n&&"thead"===c&&r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t),i.hasChildNodes()||e.remove(i))},Tl=function(e,t,n,r){var a=e.dom,o=function(e,t,n){if(P(n)&&vo(t)!==n){var r=e.dom.rename(t,n);return oc(e,r),r}return t}(e,t,n);return R(r)||a.setAttrib(o,"scope",r),o},Nl=function(e,t,n,r){return V(t,function(t){return Tl(e,t,n,r)})},El=function(e,t,n){var r,a,o,i=e.dom;"header"===n?(a="auto"===(r=Cc(e))?(o=yn(Fe.fromDom(t.cells[0])).map(vn).getOr([]),ae(o,function(e){return xl(0,e.dom)}).map(function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"}).getOr("section")):r,Nl(e,t.cells,"section"===a?"td":"th","col"),Sl(i,t,"cells"===a?"tbody":"thead")):(Nl(e,t.cells,"td",null),Sl(i,t,"footer"===n?"tfoot":"tbody"))},Dl=function(e){return function(t){var n,r=lt(t),a="col"===r||"colgroup"===r?yn(n=t).bind(function(e){return wr(e,Oo.firstSelectedSelector)}).fold(function(){return n},function(e){return e[0]}):t;return qt(a,e)}},Al=Dl("th,td"),Ol=Dl("th,td,caption"),Rl=function(e,t){return Al(e).map(function(){return No(t)}).getOr([])},Pl=function(e,t){var n,r,a,o=Al(e),i=o.bind(function(e){return yn(e)}).map(vn);return r=i,a=function(e,n){return $(n,function(n){return H(yo(n.dom.cells),function(n){return"1"===Wt(n,t)||Ue(n,e)})})},((n=o).isSome()&&r.isSome()?S.some(a(n.getOrDie(),r.getOrDie())):S.none()).getOr([])},Ll=function(e,t,n){var r=function(e){return"table"===lt(bo(e))},a=Tc(e),o=Sc(e)?y:Vc,i=function(t,n,r,o,i){return function(c,s){xo(c);var l=o(),u=Fe.fromDom(e.getDoc()),f=ho(r,u,a),d=Nc(e,c),m=(Sc(e)?Go:Yo)();return n(c)?t(l,c,s,f,d,m).bind(function(t){return V(t.newRows,function(t){ac(e,t.dom)}),V(t.newCells,function(t){oc(e,t.dom)}),t.cursor.map(function(t){var n=qc(Uc,t),r=e.dom.createRng();return r.setStart(n.element.dom,n.offset),r.setEnd(n.element.dom,n.offset),{rng:r,effect:i}})}):S.none()}},c=i(dl,function(t){return!1===r(e)||1<mi(t).rows},y,t,sc),s=i(fl,function(t){return!1===r(e)||1<mi(t).columns},y,t,sc),l=i(cl,_,y,t,sc),u=i(sl,_,y,t,sc),f=i(ll,_,o,t,sc),d=i(ul,_,o,t,sc),m=i(hl,_,y,t,sc),g=i(pl,_,y,t,sc),h=i(vl,_,y,t,sc),p=i(bl,_,y,t,sc),v=i(wl,_,y,t,sc),b=i(kl,_,y,t,sc),w=i(yl,_,y,t,sc),k=function(e,t){return tt(e,"type").filter(function(e){return F(t,e)})};return{deleteRow:c,deleteColumn:s,insertRowsBefore:l,insertRowsAfter:u,insertColumnsBefore:f,insertColumnsAfter:d,mergeCells:m,unmergeCells:g,pasteColsBefore:h,pasteColsAfter:p,pasteRowsBefore:v,pasteRowsAfter:b,pasteCells:w,setTableCellType:function(e,t){return k(t,["td","th"]).each(function(t){var r=U(Rl(To(e),n),function(e){return e.dom});Nl(e,r,t,null)})},setTableRowType:function(e,t){return k(t,["header","body","footer"]).each(function(t){U(Pl(To(e),Oo.selected),function(n){return El(e,n.dom,t)})})},makeColumnsHeader:i(ml,_,y,t,sc),unmakeColumnsHeader:i(gl,_,y,t,sc),getTableRowType:function(e){var t=Pl(To(e),Oo.selected);if(0<t.length){var n=U(t,function(e){return zl(0,e.dom)}),r=F(n,"header"),a=F(n,"footer");if(r||a){var o=F(n,"body");return!r||o||a?r||o||!a?"":"footer":"header"}return"body"}},getTableCellType:function(e){return Qs(Rl(To(e),n),function(e){return"th"===lt(e)}).getOr("")},getTableColType:_l}},Bl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Ml=function(e,t,n,r){for(var a=Fe.fromTag("tr"),o=0;e>o;o++){var i=t>r||n>o?Fe.fromTag("th"):Fe.fromTag("td");n>o&&Vt(i,"scope","row"),t>r&&Vt(i,"scope","col"),Jn(i,Fe.fromTag("br")),Jn(a,i)}return a},jl=function(e){var t=Fe.fromTag("colgroup");return q(e,function(){return Jn(t,Fe.fromTag("col"))}),t},Il=function(e,t,n,r){return q(e,function(e){return Ml(t,n,r,e)})},Fl=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},Hl=function(t,n,r,a,o){var i=hc(t),c={styles:i,attributes:gc(t),colGroups:t.getParam("table_use_colgroups",!1,"boolean")};return t.undoManager.ignore(function(){var e=function(e,t,n,r,a,o){void 0===o&&(o=Bl);var i=Fe.fromTag("table"),c="cells"!==a;Qt(i,o.styles),$t(i,o.attributes),o.colGroups&&Jn(i,jl(t));var s,l,u=Math.min(e,n);c&&n>0&&(s=Fe.fromTag("thead"),Jn(i,s),l=Il(n,t,"sectionCells"===a?u:0,r),er(s,l));var f=Fe.fromTag("tbody");Jn(i,f);var d=Il(c?e-u:e,t,c?0:n,r);return er(f,d),i}(r,n,o,a,Cc(t),c);Vt(e,"data-mce-id","__mce");var i,s,l,u=(i=e,s=Fe.fromTag("div"),l=Fe.fromDom(i.dom.cloneNode(!0)),Jn(s,l),s.dom.innerHTML);t.insertContent(u),t.addVisual()}),Ht(bo(t),'table[data-mce-id="__mce"]').map(function(n){var r,a,o;return kc(t)?Oc(t,n):_c(t)?Rc(n):(wc(t)||(r=i.width,E(r)&&-1!==r.indexOf("%")))&&Ac(t,n),xo(n),Kt(n,"data-mce-id"),a=t,V(Mt(n,"tr"),function(e){ac(a,e.dom),V(Mt(e,"th,td"),function(e){oc(a,e.dom)})}),o=t,Ht(n,"td,th").each(e(Fl,o)),n.dom}).getOr(null)},ql=function(e,t,n,r,a){void 0===r&&(r={});var o=function(e){return B(e)&&e>0};if(o(t)&&o(n)){var i=r.headerRows||0,c=r.headerColumns||0;return Hl(e,n,t,c,i)}return console.error(a),null},Ul=function(e){return function(){return e().fold(function(){return[]},function(e){return U(e,function(e){return e.dom})})}},Vl=function(e){return function(t){var n=0<t.length?S.some(yo(t)):S.none();e(n)}},$l=function(e,t,n,r){return{insertTable:(a=e,function(e,t,n){void 0===n&&(n={});var r=ql(a,t,e,n,"Invalid values for insertTable - rows and columns values are required to insert a table.");return a.undoManager.add(),r}),setClipboardRows:Vl(t.setRows),getClipboardRows:Ul(t.getRows),setClipboardCols:Vl(t.setColumns),getClipboardCols:Ul(t.getColumns),resizeHandler:n,selectionTargets:r};var a},Wl=function(e,t,n){var r=an(e,t,1);1===n||1>=r?Kt(e,t):Vt(e,t,Math.min(n,r))},Xl=function(e,n){var r=jn.fromTable(e);return cs(r,n).map(function(e){var n,a,o=e[e.length-1],i=e[0].column,c=o.column+o.colspan;return t(function(e,t,n){if(jn.hasColumns(e)){var r=$(jn.justColumns(e),function(e){return e.column>=t&&e.column<n}),a=U(r,function(e){var r=Ar(e.element);return Wl(r,"span",n-t),r}),o=Fe.fromTag("colgroup");return er(o,a),[o]}return[]}(r,i,c),(n=i,a=c,U(r.all,function(e){var t=$(e.cells,function(e){return e.column>=n&&e.column<a}),r=U(t,function(e){var t=Ar(e.element);return Wl(t,"colspan",a-n),t}),o=Fe.fromTag("tr");return er(o,r),o})))})},Kl=function(e,t,n){var r=jn.fromTable(e);return os(r,t).bind(function(e){var t=Jc(r,n,!1),a=An(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),o=J(a,function(e){var t=$(e.cells,function(e){return!e.isLocked});return 0<t.length?[oe(oe({},e),{cells:t})]:[]}),i=Qc(o,n);return Pr(0<i.length,i)}).map(function(e){return U(e,function(e){var t=Dr(e.element);return V(e.cells,function(e){var n=Ar(e.element);$c(n,"colspan",e.colspan,1),$c(n,"rowspan",e.rowspan,1),Jn(t,n)}),t})})},Gl=tinymce.util.Tools.resolve("tinymce.util.Tools"),Yl=function(e,t,n){return function(t,r){for(var a=0;a<r.length;a++){var o=e.getStyle(r[a],n);if(void 0===t&&(t=o),t!==o)return""}return t}(void 0,e.select("td,th",t))},Jl=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},Zl=function(e,t){Gl.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},Ql=function(e,t){return(t||[]).concat(U(e,function(e){var t=e.text||e.title;return rt(e,"menu")?{text:t,items:Ql(e.menu)}:{text:t,value:e.value}}))},eu=function(e){return function(t){return pe(t,"rgb")?e.toHex(t):t}},tu=function(e,t){var n=Fe.fromDom(t);return{borderwidth:nn(n,"border-width").getOr(""),borderstyle:nn(n,"border-style").getOr(""),bordercolor:nn(n,"border-color").map(eu(e)).getOr(""),backgroundcolor:nn(n,"background-color").map(eu(e)).getOr("")}},nu=function(e){var t=e[0],n=e.slice(1);return V(n,function(e){V(Xe(t),function(n){Ge(e,function(e,r){var a=t[n];""!==a&&n===r&&a!==e&&(t[n]="")})})}),t},ru=function(e){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},au=function(e,t,n,r){return K(e,function(e){return n.formatter.matchNode(r,t+e)}).getOr("")},ou=e(au,["left","center","right"],"align"),iu=e(au,["top","middle","bottom"],"valign"),cu=function(e,t){var n,r,a,o,i=hc(e),c=gc(e),s=t?(n=e.dom,{borderstyle:tt(i,"border-style").getOr(""),bordercolor:eu(n)(tt(i,"border-color").getOr("")),backgroundcolor:eu(n)(tt(i,"background-color").getOr(""))}):{};return oe(oe(oe(oe(oe(oe({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,"class":"",align:"",border:""}),i),c),s),(o=i["border-width"],bc(e)&&o?{border:o}:tt(c,"border").fold(function(){return{}},function(e){return{border:e}}))),(r=tt(i,"border-spacing").or(tt(c,"cellspacing")).fold(function(){return{}},function(e){return{cellspacing:e}}),a=tt(i,"border-padding").or(tt(c,"cellpadding")).fold(function(){return{}},function(e){return{cellpadding:e}}),oe(oe({},r),a)))},su=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],lu=function(e){return su.concat((0<(t=Ql(e.getParam("table_cell_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()).toArray());var t},uu=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,a){e&&!a||r.setAttrib(n,t,a)},setStyle:function(t,a){e&&!a||r.setStyle(n,t,a)},setFormat:function(r,a){e&&!a||(""===a?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:a},n))}}}},fu={normal:uu(!1),ifTruthy:uu(!0)},du=function(e){return yn(e[0]).map(function(t){var n=jn.fromTable(t),r=jn.justCells(n),a=$(r,function(t){return H(e,function(e){return Ue(t.element,e)})});return U(a,function(e){return{element:e.element.dom,column:jn.getColumnAt(n,e.column).map(function(e){return e.element.dom})}})})},mu=function(e,t,n,r){var a,o,i=1===t.length,c=Ze(r,function(e,t){return n[t]!==e});0<et(c)&&1<=t.length&&(a=yn(t[0]),du(t).each(function(t){V(t,function(t){var n,a,o,c,s,l,u,f,d,m,g=Tl(e,t.element,r.celltype),h=i?fu.normal(e,g):fu.ifTruthy(e,g),p=t.column.map(function(t){return i?fu.normal(e,t):fu.ifTruthy(e,t)}).getOr(h);a=p,o=r,(n=h).setAttrib("scope",o.scope),n.setAttrib("class",o["class"]),n.setStyle("height",Co(o.height)),a.setStyle("width",Co(o.width)),pc(e)&&(s=r,(c=h).setFormat("tablecellbackgroundcolor",s.backgroundcolor),c.setFormat("tablecellbordercolor",s.bordercolor),c.setFormat("tablecellborderstyle",s.borderstyle),c.setFormat("tablecellborderwidth",Co(s.borderwidth))),i&&(Zl(e,g),l=e,u=g,Gl.each("top middle bottom".split(" "),function(e){l.formatter.remove("valign"+e,{},u)})),r.halign&&Jl(e,g,r.halign),r.valign&&(f=e,d=g,(m=r.valign)&&f.formatter.apply("valign"+m,{},d))})}),o=0<et(Ze(c,function(e,t){return"scope"!==t&&"celltype"!==t})),a.each(function(t){return ic(e,t.dom,{structure:nt(c,"celltype"),style:o})}))},gu=function(e,t,n,r){var a=r.getData();r.close(),e.undoManager.transact(function(){mu(e,t,n,a),e.focus()})},hu=function(e,t){var n=du(t).map(function(t){return U(t,function(t){return n=e,r=t.element,a=pc(e),o=t.column,i=n.dom,c=o.getOr(r),oe({width:(s=function(e,t){return i.getStyle(e,t)||i.getAttrib(e,t)})(c,"width"),height:s(r,"height"),scope:i.getAttrib(r,"scope"),celltype:vo(r),"class":i.getAttrib(r,"class",""),halign:ou(n,r),valign:iu(n,r)},a?tu(i,r):{});var n,r,a,o,i,c,s})});return nu(n.getOrDie())},pu=function(t,n){var r,a,o,i=Rl(To(t),n);0!==i.length&&(r=hu(t,i),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:lu(t)},ru("cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:lu(t)}]},t.windowManager.open({title:"Cell Properties",size:"normal",body:pc(t)?a:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:e(gu,t,i,r)}))},yu=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],vu=function(e){return yu.concat((0<(t=Ql(e.getParam("table_row_class_list",[],"array"))).length?S.some({name:"class",type:"listbox",label:"Class",items:t}):S.none()).toArray());var t},bu=function(e,t,n,r){var a,o,i=1===t.length,c=Ze(r,function(e,t){return n[t]!==e});0<et(c)&&(V(t,function(t){r.type!==vo(t.parentNode)&&El(e,t,r.type);var a,o,c,s,l=i?fu.normal(e,t):fu.ifTruthy(e,t);o=r,(a=l).setAttrib("class",o["class"]),a.setStyle("height",Co(o.height)),yc(e)&&(s=r,(c=l).setStyle("background-color",s.backgroundcolor),c.setStyle("border-color",s.bordercolor),c.setStyle("border-style",s.borderstyle)),r.align!==n.align&&(Zl(e,t),Jl(e,t,r.align))}),a=nt(c,"type"),o=!a||1<et(c),yn(Fe.fromDom(t[0])).each(function(t){return ic(e,t.dom,{structure:a,style:o})}))},wu=function(e,t,n,r){var a=r.getData();r.close(),e.undoManager.transact(function(){bu(e,t,n,a),e.focus()})},ku=function(t){var n,r,a,o,i=Pl(To(t),Oo.selected);0!==i.length&&(n=U(i,function(e){return n=t,r=e.dom,a=yc(t),o=n.dom,oe({height:o.getStyle(r,"height")||o.getAttrib(r,"height"),"class":o.getAttrib(r,"class",""),type:zl(0,r),align:ou(n,r)},a?tu(o,r):{});var n,r,a,o}),r=nu(n),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:vu(t)},ru("row")]},o={type:"panel",items:[{type:"grid",columns:2,items:vu(t)}]},t.windowManager.open({title:"Row Properties",size:"normal",body:yc(t)?a:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:e(wu,t,U(i,function(e){return e.dom}),r)}))},_u=tinymce.util.Tools.resolve("tinymce.Env"),Cu=function(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)E(n)?e.setStyle(t,n,r):e.setStyle(t,n);else if(t.children)for(var a=0;a<t.children.length;a++)Cu(e,t.children[a],n,r)},xu=function(e,t,n,r){var a,o=e.dom,i=r.getData(),c=Ze(i,function(e,t){return n[t]!==e});r.close(),""===i["class"]&&delete i["class"],e.undoManager.transact(function(){var n,r,s,l;t||(n=parseInt(i.cols,10)||1,r=parseInt(i.rows,10)||1,t=Hl(e,n,r,0,0)),0<et(c)&&(function(e,t,n){var r,a=e.dom,o={},i={};if(o["class"]=n["class"],i.height=Co(n.height),a.getAttrib(t,"width")&&!bc(e)?o.width=(r=n.width)?r.replace(/px$/,""):"":i.width=Co(n.width),bc(e)?(i["border-width"]=Co(n.border),i["border-spacing"]=Co(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),bc(e)&&t.children)for(var c=0;c<t.children.length;c++)Cu(a,t.children[c],{"border-width":Co(n.border),padding:Co(n.cellpadding)}),vc(e)&&Cu(a,t.children[c],{"border-color":n.bordercolor});vc(e)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=a.serializeStyle(oe(oe({},hc(e)),i)),a.setAttribs(t,oe(oe({},gc(e)),o))}(e,t,i),(a=o.select("caption",t)[0])&&!i.caption&&o.remove(a),!a&&i.caption&&((a=o.create("caption")).innerHTML=_u.ie?"\xa0":'<br data-mce-bogus="1"/>',t.insertBefore(a,t.firstChild)),""===i.align?Zl(e,t):Jl(e,t,i.align)),e.focus(),e.addVisual(),0<et(c)&&(l=!(s=nt(c,"caption"))||1<et(c),ic(e,t,{structure:s,style:l}))})},zu=function(t,n){var r,a,o,i,c,s,l,u,f=t.dom,d=cu(t,vc(t));!1===n?(r=f.getParent(t.selection.getStart(),"table"))?(o=r,i=vc(a=t),u=a.dom,d=oe({width:u.getStyle(o,"width")||u.getAttrib(o,"width"),height:u.getStyle(o,"height")||u.getAttrib(o,"height"),cellspacing:u.getStyle(o,"border-spacing")||u.getAttrib(o,"cellspacing"),
cellpadding:u.getAttrib(o,"cellpadding")||Yl(a.dom,o,"padding"),border:(c=u,s=o,l=nn(Fe.fromDom(s),"border-width"),bc(a)&&l.isSome()?l.getOr(""):c.getAttrib(s,"border")||Yl(a.dom,s,"border-width")||Yl(a.dom,s,"border")),caption:!!u.select("caption",o)[0],"class":u.getAttrib(o,"class",""),align:ou(a,o)},i?tu(u,o):{})):vc(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""):(d.cols="1",d.rows="1",vc(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""));var m=Ql(t.getParam("table_class_list",[],"array"));0<m.length&&d["class"]&&(d["class"]=d["class"].replace(/\s*mce\-item\-table\s*/g,""));var g,h,p,y,v={type:"grid",columns:2,items:(g=m,h=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],p=t.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],y=0<g.length?[{type:"listbox",name:"class",label:"Class",items:g}]:[],h.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(p).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(y))},b=vc(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[v]},ru("table")]}:{type:"panel",items:[v]};t.windowManager.open({title:"Table Properties",size:"normal",body:b,onSubmit:e(xu,t,r,d),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d})},Su=function(e){return Ol(To(e))},Tu=function(e){return Al(To(e))},Nu=function(t,n,r,a,o){var i=_o(t),c=function(e){return yn(e,i)},s=function(e){return function(n){t.selection.setRng(n.rng),t.focus(),r.clear(e),xo(e),ic(t,e.dom,n.effect)}},l=function(e){return Tu(t).each(function(t){c(t).each(function(n){var r=Po(a,n,t);e(n,r).each(s(n))})})},u=function(){return Tu(t).map(function(e){return c(e).bind(function(n){var r=Po(a,n,e),o=ho(y,Fe.fromDom(t.getDoc()),S.none());return Kl(n,r,o)})})},f=function(){return Tu(t).map(function(e){return c(e).bind(function(t){var n=Po(a,t,e);return Xl(t,n)})})},d=function(e,n){return n().each(function(n){var r=U(n,Ar);Tu(t).each(function(n){return c(n).each(function(n){var o,i,c=po(Fe.fromDom(t.getDoc())),l=(o=r,i=c,{selection:No(a),clipboard:o,generators:i});e(n,l).each(s(n))})})})};Ge({mceTableSplitCells:function(){return l(n.unmergeCells)},mceTableMergeCells:function(){return l(n.mergeCells)},mceTableInsertRowBefore:function(){return l(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return l(n.insertRowsAfter)},mceTableInsertColBefore:function(){return l(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return l(n.insertColumnsAfter)},mceTableDeleteCol:function(){return l(n.deleteColumn)},mceTableDeleteRow:function(){return l(n.deleteRow)},mceTableCutCol:function(){return f().each(function(e){o.setColumns(e),l(n.deleteColumn)})},mceTableCutRow:function(){return u().each(function(e){o.setRows(e),l(n.deleteRow)})},mceTableCopyCol:function(){return f().each(function(e){return o.setColumns(e)})},mceTableCopyRow:function(){return u().each(function(e){return o.setRows(e)})},mceTablePasteColBefore:function(){return d(n.pasteColsBefore,o.getColumns)},mceTablePasteColAfter:function(){return d(n.pasteColsAfter,o.getColumns)},mceTablePasteRowBefore:function(){return d(n.pasteRowsBefore,o.getRows)},mceTablePasteRowAfter:function(){return d(n.pasteRowsAfter,o.getRows)},mceTableDelete:function(){return Su(t).each(function(e){yn(e,i).filter(w(i)).each(function(e){var n,r=Fe.fromText("");Gn(e,r),nr(e),t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):((n=t.dom.createRng()).setStart(r.dom,0),n.setEnd(r.dom,0),t.selection.setRng(n),t.nodeChanged())})})},mceTableSizingMode:function(e,n){return r=n,Su(t).each(function(e){_c(t)||kc(t)||wc(t)||yn(e,i).each(function(e){"relative"!==r||li(e)?"fixed"!==r||ui(e)?"responsive"!==r||fi(e)||Rc(e):Oc(t,e):Ac(t,e),xo(e),ic(t,e.dom,sc)})});var r}},function(e,n){return t.addCommand(n,e)});var m=function(e,t){t.each(function(t){ic(e,t.dom,sc)})};Ge({mceTableCellType:function(e,r){var a=yn(To(t),i);n.setTableCellType(t,r),m(t,a)},mceTableRowType:function(e,r){var a=yn(To(t),i);n.setTableRowType(t,r),m(t,a)}},function(e,n){return t.addCommand(n,e)}),t.addCommand("mceTableColType",function(e,t){return tt(t,"type").each(function(e){return l("th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader)})}),Ge({mceTableProps:e(zu,t,!1),mceTableRowProps:e(ku,t),mceTableCellProps:e(pu,t,a)},function(e,n){return t.addCommand(n,function(){return e()})}),t.addCommand("mceInsertTable",function(e,n){D(n)&&0<Xe(n).length?ql(t,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):zu(t,!0)}),t.addCommand("mceTableApplyCellStyle",function(e,n){var r,o,i=function(e){return"tablecell"+e.toLowerCase().replace("-","")};!D(n)||0!==(r=Rl(To(t),a)).length&&(function(e){for(var t in e)if(Ke.call(e,t))return!1;return!0}(o=Ze(n,function(e,n){return t.formatter.has(i(n))&&E(e)}))||(Ge(o,function(e,n){V(r,function(r){fu.normal(t,r.dom).setFormat(i(n),e)})}),c(r[0]).each(function(e){return ic(t,e.dom,cc)})))})},Eu=function(e,t,n){var r=_o(e);Ge({mceTableRowType:function(){return t.getTableRowType(e)},mceTableCellType:function(){return t.getTableCellType(e)},mceTableColType:function(){return Al(To(e)).bind(function(e){return yn(e,r).map(function(r){var a=Po(n,r,e);return t.getTableColType(r,a)})}).getOr("")}},function(t,n){return e.addQueryValueHandler(n,t)})},Du={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Au=_r([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Ou=oe(oe({},Au),{none:function(e){return void 0===e&&(e=void 0),Au.none(e)}}),Ru=function(e,t){return yn(e,t).bind(function(t){var n=hn(t);return G(n,function(t){return Ue(e,t)}).map(function(e){return{index:e,all:n}})})},Pu=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Lu=_r([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Bu={before:Lu.before,on:Lu.on,after:Lu.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(b,b,b)}},Mu=_r([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ju={domRange:Mu.domRange,relative:Mu.relative,exact:Mu.exact,exactFromRange:function(e){return Mu.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=e.match({domRange:function(e){return Fe.fromDom(e.startContainer)},relative:function(e){return Bu.getStart(e)},exact:function(e){return e}});return t=n,Fe.fromDom(bt(t).dom.defaultView)},range:Pu},Iu=function(e,t){return e.selectNodeContents(t.dom)},Fu=function(e,t,n){var r,a,o=e.document.createRange();return r=o,t.fold(function(e){r.setStartBefore(e.dom)},function(e,t){r.setStart(e.dom,t)},function(e){r.setStartAfter(e.dom)}),a=o,n.fold(function(e){a.setEndBefore(e.dom)},function(e,t){a.setEnd(e.dom,t)},function(e){a.setEndAfter(e.dom)}),o},Hu=function(e,t,n,r,a){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,a),o},qu=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Uu=_r([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Vu=function(e,t,n){return t(Fe.fromDom(n.startContainer),n.startOffset,Fe.fromDom(n.endContainer),n.endOffset)},$u=function(e,t){var n,r,a,o=(n=e,t.match({domRange:function(e){return{ltr:v(e),rtl:S.none}},relative:function(e,t){return{ltr:ie(function(){return Fu(n,e,t)}),rtl:ie(function(){return S.some(Fu(n,t,e))})}},exact:function(e,t,r,a){return{ltr:ie(function(){return Hu(n,e,t,r,a)}),rtl:ie(function(){return S.some(Hu(n,r,a,e,t))})}}}));return(a=(r=o).ltr()).collapsed?r.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Uu.rtl(Fe.fromDom(e.endContainer),e.endOffset,Fe.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Vu(0,Uu.ltr,a)}):Vu(0,Uu.ltr,a)},Wu=function(e,t){return $u(e,t).match({ltr:function(t,n,r,a){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,a),o},rtl:function(t,n,r,a){var o=e.document.createRange();return o.setStart(r.dom,a),o.setEnd(t.dom,n),o}})},Xu=(Uu.ltr,Uu.rtl,function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}),Ku=function(e,t,n,r,a){var o=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},i=or(t).length,c=function(e,t,n,r,a){if(0===a)return 0;if(t===r)return a-1;for(var o=r,i=1;a>i;i++){var c=e(i),s=Math.abs(t-c.left);if(n<=c.bottom){if(n<c.top||s>o)return i-1;o=s}}return 0}(function(e){return o(e).getBoundingClientRect()},n,r,a.right,i);return o(c)},Gu=function(e,t,n,r){return gt(t)?function(e,t,n,r){var a=e.dom.createRange();a.selectNode(t.dom);var o=a.getClientRects();return ae(o,function(e){return Xu(e,n,r)?S.some(e):S.none()}).map(function(a){return Ku(e,t,n,r,a)})}(e,t,n,r):(o=t,i=n,c=r,s=(a=e).dom.createRange(),l=xt(o),ae(l,function(e){return s.selectNode(e.dom),Xu(s.getBoundingClientRect(),i,c)?Gu(a,e,i,c):S.none()}));var a,o,i,c,s,l},Yu=function(e,t){return t-e.left<e.right-t},Ju=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},Zu=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var a=r.getBoundingClientRect(),o=Yu(a,n);return(!0===o?ao:oo)(t).map(function(t){return Ju(e,t,o)})},Qu=function(e,t,n){var r=t.dom.getBoundingClientRect(),a=Yu(r,n);return S.some(Ju(e,t,a))},ef=function(e,t,n){return S.from(e.dom.caretPositionFromPoint(t,n)).bind(function(t){if(null===t.offsetNode)return S.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),S.some(n)})},tf=function(e,t,n){return S.from(e.dom.caretRangeFromPoint(t,n))},nf=function(e,t,n,r){var a=e.dom.createRange();a.selectNode(t.dom);var o=a.getBoundingClientRect();return function(e,t,n,r){var a=e.dom.createRange();a.selectNode(t.dom);var o=a.getBoundingClientRect(),i=Math.max(o.left,Math.min(o.right,n)),c=Math.max(o.top,Math.min(o.bottom,r));return Gu(e,t,i,c)}(e,t,Math.max(o.left,Math.min(o.right,n)),Math.max(o.top,Math.min(o.bottom,r)))},rf=function(e,t,n){return Fe.fromPoint(e,t,n).bind(function(r){var a=function(){return n=e,o=t,(0===xt(a=r).length?Qu:Zu)(n,a,o);var n,a,o};return 0===xt(r).length?a():nf(e,r,t,n).orThunk(a)})},af=document.caretPositionFromPoint?ef:document.caretRangeFromPoint?tf:rf,of=function(e,t){var n=lt(e);return"input"===n?Bu.after(e):F(["br","img"],n)?0===t?Bu.before(e):Bu.after(e):Bu.on(e,t)},cf=function(e,t){var n=e.fold(Bu.before,of,Bu.after),r=t.fold(Bu.before,of,Bu.after);return ju.relative(n,r)},sf=function(e,t,n,r){var a=of(e,t),o=of(n,r);return ju.relative(a,o)},lf=function(e,t,n,r){var a,o,i,c,s,l=(o=t,i=n,c=r,(s=vt(a=e).dom.createRange()).setStart(a.dom,o),s.setEnd(i.dom,c),s),u=Ue(e,n)&&t===r;return l.collapsed&&!u},uf=function(e){return S.from(e.getSelection())},ff=function(e,t){uf(e).each(function(e){e.removeAllRanges(),e.addRange(t)})},df=function(e,t,n,r,a){var o=Hu(e,t,n,r,a);ff(e,o)},mf=function(e,t){return $u(e,t).match({ltr:function(t,n,r,a){df(e,t,n,r,a)},rtl:function(t,n,r,a){uf(e).each(function(o){if(o.setBaseAndExtent)o.setBaseAndExtent(t.dom,n,r.dom,a);else if(o.extend)try{s=t,l=n,u=r,f=a,(c=o).collapse(s.dom,l),c.extend(u.dom,f)}catch(i){df(e,r,a,t,n)}else df(e,r,a,t,n);var c,s,l,u,f})}})},gf=function(e,t,n,r,a){var o=sf(t,n,r,a);mf(e,o)},hf=function(e,t,n){var r=cf(t,n);mf(e,r)},pf=function(e){var t=ju.getWin(e).dom,n=function(e,n,r,a){return Hu(t,e,n,r,a)},r=e.match({domRange:function(e){var t=Fe.fromDom(e.startContainer),n=Fe.fromDom(e.endContainer);return sf(t,e.startOffset,n,e.endOffset)},relative:cf,exact:sf});return $u(t,r).match({ltr:n,rtl:n})},yf=function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return S.some(Pu(Fe.fromDom(t.startContainer),t.startOffset,Fe.fromDom(n.endContainer),n.endOffset))}return S.none()},vf=function(e){if(null===e.anchorNode||null===e.focusNode)return yf(e);var t=Fe.fromDom(e.anchorNode),n=Fe.fromDom(e.focusNode);return lf(t,e.anchorOffset,n,e.focusOffset)?S.some(Pu(t,e.anchorOffset,n,e.focusOffset)):yf(e)},bf=function(e,t){var n,r,a=(n=t,r=e.document.createRange(),Iu(r,n),r);ff(e,a)},wf=function(e){return uf(e).filter(function(e){return 0<e.rangeCount}).bind(vf).map(function(e){return ju.exact(e.start,e.soffset,e.finish,e.foffset)})},kf=function(e,t){var n,r,a,o=Wu(e,t);return r=(n=o).getClientRects(),0<(a=0<r.length?r[0]:n.getBoundingClientRect()).width||0<a.height?S.some(a).map(qu):S.none()},_f=function(e,t,n){return r=e,a=t,o=n,i=Fe.fromDom(r.document),af(i,a,o).map(function(e){return Pu(Fe.fromDom(e.startContainer),e.startOffset,Fe.fromDom(e.endContainer),e.endOffset)});var r,a,o,i},Cf=tinymce.util.Tools.resolve("tinymce.util.VK"),xf=function(e,t,n,r){return Tf(e,t,Ru(a=n,o).fold(function(){return Ou.none(a)},function(e){return e.index+1<e.all.length?Ou.middle(a,e.all[e.index+1]):Ou.last(a)}),r);var a,o},zf=function(e,t,n,r){return Tf(e,t,Ru(a=n,o).fold(function(){return Ou.none()},function(e){return 0<=e.index-1?Ou.middle(a,e.all[e.index-1]):Ou.first(a)}),r);var a,o},Sf=function(e,t){var n=ju.exact(t,0,t,0);return pf(n)},Tf=function(e,t,n,r){return n.fold(S.none,S.none,function(e,t){return ao(t).map(function(e){return Sf(0,e)})},function(n){return yn(n,t).bind(function(t){var a,o=Ro(n);return e.undoManager.transact(function(){r.insertRowsAfter(t,o)}),a=Mt(t,"tr"),re(a).bind(function(e){return Ht(e,"td,th").map(function(e){return Sf(0,e)})})})})},Nf=["table","li","dl"],Ef=function(e,t){return{selection:e,kill:t}},Df=function(e,t,n,r){return{start:Bu.on(e,t),finish:Bu.on(n,r)}},Af=function(e,t){var n=Wu(e,t);return Pu(Fe.fromDom(n.startContainer),n.startOffset,Fe.fromDom(n.endContainer),n.endOffset)},Of=Df,Rf=function(e,t,n,r,a){return Ue(n,r)?S.none():pr(n,r,t).bind(function(t){var r=t.boxes.getOr([]);return 0<r.length?(a(e,r,t.start,t.finish),S.some(Ef(S.some(Of(n,0,n,to(n))),!0))):S.none()})},Pf=function(e,t){return{item:e,mode:t}},Lf=function(e,t,n,r){return void 0===r&&(r=Bf),e.property().parent(t).map(function(e){return Pf(e,r)})},Bf=function(e,t,n,r){return void 0===r&&(r=Mf),n.sibling(e,t).map(function(e){return Pf(e,r)})},Mf=function(e,t,n,r){void 0===r&&(r=Mf);var a=e.property().children(t);return n.first(a).map(function(e){return Pf(e,r)})},jf=[{current:Lf,next:Bf,fallback:S.none()},{current:Bf,next:Mf,fallback:S.some(Lf)},{current:Mf,next:Mf,fallback:S.some(Bf)}],If=function(e,t,n,r,a){return void 0===a&&(a=jf),K(a,function(e){return e.current===n}).bind(function(n){return n.current(e,t,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return If(e,t,n,r)})})})},Ff=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return 0<e.length?S.some(e[e.length-1]):S.none()}}},Hf=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return 0<e.length?S.some(e[0]):S.none()}}},qf=function(e,t,n,r,a,o){return If(e,t,r,a).bind(function(t){return o(t.item)?S.none():n(t.item)?S.some(t.item):qf(e,t.item,n,t.mode,a,o)})},Uf=function(e){return function(t){return 0===e.property().children(t).length}},Vf=function(e,t,n,r){return qf(e,t,n,Bf,Ff(),r)},$f=function(e,t,n,r){return qf(e,t,n,Bf,Hf(),r)},Wf=r(),Xf=function(e,t){return Vf(n=Wf,e,Uf(n),t);var n},Kf=function(e,t){return $f(n=Wf,e,Uf(n),t);var n},Gf=_r([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Yf=function(e){return qt(e,"tr")},Jf=oe(oe({},Gf),{verify:function(e,t,n,r,a,o,i){return qt(r,"td,th",i).bind(function(n){return qt(t,"td,th",i).map(function(t){return Ue(n,t)?Ue(r,n)&&to(n)===a?o(t):Gf.none("in same cell"):gr(Yf,[n,t]).fold(function(){return a=t,i=n,c=(r=e).getRect(a),(s=r.getRect(i)).right>c.left&&s.left<c.right?Gf.success():o(t);var r,a,i,c,s},function(){return o(t)})})}).getOr(Gf.none("default"))},cata:function(e,t,n,r,a){return e.fold(t,n,r,a)}}),Zf=function(t,n){return G(t,e(Ue,n))},Qf=function(e){return"br"===lt(e)},ed=function(e,t,n){return t(e,n).bind(function(e){return gt(e)&&0===or(e).trim().length?ed(e,t,n):S.some(e)})},td=function(e,t,n,r){return zt(a=t,o=n).filter(Qf).orThunk(function(){return zt(a,o-1).filter(Qf)}).bind(function(t){return r.traverse(t).fold(function(){return ed(t,r.gather,e).map(r.relative)},function(e){return wt(t=e).bind(function(e){var n=xt(e);return Zf(n,t).map(function(r){return{parent:e,children:n,element:t,index:r}})}).map(function(e){return Bu.on(e.parent,e.index)});var t})});var a,o},nd=function(e,t,n,r){var a,o,i;return(Qf(t)?(a=e,o=t,(i=r).traverse(o).orThunk(function(){return ed(o,i.gather,a)}).map(i.relative)):td(e,t,n,r)).map(function(e){return{start:e,finish:e}})},rd=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},ad=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},od=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},id=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},cd=function(e,t){return S.some(e.getRect(t))},sd=function(e,t,n){return mt(t)?cd(e,t).map(id):gt(t)?(r=e,a=t,(0<=(o=n)&&o<to(a)?r.getRangedRect(a,o,a,o+1):o>0?r.getRangedRect(a,o-1,a,o):S.none()).map(id)):S.none();var r,a,o},ld=function(e,t){return mt(t)?cd(e,t).map(id):gt(t)?e.getRangedRect(t,0,t,to(t)).map(id):S.none()},ud=_r([{none:[]},{retry:["caret"]}]),fd=function(e,t,r){return n(function(e,t){return t(e)},jt,t,qs,a).fold(k,function(t){return ld(e,t).exists(function(e){return n=e,(t=r).left<n.left||Math.abs(n.right-t.left)<1||t.left>n.right;var t,n})});var a},dd={point:function(e){return e.bottom},adjuster:function(e,t,n,r,a){var o=rd(a,5);return Math.abs(n.bottom-r.bottom)<1||n.top>a.bottom?ud.retry(o):n.top===a.bottom?ud.retry(rd(a,1)):fd(e,t,a)?ud.retry(od(o,5,0)):ud.none()},move:rd,gather:Kf},md=function(e,t,n,r,a){return 0===a?S.some(r):(s=e,l=r.left,u=t.point(r),s.elementFromPoint(l,u).filter(function(e){return"table"===lt(e)}).isSome()?(i=r,c=a-1,md(e,o=t,n,o.move(i,5),c)):e.situsFromPoint(r.left,t.point(r)).bind(function(o){return o.start.fold(S.none,function(o){return ld(e,o).bind(function(i){return t.adjuster(e,o,i,n,r).fold(S.none,function(r){return md(e,t,n,r,a-1)})}).orThunk(function(){return S.some(r)})},S.none)}));var o,i,c,s,l,u},gd=function(e,t,n){var r,a,o,i=e.move(n,5),c=md(t,e,n,i,100).getOr(i);return a=c,o=t,((r=e).point(a)>o.getInnerHeight()?S.some(r.point(a)-o.getInnerHeight()):r.point(a)<0?S.some(-r.point(a)):S.none()).fold(function(){return t.situsFromPoint(c.left,e.point(c))},function(n){return t.scrollBy(0,n),t.situsFromPoint(c.left,e.point(c)-n)})},hd={tryUp:e(gd,{point:function(e){return e.top},adjuster:function(e,t,n,r,a){var o=ad(a,5);return Math.abs(n.top-r.top)<1||n.bottom<a.top?ud.retry(o):n.bottom===a.top?ud.retry(ad(a,1)):fd(e,t,a)?ud.retry(od(o,5,0)):ud.none()},move:ad,gather:Xf}),tryDown:e(gd,dd),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:v(5)},pd=function(e,t,n){return e.getSelection().bind(function(r){return nd(t,r.finish,r.foffset,n).fold(function(){return S.some(jc(r.finish,r.foffset))},function(a){var o,i=e.fromSitus(a),c=Jf.verify(e,r.finish,r.foffset,i.finish,i.foffset,n.failure,t);return o=c,Jf.cata(o,function(){return S.none()},function(){return S.none()},function(e){return S.some(jc(e,0))},function(e){return S.some(jc(e,to(e)))})})})},yd=function(e,t,n,r,a,o){return 0===o?S.none():wd(e,t,n,r,a).bind(function(i){var c=e.fromSitus(i),s=Jf.verify(e,n,r,c.finish,c.foffset,a.failure,t);return Jf.cata(s,function(){return S.none()},function(){return S.some(i)},function(i){return Ue(n,i)&&0===r?vd(e,n,r,ad,a):yd(e,t,i,0,a,o-1)},function(i){return Ue(n,i)&&r===to(i)?vd(e,n,r,rd,a):yd(e,t,i,to(i),a,o-1)})})},vd=function(e,t,n,r,a){return sd(e,t,n).bind(function(t){return bd(e,a,r(t,hd.getJumpSize()))})},bd=function(e,t,n){var r=je().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):S.none()},wd=function(e,t,n,r,a){return sd(e,n,r).bind(function(t){return bd(e,a,t)})},kd=function(e,t){return jt(e,function(e){return wt(e).exists(function(e){return Ue(e,t)})},n).isSome();var n},_d=function(e,t,n,r,a){return qt(r,"td,th",t).bind(function(r){return qt(r,"table",t).bind(function(o){return kd(a,o)?pd(i=e,c=t,s=n).bind(function(e){return yd(i,c,e.element,e.offset,s,20).map(i.fromSitus)}).bind(function(e){return qt(e.finish,"td,th",t).map(function(t){return{start:r,finish:t,range:e}})}):S.none();var i,c,s})})},Cd=function(e,t,n,r,a,o){return je().browser.isIE()?S.none():o(r,t).orThunk(function(){return _d(e,t,n,r,a).map(function(e){var t=e.range;return Ef(S.some(Of(t.start,t.soffset,t.finish,t.foffset)),!0)})})},xd=function(e,t){return qt(e,"tr",t).bind(function(e){return qt(e,"table",t).bind(function(n){var r=Mt(n,"tr");return Ue(e,r[0])?Vf(Wf,n,function(e){return oo(e).isSome()},t).map(function(e){var t=to(e);return Ef(S.some(Of(e,t,e,t)),!0)}):S.none()})})},zd=function(e,t){return qt(e,"tr",t).bind(function(e){return qt(e,"table",t).bind(function(n){var r=Mt(n,"tr");return Ue(e,r[r.length-1])?$f(Wf,n,function(e){return ao(e).isSome()},t).map(function(e){return Ef(S.some(Of(e,0,e,0)),!0)}):S.none()})})},Sd=function(e,t,n,r,a,o,i){return _d(e,n,r,a,o).bind(function(e){return Rf(t,n,e.start,e.finish,i)})},Td=function(e,t){return qt(e,"td,th",t)},Nd=function(e,t,n,r){var a,o=(a=Wa(S.none()),{clear:function(){return a.set(S.none())},set:function(e){return a.set(S.some(e))},isSet:function(){return a.get().isSome()},on:function(e){return a.get().each(e)}}),i=o.clear,c=function(a){o.on(function(o){r.clearBeforeUpdate(t),Td(a.target,n).each(function(a){pr(o,a,n).each(function(n){var i=n.boxes.getOr([]);(1<i.length||1===i.length&&!Ue(o,a))&&(r.selectRange(t,i,n.start,n.finish),e.selectContents(a))})})})};return{clearstate:i,mousedown:function(e){r.clear(t),Td(e.target,n).each(o.set)},mouseover:function(e){c(e)},mouseup:function(e){c(e),i()}}},Ed={traverse:Ct,gather:Kf,relative:Bu.before,otherRetry:hd.tryDown,ieRetry:hd.ieTryDown,failure:Jf.failedDown},Dd={traverse:_t,gather:Xf,relative:Bu.before,otherRetry:hd.tryUp,ieRetry:hd.ieTryUp,failure:Jf.failedUp},Ad=function(e){return function(t){return t===e}},Od=Ad(38),Rd=Ad(40),Pd=function(e){return e>=37&&40>=e},Ld={isBackward:Ad(37),isForward:Ad(39)},Bd={isBackward:Ad(39),isForward:Ad(37)},Md=function(e){return{elementFromPoint:function(t,n){return Fe.fromPoint(Fe.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,a){var o=ju.exact(t,n,r,a);return kf(e,o)},getSelection:function(){return wf(e).map(function(t){return Af(e,t)})},fromSitus:function(t){var n=ju.relative(t.start,t.finish);return Af(e,n)},situsFromPoint:function(t,n){return _f(e,t,n).map(function(e){return Df(e.start,e.soffset,e.finish,e.foffset)})},clearSelection:function(){uf(e).each(function(e){return e.removeAllRanges()})},collapseSelection:function(t){void 0===t&&(t=!1),wf(e).each(function(n){return n.fold(function(e){return e.collapse(t)},function(n,r){var a=t?n:r;hf(e,a,a)},function(n,r,a,o){var i=t?n:a,c=t?r:o;gf(e,i,c,i,c)})})},setSelection:function(t){gf(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){hf(e,t,n)},selectContents:function(t){bf(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,a;return(t=Fe.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,a=n.body.scrollTop||n.documentElement.scrollTop,Gr(r,a)).top},scrollBy:function(t,n){var r,a,o,i;r=t,a=n,o=Fe.fromDom(e.document),(i=(void 0!==o?o.dom:document).defaultView)&&i.scrollBy(r,a)}}},jd=function(e,t){return{rows:e,cols:t}},Id=function(t,n,r,a){var o=Md(t),i=function(){return a.clear(n),S.none()};return{keydown:function(t,c,s,l,u,f){var d=t.raw,m=d.which,g=!0===d.shiftKey;return yr(n,a.selectedSelector).fold(function(){return Rd(m)&&g?e(Sd,o,n,r,Ed,l,c,a.selectRange):Od(m)&&g?e(Sd,o,n,r,Dd,l,c,a.selectRange):Rd(m)?e(Cd,o,r,Ed,l,c,zd):Od(m)?e(Cd,o,r,Dd,l,c,xd):S.none},function(e){var t=function(t){return function(){return ae(t,function(t){return r=t.rows,o=t.cols,i=n,br(e,r,o,(c=a).firstSelectedSelector,c.lastSelectedSelector).map(function(e){return c.clearBeforeUpdate(i),c.selectRange(i,e.boxes,e.start,e.finish),e.boxes});var r,o,i,c}).fold(function(){return vr(n,a.firstSelectedSelector,a.lastSelectedSelector).map(function(e){var t=Rd(m)||f.isForward(m)?Bu.after:Bu.before;return o.setRelativeSelection(Bu.on(e.first,0),t(e.table)),a.clear(n),Ef(S.none(),!0)})},function(){return S.some(Ef(S.none(),!0))})}};return Rd(m)&&g?t([jd(1,0)]):Od(m)&&g?t([jd(-1,0)]):f.isBackward(m)&&g?t([jd(0,-1),jd(-1,0)]):f.isForward(m)&&g?t([jd(0,1),jd(1,0)]):Pd(m)&&0==g?i:S.none})()},keyup:function(e,t,o,i,c){return yr(n,a.selectedSelector).fold(function(){var s,l,u,f,d,m,g,h=e.raw,p=h.which;return 0!=(!0===h.shiftKey)&&Pd(p)?(s=n,l=r,u=t,f=o,d=i,m=c,g=a.selectRange,Ue(u,d)&&f===m?S.none():qt(u,"td,th",l).bind(function(e){return qt(d,"td,th",l).bind(function(t){return Rf(s,l,e,t,g)})})):S.none()},S.none)}}},Fd=function(e,t,n){var r=function(t){Kt(t,e.selected),Kt(t,e.firstSelected),Kt(t,e.lastSelected)},a=function(t){Vt(t,e.selected,"1")},o=function(e){i(e),n()},i=function(t){var n=Mt(t,e.selectedSelector);V(n,r)};return{clearBeforeUpdate:i,clear:o,selectRange:function(n,r,i,c){o(n),V(r,a),Vt(i,e.firstSelected,"1"),Vt(c,e.lastSelected,"1"),t(r,i,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Hd=function(e,t,n){var r=jn.fromTable(e);return os(r,t).map(function(e){var t,a,o,i,c,s,l,u,f,d=Jc(r,n,!1);return{upOrLeftCells:(t=e,a=n,o=d.slice(0,t[t.length-1].row+1),i=Qc(o,a),J(i,function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return U(n,function(e){return e.element})})),downOrRightCells:(s=e,l=n,u=(c=d).slice(s[0].row+s[0].rowspan-1,c.length),f=Qc(u,l),J(f,function(e){var t=e.cells.slice(s[0].column+s[0].colspan-1,e.cells.length);return U(t,function(e){return e.element})}))}})},qd=function(e){return!1===Bi(Fe.fromDom(e.target),"ephox-snooker-resizer-bar")},Ud=function(e){var t,n,r,o,i,c,s,l,u,f,d,m,g,h,p,y,v,b,w,k,_=(t=function(){return bo(e)},n=function(){return Ol(To(e))},r=Oo.selectedSelector,{get:function(){return wr(t(),r).fold(function(){return n().map(Tr).getOrThunk(zr)},function(e){return Sr(e)})}}),C=(o=e,i=_,c=Wa(S.none()),s=Wa([]),l=S.none(),u=yt("caption"),f=function(e){return l.forall(function(t){return!t[e]})},d=function(){return Ol(To(o)).bind(function(e){return yn(e).map(function(t){return u(e)?Ro(e):Po(i,t,e)})})},m=function(e){return yn(e.element).map(function(t){var n=jn.fromTable(t),r=os(n,e).getOr([]),a=X(r,function(e,t){return t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ls(n,e).isSome(),unmergeable:us(n,e).isSome(),locked:a}})},g=function(){c.set(ie(d)()),l=c.get().bind(m),V(s.get(),function(e){return e()})},h=function(e,t){var n=function(){return c.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})};return n(),s.set(s.get().concat([n])),function(){s.set($(s.get(),function(e){return e!==n}))}},p=function(e){return l.exists(function(t){return t.locked[e]})},o.on("NodeChange ExecCommand TableSelectorChange",g),{onSetupTable:function(e){return h(e,function(){return!1})},onSetupCellOrRow:function(e){return h(e,function(e){return u(e.element)})},onSetupColumn:function(e){return function(t){return h(t,function(t){return u(t.element)||p(e)})}},onSetupPasteable:function(e){return function(t){return h(t,function(t){return u(t.element)||e().isNone()})}},onSetupPasteableColumn:function(e,t){return function(n){return h(n,function(n){return u(n.element)||e().isNone()||p(t)})}},onSetupMergeable:function(e){return h(e,function(){return f("mergeable")})},onSetupUnmergeable:function(e){return h(e,function(){return f("unmergeable")})},resetTargets:g,targets:function(){return c.get()}}),x=Mc(e),z=a(e,x.lazyResize,C),T=Ll(e,x.lazyWire,_),N=(y=Wa(S.none()),v=Wa(S.none()),b=function(e){e.set(S.none())},{getRows:y.get,setRows:function(e){y.set(e),b(v)},clearRows:function(){return b(y)},getColumns:v.get,setColumns:function(e){v.set(e),b(y)},clearColumns:function(){return b(v)}});return Nu(e,T,z,_,N),Eu(e,T,_),Lo(e,_,T,z),function(e,t,n){var r=function(t){return function(){return e.execCommand(t)}},a=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},o={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onLast")}),e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){
return[{type:"fancymenuitem",fancytype:"inserttable",onAction:a}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",o),e.ui.registry.addMenuItem("deletetable",i),e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(function(){return""},function(e){return"caption"===lt(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}(e,C,N),function(e,t,n){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(e,C,N),0<(k=(w=e).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&w.ui.registry.addContextToolbar("table",{predicate:function(e){return w.dom.is(e,"table")&&w.getBody().contains(e)},items:k,scope:"node",position:"node"}),e.on("PreInit",function(){e.serializer.addTempAttr(Oo.firstSelected),e.serializer.addTempAttr(Oo.lastSelected),e.formatter.register(Du)}),e.getParam("table_tab_navigation",!0,"boolean")&&e.on("keydown",function(t){var n,r,a,o,i,c,s;r=e,a=T,(n=t).keyCode===Cf.TAB&&(o=bo(r),i=function(e){var t=lt(e);return Ue(e,o)||F(Nf,t)},(c=r.selection.getRng()).collapsed&&(s=Fe.fromDom(c.startContainer),gn(s,i).each(function(e){n.preventDefault(),(n.shiftKey?zf:xf)(r,i,e,a).each(function(e){r.selection.setRng(e)})})))}),e.on("remove",function(){x.destroy()}),$l(e,N,x,C)};Nr.add("table",Ud)}();