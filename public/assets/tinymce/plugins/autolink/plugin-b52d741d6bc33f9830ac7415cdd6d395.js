/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e,t){var n;return 0>t&&(t=0),3!==e.nodeType||(n=e.data.length)<t&&(t=n),t},r=function(e,t,r){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,n(t,r)):e.setStartBefore(t)},o=function(e,t,r){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,n(t,r)):e.setEndAfter(t)},i=function(e,t,n){var i,a,u,s,c,l,f,d=e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@(?!.*@))(.+)$/i),h=e.getParam("default_link_target",!1);if("A"!==e.selection.getNode().tagName){var p=e.selection.getRng().cloneRange();if(p.startOffset<5){if(!(c=p.endContainer.previousSibling)){if(!p.endContainer.firstChild||!p.endContainer.firstChild.nextSibling)return;c=p.endContainer.firstChild.nextSibling}if(l=c.length,r(p,c,l),o(p,c,l),p.endOffset<5)return;i=p.endOffset,a=c}else{if(3!==(a=p.endContainer).nodeType&&a.firstChild){for(;3!==a.nodeType&&a.firstChild;)a=a.firstChild;3===a.nodeType&&(r(p,a,0),o(p,a,a.nodeValue.length))}i=1===p.endOffset?2:p.endOffset-1-t}for(var m,g=i;r(p,a,i>=2?i-2:0),o(p,a,i>=1?i-1:0),--i," "!==(f=p.toString())&&""!==f&&160!==f.charCodeAt(0)&&i-2>=0&&f!==n;);(m=p.toString())===n||" "===m||160===m.charCodeAt(0)?(r(p,a,i),o(p,a,g),i+=1):(0===p.startOffset?r(p,a,0):r(p,a,i),o(p,a,g)),"."===(s=p.toString()).charAt(s.length-1)&&o(p,a,g-1);var v=(s=p.toString().trim()).match(d),y=e.getParam("link_default_protocol","http","string");v&&("www."===v[1]?v[1]=y+"://www.":/@$/.test(v[1])&&!/^mailto:/.test(v[1])&&(v[1]="mailto:"+v[1]),u=e.selection.getBookmark(),e.selection.setRng(p),e.execCommand("createlink",!1,v[1]+v[2]),!1!==h&&e.dom.setAttrib(e.selection.getNode(),"target",h),e.selection.moveToBookmark(u),e.nodeChanged())}},a=function(e){var n;e.on("keydown",function(t){13!==t.keyCode||i(e,-1,"")}),t.browser.isIE()?e.on("focus",function(){if(!n){n=!0;try{e.execCommand("AutoUrlDetect",!1,!0)}catch(t){}}}):(e.on("keypress",function(t){41!==t.keyCode||i(e,-1,"(")}),e.on("keyup",function(t){32!==t.keyCode||i(e,0,"")}))};e.add("autolink",function(e){a(e)})}();