/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";function e(e,t,n,r,a){return e(n,r)?b.some(n):T(a)&&a(n)?b.none():t(n,r,a)}var t,n,r,a,i,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=0,s=function(e,t,n){var r,a,i=e.editorUpload.blobCache,o=i.create((r="mceu",a=(new Date).getTime(),r+"_"+Math.floor(1e9*Math.random())+ ++c+String(a)),n,t);i.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},l=tinymce.util.Tools.resolve("tinymce.util.Promise"),u=tinymce.util.Tools.resolve("tinymce.Env"),f=tinymce.util.Tools.resolve("tinymce.util.Delay"),d=function(e){e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var t;t=e,new l(function(e){var n=document.createElement("input");n.type="file",n.accept="image/*",n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.opacity="0.001",document.body.appendChild(n),n.addEventListener("change",function(t){e(Array.prototype.slice.call(t.target.files))});var r=function(a){var i=function(){e([]),n.parentNode.removeChild(n)};u.os.isAndroid()&&"remove"!==a.type?f.setEditorTimeout(t,i,0):i(),t.off("focusin remove",r)};t.on("focusin remove",r),n.click()}).then(function(t){var n,r;0<t.length&&(n=t[0],r=n,new l(function(e){var t=new FileReader;t.onloadend=function(){e(t.result.split(",")[1])},t.readAsDataURL(r)}).then(function(t){s(e,t,n)}))})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var t,n,r,a,i,o;r=n=2,(t=e).plugins.table?t.plugins.table.insertTable(n,r):(i=n,o=r,(a=t).undoManager.transact(function(){a.insertContent(function(e,t){var n,r,a='<table data-mce-id="mce" style="width: 100%">';for(a+="<tbody>",r=0;t>r;r++){for(a+="<tr>",n=0;e>n;n++)a+="<td><br></td>";a+="</tr>"}return a+="</tbody>",a+="</table>"}(i,o));var e=a.dom.select("*[data-mce-id]")[0];e.removeAttribute("data-mce-id");var t=a.dom.select("td,th",e);a.selection.setCursorLocation(t[0],0)}))}})},m=function(e){return function(){return e}},g=m(!1),h=m(!0),p=function(){return y},y=(t=function(e){return e.isNone()},{fold:function(e){return e()},is:g,isSome:g,isNone:h,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(void 0),or:r,orThunk:n,map:p,each:function(){},bind:p,exists:g,forall:h,filter:p,equals:t,equals_:t,toArray:function(){return[]},toString:m("none()")}),v=function(e){var t=m(e),n=function(){return a},r=function(t){return t(e)},a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:h,isNone:g,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return v(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?a:y},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(g,function(t){return n(e,t)})}};return a},b={some:v,none:p,from:function(e){return null===e||void 0===e?y:v(e)}},w=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},k=function(e){return function(t){return typeof t===e}},_=w("string"),C=w("object"),x=w("array"),z=k("boolean"),S=(a=void 0,function(e){return a===e}),T=k("function"),N=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},E={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return N(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return N(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return N(n)},fromDom:N,fromPoint:function(e,t,n){return b.from(e.dom.elementFromPoint(t,n)).map(N)}},D=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},A=("undefined"!=typeof window||Function("return this;")(),function(e,t,n){for(var r=e.dom,a=T(n)?n:g;r.parentNode;){r=r.parentNode;var i=E.fromDom(r);if(t(i))return b.some(i);if(a(i))break}return b.none()}),O=function(e,t,n){return A(e,function(e){return D(e,t)},n)},R=(i=_,function(e,t,n){return function(e,t){if(!t(e))throw new Error("Default value doesn't match requested type.")}(n,i),function(e,t){if(x(e)||C(e))throw new Error("expected a string but found: "+e);return S(e)?t:z(e)?!1===e?"":t:e}(e.getParam(t,n),n)}),P=function(t){var n=R(t,"quickbars_insert_toolbar","quickimage quicktable");0<n.trim().length&&t.ui.registry.addContextToolbar("quickblock",{predicate:function(n){var r=E.fromDom(n),a=t.schema.getTextBlockElements(),i=function(e){return e.dom===t.getBody()};return e(D,O,r,"table",i).fold(function(){return e(function(e,t){return t(e)},A,r,function(e){return e.dom.nodeName.toLowerCase()in a&&t.dom.isEmpty(e.dom)},i).isSome()},g)},items:n,position:"line",scope:"editor"})},L=function(e){var t=function(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)},n=R(e,"quickbars_image_toolbar","alignleft aligncenter alignright");0<n.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:t,items:n,position:"node"});var r=R(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote");0<r.trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(n){return!t(n)&&!e.selection.isCollapsed()&&(r=n,"false"!==e.dom.getContentEditableParent(r));var r},items:r,position:"selection",scope:"editor"})};o.add("quickbars",function(e){d(e),P(e),L(e)})}();