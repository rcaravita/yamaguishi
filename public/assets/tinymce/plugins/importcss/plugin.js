/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),r=tinymce.util.Tools.resolve("tinymce.EditorManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=function(e){return e.getParam("importcss_selector_converter")},c=(e="array",function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}),s=Array.prototype.push,l=function(e,t){return function(e){for(var t=[],n=0,r=e.length;r>n;++n){if(!c(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);s.apply(t,e[n])}return t}(function(e,t){for(var n=e.length,r=new Array(n),a=0;n>a;a++){var i=e[a];r[a]=t(i,a)}return r}(e,t))},u=function(e){return"string"==typeof e?function(t){return-1!==t.indexOf(e)}:e instanceof RegExp?function(t){return e.test(t)}:e},f=function(e,t,n){var o=[],c={},s=function(t,c){var l,u,f,d=t.href;if(u=d,f=a.cacheSuffix,"string"==typeof u&&(u=u.replace("?"+f,"").replace("&"+f,"")),(d=u)&&n(d,c)&&!function(e,t){var n,a=!1!==(n=e.getParam("skin"))&&(n||"oxide");if(a){var i=e.getParam("skin_url"),o=i?e.documentBaseURI.toAbsolute(i):r.baseURL+"/skins/ui/"+a,c=r.baseURL+"/skins/content/";return t===o+"/content"+(e.inline?".inline":"")+".min.css"||-1!==t.indexOf(c)}return!1}(e,d)){i.each(t.imports,function(e){s(e,!0)});try{l=t.cssRules||t.rules}catch(m){}i.each(l,function(e){e.styleSheet?s(e.styleSheet,!0):e.selectorText&&i.each(e.selectorText.split(","),function(e){o.push(i.trim(e))})})}};i.each(e.contentCSS,function(e){c[e]=!0}),n=n||function(e,t){return t||c[e]};try{i.each(t.styleSheets,function(e){s(e)})}catch(l){}return o},d=function(e,t){var n,r=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(t);if(r){var a=r[1],o=r[2].substr(1).split(".").join(" "),c=i.makeMap("a,img");return r[1]?(n={title:t},e.schema.getTextBlockElements()[a]?n.block=a:e.schema.getBlockElements()[a]||c[a.toLowerCase()]?n.selector=a:n.inline=a):r[2]&&(n={inline:"span",title:t.substr(1),classes:o}),!1!==e.getParam("importcss_merge_classes")?n.classes=o:n.attributes={"class":o},n}},m=function(e,t){return null===t||!1!==e.getParam("importcss_exclusive")},g=function(e){e.on("init",function(){var t,r,a,c,s=(t=[],r=[],a={},{addItemToGroup:function(e,t){a[e]?a[e].push(t):(r.push(e),a[e]=[t])},addItem:function(e){t.push(e)},toFormats:function(){return l(r,function(e){var t=a[e];return 0===t.length?[]:[{title:e,items:t}]}).concat(t)}}),g={},h=u(e.getParam("importcss_selector_filter")),p=(c=e.getParam("importcss_groups"),i.map(c,function(e){return i.extend({},e,{original:e,selectors:{},filter:u(e.filter),item:{text:e.title,menu:[]}})})),y=function(t,r){if(v=t,w=g,!(m(e,b=r)?v in w:v in b.selectors)){h=t,y=g,m(e,p=r)?y[h]=!0:p.selectors[h]=!0;var a=(l=(s=e).plugins.importcss,u=t,((f=r)&&f.selector_converter?f.selector_converter:o(s)?o(s):function(){return d(s,u)}).call(l,u,f));if(a){var c=a.name||n.DOM.uniqueId();return e.formatter.register(c,a),i.extend({},{title:a.title,format:c})}}var s,l,u,f,h,p,y,v,b,w;return null};i.each(f(e,e.getDoc(),u(e.getParam("importcss_file_filter"))),function(e){var t,n,r,a;-1===e.indexOf(".mce-")&&(h&&!h(e)||(r=p,a=e,0<(t=i.grep(r,function(e){return!e.filter||e.filter(a)})).length?i.each(t,function(t){var n=y(e,t);n&&s.addItemToGroup(t.title,n)}):(n=y(e,null))&&s.addItem(n)))});var v=s.toFormats();e.fire("addStyleModifications",{items:v,replace:!e.getParam("importcss_append")})})};t.add("importcss",function(e){return g(e),t=e,{convertSelectorToFormat:function(e){return d(t,e)}};var t})}();