/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";function e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function t(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;n>t;t++)for(var o=arguments[t],i=0,c=o.length;c>i;i++,a++)r[a]=o[i];return r}function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=t.concat(n);return e.apply(null,a)}}function r(e,t,n,r,a){return e(n,r)?A.some(n):I(a)&&a(n)?A.none():t(n,r,a)}function a(e){var t=this;null!==this._state?ec(function(){var n,r=t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(a){return void e.reject(a)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)}):this._deferreds.push(e)}function o(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void rc(tc(t,e),tc(o,this),tc(i,this))}this._state=!0,this._value=e,c.call(this)}catch(n){i.call(this,n)}}function i(e){this._state=!1,this._value=e,c.call(this)}function c(){for(var e=0,t=this._deferreds;e<t.length;e++){var n=t[e];a.call(this,n)}this._deferreds=[]}function s(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function l(e){var t=Hm(Pd.sketch({dom:{classes:[Po("outer-container")].concat(e.classes)},containerBehaviours:Sa([Aa.config({alpha:Up,omega:Vp})])}));return qp(t)}function u(e){var t=l({classes:[Po("ios-container")]}),n=cp(),r=um(),a=sp(r),o=lp(),i=Np(function(){r.run(function(e){e.refreshStructure()})},e);return t.add(n.wrapper),t.add(o),t.add(i.component),{system:t,element:t.element,init:function(e){r.set(function(e){var t=jr("Getting IosWebapp schema",Jh,e);Uo(t.toolstrip,"width","100%"),Uo(t.container,"position","relative");var n=Hm(Gh(function(){t.setReadOnly(t.readOnlyOnInit()),a.enter()},t.translate));t.alloy.add(n);var r={show:function(){t.alloy.add(n)},hide:function(){t.alloy.remove(n)}},a=Ry(t,r);return{setReadOnly:t.setReadOnly,refreshStructure:a.refreshStructure,enter:a.enter,exit:a.exit,destroy:v}}(e))},exit:function(){r.run(function(e){ug.remove(o,a),e.exit()})},setToolbarGroups:function(e){var t=n.createGroups(e);n.setGroups(t)},setContextToolbar:function(e){var t=n.createGroups(e);n.setContextToolbar(t)},focusToolbar:function(){n.focus()},restoreToolbar:function(){n.restoreToolbar()},updateMode:function(e){dp(o,a,e,t.root)},socket:o,dropup:i}}var f,d,m,g,h,p,y=function(){return(y=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},v=function(){},b=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},w=function(e){return function(){return e}},k=function(e){return e},_=function(e){return function(t){return!e(t)}},x=function(e){return function(){throw new Error(e)}},C=function(e){return e()},z=w(!1),S=w(!0),T=function(e){var t,n=!1;return function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return n||(n=!0,t=e.apply(null,r)),t}},E=function(){return N},N=(f=function(e){return e.isNone()},{fold:function(e){return e()},is:z,isSome:z,isNone:S,getOr:m=function(e){return e},getOrThunk:d=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(void 0),or:m,orThunk:d,map:E,each:v,bind:E,exists:z,forall:S,filter:E,equals:f,equals_:f,toArray:function(){return[]},toString:w("none()")}),D=function(e){var t=w(e),n=function(){return a},r=function(t){return t(e)},a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:S,isNone:z,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return D(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?a:N},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(z,function(t){return n(e,t)})}};return a},A={some:D,none:E,from:function(e){return null===e||void 0===e?N:D(e)}},O=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},R=function(e){return function(t){return typeof t===e}},P=O("string"),M=O("object"),B=O("array"),L=R("boolean"),j=function(e){return!(null===(t=e)||void 0===t);var t},I=R("function"),F=R("number"),H=Array.prototype.slice,q=Array.prototype.indexOf,U=Array.prototype.push,V=function(e,t){return n=e,r=t,-1<q.call(n,r);var n,r},$=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return!0;return!1},W=function(e,t){for(var n=e.length,r=new Array(n),a=0;n>a;a++){var o=e[a];r[a]=t(o,a)}return r},X=function(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)},K=function(e,t){for(var n=[],r=0,a=e.length;a>r;r++){var o=e[r];t(o,r)&&n.push(o)}return n},G=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n)}(e,function(e){n=t(n,e)}),n},Y=function(e,t,n){return X(e,function(e){n=t(n,e)}),n},J=function(e,t){return function(e,t,n){for(var r=0,a=e.length;a>r;r++){var o=e[r];if(t(o,r))return A.some(o);if(n(o,r))break}return A.none()}(e,t,z)},Z=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return A.some(n);return A.none()},Q=function(e){for(var t=[],n=0,r=e.length;r>n;++n){if(!B(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);U.apply(t,e[n])}return t},ee=function(e,t){return Q(W(e,t))},te=function(e,t){for(var n=0,r=e.length;r>n;++n)if(!0!==t(e[n],n))return!1;return!0},ne=function(e){var t=H.call(e,0);return t.reverse(),t},re=function(e,t){return K(e,function(e){return!V(t,e)})},ae=function(e){return[e]},oe=function(e){return t=e,(n=0)<=n&&n<t.length?A.some(t[n]):A.none();var t,n},ie=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return A.none()},ce=function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return le(r(1),r(2))},se=function(){return le(0,0)},le=function(e,t){return{major:e,minor:t}},ue={nu:le,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?se():ce(e,n)},unknown:se},fe=function(e,t){var n=String(t).toLowerCase();return J(e,function(e){return e.search(n)})},de=function(e,t){return fe(e,t).map(function(e){var n=ue.detect(e.versionRegexes,t);return{current:e.name,version:n}})},me=function(e,t){return fe(e,t).map(function(e){var n=ue.detect(e.versionRegexes,t);return{current:e.name,version:n}})},ge=function(e,t){return e.replace(/\$\{([^{}]*)\}/g,function(e,n){var r,a=t[n];return"string"==(r=typeof a)||"number"==r?a.toString():e})},he=function(e,t){return-1!==e.indexOf(t)},pe=(g=/^\s+|\s+$/g,function(e){return e.replace(g,"")}),ye=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ve=function(e){return function(t){return he(t,e)}},be=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return he(e,"edge/")&&he(e,"chrome")&&he(e,"safari")&&he(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ye],search:function(e){return he(e,"chrome")&&!he(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return he(e,"msie")||he(e,"trident")}},{name:"Opera",versionRegexes:[ye,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ve("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ve("firefox")},{name:"Safari",versionRegexes:[ye,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(he(e,"safari")||he(e,"mobile/"))&&he(e,"applewebkit")}}],we=[{name:"Windows",search:ve("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return he(e,"iphone")||he(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ve("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ve("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ve("linux"),versionRegexes:[]},{name:"Solaris",search:ve("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ve("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ve("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ke={browsers:w(be),oses:w(we)},_e="Firefox",xe=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(_e),isSafari:r("Safari")}},Ce={unknown:function(){return xe({current:void 0,version:ue.unknown()})},nu:xe,edge:w("Edge"),chrome:w("Chrome"),ie:w("IE"),opera:w("Opera"),firefox:w(_e),safari:w("Safari")},ze="Windows",Se="Android",Te="Solaris",Ee="FreeBSD",Ne="ChromeOS",De=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(ze),isiOS:r("iOS"),isAndroid:r(Se),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(Te),isFreeBSD:r(Ee),isChromeOS:r(Ne)}},Ae={unknown:function(){return De({current:void 0,version:ue.unknown()})},nu:De,windows:w(ze),ios:w("iOS"),android:w(Se),linux:w("Linux"),osx:w("OSX"),solaris:w(Te),freebsd:w(Ee),chromeos:w(Ne)},Oe=function(e,t){var n,r,a,o,i,c,s,l,u,f,d,m,g=ke.browsers(),h=ke.oses(),p=de(g,e).fold(Ce.unknown,Ce.nu),y=me(h,e).fold(Ae.unknown,Ae.nu);return{browser:p,os:y,deviceType:(r=p,a=e,o=t,i=(n=y).isiOS()&&!0===/ipad/i.test(a),c=n.isiOS()&&!i,s=n.isiOS()||n.isAndroid(),l=s||o("(pointer:coarse)"),u=i||!c&&s&&o("(min-device-width:768px)"),f=c||s&&!u,d=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(a),m=!f&&!u&&!d,{isiPad:w(i),isiPhone:w(c),isTablet:w(u),isPhone:w(f),isTouch:w(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:w(d),isDesktop:w(m)})}},Re=function(e){return window.matchMedia(e).matches},Pe=T(function(){return Oe(navigator.userAgent,Re)}),Me=function(){return Pe()},Be=w,Le=Be("touchstart"),je=Be("touchmove"),Ie=Be("touchend"),Fe=Be("mousedown"),He=Be("mousemove"),qe=Be("mouseup"),Ue=Be("mouseover"),Ve=Be("keydown"),$e=Be("keyup"),We=Be("input"),Xe=Be("change"),Ke=Be("click"),Ge=Be("transitionend"),Ye=Be("selectstart"),Je=function(e){return w("alloy."+e)},Ze={tap:Je("tap")},Qe=Je("focus"),et=Je("blur.post"),tt=Je("paste.post"),nt=Je("receive"),rt=Je("execute"),at=Je("focus.item"),ot=Ze.tap,it=Je("longpress"),ct=Je("system.init"),st=Je("system.attached"),lt=Je("system.detached"),ut=Je("focusmanager.shifted"),ft=Je("highlight"),dt=Je("dehighlight"),mt=function(e,t){yt(e,e.element,t,{})},gt=function(e,t,n){yt(e,e.element,t,n)},ht=function(e){mt(e,rt())},pt=function(e,t,n){yt(e,t,n,{})},yt=function(e,t,n,r){var a=y({target:t},r);e.getSystem().triggerEvent(n,t,a)},vt=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},bt={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return vt(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return vt(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return vt(n)},fromDom:vt,fromPoint:function(e,t,n){return A.from(e.dom.elementFromPoint(t,n)).map(vt)}},wt=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},kt=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},_t=function(e,t){var n=void 0===t?document:t.dom;return kt(n)?[]:W(n.querySelectorAll(e),bt.fromDom)},xt=function(e,t){var n=void 0===t?document:t.dom;return kt(n)?A.none():A.from(n.querySelector(e)).map(bt.fromDom)},Ct=function(e,t){return e.dom===t.dom},zt=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),St=function(e){return function(t){return t.dom.nodeType===e}},Tt=St(1),Et=St(3),Nt=St(9),Dt=St(11),At=function(e){return bt.fromDom(e.dom.ownerDocument)},Ot=function(e){return Nt(e)?e:At(e)},Rt=function(e){return A.from(e.dom.parentNode).map(bt.fromDom)},Pt=function(e){return W(e.dom.childNodes,bt.fromDom)},Mt=function(e,t){var n=e.dom.childNodes;return A.from(n[t]).map(bt.fromDom)},Bt=function(e,t){Rt(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Lt=function(e,t){var n;(n=e,A.from(n.dom.nextSibling).map(bt.fromDom)).fold(function(){Rt(e).each(function(e){It(e,t)})},function(e){Bt(e,t)})},jt=function(e,t){Mt(e,0).fold(function(){It(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},It=function(e,t){e.dom.appendChild(t.dom)},Ft=function(e,t){X(t,function(t){It(e,t)})},Ht=function(e){e.dom.textContent="",X(Pt(e),function(e){qt(e)})},qt=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Ut=function(e){return Dt(e)&&j(e.dom.host)},Vt=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode),$t=w(Vt),Wt=Vt?function(e){return bt.fromDom(e.dom.getRootNode())}:Ot,Xt=function(e){return bt.fromDom(e.dom.host)},Kt=function(e){return j(e.dom.shadowRoot)},Gt=function(e){var t=Et(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n,r,a,o,i=t.ownerDocument;return a=bt.fromDom(t),o=Wt(a),(Ut(o)?A.some(o):A.none()).fold(function(){return i.body.contains(t)},(n=Gt,r=Xt,function(e){return n(r(e))}))},Yt=function(){return Jt(bt.fromDom(document))},Jt=function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return bt.fromDom(t)},Zt=function(e){mt(e,lt());var t=e.components();X(t,Zt)},Qt=function(e){var t=e.components();X(t,Qt),mt(e,st())},en=function(e,t){It(e.element,t.element)},tn=function(e,t){var n,r=e.components();X((n=e).components(),function(e){return qt(e.element)}),Ht(n.element),n.syncComponents();var a=re(r,t);X(a,function(t){Zt(t),e.getSystem().removeFromWorld(t)}),X(t,function(t){t.getSystem().isConnected()?en(e,t):(e.getSystem().addToWorld(t),en(e,t),Gt(e.element)&&Qt(t)),e.syncComponents()})},nn=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),Gt(e.element)&&Qt(t),e.syncComponents()},rn=function(e){var t,n=Rt(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()});Zt(t=e),qt(t.element),t.getSystem().removeFromWorld(t),n.each(function(e){e.syncComponents()})},an=function(e,t,n){n(e,t.element);var r=Pt(t.element);X(r,function(e){t.getByDom(e).each(Qt)})},on=Object.keys,cn=Object.hasOwnProperty,sn=function(e,t){for(var n=on(e),r=0,a=n.length;a>r;r++){var o=n[r];t(e[o],o)}},ln=function(e,t){return un(e,function(e,n){return{k:n,v:t(e,n)}})},un=function(e,t){var n={};return sn(e,function(e,r){var a=t(e,r);n[a.k]=a.v}),n},fn=function(e,t){var n,r,a,o,i={};return n=t,o=i,r=function(e,t){o[t]=e},a=v,sn(e,function(e,t){(n(e,t)?r:a)(e,t)}),i},dn=function(e,t){var n=[];return sn(e,function(e,r){n.push(t(e,r))}),n},mn=function(e,t){return gn(e,t)?A.from(e[t]):A.none()},gn=function(e,t){return cn.call(e,t)},hn=function(e,t){return gn(e,t)&&void 0!==e[t]&&null!==e[t]},pn=function(e,t,n){if(!(P(n)||L(n)||F(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},yn=function(e,t,n){pn(e.dom,t,n)},vn=function(e,t){var n=e.dom;sn(t,function(e,t){pn(n,t,e)})},bn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},wn=function(e,t){return A.from(bn(e,t))},kn=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},_n=function(e,t){e.dom.removeAttribute(t)},xn=function(e,t){var n=bn(e,t);return void 0===n||""===n?[]:n.split(" ")},Cn=function(e){return void 0!==e.dom.classList},zn=function(e,t){return a=t,o=xn(n=e,r="class").concat([a]),yn(n,r,o.join(" ")),!0;var n,r,a,o},Sn=function(e,t){return a=t,0<(o=K(xn(n=e,r="class"),function(e){return e!==a})).length?yn(n,r,o.join(" ")):_n(n,r),!1;var n,r,a,o},Tn=function(e,t){Cn(e)?e.dom.classList.add(t):zn(e,t)},En=function(e){0===(Cn(e)?e.dom.classList:xn(e,"class")).length&&_n(e,"class")},Nn=function(e,t){Cn(e)?e.dom.classList.remove(t):Sn(e,t),En(e)},Dn=function(e,t){return Cn(e)&&e.dom.classList.contains(t)},An=function(e,t,n){Nn(e,n),Tn(e,t)},On=Object.freeze({__proto__:null,toAlpha:function(e,t){An(e.element,t.alpha,t.omega)},toOmega:function(e,t){An(e.element,t.omega,t.alpha)},isAlpha:function(e,t){return Dn(e.element,t.alpha)},isOmega:function(e,t){return Dn(e.element,t.omega)},clear:function(e,t){Nn(e.element,t.alpha),Nn(e.element,t.omega)}}),Rn=function(e){return{is:function(t){return e===t},isValue:S,isError:z,getOr:w(e),getOrThunk:w(e),getOrDie:w(e),or:function(){return Rn(e)},orThunk:function(){return Rn(e)},fold:function(t,n){return n(e)},map:function(t){return Rn(t(e))},mapError:function(){return Rn(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return A.some(e)}}},Pn=function(e){return{is:z,isValue:z,isError:S,getOr:k,getOrThunk:function(e){return e()},getOrDie:function(){return x(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t){return t(e)},map:function(){return Pn(e)},mapError:function(t){return Pn(t(e))},each:v,bind:function(){return Pn(e)},exists:z,forall:S,toOptional:A.none}},Mn={value:Rn,error:Pn,fromOption:function(e,t){return e.fold(function(){return Pn(t)},Rn)}};(p=h=h||{})[p.Error=0]="Error",p[p.Value=1]="Value";var Bn,Ln,jn,In,Fn,Hn=function(e,t,n){return e.stype===h.Error?t(e.serror):n(e.svalue)},qn=function(e){return{stype:h.Value,svalue:e}},Un=function(e){return{stype:h.Error,serror:e}},Vn=function(e){return e.fold(Un,qn)},$n=function(e){return Hn(e,Mn.error,Mn.value)},Wn=qn,Xn=function(e){var t=[],n=[];return X(e,function(e){Hn(e,function(e){return n.push(e)},function(e){return t.push(e)})}),{values:t,errors:n}},Kn=Un,Gn=function(e,t){return e.stype===h.Value?t(e.svalue):e},Yn=function(e,t){return e.stype===h.Error?t(e.serror):e},Jn=function(e,t){return e.stype===h.Value?{stype:h.Value,svalue:t(e.svalue)}:e},Zn=function(e,t){return e.stype===h.Error?{stype:h.Error,serror:t(e.serror)}:e},Qn=function(e){if(!B(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return X(e,function(r,a){var o=on(r);if(1!==o.length)throw new Error("one and only one name per case");var i=o[0],c=r[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!B(c))throw new Error("case arguments must be an array");t.push(i),n[i]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+o);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[a].apply(null,n)},match:function(e){var r=on(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!te(t,function(e){return V(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},er=Object.prototype.hasOwnProperty,tr=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},a=0;a<t.length;a++){var o=t[a];for(var i in o)er.call(o,i)&&(r[i]=e(r[i],o[i]))}return r}},nr=tr(function(e,t){return M(e)&&M(t)?nr(e,t):t}),rr=tr(function(e,t){return t}),ar=Qn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),or=function(e){return ar.defaultedThunk(w(e))},ir=ar.strict,cr=ar.asOption,sr=ar.defaultedThunk,lr=(ar.asDefaultedOptionThunk,ar.mergeWithThunk),ur=(Qn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e,t){var n={};return n[e]=t,n}),fr=function(e,t){return n=t,r={},sn(e,function(e,t){V(n,t)||(r[t]=e)}),r;var n,r},dr=ur,mr=function(e){return t={},X(e,function(e){t[e.key]=e.value}),t;var t},gr=function(e,t){var n,r,a,o,i,c=(n=[],r=[],X(e,function(e){e.fold(function(e){n.push(e)},function(e){r.push(e)})}),{errors:n,values:r});return 0<c.errors.length?(i=c.errors,Mn.error(Q(i))):(o=t,0===(a=c.values).length?Mn.value(o):Mn.value(nr(o,rr.apply(void 0,a))))},hr=function(e){return b(Kn,Q)(e)},pr=function(e,t){var n,r,a=Xn(e);return 0<a.errors.length?hr(a.errors):(n=a.values,r=t,Wn(0<n.length?nr(r,rr.apply(void 0,n)):r))},yr=function(e){var t=Xn(e);return 0<t.errors.length?hr(t.errors):Wn(t.values)},vr=function(e){return M(e)&&100<on(e).length?" removed due to size":JSON.stringify(e,null,2)},br=function(e,t){return Kn([{path:e,getErrorInfo:t}])},wr=Qn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),kr=function(e,t,n){return mn(t,n).fold(function(){return r=n,a=t,br(e,function(){return'Could not find valid *strict* value for "'+r+'" in '+vr(a)});var r,a},Wn)},_r=function(e,t,n){var r=mn(e,t).fold(function(){return n(e)},k);return Wn(r)},xr=function(e,t,n,r){return n.fold(function(n,a,o,i){var c=function(t){var o=i.extract(e.concat([n]),r,t);return Jn(o,function(e){return ur(a,r(e))})},s=function(t){return t.fold(function(){var e=ur(a,r(A.none()));return Wn(e)},function(t){var o=i.extract(e.concat([n]),r,t);return Jn(o,function(e){return ur(a,r(A.some(e)))})})};return o.fold(function(){return Gn(kr(e,t,n),c)},function(e){return Gn(_r(t,n,e),c)},function(){return Gn(Wn(mn(t,n)),s)},function(e){return Gn((a=e,o=mn(r=t,n).map(function(e){return!0===e?a(r):e}),Wn(o)),s);var r,a,o},function(e){var r=e(t),a=Jn(_r(t,n,w({})),function(e){return nr(r,e)});return Gn(a,c)})},function(e,n){var a=n(t);return Wn(ur(e,r(a)))})},Cr=function(e){return{extract:function(t,n,r){return Yn(e(r,n),function(e){return n=e,br(t,function(){return n});var n})},toString:function(){return"val"}}},zr=function(e){var t=Sr(e),n=G(e,function(e,t){return t.fold(function(t){return nr(e,dr(t,!0))},w(e))},{});return{extract:function(e,r,a){var o,i=L(a)?[]:on(fn(a,function(e){return void 0!==e&&null!==e})),c=K(i,function(e){return!hn(n,e)});return 0===c.length?t.extract(e,r,a):(o=c,br(e,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:t.toString}},Sr=function(e){return{extract:function(t,n,r){return a=t,o=r,i=n,c=W(e,function(e){return xr(a,o,e,i)}),pr(c,{});var a,o,i,c},toString:function(){return"obj{\n"+W(e,function(e){return e.fold(function(e,t,n,r){return e+" -> "+r.toString()},function(e){return"state("+e+")"})}).join("\n")+"}"}}},Tr=function(e,t){var n=function(t,n){return r=Cr(e),function(e,t,n){var a=W(n,function(n,a){return r.extract(e.concat(["["+a+"]"]),t,n)});return yr(a)}(t,k,n);var r};return{extract:function(e,r,a){var o=on(a),i=n(e,o);return Gn(i,function(n){var o=W(n,function(e){return wr.field(e,e,ir(),t)});return Sr(o).extract(e,r,a)})},toString:function(){return"setOf("+t.toString()+")"}}},Er=w(Cr(Wn)),Nr=wr.state,Dr=wr.field,Ar=function(e,t,n,r,a){return mn(r,a).fold(function(){return t=r,n=a,br(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+vr(t)});var t,n},function(r){return r.extract(e.concat(["branch: "+a]),t,n)})},Or=function(e,t){return{extract:function(n,r,a){return mn(a,e).fold(function(){return t=e,br(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(e){return Ar(n,r,a,t,e)})},toString:function(){return"chooseOn("+e+"). Possible values: "+on(t)}}},Rr=Cr(Wn),Pr=function(e){return Cr(function(t){return e(t).fold(Kn,Wn)})},Mr=function(e,t){return Tr(function(t){return Vn(e(t))},t)},Br=function(e,t,n){return $n((r=e,a=k,o=n,i=t.extract([r],a,o),Zn(i,function(e){return{input:o,errors:e}})));var r,a,o,i},Lr=function(e){return e.fold(function(e){throw new Error(Ir(e))},k)},jr=function(e,t,n){return Lr(Br(e,t,n))},Ir=function(e){return"Errors: \n"+(t=e.errors,n=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,W(n,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()}).join("\n"))+"\n\nInput object: "+vr(e.input);var t,n},Fr=function(e,t){return Or(e,ln(t,Sr))},Hr=w(Rr),qr=(Bn=I,Ln="function",Cr(function(e){var t=typeof e;return Bn(e)?Wn(e):Kn("Expected type: "+Ln+" but got: "+t)})),Ur=function(e){return Dr(e,e,ir(),Er())},Vr=function(e,t){return Dr(e,e,ir(),t)},$r=function(e,t){return Dr(e,e,ir(),Sr(t))},Wr=function(e){return Dr(e,e,cr(),Er())},Xr=function(e,t){return Dr(e,e,cr(),t)},Kr=function(e,t){return Xr(e,Sr(t))},Gr=function(e,t){return Xr(e,zr(t))},Yr=function(e,t){return Dr(e,e,or(t),Er())},Jr=function(e,t,n){return Dr(e,e,or(t),n)},Zr=function(e,t){return Nr(e,t)},Qr=[Ur("alpha"),Ur("omega")],ea=function(e){return I(e)?e:z},ta=function(e,t,n){var r=t(e),a=ea(n);return r.orThunk(function(){return a(e)?A.none():function(e,t,n){for(var r=e.dom,a=ea(n);r.parentNode;){r=r.parentNode;var o=bt.fromDom(r),i=t(o);if(i.isSome())return i;if(a(o))break}return A.none()}(e,t,a)})},na=function(e,t){return Ct(e.element,t.event.target)},ra=function(e){if(!hn(e,"can")&&!hn(e,"abort")&&!hn(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return jr("Extracting event.handler",zr([Yr("can",S),Yr("abort",z),Yr("run",v)]),e)},aa=function(e){var t,n,r,a,o=(n=function(e){return e.can},function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Y(t,function(t,r){return t&&n(r).apply(void 0,e)},!0)}),i=(r=t=e,a=function(e){return e.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Y(r,function(t,n){return t||a(n).apply(void 0,e)},!1)});return ra({can:o,abort:i,run:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];X(e,function(e){e.run.apply(void 0,t)})}})},oa=mr,ia=function(e,t){return{key:e,value:ra({abort:t})}},ca=function(e,t){return{key:e,value:ra({run:t})}},sa=function(e,t,n){return{key:e,value:ra({run:function(e,r){t.apply(void 0,[e,r].concat(n))}})}},la=function(e){return function(t){return{key:e,value:ra({run:function(e,n){na(e,n)&&t(e,n)}})}}},ua=function(e,t){return ca(e,function(n,r){n.getSystem().getByUid(t).each(function(t){var n,a,o,i;a=(n=t).element,o=e,i=r,n.getSystem().triggerEvent(o,a,i.event)})})},fa=function(e,t,n){var r=t.partUids[n];return ua(e,r)},da=function(e){return ca(e,function(e,t){t.cut()})},ma=la(st()),ga=la(lt()),ha=la(ct()),pa=(jn=rt(),function(e){return ca(jn,e)}),ya=function(e){return W(e,function(e){return r=t="/*",a=(n=e).length-t.length,""===r||n.length>=r.length&&n.substr(a,a+r.length)===r?e.substring(0,e.length-"/*".length):e;var t,n,r,a})},va=function(e,t){var n=e.toString(),r=n.indexOf(")")+1,a=n.indexOf("("),o=n.substring(a+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:ya(o)}},e},ba=function(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}},wa=function(e,t,n){return ha(function(r){n(r,e,t)})},ka=function(e,t,n){var r,a,o,i,c,s;return r=function(r){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var i=[r].concat(a);return r.config({name:w(e)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+n)},function(e){var n=Array.prototype.slice.call(i,1);return t.apply(void 0,[r,e.config,e.state].concat(n))})},a=n,o=t.toString(),i=o.indexOf(")")+1,c=o.indexOf("("),s=o.substring(c+1,i-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:a,parameters:ya(s.slice(0,1).concat(s.slice(3)))}},r},_a=function(e){return{key:e,value:void 0}},xa=function(e,t,r,a,o,i,c){var s=function(e){return hn(e,r)?e[r]():A.none()},l=ln(o,function(e,t){return ka(r,e,t)}),u=ln(i,va),f=y(y(y({},u),l),{revoke:n(_a,r),config:function(t){var n=jr(r+"-config",e,t);return{key:r,value:{config:n,me:f,configAsRaw:T(function(){return jr(r+"-config",e,t)}),initialConfig:t,state:c}}},schema:w(t),exhibit:function(e,t){return s(e).bind(function(e){return mn(a,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(ba({}))},name:w(r),handlers:function(e){return s(e).map(function(e){return mn(a,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return f},Ca={init:function(){return za({readState:function(){return"No State required"}})}},za=function(e){return e},Sa=mr,Ta=zr([Ur("fields"),Ur("name"),Yr("active",{}),Yr("apis",{}),Yr("state",Ca),Yr("extra",{})]),Ea=function(e){var t,n,r,a,o,i,c,s,l=jr("Creating behaviour: "+e.name,Ta,e);return t=l.fields,n=l.name,r=l.active,a=l.apis,o=l.extra,i=l.state,c=zr(t),s=Kr(n,[Gr("config",t)]),xa(c,s,n,r,a,o,i)},Na=zr([Ur("branchKey"),Ur("branches"),Ur("name"),Yr("active",{}),Yr("apis",{}),Yr("state",Ca),Yr("extra",{})]),Da=w(void 0),Aa=Ea({fields:Qr,name:"swapping",apis:On}),Oa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Ra=function(e){return e.dom.focus()},Pa=function(e){return e.dom.blur()},Ma=function(e){return void 0===e&&(e=bt.fromDom(document)),A.from(e.dom.activeElement).map(bt.fromDom)},Ba=function(e){return Ma(Wt(e)).filter(function(t){return e.dom.contains(t.dom)})},La=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ja=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Ia=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Fa=["undo","bold","italic","link","image","bullist","styleselect"],Ha="formatChanged",qa="orientationChanged",Ua="dropupDismissed",Va=function(e){return e.dom.innerHTML},$a=function(e,t){var n,r,a=At(e).dom,o=bt.fromDom(a.createDocumentFragment()),i=(n=t,(r=(a||document).createElement("div")).innerHTML=n,Pt(bt.fromDom(r)));Ft(o,i),Ht(e),It(e,o)},Wa=function(e){return t=e,n=!1,bt.fromDom(t.dom.cloneNode(n));var t,n},Xa=function(e){if(Ut(e))return"#shadow-root";var t,n,r,a=Wa(e);return t=a,n=bt.fromTag("div"),r=bt.fromDom(t.dom.cloneNode(!0)),It(n,r),Va(n)},Ka=Object.freeze({__proto__:null,events:function(e){return oa([ca(nt(),function(t,n){var r,a,o=e.channels,i=on(o),c=n,s=(r=i,(a=c).universal?r:K(r,function(e){return V(a.channels,e)}));X(s,function(e){var n=o[e],r=n.schema,a=jr("channel["+e+"] data\nReceiver: "+Xa(t.element),r,c.data);n.onReceive(t,a)})})])}}),Ga="unknown";(Fn=In=In||{})[Fn.STOP=0]="STOP",Fn[Fn.NORMAL=1]="NORMAL",Fn[Fn.LOGGING=2]="LOGGING";
var Ya,Ja,Za,Qa=Oa({}),eo=["alloy/data/Fields","alloy/debugging/Debugging"],to=function(e,t,n){var r,a,o,i;switch(mn(Qa.get(),e).orThunk(function(){var t=on(Qa.get());return ie(t,function(t){return-1<e.indexOf(t)?A.some(Qa.get()[t]):A.none()})}).getOr(In.NORMAL)){case In.NORMAL:return n(no());case In.LOGGING:var c=(r=e,a=t,o=[],i=(new Date).getTime(),{logEventCut:function(e,t,n){o.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){o.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){o.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){o.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){o.push({outcome:"response",purpose:n,target:t})},write:function(){var e=(new Date).getTime();V(["mousemove","mouseover","mouseout",ct()],r)||console.log(r,{event:r,time:e-i,target:a.dom,sequence:W(o,function(e){return V(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Xa(e.target)+")":e.outcome})})}}),s=n(c);return c.write(),s;case In.STOP:return!0}},no=w({logEventCut:v,logEventStopped:v,logNoParent:v,logEventNoHandlers:v,logEventResponse:v,write:v}),ro=w([Ur("menu"),Ur("selectedMenu")]),ao=w([Ur("item"),Ur("selectedItem")]),oo=(w(Sr(ao().concat(ro()))),w(Sr(ao()))),io=$r("initSize",[Ur("numColumns"),Ur("numRows")]),co=function(e,t,n){return!function(){var e=new Error;if(void 0!==e.stack){var t=e.stack.split("\n");J(t,function(e){return 0<e.indexOf("alloy")&&!$(eo,function(t){return-1<e.indexOf(t)})}).getOr(Ga)}}(),Dr(t,t,n,Pr(function(e){return Mn.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)})}))},so=function(e){return co(0,e,or(v))},lo=function(e){return co(0,e,or(A.none))},uo=function(e){return co(0,e,ir())},fo=function(e){return co(0,e,ir())},mo=function(e,t){return Zr(e,w(t))},go=function(e){return Zr(e,k)},ho=w(io),po=[Vr("channels",Mr(Mn.value,zr([uo("onReceive"),Yr("schema",Hr())])))],yo=Ea({fields:po,name:"receiving",active:Ka}),vo=function(e,t,n){var r=t.aria;r.update(e,r,n.get())},bo=function(e,t,n){t.toggleClass.each(function(t){(n.get()?Tn:Nn)(e.element,t)})},wo=function(e,t,n){xo(e,t,n,!n.get())},ko=function(e,t,n){n.set(!0),bo(e,t,n),vo(e,t,n)},_o=function(e,t,n){n.set(!1),bo(e,t,n),vo(e,t,n)},xo=function(e,t,n,r){(r?ko:_o)(e,t,n)},Co=function(e,t,n){xo(e,t,n,t.selected)},zo=Object.freeze({__proto__:null,onLoad:Co,toggle:wo,isOn:function(e,t,n){return n.get()},on:ko,off:_o,set:xo}),So=Object.freeze({__proto__:null,exhibit:function(){return ba({})},events:function(e,t){var n,r,a,o=(n=e,r=t,a=wo,pa(function(e){a(e,n,r)})),i=wa(e,t,Co);return oa(Q([e.toggleOnExecute?[o]:[],[i]]))}}),To=function(e,t,n){yn(e.element,"aria-expanded",n)},Eo=[Yr("selected",!1),Wr("toggleClass"),Yr("toggleOnExecute",!0),Jr("aria",{mode:"none"},Fr("mode",{pressed:[Yr("syncWithExpanded",!1),mo("update",function(e,t,n){yn(e.element,"aria-pressed",n),t.syncWithExpanded&&To(e,t,n)})],checked:[mo("update",function(e,t,n){yn(e.element,"aria-checked",n)})],expanded:[mo("update",To)],selected:[mo("update",function(e,t,n){yn(e.element,"aria-selected",n)})],none:[mo("update",v)]}))],No=Ea({fields:Eo,name:"toggling",active:So,apis:zo,state:(Ya=!1,{init:function(){var e=Oa(Ya);return{get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(Ya)},readState:function(){return e.get()}}}})}),Do=function(e,t){return yo.config({channels:dr(Ha,{onReceive:function(n,r){r.command===e&&t(n,r.state)}})})},Ao=function(e){return yo.config({channels:dr(qa,{onReceive:e})})},Oo=function(e,t){return{key:e,value:{onReceive:t}}},Ro="tinymce-mobile",Po=function(e){return Ro+"-"+e},Mo=function(){var e=function(e,t){t.stop(),ht(e)};return[ca(Ke(),e),ca(ot(),e),da(Le()),da(Fe())]},Bo=function(e,t){t.ignore||(Ra(e.element),t.onFocus(e))},Lo=Object.freeze({__proto__:null,focus:Bo,blur:function(e,t){t.ignore||Pa(e.element)},isFocused:function(e){return t=e.element,n=Wt(t).dom,t.dom===n.activeElement;var t,n}}),jo=Object.freeze({__proto__:null,exhibit:function(e,t){var n=t.ignore?{}:{attributes:{tabindex:"-1"}};return ba(n)},events:function(e){return oa([ca(Qe(),function(t,n){Bo(t,e),n.stop()})].concat(e.stopMousedown?[ca(Fe(),function(e,t){t.event.prevent()})]:[]))}}),Io=[so("onFocus"),Yr("stopMousedown",!1),Yr("ignore",!1)],Fo=Ea({fields:Io,name:"focusing",active:jo,apis:Lo}),Ho=function(e){return void 0!==e.style&&I(e.style.getPropertyValue)},qo=function(e,t,n){if(!P(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ho(e)&&e.style.setProperty(t,n)},Uo=function(e,t,n){var r=e.dom;qo(r,t,n)},Vo=function(e,t){var n=e.dom;sn(t,function(e,t){qo(n,t,e)})},$o=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Gt(e)?r:Wo(n,t)},Wo=function(e,t){return Ho(e)?e.style.getPropertyValue(t):""},Xo=function(e,t){var n=e.dom,r=Wo(n,t);return A.from(r).filter(function(e){return 0<e.length})},Ko=function(e,t){var n,r,a=e.dom;r=t,Ho(n=a)&&n.style.removeProperty(r),wn(e,"style").map(pe).is("")&&_n(e,"style")},Go=function(e){return e.dom.offsetWidth},Yo=function(e,t){var n=function(n){var r=t(n);if(0>=r||null===r){var a=$o(n,e);return parseFloat(a)||0}return r},r=function(e,t){return Y(t,function(t,n){var r=$o(e,n),a=void 0===r?0:parseInt(r,10);return isNaN(a)?t:t+a},0)};return{set:function(t,n){if(!F(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Ho(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var a=r(e,n);return t>a?t-a:0}}},Jo=Yo("height",function(e){var t=e.dom;return Gt(e)?t.getBoundingClientRect().height:t.offsetHeight}),Zo=function(e){return Jo.get(e)},Qo=function(e,t,n){return K(function(e,t){for(var n=I(t)?t:z,r=e.dom,a=[];null!==r.parentNode&&void 0!==r.parentNode;){var o=r.parentNode,i=bt.fromDom(o);if(a.push(i),!0===n(i))break;r=o}return a}(e,n),t)},ei=function(e,t){return K(Rt(n=e).map(Pt).map(function(e){return K(e,function(e){return!Ct(n,e)})}).getOr([]),t);var n},ti=function(e,t){return _t(t,e)},ni=function(e,t,n){for(var r=e.dom,a=I(n)?n:z;r.parentNode;){r=r.parentNode;var o=bt.fromDom(r);if(t(o))return A.some(o);if(a(o))break}return A.none()},ri=function(e){return xt(e)},ai=function(e,t,n){return ni(e,function(e){return wt(e,t)},n)},oi=function(e,t){return xt(t,e)},ii=function(e,t,n){return r(wt,ai,e,t,n)},ci=[8],si=[9],li=[13],ui=[27],fi=[32],di=[37],mi=[38],gi=[39],hi=[40],pi=function(e,t,n){var r=ne(e.slice(0,t)),a=ne(e.slice(t+1));return J(r.concat(a),n)},yi=function(e,t,n){var r=ne(e.slice(0,t));return J(r,n)},vi=function(e,t,n){var r=e.slice(0,t),a=e.slice(t+1);return J(a.concat(r),n)},bi=function(e,t,n){var r=e.slice(t+1);return J(r,n)},wi=function(e){return function(t){var n=t.raw;return V(e,n.which)}},ki=function(e){return function(t){return te(e,function(e){return e(t)})}},_i=function(e){return!0===e.raw.shiftKey},xi=function(e){return!0===e.raw.ctrlKey},Ci=_(_i),zi=function(e,t){return{matches:e,classification:t}},Si=function(e,t,n,r){var a=e+t;return a>r?n:n>a?r:a},Ti=function(e,t,n){return Math.min(Math.max(e,t),n)},Ei=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Ni=function(e,t,n,r){var a=ti(e.element,"."+t.highlightClass);X(a,function(n){$(r,function(e){return e.element===n})||(Nn(n,t.highlightClass),e.getSystem().getByDom(n).each(function(n){t.onDehighlight(e,n),mt(n,dt())}))})},Di=function(e,t,n,r){Ni(e,t,0,[r]),Ai(e,t,n,r)||(Tn(r.element,t.highlightClass),t.onHighlight(e,r),mt(r,ft()))},Ai=function(e,t,n,r){return Dn(r.element,t.highlightClass)},Oi=function(e,t,n,r){var a=ti(e.element,"."+t.itemClass);return A.from(a[r]).fold(function(){return Mn.error(new Error("No element found with index "+r))},e.getSystem().getByDom)},Ri=function(e,t){return oi(e.element,"."+t.itemClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},Pi=function(e,t){var n=ti(e.element,"."+t.itemClass);return(0<n.length?A.some(n[n.length-1]):A.none()).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},Mi=function(e,t,n,r){var a=ti(e.element,"."+t.itemClass);return Z(a,function(e){return Dn(e,t.highlightClass)}).bind(function(t){var n=Si(t,r,0,a.length-1);return e.getSystem().getByDom(a[n]).toOptional()})},Bi=function(e,t){var n=ti(e.element,"."+t.itemClass);return Ei(W(n,function(t){return e.getSystem().getByDom(t).toOptional()}))},Li=Object.freeze({__proto__:null,dehighlightAll:function(e,t){return Ni(e,t,0,[])},dehighlight:function(e,t,n,r){Ai(e,t,n,r)&&(Nn(r.element,t.highlightClass),t.onDehighlight(e,r),mt(r,dt()))},highlight:Di,highlightFirst:function(e,t,n){Ri(e,t).each(function(r){Di(e,t,n,r)})},highlightLast:function(e,t,n){Pi(e,t).each(function(r){Di(e,t,n,r)})},highlightAt:function(e,t,n,r){Oi(e,t,n,r).fold(function(e){throw e},function(r){Di(e,t,n,r)})},highlightBy:function(e,t,n,r){var a=Bi(e,t);J(a,r).each(function(r){Di(e,t,n,r)})},isHighlighted:Ai,getHighlighted:function(e,t){return oi(e.element,"."+t.highlightClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},getFirst:Ri,getLast:Pi,getPrevious:function(e,t){return Mi(e,t,0,-1)},getNext:function(e,t){return Mi(e,t,0,1)},getCandidates:Bi}),ji=[Ur("highlightClass"),Ur("itemClass"),so("onHighlight"),so("onDehighlight")],Ii=Ea({fields:ji,name:"highlighting",apis:Li}),Fi=function(e,t,n){t.exists(function(e){return n.exists(function(t){return Ct(t,e)})})||gt(e,ut(),{prevFocus:t,newFocus:n})},Hi=function(){var e=function(e){return Ba(e.element)};return{get:e,set:function(t,n){var r=e(t);t.getSystem().triggerFocus(n,t.element);var a=e(t);Fi(t,r,a)}}};(Za=Ja=Ja||{}).OnFocusMode="onFocus",Za.OnEnterOrSpaceMode="onEnterOrSpace",Za.OnApiMode="onApi";var qi,Ui,Vi,$i,Wi,Xi,Ki,Gi,Yi,Ji,Zi,Qi,ec,tc,nc,rc,ac,oc,ic,cc,sc,lc,uc,fc,dc,mc=function(e,t,n,r,a){var o=function(e,t,n,r,a){var o,i,c=n(e,t,r,a);return o=c,i=t.event,J(o,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(n){return n(e,t,r,a)})},i={schema:function(){return e.concat([Yr("focusManager",Hi()),Jr("focusInside","onFocus",Pr(function(e){return V(["onFocus","onEnterOrSpace","onApi"],e)?Mn.value(e):Mn.error("Invalid value for focusInside")})),mo("handler",i),mo("state",t),mo("sendFocusIn",a)])},processKey:o,toEvents:function(e,t){var i=e.focusInside!==Ja.OnFocusMode?A.none():a(e).map(function(n){return ca(Qe(),function(r,a){n(r,e,t),a.stop()})}),c=[ca(Ve(),function(r,i){o(r,i,n,e,t).fold(function(){var n,o,c;n=r,o=i,c=wi(fi.concat(li))(o.event),e.focusInside===Ja.OnEnterOrSpaceMode&&c&&na(n,o)&&a(e).each(function(r){r(n,e,t),o.stop()})},function(){i.stop()})}),ca($e(),function(n,a){o(n,a,r,e,t).each(function(){a.stop()})})];return oa(i.toArray().concat(c))}};return i},gc=function(e){var t=[Wr("onEscape"),Wr("onEnter"),Yr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Yr("firstTabstop",0),Yr("useTabstopAt",S),Wr("visibilitySelector")].concat([e]),r=function(e,t){var n=e.visibilitySelector.bind(function(e){return ii(t,e)}).getOr(t);return 0<Zo(n)},a=function(e,t){var n,a,o;n=t,a=ti(e.element,n.selector),o=K(a,function(e){return r(n,e)}),A.from(o[n.firstTabstop]).each(function(n){t.focusManager.set(e,n)})},o=function(e,t,n,a,o){return o(t,n,function(e){return r(t=a,n=e)&&t.useTabstopAt(n);var t,n}).fold(function(){return a.cyclic?A.some(!0):A.none()},function(t){return a.focusManager.set(e,t),A.some(!0)})},i=function(e,t,r,a){var i,c,s=ti(e.element,r.selector);return i=e,(c=r).focusManager.get(i).bind(function(e){return ii(e,c.selector)}).bind(function(t){return Z(s,n(Ct,t)).bind(function(t){return o(e,s,t,r,a)})})},c=w([zi(ki([_i,wi(si)]),function(e,t,n){var r=n.cyclic?pi:yi;return i(e,0,n,r)}),zi(wi(si),function(e,t,n){var r=n.cyclic?vi:bi;return i(e,0,n,r)}),zi(wi(ui),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),zi(ki([Ci,wi(li)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),s=w([]);return mc(t,Ca.init,c,s,function(){return A.some(a)})},hc=gc(Zr("cyclic",z)),pc=gc(Zr("cyclic",S)),yc=function(e){return"input"===zt(e)&&"radio"!==bn(e,"type")||"textarea"===zt(e)},vc=function(e,t,n){return yc(n)&&wi(fi)(t.event)?A.none():(pt(e,n,rt()),A.some(!0))},bc=function(){return A.some(!0)},wc=[Yr("execute",vc),Yr("useSpace",!1),Yr("useEnter",!0),Yr("useControlEnter",!1),Yr("useDown",!1)],kc=function(e,t,n){return n.execute(e,t,e.element)},_c=mc(wc,Ca.init,function(e,t,n){var r=n.useSpace&&!yc(e.element)?fi:[],a=n.useEnter?li:[],o=n.useDown?hi:[],i=r.concat(a).concat(o);return[zi(wi(i),kc)].concat(n.useControlEnter?[zi(ki([xi,wi(li)]),kc)]:[])},function(e,t,n){return n.useSpace&&!yc(e.element)?[zi(wi(fi),bc)]:[]},function(){return A.none()}),xc=function(){var e=Oa(A.none());return za({readState:function(){return e.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(A.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(e){return e.numRows})},getNumColumns:function(){return e.get().map(function(e){return e.numColumns})}})},Cc=Object.freeze({__proto__:null,flatgrid:xc,init:function(e){return e.state(e)}}),zc=function(e,t){return function(n){return"rtl"===Sc(n)?t:e}},Sc=function(e){return"rtl"===$o(e,"direction")?"rtl":"ltr"},Tc=function(e){return function(t,n,r,a){var o=e(t.element);return Ac(o,t,n,r,a)}},Ec=function(e,t){var n=zc(e,t);return Tc(n)},Nc=function(e,t){var n=zc(t,e);return Tc(n)},Dc=function(e){return function(t,n,r,a){return Ac(e,t,n,r,a)}},Ac=function(e,t,n,r,a){return r.focusManager.get(t).bind(function(n){return e(t.element,n,r,a)}).map(function(e){return r.focusManager.set(t,e),!0})},Oc=Dc,Rc=Dc,Pc=Dc,Mc=function(e){return!((t=e.dom).offsetWidth<=0&&t.offsetHeight<=0);var t},Bc=function(e,t,n){var r,a=ti(e,n),o=K(a,Mc);return Z(r=o,function(e){return Ct(e,t)}).map(function(e){return{index:e,candidates:r}})},Lc=function(e,t){return Z(e,function(e){return Ct(t,e)})},jc=function(e,t,n,r){return r(Math.floor(t/n),t%n).bind(function(t){var r=t.row*n+t.column;return r>=0&&r<e.length?A.some(e[r]):A.none()})},Ic=function(e,t,n,r,a){return jc(e,t,r,function(t,o){var i=t===n-1?e.length-t*r:r,c=Si(o,a,0,i-1);return A.some({row:t,column:c})})},Fc=function(e,t,n,r,a){return jc(e,t,r,function(t,o){var i=Si(t,a,0,n-1),c=i===n-1?e.length-i*r:r,s=Ti(o,0,c-1);return A.some({row:i,column:s})})},Hc=[Ur("selector"),Yr("execute",vc),lo("onEscape"),Yr("captureTab",!1),ho()],qc=function(e,t){oi(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},Uc=function(e){return function(t,n,r,a){return Bc(t,n,r.selector).bind(function(t){return e(t.candidates,t.index,a.getNumRows().getOr(r.initSize.numRows),a.getNumColumns().getOr(r.initSize.numColumns))})}},Vc=function(e,t,n){return n.captureTab?A.some(!0):A.none()},$c=Uc(function(e,t,n,r){return Ic(e,t,n,r,-1)}),Wc=Uc(function(e,t,n,r){return Ic(e,t,n,r,1)}),Xc=Uc(function(e,t,n,r){return Fc(e,t,n,r,-1)}),Kc=Uc(function(e,t,n,r){return Fc(e,t,n,r,1)}),Gc=w([zi(wi(di),Ec($c,Wc)),zi(wi(gi),Nc($c,Wc)),zi(wi(mi),Oc(Xc)),zi(wi(hi),Rc(Kc)),zi(ki([_i,wi(si)]),Vc),zi(ki([Ci,wi(si)]),Vc),zi(wi(ui),function(e,t,n){return n.onEscape(e,t)}),zi(wi(fi.concat(li)),function(e,t,n){return r=e,(a=n).focusManager.get(r).bind(function(e){return ii(e,a.selector)}).bind(function(r){return n.execute(e,t,r)});var r,a})]),Yc=w([zi(wi(fi),bc)]),Jc=mc(Hc,xc,Gc,Yc,function(){return A.some(qc)}),Zc=function(e,t,n,r){var a=function(e,t,n){var o,i=Si(t,r,0,n.length-1);return i===e?A.none():(o=n[i],"button"===zt(o)&&"disabled"===bn(o,"disabled")?a(e,i,n):A.from(n[i]))};return Bc(e,n,t).bind(function(e){var t=e.index,n=e.candidates;return a(t,t,n)})},Qc=[Ur("selector"),Yr("getInitial",A.none),Yr("execute",vc),lo("onEscape"),Yr("executeOnMove",!1),Yr("allowVertical",!0)],es=function(e,t,n){return r=e,(a=n).focusManager.get(r).bind(function(e){return ii(e,a.selector)}).bind(function(r){return n.execute(e,t,r)});var r,a},ts=function(e,t){t.getInitial(e).orThunk(function(){return oi(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})},ns=function(e,t,n){return Zc(e,n.selector,t,-1)},rs=function(e,t,n){return Zc(e,n.selector,t,1)},as=function(e){return function(t,n,r,a){return e(t,n,r,a).bind(function(){return r.executeOnMove?es(t,n,r):A.some(!0)})}},os=function(e,t,n){return n.onEscape(e,t)},is=w([zi(wi(fi),bc)]),cs=mc(Qc,Ca.init,function(e,t,n){var r=di.concat(n.allowVertical?mi:[]),a=gi.concat(n.allowVertical?hi:[]);return[zi(wi(r),as(Ec(ns,rs))),zi(wi(a),as(Nc(ns,rs))),zi(wi(li),es),zi(wi(fi),es),zi(wi(ui),os)]},is,function(){return A.some(ts)}),ss=function(e,t,n){return A.from(e[t]).bind(function(e){return A.from(e[n]).map(function(e){return{rowIndex:t,columnIndex:n,cell:e}})})},ls=function(e,t,n,r){var a=e[t].length,o=Si(n,r,0,a-1);return ss(e,t,o)},us=function(e,t,n,r){var a=Si(n,r,0,e.length-1),o=e[a].length,i=Ti(t,0,o-1);return ss(e,a,i)},fs=function(e,t,n,r){var a=e[t].length,o=Ti(n+r,0,a-1);return ss(e,t,o)},ds=function(e,t,n,r){var a=Ti(n+r,0,e.length-1),o=e[a].length,i=Ti(t,0,o-1);return ss(e,a,i)},ms=[$r("selectors",[Ur("row"),Ur("cell")]),Yr("cycles",!0),Yr("previousSelector",A.none),Yr("execute",vc)],gs=function(e,t){t.previousSelector(e).orThunk(function(){var n=t.selectors;return oi(e.element,n.cell)}).each(function(n){t.focusManager.set(e,n)})},hs=function(e,t){return function(n,r,a){var o=a.cycles?e:t;return ii(r,a.selectors.row).bind(function(e){var t=ti(e,a.selectors.cell);return Lc(t,r).bind(function(t){var r=ti(n,a.selectors.row);return Lc(r,e).bind(function(e){var n,i=(n=a,W(r,function(e){return ti(e,n.selectors.cell)}));return o(i,e,t).map(function(e){return e.cell})})})})}},ps=hs(function(e,t,n){return ls(e,t,n,-1)},function(e,t,n){return fs(e,t,n,-1)}),ys=hs(function(e,t,n){return ls(e,t,n,1)},function(e,t,n){return fs(e,t,n,1)}),vs=hs(function(e,t,n){return us(e,n,t,-1)},function(e,t,n){return ds(e,n,t,-1)}),bs=hs(function(e,t,n){return us(e,n,t,1)},function(e,t,n){return ds(e,n,t,1)}),ws=w([zi(wi(di),Ec(ps,ys)),zi(wi(gi),Nc(ps,ys)),zi(wi(mi),Oc(vs)),zi(wi(hi),Rc(bs)),zi(wi(fi.concat(li)),function(e,t,n){return Ba(e.element).bind(function(r){return n.execute(e,t,r)})})]),ks=w([zi(wi(fi),bc)]),_s=mc(ms,Ca.init,ws,ks,function(){return A.some(gs)}),xs=[Ur("selector"),Yr("execute",vc),Yr("moveOnTab",!1)],Cs=function(e,t,n){return n.focusManager.get(e).bind(function(r){return n.execute(e,t,r)})},zs=function(e,t){oi(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},Ss=function(e,t,n){return Zc(e,n.selector,t,-1)},Ts=function(e,t,n){return Zc(e,n.selector,t,1)},Es=w([zi(wi(mi),Pc(Ss)),zi(wi(hi),Pc(Ts)),zi(ki([_i,wi(si)]),function(e,t,n,r){return n.moveOnTab?Pc(Ss)(e,t,n,r):A.none()}),zi(ki([Ci,wi(si)]),function(e,t,n,r){return n.moveOnTab?Pc(Ts)(e,t,n,r):A.none()}),zi(wi(li),Cs),zi(wi(fi),Cs)]),Ns=w([zi(wi(fi),bc)]),Ds=mc(xs,Ca.init,Es,Ns,function(){return A.some(zs)}),As=[lo("onSpace"),lo("onEnter"),lo("onShiftEnter"),lo("onLeft"),lo("onRight"),lo("onTab"),lo("onShiftTab"),lo("onUp"),lo("onDown"),lo("onEscape"),Yr("stopSpaceKeyup",!1),Wr("focusIn")],Os=mc(As,Ca.init,function(e,t,n){return[zi(wi(fi),n.onSpace),zi(ki([Ci,wi(li)]),n.onEnter),zi(ki([_i,wi(li)]),n.onShiftEnter),zi(ki([_i,wi(si)]),n.onShiftTab),zi(ki([Ci,wi(si)]),n.onTab),zi(wi(mi),n.onUp),zi(wi(hi),n.onDown),zi(wi(di),n.onLeft),zi(wi(gi),n.onRight),zi(wi(fi),n.onSpace),zi(wi(ui),n.onEscape)]},function(e,t,n){return n.stopSpaceKeyup?[zi(wi(fi),bc)]:[]},function(e){return e.focusIn}),Rs=hc.schema(),Ps=pc.schema(),Ms=cs.schema(),Bs=Jc.schema(),Ls=_s.schema(),js=_c.schema(),Is=Ds.schema(),Fs=Os.schema(),Hs=(Ji=jr("Creating behaviour: "+(qi={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Rs,cyclic:Ps,flow:Ms,flatgrid:Bs,matrix:Ls,execution:js,menu:Is,special:Fs}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(e,t,n){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(r){r(e,t,n)})},setGridSize:function(e,t,n,r,a){hn(n,"setGridSize")?n.setGridSize(r,a):console.error("Layout does not support setGridSize")}},state:Cc}).name,Na,qi),Ui=Fr(Ji.branchKey,Ji.branches),Vi=Ji.name,$i=Ji.active,Wi=Ji.apis,Xi=Ji.extra,Ki=Ji.state,Yi=Kr(Vi,[Xr("config",Gi=Ui)]),xa(Gi,Yi,Vi,$i,Wi,Xi,Ki)),qs=function(e,t){return n=e,r={},a=W(t,function(t){return n=t.name(),r="Cannot configure "+t.name()+" for "+e,Dr(n,n,cr(),Cr(function(){return Kn("The field: "+n+" is forbidden. "+r)}));var n,r}).concat([Zr("dump",k)]),Jr(n,r,Sr(a));var n,r,a},Us=function(e){return e.dump},Vs=function(e,t){return y(y({},e.dump),Sa(t))},$s=qs,Ws=Vs,Xs="placeholder",Ks=Qn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Gs=function(e){return gn(e,"uiType")},Ys=function(e,t,n,r){return Gs(n)&&n.uiType===Xs?(o=n,i=r,(a=e).exists(function(e){return e!==o.owner})?Ks.single(!0,w(o)):mn(i,o.name).fold(function(){throw new Error("Unknown placeholder component: "+o.name+"\nKnown: ["+on(i)+"]\nNamespace: "+a.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))},function(e){return e.replace()})):Ks.single(!1,w(n));var a,o,i},Js=function(e,t,n,r){return Ys(e,0,n,r).fold(function(a,o){var i=Gs(n)?o(t,n.config,n.validated):o(t),c=mn(i,"components").getOr([]),s=ee(c,function(n){return Js(e,t,n,r)});return[y(y({},i),{components:s})]},function(e,r){if(Gs(n)){var a=r(t,n.config,n.validated);return n.validated.preprocess.getOr(k)(a)}return r(t)})},Zs=function(e,t,n,r){var a,o,i,c=ln(r,function(e,t){return r=e,a=!1,{name:w(n=t),required:function(){return r.fold(function(e){return e},function(e){return e})},used:function(){return a},replace:function(){if(a)throw new Error("Trying to use the same placeholder more than once: "+n);return a=!0,r}};var n,r,a}),s=(a=e,o=t,i=c,ee(n,function(e){return Js(a,o,e,i)}));return sn(c,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),s},Qs=Ks.single,el=Ks.multiple,tl=w(Xs),nl=0,rl=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++nl+String(t)},al=Qn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ol=Yr("factory",{sketch:k}),il=Yr("schema",[]),cl=Ur("name"),sl=Dr("pname","pname",sr(function(e){return"<alloy."+rl(e.name)+">"}),Hr()),ll=Zr("schema",function(){return[Wr("preprocess")]}),ul=Yr("defaults",w({})),fl=Yr("overrides",w({})),dl=Sr([ol,il,cl,sl,ul,fl]),ml=Sr([ol,il,cl,ul,fl]),gl=Sr([ol,il,cl,sl,ul,fl]),hl=Sr([ol,ll,cl,Ur("unit"),sl,ul,fl]),pl=function(e){var t=function(e){return e.name};return e.fold(t,t,t,t)},yl=function(e,t){return function(n){var r=jr("Converting part type",t,n);return e(r)}},vl=yl(al.required,dl),bl=(yl(al.external,ml),yl(al.optional,gl)),wl=yl(al.group,hl),kl=w("entirety"),_l=function(e,t,n,r){return nr(t.defaults(e,n,r),n,{uid:e.partUids[t.name]},t.overrides(e,n,r))},xl=function(e,t){var n={};return X(t,function(t){t.fold(A.some,A.none,A.some,A.some).each(function(t){var r=Cl(e,t.pname);n[t.name]=function(n){var a=jr("Part: "+t.name+" in "+e,Sr(t.schema),n);return y(y({},r),{config:n,validated:a})}})}),n},Cl=function(e,t){return{uiType:tl(),owner:e,name:t}},zl=function(e,t,n){return r=t,a={},o={},X(n,function(e){e.fold(function(e){a[e.pname]=Qs(!0,function(t,n,r){return e.factory.sketch(_l(t,e,n,r))})},function(e){var t=r.parts[e.name];o[e.name]=w(e.factory.sketch(_l(r,e,t[kl()]),t))},function(e){a[e.pname]=Qs(!1,function(t,n,r){return e.factory.sketch(_l(t,e,n,r))})},function(e){a[e.pname]=el(!0,function(t,n,r){var a=t[e.name];return W(a,function(n){return e.factory.sketch(nr(e.defaults(t,n,r),n,e.overrides(t,n)))})})})}),{internals:w(a),externals:w(o)};var r,a,o},Sl=function(e,t,n){return Zs(A.some(e),t,t.components,n)},Tl=function(e,t,n){var r=t.partUids[n];return e.getSystem().getByUid(r).toOptional()},El=function(e,t,n){return Tl(e,t,n).getOrDie("Could not find part: "+n)},Nl=function(e,t){var n=W(t,pl);return mr(W(n,function(t){return{key:t,value:e+"-"+t}}))},Dl=function(e){return Dr("partUids","partUids",lr(function(t){return Nl(t.uid,e)}),Hr())},Al=rl("alloy-premade"),Ol=function(e){return dr(Al,e)},Rl=function(e){return n=function(n){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return e.apply(void 0,t([n.getApis(),n],r))},r=e.toString(),a=r.indexOf(")")+1,o=r.indexOf("("),i=r.substring(o+1,a-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ya(i.slice(1))}},n;var n,r,a,o,i},Pl=w("alloy-id-"),Ml=w("data-alloy-id"),Bl=Pl(),Ll=Ml(),jl=function(e,t){Object.defineProperty(e.dom,Ll,{value:t,writable:!0})},Il=function(e){var t=Tt(e)?e.dom[Ll]:null;return A.from(t)},Fl=rl,Hl=function(e,t,n,r,a){var o,i,c=(i=a,(0<(o=r).length?[$r("parts",o)]:[]).concat([Ur("uid"),Yr("dom",{}),Yr("components",[]),go("originalSpec"),Yr("debug.sketcher",{})]).concat(i));return jr(e+" [SpecSchema]",zr(c.concat(t)),n)},ql=function(e,t,n,r,a){var o=Ul(a),i=ee(n,function(e){return e.fold(A.none,A.some,A.none,A.none).map(function(e){return $r(e.name,e.schema.concat([go(kl())]))}).toArray()}),c=Dl(n),s=Hl(e,t,o,i,[c]),l=zl(0,s,n);return r(s,Sl(e,s,l.internals()),o,l.externals())},Ul=function(e){return gn(e,"uid")?e:y(y({},e),{uid:Fl("uid")})},Vl=zr([Ur("name"),Ur("factory"),Ur("configFields"),Yr("apis",{}),Yr("extraApis",{})]),$l=zr([Ur("name"),Ur("factory"),Ur("configFields"),Ur("partFields"),Yr("apis",{}),Yr("extraApis",{})]),Wl=function(e){var t=jr("Sketcher for "+e.name,Vl,e),n=ln(t.apis,Rl),r=ln(t.extraApis,va);return y(y({name:t.name,configFields:t.configFields,sketch:function(e){return n=t.name,r=t.configFields,a=t.factory,o=Ul(e),a(Hl(n,r,o,[],[]),o);var n,r,a,o}},n),r)},Xl=function(e){var t=jr("Sketcher for "+e.name,$l,e),n=xl(t.name,t.partFields),r=ln(t.apis,Rl),a=ln(t.extraApis,va);return y(y({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(e){return ql(t.name,t.configFields,t.partFields,t.factory,e)},parts:n},r),a)},Kl=Wl({name:"Button",factory:function(e){var t,n=(t=e.action,oa(Q([t.map(function(e){return pa(function(t,n){e(t),n.stop()})}).toArray(),Mo()]))),r=e.dom.tag,a=function(t){return mn(e.dom,"attributes").bind(function(e){return mn(e,t)})};return{uid:e.uid,dom:e.dom,components:e.components,events:n,behaviours:Ws(e.buttonBehaviours,[Fo.config({}),Hs.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==r)return{role:a("role").getOr("button")};var e=a("type").getOr("button"),t=a("role").map(function(e){return{role:e}}).getOr({});return y({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[Yr("uid",void 0),Ur("dom"),Yr("components",[]),$s("buttonBehaviours",[Fo,Hs]),Wr("action"),Wr("role"),Yr("eventOrder",{})]}),Gl=Ea({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return oa([ia(Ye(),S)])},exhibit:function(){return ba({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Yl=function(e){var t,n,r,a=bt.fromHtml(e),o=Pt(a),i=(n=void 0!==(t=a).dom.attributes?t.dom.attributes:[],Y(n,function(e,t){var n;return"class"===t.name?e:y(y({},e),((n={})[t.name]=t.value,n))},{})),c=(r=a,Array.prototype.slice.call(r.dom.classList,0)),s=0===o.length?{}:{innerHtml:Va(a)};return y({tag:zt(a),classes:c,attributes:i},s)},Jl=function(e){var t=ge(e,{prefix:Ro});return Yl(t)},Zl=function(e){return{dom:Jl(e)}},Ql=function(e){return Sa([No.config({toggleClass:Po("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Do(e,function(e,t){(t?No.on:No.off)(e)})])},eu=function(e,t,n,r){var a=Ql(n);return nu(t,r,a,e)},tu=function(e,t){var n=t.ui.registry.getAll().icons;return A.from(n[e]).fold(function(){return Jl('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+e+' ${prefix}-icon"></span>')},function(e){return Jl('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+e+"</span>")})},nu=function(e,t,n,r){return Kl.sketch({dom:tu(e,r),action:t,buttonBehaviours:nr(Sa([Gl.config({})]),n)})},ru=bl({schema:[Ur("dom")],name:"label"}),au=function(e){return bl({name:e+"-edge",overrides:function(t){return t.model.manager.edgeActions[e].fold(function(){return{}},function(e){return{events:oa([sa(Le(),function(t,n,r){return e(t,r)},[t]),sa(Fe(),function(t,n,r){return e(t,r)},[t]),sa(He(),function(t,n,r){r.mouseIsDown.get()&&e(t,r)},[t])])}})}})},ou=au("top-left"),iu=au("top"),cu=au("top-right"),su=au("right"),lu=au("bottom-right"),uu=au("bottom"),fu=au("bottom-left"),du=[ru,au("left"),su,iu,uu,ou,cu,fu,lu,vl({name:"thumb",defaults:w({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:oa([fa(Le(),e,"spectrum"),fa(je(),e,"spectrum"),fa(Ie(),e,"spectrum"),fa(Fe(),e,"spectrum"),fa(He(),e,"spectrum"),fa(qe(),e,"spectrum")])}}}),vl({schema:[Zr("mouseIsDown",function(){return Oa(!1)})],name:"spectrum",overrides:function(e){var t=e.model.manager,n=function(n,r){return t.getValueFromEvent(r).map(function(r){return t.setValueFrom(n,e,r)})};return{behaviours:Sa([Hs.config({mode:"special",onLeft:function(n){return t.onLeft(n,e)},onRight:function(n){return t.onRight(n,e)},onUp:function(n){return t.onUp(n,e)},onDown:function(n){return t.onDown(n,e)}}),Fo.config({})]),events:oa([ca(Le(),n),ca(je(),n),ca(Fe(),n),ca(He(),function(t,r){e.mouseIsDown.get()&&n(t,r)})])}}})],mu=function(e,t,n){t.store.manager.onLoad(e,t,n)},gu=function(e,t,n){t.store.manager.onUnload(e,t,n)},hu=Object.freeze({__proto__:null,onLoad:mu,onUnload:gu,setValue:function(e,t,n,r){t.store.manager.setValue(e,t,n,r)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),pu=Object.freeze({__proto__:null,events:function(e,t){var n=e.resetOnDom?[ma(function(n){mu(n,e,t)}),ga(function(n){gu(n,e,t)})]:[wa(e,t,mu)];return oa(n)}}),yu=function(){var e=Oa(null);return za({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},vu=function(){var e=Oa({}),t=Oa({});return za({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},lookup:function(n){return mn(e.get(),n).orThunk(function(){return mn(t.get(),n)})},update:function(n){var r=e.get(),a=t.get(),o={},i={};X(n,function(e){o[e.value]=e,mn(e,"meta").each(function(t){mn(t,"text").each(function(t){i[t]=e})})}),e.set(y(y({},r),o)),t.set(y(y({},a),i))},clear:function(){e.set({}),t.set({})}})},bu=Object.freeze({__proto__:null,memory:yu,dataset:vu,manual:function(){return za({readState:v})},init:function(e){return e.store.manager.state(e)}}),wu=function(e,t,n,r){var a=t.store;n.update([r]),a.setValue(e,r),t.onSetValue(e,r)},ku=[Wr("initialValue"),Ur("getFallbackEntry"),Ur("getDataKey"),Ur("setValue"),mo("manager",{setValue:wu,getValue:function(e,t,n){var r=t.store,a=r.getDataKey(e);return n.lookup(a).fold(function(){return r.getFallbackEntry(a)},function(e){return e})},onLoad:function(e,t,n){t.store.initialValue.each(function(r){wu(e,t,n,r)})},onUnload:function(e,t,n){n.clear()},state:vu})],_u=[Ur("getValue"),Yr("setValue",v),Wr("initialValue"),mo("manager",{setValue:function(e,t,n,r){t.store.setValue(e,r),t.onSetValue(e,r)},getValue:function(e,t){return t.store.getValue(e)},onLoad:function(e,t){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:v,state:Ca.init})],xu=[Wr("initialValue"),mo("manager",{setValue:function(e,t,n,r){n.set(r),t.onSetValue(e,r)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each(function(e){n.isNotSet()&&n.set(e)})},onUnload:function(e,t,n){n.clear()},state:yu})],Cu=[Jr("store",{mode:"memory"},Fr("mode",{memory:xu,manual:_u,dataset:ku})),so("onSetValue"),Yr("resetOnDom",!1)],zu=Ea({fields:Cu,name:"representing",active:pu,apis:hu,extra:{setValueFrom:function(e,t){var n=zu.getValue(t);zu.setValue(e,n)}},state:bu}),Su=Yo("width",function(e){return e.dom.offsetWidth}),Tu=function(e,t){return Su.set(e,t)},Eu=function(e){return Su.get(e)},Nu=function(e,t){return{left:e,top:t,translate:function(n,r){return Nu(e+n,t+r)}}},Du=Nu,Au=w("slider.change.value"),Ou=function(e){var t=e.event.raw;return-1===t.type.indexOf("touch")?void 0!==t.clientX?A.some(t).map(function(e){return Du(e.clientX,e.clientY)}):A.none():void 0!==t.touches&&1===t.touches.length?A.some(t.touches[0]).map(function(e){return Du(e.clientX,e.clientY)}):A.none()},Ru=function(e){return e.model.minX;
},Pu=function(e){return e.model.minY},Mu=function(e){return e.model.minX-1},Bu=function(e){return e.model.minY-1},Lu=function(e){return e.model.maxX},ju=function(e){return e.model.maxY},Iu=function(e){return e.model.maxX+1},Fu=function(e){return e.model.maxY+1},Hu=function(e,t,n){return t(e)-n(e)},qu=function(e){return Hu(e,Lu,Ru)},Uu=function(e){return Hu(e,ju,Pu)},Vu=function(e){return qu(e)/2},$u=function(e){return Uu(e)/2},Wu=function(e){return e.stepSize},Xu=function(e){return e.snapToGrid},Ku=function(e){return e.snapStart},Gu=function(e){return e.rounded},Yu=function(e,t){return void 0!==e[t+"-edge"]},Ju=function(e){return Yu(e,"left")},Zu=function(e){return Yu(e,"right")},Qu=function(e){return Yu(e,"top")},ef=function(e){return Yu(e,"bottom")},tf=function(e){return e.model.value.get()},nf=function(e){return{x:e}},rf=function(e){return{y:e}},af=function(e,t){return{x:e,y:t}},of=function(e,t){gt(e,Au(),{value:t})},cf=function(e,t,n,r){return t>e?e:e>n?n:e===t?t-1:Math.max(t,e-r)},sf=function(e,t,n,r){return e>n?e:t>e?t:e===n?n+1:Math.min(n,e+r)},lf=function(e,t,n){return Math.max(t,Math.min(n,e))},uf=function(e){var t=e.min,n=e.max,r=e.range,a=e.value,o=e.step,i=e.snap,c=e.snapStart,s=e.rounded,l=e.hasMinEdge,u=e.hasMaxEdge,f=e.minBound,d=e.maxBound,m=e.screenRange,g=l?t-1:t,h=u?n+1:n;if(f>a)return g;if(a>d)return h;var p,y,v,b,w,k,_,x=(w=a,k=f,_=d,Math.min(_,Math.max(w,k))-k),C=lf(x/m*r+t,g,h);return i&&C>=t&&n>=C?(p=C,y=t,v=n,b=o,c.fold(function(){var e=p-y,t=Math.round(e/b)*b;return lf(y+t,y-1,v+1)},function(e){var t=(p-e)%b,n=Math.round(t/b),r=Math.floor((p-e)/b),a=Math.floor((v-e)/b),o=e+Math.min(a,r+n)*b;return Math.max(e,o)})):s?Math.round(C):C},ff=function(e){var t=e.min,n=e.max,r=e.range,a=e.value,o=e.hasMinEdge,i=e.hasMaxEdge,c=e.maxBound,s=e.maxOffset,l=e.centerMinEdge,u=e.centerMaxEdge;return t>a?o?0:l:a>n?i?c:u:(a-t)/r*s},df="left",mf=function(e){return e.element.dom.getBoundingClientRect()},gf=function(e,t){return e[t]},hf=function(e){var t=mf(e);return gf(t,df)},pf=function(e){var t=mf(e);return gf(t,"right")},yf=function(e){var t=mf(e);return gf(t,"top")},vf=function(e){var t=mf(e);return gf(t,"bottom")},bf=function(e){var t=mf(e);return gf(t,"width")},wf=function(e){var t=mf(e);return gf(t,"height")},kf=function(e,t,n){return(e+t)/2-n},_f=function(e,t){var n=mf(e),r=mf(t),a=gf(n,df),o=gf(n,"right"),i=gf(r,df);return kf(a,o,i)},xf=function(e,t){var n=mf(e),r=mf(t),a=gf(n,"top"),o=gf(n,"bottom"),i=gf(r,"top");return kf(a,o,i)},Cf=function(e,t){gt(e,Au(),{value:t})},zf=function(e){return{x:e}},Sf=function(e,t,n){var r={min:Ru(t),max:Lu(t),range:qu(t),value:n,step:Wu(t),snap:Xu(t),snapStart:Ku(t),rounded:Gu(t),hasMinEdge:Ju(t),hasMaxEdge:Zu(t),minBound:hf(e),maxBound:pf(e),screenRange:bf(e)};return uf(r)},Tf=function(e){return function(t,n){return r=t,o=(e>0?sf:cf)(tf(a=n).x,Ru(a),Lu(a),Wu(a)),Cf(r,zf(o)),A.some(o).map(S);var r,a,o}},Ef=function(e,t,n,r,a,o){var i,c,s,l,u,f,d,m,g,h=(c=o,s=n,l=r,u=a,f=bf(i=t),d=l.bind(function(e){return A.some(_f(e,i))}).getOr(0),m=u.bind(function(e){return A.some(_f(e,i))}).getOr(f),g={min:Ru(c),max:Lu(c),range:qu(c),value:s,hasMinEdge:Ju(c),hasMaxEdge:Zu(c),minBound:hf(i),minOffset:0,maxBound:pf(i),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},ff(g));return hf(t)-hf(e)+h},Nf=Tf(-1),Df=Tf(1),Af=A.none,Of=A.none,Rf={"top-left":A.none(),top:A.none(),"top-right":A.none(),right:A.some(function(e,t){of(e,nf(Iu(t)))}),"bottom-right":A.none(),bottom:A.none(),"bottom-left":A.none(),left:A.some(function(e,t){of(e,nf(Mu(t)))})},Pf=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=Sf(e,t,n),a=zf(r);return Cf(e,a),r},setToMin:function(e,t){var n=Ru(t);Cf(e,zf(n))},setToMax:function(e,t){var n=Lu(t);Cf(e,zf(n))},findValueOfOffset:Sf,getValueFromEvent:function(e){return Ou(e).map(function(e){return e.left})},findPositionOfValue:Ef,setPositionFromValue:function(e,t,n,r){var a=tf(n),o=Ef(e,r.getSpectrum(e),a.x,r.getLeftEdge(e),r.getRightEdge(e),n),i=Eu(t.element)/2;Uo(t.element,"left",o-i+"px")},onLeft:Nf,onRight:Df,onUp:Af,onDown:Of,edgeActions:Rf}),Mf=function(e,t){gt(e,Au(),{value:t})},Bf=function(e){return{y:e}},Lf=function(e,t,n){var r={min:Pu(t),max:ju(t),range:Uu(t),value:n,step:Wu(t),snap:Xu(t),snapStart:Ku(t),rounded:Gu(t),hasMinEdge:Qu(t),hasMaxEdge:ef(t),minBound:yf(e),maxBound:vf(e),screenRange:wf(e)};return uf(r)},jf=function(e){return function(t,n){return r=t,o=(e>0?sf:cf)(tf(a=n).y,Pu(a),ju(a),Wu(a)),Mf(r,Bf(o)),A.some(o).map(S);var r,a,o}},If=function(e,t,n,r,a,o){var i,c,s,l,u,f,d,m,g,h=(c=o,s=n,l=r,u=a,f=wf(i=t),d=l.bind(function(e){return A.some(xf(e,i))}).getOr(0),m=u.bind(function(e){return A.some(xf(e,i))}).getOr(f),g={min:Pu(c),max:ju(c),range:Uu(c),value:s,hasMinEdge:Qu(c),hasMaxEdge:ef(c),minBound:yf(i),minOffset:0,maxBound:vf(i),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},ff(g));return yf(t)-yf(e)+h},Ff=A.none,Hf=A.none,qf=jf(-1),Uf=jf(1),Vf={"top-left":A.none(),top:A.some(function(e,t){of(e,rf(Bu(t)))}),"top-right":A.none(),right:A.none(),"bottom-right":A.none(),bottom:A.some(function(e,t){of(e,rf(Fu(t)))}),"bottom-left":A.none(),left:A.none()},$f=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=Lf(e,t,n),a=Bf(r);return Mf(e,a),r},setToMin:function(e,t){var n=Pu(t);Mf(e,Bf(n))},setToMax:function(e,t){var n=ju(t);Mf(e,Bf(n))},findValueOfOffset:Lf,getValueFromEvent:function(e){return Ou(e).map(function(e){return e.top})},findPositionOfValue:If,setPositionFromValue:function(e,t,n,r){var a=tf(n),o=If(e,r.getSpectrum(e),a.y,r.getTopEdge(e),r.getBottomEdge(e),n),i=Zo(t.element)/2;Uo(t.element,"top",o-i+"px")},onLeft:Ff,onRight:Hf,onUp:qf,onDown:Uf,edgeActions:Vf}),Wf=function(e,t){gt(e,Au(),{value:t})},Xf=function(e,t){return{x:e,y:t}},Kf=function(e,t){return function(n,r){return o=n,i=r,c=e>0?sf:cf,s=(a=t)?tf(i).x:c(tf(i).x,Ru(i),Lu(i),Wu(i)),l=a?c(tf(i).y,Pu(i),ju(i),Wu(i)):tf(i).y,Wf(o,Xf(s,l)),A.some(s).map(S);var a,o,i,c,s,l}},Gf=Ou,Yf=Kf(-1,!1),Jf=Kf(1,!1),Zf=Kf(-1,!0),Qf=Kf(1,!0),ed={"top-left":A.some(function(e,t){of(e,af(Mu(t),Bu(t)))}),top:A.some(function(e,t){of(e,af(Vu(t),Bu(t)))}),"top-right":A.some(function(e,t){of(e,af(Iu(t),Bu(t)))}),right:A.some(function(e,t){of(e,af(Iu(t),$u(t)))}),"bottom-right":A.some(function(e,t){of(e,af(Iu(t),Fu(t)))}),bottom:A.some(function(e,t){of(e,af(Vu(t),Fu(t)))}),"bottom-left":A.some(function(e,t){of(e,af(Mu(t),Fu(t)))}),left:A.some(function(e,t){of(e,af(Mu(t),$u(t)))})},td=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=Sf(e,t,n.left),a=Lf(e,t,n.top),o=Xf(r,a);return Wf(e,o),o},setToMin:function(e,t){var n=Ru(t),r=Pu(t);Wf(e,Xf(n,r))},setToMax:function(e,t){var n=Lu(t),r=ju(t);Wf(e,Xf(n,r))},getValueFromEvent:Gf,setPositionFromValue:function(e,t,n,r){var a=tf(n),o=Ef(e,r.getSpectrum(e),a.x,r.getLeftEdge(e),r.getRightEdge(e),n),i=If(e,r.getSpectrum(e),a.y,r.getTopEdge(e),r.getBottomEdge(e),n),c=Eu(t.element)/2,s=Zo(t.element)/2;Uo(t.element,"left",o-c+"px"),Uo(t.element,"top",i-s+"px")},onLeft:Yf,onRight:Jf,onUp:Zf,onDown:Qf,edgeActions:ed}),nd=[Yr("stepSize",1),Yr("onChange",v),Yr("onChoose",v),Yr("onInit",v),Yr("onDragStart",v),Yr("onDragEnd",v),Yr("snapToGrid",!1),Yr("rounded",!0),Wr("snapStart"),Vr("model",Fr("mode",{x:[Yr("minX",0),Yr("maxX",100),Zr("value",function(e){return Oa(e.mode.minX)}),Ur("getInitialValue"),mo("manager",Pf)],y:[Yr("minY",0),Yr("maxY",100),Zr("value",function(e){return Oa(e.mode.minY)}),Ur("getInitialValue"),mo("manager",$f)],xy:[Yr("minX",0),Yr("maxX",100),Yr("minY",0),Yr("maxY",100),Zr("value",function(e){return Oa({x:e.mode.minX,y:e.mode.minY})}),Ur("getInitialValue"),mo("manager",td)]})),qs("sliderBehaviours",[Hs,zu]),Zr("mouseIsDown",function(){return Oa(!1)})],rd=w("mouse.released"),ad=Xl({name:"Slider",configFields:nd,partFields:du,factory:function(e,t){var n,r=function(t){return El(t,e,"thumb")},a=function(t){return El(t,e,"spectrum")},o=function(t){return Tl(t,e,"left-edge")},i=function(t){return Tl(t,e,"right-edge")},c=function(t){return Tl(t,e,"top-edge")},s=function(t){return Tl(t,e,"bottom-edge")},l=e.model,u=l.manager,f=function(t,n){u.setPositionFromValue(t,n,e,{getLeftEdge:o,getRightEdge:i,getTopEdge:c,getBottomEdge:s,getSpectrum:a})},d=function(t,n){l.value.set(n);var a=r(t);return f(t,a),e.onChange(t,a,n),A.some(!0)},m=function(t){var n=e.mouseIsDown.get();e.mouseIsDown.set(!1),n&&Tl(t,e,"thumb").each(function(n){var r=l.value.get();e.onChoose(t,n,r)})},g=function(t,n){n.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,r(t))},h=function(t,n){n.stop(),e.onDragEnd(t,r(t)),m(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Vs(e.sliderBehaviours,[Hs.config({mode:"special",focusIn:function(t){return Tl(t,e,"spectrum").map(Hs.focusIn).map(S)}}),zu.config({store:{mode:"manual",getValue:function(){return l.value.get()}}}),yo.config({channels:((n={})[rd()]={onReceive:m},n)})]),events:oa([ca(Au(),function(e,t){d(e,t.event.value)}),ma(function(t){var n=l.getInitialValue();l.value.set(n);var o=r(t);f(t,o);var i=a(t);e.onInit(t,o,i,l.value.get())}),ca(Le(),g),ca(Ie(),h),ca(Fe(),g),ca(qe(),h)]),apis:{resetToMin:function(t){u.setToMin(t,e)},resetToMax:function(t){u.setToMax(t,e)},changeValue:d,refresh:f},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),od=function(e,t,n,r){return nu(t,function(){var r=n();e.setContextToolbar([{label:t+" group",items:r}])},{},r)},id=function(e){return[(t=e,n=function(e){return 0>e?"black":e>360?"white":"hsl("+e+", 100%, 50%)"},ad.sketch({dom:Jl('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[ad.parts["left-edge"](Zl('<div class="${prefix}-hue-slider-black"></div>')),ad.parts.spectrum({dom:Jl('<div class="${prefix}-slider-gradient-container"></div>'),components:[Zl('<div class="${prefix}-slider-gradient"></div>')],behaviours:Sa([No.config({toggleClass:Po("thumb-active")})])}),ad.parts["right-edge"](Zl('<div class="${prefix}-hue-slider-white"></div>')),ad.parts.thumb({dom:Jl('<div class="${prefix}-slider-thumb"></div>'),behaviours:Sa([No.config({toggleClass:Po("thumb-active")})])})],onChange:function(e,r,a){var o=n(a.x());Uo(r.element,"background-color",o),t.onChange(e,r,o)},onDragStart:function(e,t){No.on(t)},onDragEnd:function(e,t){No.off(t)},onInit:function(e,t,r,a){var o=n(a.x());Uo(t.element,"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:t.getInitialValue()}}},sliderBehaviours:Sa([Ao(ad.refresh)])}))];var t,n},cd=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],sd=function(e,t){return(Tt(t)?A.some(t):Rt(t).filter(Tt)).map(function(t){return r(function(e,t){return t(e)},ni,t,function(e){return Xo(e,"font-size").isSome()},e).bind(function(e){return Xo(e,"font-size")}).getOrThunk(function(){return $o(t,"font-size")})}).getOr("")},ld=function(e){var t=e.selection.getStart(),n=bt.fromDom(t),r=bt.fromDom(e.getBody()),a=sd(function(e){return Ct(r,e)},n);return J(cd,function(e){return a===e}).getOr("medium")},ud=function(e){var t,n=ld(e);return t=n,Z(cd,function(e){return e===t}).getOr(2)},fd=function(e,t){var n;n=t,A.from(cd[n]).each(function(t){var n,r;r=t,ld(n=e)!==r&&n.execCommand("fontSize",!1,r)})},dd=w(cd),md=zr([Ur("getInitialValue"),Ur("onChange"),Ur("category"),Ur("sizes")]),gd=function(e){var t=jr("SizeSlider",md,e);return ad.sketch({dom:{tag:"div",classes:[Po("slider-"+t.category+"-size-container"),Po("slider"),Po("slider-size-container")]},onChange:function(e,n,r){var a,o=r.x();0<=(a=o)&&a<t.sizes.length&&t.onChange(o)},onDragStart:function(e,t){No.on(t)},onDragEnd:function(e,t){No.off(t)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:t.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:Sa([Ao(ad.refresh)]),components:[ad.parts.spectrum({dom:Jl('<div class="${prefix}-slider-size-container"></div>'),components:[Zl('<div class="${prefix}-slider-size-line"></div>')]}),ad.parts.thumb({dom:Jl('<div class="${prefix}-slider-thumb"></div>'),behaviours:Sa([No.config({toggleClass:Po("thumb-active")})])})]})},hd=dd(),pd=function(e){return[Zl('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),gd({onChange:(t=e).onChange,sizes:hd,category:"font",getInitialValue:t.getInitialValue}),Zl('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var t},yd=function(e){var t=void 0!==e.uid&&hn(e,"uid")?e.uid:Fl("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOptional()},asSpec:function(){return y(y({},e),{uid:t})}}},vd=window.Promise?window.Promise:(Zi=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],rc(e,tc(o,this),tc(i,this))},Qi=window,ec=Zi.immediateFn||"function"==typeof Qi.setImmediate&&Qi.setImmediate||function(e){return setTimeout(e,1)},tc=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(t,n)}},nc=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},rc=function(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(a){if(r)return;r=!0,n(a)}},Zi.prototype["catch"]=function(e){return this.then(null,e)},Zi.prototype.then=function(e,t){var n=this;return new Zi(function(r,o){a.call(n,new s(e,t,r,o))})},Zi.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Array.prototype.slice.call(1===e.length&&nc(e[0])?e[0]:e);return new Zi(function(e,t){if(0===n.length)return e([]);for(var r=n.length,a=function(o,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var c=i.then;if("function"==typeof c)return void c.call(i,function(e){a(o,e)},t)}n[o]=i,0==--r&&e(n)}catch(s){t(s)}},o=0;o<n.length;o++)a(o,n[o])})},Zi.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Zi?e:new Zi(function(t){t(e)})},Zi.reject=function(e){return new Zi(function(t,n){n(e)})},Zi.race=function(e){return new Zi(function(t,n){for(var r=0,a=e;r<a.length;r++)a[r].then(t,n)})},Zi),bd=function(e){return t=e,new vd(function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t)}).then(function(e){return e.split(",")[1]});var t},wd=function(e){var t=yd({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:oa([da(Ke()),ca(Xe(),function(t,n){var r,a;r=n.event.raw,a=r.target.files||r.dataTransfer.files,A.from(a[0]).each(function(t){var n,r;n=e,bd(r=t).then(function(e){n.undoManager.transact(function(){var t=n.editorUpload.blobCache,a=t.create(rl("mceu"),r,e);t.add(a);var o=n.dom.createHTML("img",{src:a.blobUri()});n.insertContent(o)})})})})])});return Kl.sketch({dom:tu("image",e),components:[t.asSpec()],action:function(e){t.get(e).element.dom.click()}})},kd=function(e){return e.dom.textContent},_d=function(e){return 0<e.length},xd=function(e){return void 0===e||null===e?"":e},Cd=function(e){return Td(e).fold(function(){return{url:"",text:e.selection.getContent({format:"text"}),title:"",target:"",link:A.none()}},function(e){return n=kd(t=e),r=bn(t,"href"),a=bn(t,"title"),o=bn(t,"target"),{url:xd(r),text:n!==r?xd(n):"",title:xd(a),target:xd(o),link:A.some(t)};var t,n,r,a,o})},zd=function(e,t,n){return n.text.toOptional().filter(_d).fold(function(){return bn(n=e,"href")===kd(n)?A.some(t):A.none();var n},A.some)},Sd=function(e,t){t.url.toOptional().filter(_d).fold(function(){var n;n=e,t.link.bind(k).each(function(){n.execCommand("unlink")})},function(n){var r,a,o=(r=t,(a={}).href=n,r.title.toOptional().filter(_d).each(function(e){a.title=e}),r.target.toOptional().filter(_d).each(function(e){a.target=e}),a);t.link.bind(k).fold(function(){var r=t.text.toOptional().filter(_d).getOr(n);e.insertContent(e.dom.createHTML("a",o,e.dom.encode(r)))},function(e){var r=zd(e,n,t);vn(e,o),r.each(function(t){var n;n=t,e.dom.textContent=n})})})},Td=function(e){var t=bt.fromDom(e.selection.getStart());return ii(t,"a")},Ed=Me(),Nd=function(e,t){var n=t.selection.getRng();e(),t.selection.setRng(n)},Dd=function(e,t){var n,r;return{key:e,value:{config:{},me:(n=e,r=oa(t),Ea({fields:[Ur("enabled")],name:n,active:{events:w(r)}})),configAsRaw:w({}),initialConfig:{},state:Ca}}},Ad=Object.freeze({__proto__:null,getCurrent:function(e,t){return t.find(e)}}),Od=[Ur("find")],Rd=Ea({fields:Od,name:"composing",apis:Ad}),Pd=Wl({name:"Container",factory:function(t){var n=t.dom,r=n.attributes,a=e(n,["attributes"]);return{uid:t.uid,dom:y({tag:"div",attributes:y({role:"presentation"},r)},a),components:t.components,behaviours:Us(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Yr("components",[]),qs("containerBehaviours",[]),Yr("events",{}),Yr("domModification",{}),Yr("eventOrder",{})]}),Md=Wl({name:"DataField",factory:function(e){return{uid:e.uid,dom:e.dom,behaviours:Ws(e.dataBehaviours,[zu.config({store:{mode:"memory",initialValue:e.getInitialValue()}}),Rd.config({find:A.some})]),events:oa([ma(function(t){zu.setValue(t,e.getInitialValue())})])}},configFields:[Ur("uid"),Ur("dom"),Ur("getInitialValue"),$s("dataBehaviours",[zu,Rd])]}),Bd=function(e){return e.dom.value},Ld=function(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},jd=w([Wr("data"),Yr("inputAttributes",{}),Yr("inputStyles",{}),Yr("tag","input"),Yr("inputClasses",[]),so("onSetValue"),Yr("styles",{}),Yr("eventOrder",{}),qs("inputBehaviours",[zu,Fo]),Yr("selectOnFocus",!0)]),Id=function(e){return y(y({},(t=e,Sa([Fo.config({onFocus:t.selectOnFocus?function(e){var t=e.element,n=Bd(t);t.dom.setSelectionRange(0,n.length)}:v})]))),Vs(e.inputBehaviours,[zu.config({store:y(y({mode:"manual"},e.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return Bd(e.element)},setValue:function(e,t){Bd(e.element)!==t&&Ld(e.element,t)}}),onSetValue:e.onSetValue})]));var t},Fd=Wl({name:"Input",configFields:jd(),factory:function(e){return{uid:e.uid,dom:{tag:(t=e).tag,attributes:y({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:Id(e),eventOrder:e.eventOrder};var t}}),Hd=Object.freeze({__proto__:null,exhibit:function(e,t){return ba({attributes:mr([{key:t.tabAttr,value:"true"}])})}}),qd=[Yr("tabAttr","data-alloy-tabstop")],Ud=Ea({fields:qd,name:"tabstopping",active:Hd}),Vd=tinymce.util.Tools.resolve("tinymce.util.I18n"),$d=function(e,t){var n=yd(Fd.sketch({inputAttributes:{placeholder:Vd.translate(t)},onSetValue:function(e){mt(e,We())},inputBehaviours:Sa([Rd.config({find:A.some}),Ud.config({}),Hs.config({mode:"execution"})]),selectOnFocus:!1})),r=yd(Kl.sketch({dom:Jl('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(e){var t=n.get(e);zu.setValue(t,"")}}));return{name:e,spec:Pd.sketch({dom:Jl('<div class="${prefix}-input-container"></div>'),components:[n.asSpec(),r.asSpec()],containerBehaviours:Sa([No.config({toggleClass:Po("input-container-empty")}),Rd.config({find:function(e){return A.some(n.get(e))}}),Dd("input-clearing",[ca(We(),function(e){var t=n.get(e);(0<zu.getValue(t).length?No.off:No.on)(e)})])])})}},Wd=["input","button","textarea","select"],Xd=function(e,t){(t.disabled()?Qd:em)(e,t)},Kd=function(e,t){return!0===t.useNative&&V(Wd,zt(e.element))},Gd=function(e){yn(e.element,"disabled","disabled")},Yd=function(e){_n(e.element,"disabled")},Jd=function(e){yn(e.element,"aria-disabled","true")},Zd=function(e){yn(e.element,"aria-disabled","false")},Qd=function(e,t){t.disableClass.each(function(t){Tn(e.element,t)}),(Kd(e,t)?Gd:Jd)(e),t.onDisabled(e)},em=function(e,t){t.disableClass.each(function(t){Nn(e.element,t)}),(Kd(e,t)?Yd:Zd)(e),t.onEnabled(e)},tm=function(e,t){return Kd(e,t)?kn(e.element,"disabled"):"true"===bn(e.element,"aria-disabled")},nm=Object.freeze({__proto__:null,enable:em,disable:Qd,isDisabled:tm,onLoad:Xd,set:function(e,t,n,r){(r?Qd:em)(e,t)}}),rm=Object.freeze({__proto__:null,exhibit:function(e,t){return ba({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(e,t){return oa([ia(rt(),function(t){return tm(t,e)}),wa(e,t,Xd)])}}),am=[Jr("disabled",z,qr),Yr("useNative",!0),Wr("disableClass"),so("onDisabled"),so("onEnabled")],om=Ea({fields:am,name:"disabling",active:rm,apis:nm}),im=[qs("formBehaviours",[zu])],cm=function(e){return"<alloy.field."+e+">"},sm=function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Vs(e.formBehaviours,[zu.config({store:{mode:"manual",getValue:function(t){var n,r,a=(n=e,r=t.getSystem(),ln(n.partUids,function(e){return w(r.getByUid(e))}));return ln(a,function(e,t){return e().bind(function(e){var n,r,a=Rd.getCurrent(e);return n=a,r=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Xa(e.element)),n.fold(function(){return Mn.error(r)},Mn.value)}).map(zu.getValue)})},setValue:function(t,n){sn(n,function(n,r){Tl(t,e,r).each(function(e){Rd.getCurrent(e).each(function(e){zu.setValue(e,n)})})})}}})]),apis:{getField:function(t,n){return Tl(t,e,n).bind(Rd.getCurrent)}}}},lm=(Rl(function(e,t,n){return e.getField(t,n)}),function(e){var t,n=(t=[],{field:function(e,n){return t.push(e),r="form",a=cm(e),o=n,{uiType:tl(),owner:r,name:a,config:o,validated:{}};var r,a,o},record:function(){return t}}),r=e(n),a=n.record(),o=W(a,function(e){return vl({name:e,pname:cm(e)})});return ql("form",im,o,sm,r)}),um=function(){var e=Oa(A.none()),t=function(){return e.get().each(function(e){return e.destroy()})};return{clear:function(){t(),e.set(A.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(A.some(n))},run:function(t){return e.get().each(t)}}},fm=function(){var e=Oa(A.none());return{clear:function(){return e.set(A.none())},set:function(t){return e.set(A.some(t))},isSet:function(){return e.get().isSome()},on:function(t){return e.get().each(t)}}},dm=function(e){var t="navigateEvent",n=Sr([Ur("fields"),Yr("maxFieldIndex",e.fields.length-1),Ur("onExecute"),Ur("getInitialValue"),Zr("state",function(){return{dialogSwipeState:fm(),currentScreen:Oa(0)}})]),r=jr("SerialisedDialog",n,e),a=function(e,n,r){return Kl.sketch({dom:Jl('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){gt(n,t,{direction:e})},buttonBehaviours:Sa([om.config({disableClass:Po("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},o=function(e,t){var n=ti(e.element,"."+Po("serialised-dialog-screen"));oi(e.element,"."+Po("serialised-dialog-chain")).each(function(e){0<=r.state.currentScreen.get()+t&&r.state.currentScreen.get()+t<n.length&&(Xo(e,"left").each(function(r){var a=parseInt(r,10),o=Eu(n[0]);Uo(e,"left",a-t*o+"px")}),r.state.currentScreen.set(r.state.currentScreen.get()+t))})},i=function(e){var t=ti(e.element,"input");A.from(t[r.state.currentScreen.get()]).each(function(t){e.getSystem().getByDom(t).each(function(t){var n,r;n=e,r=t.element,n.getSystem().triggerFocus(r,n.element)})});var n=s.get(e);Ii.highlightAt(n,r.state.currentScreen.get())},c=yd(lm(function(e){return{dom:Jl('<div class="${prefix}-serialised-dialog"></div>'),components:[Pd.sketch({dom:Jl('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:W(r.fields,function(t,n){return n<=r.maxFieldIndex?Pd.sketch({dom:Jl('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[a(-1,"previous",n>0),e.field(t.name,t.spec),a(1,"next",n<r.maxFieldIndex)]}):e.field(t.name,t.spec)})})],formBehaviours:Sa([Ao(function(e,t){var n;n=t,oi(e.element,"."+Po("serialised-dialog-chain")).each(function(e){Uo(e,"left",-r.state.currentScreen.get()*n.width+"px")})}),Hs.config({mode:"special",focusIn:function(e){i(e)},onTab:function(e){return o(e,1),A.some(!0)},onShiftTab:function(e){return o(e,-1),A.some(!0)}}),Dd("form-events",[ma(function(e){r.state.currentScreen.set(0),r.state.dialogSwipeState.clear();var t=s.get(e);Ii.highlightFirst(t),r.getInitialValue(e).each(function(t){zu.setValue(e,t)})}),pa(r.onExecute),ca(Ge(),function(e,t){"left"===t.event.raw.propertyName&&i(e)}),ca(t,function(e,t){var n=t.event.direction;o(e,n)})])])}})),s=yd({dom:Jl('<div class="${prefix}-dot-container"></div>'),behaviours:Sa([Ii.config({highlightClass:Po("dot-active"),itemClass:Po("dot-item")})]),components:ee(r.fields,function(e,t){return t<=r.maxFieldIndex?[Zl('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:Jl('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),s.asSpec()],behaviours:Sa([Hs.config({mode:"special",focusIn:function(e){var t=c.get(e);Hs.focusIn(t)}}),Dd("serializer-wrapper-events",[ca(Le(),function(e,t){var n=t.event;r.state.dialogSwipeState.set({xValue:n.raw.touches[0].clientX,points:[]})}),ca(je(),function(e,t){var n=t.event;r.state.dialogSwipeState.on(function(e){t.event.prevent(),r.state.dialogSwipeState.set(function(e,t){if(t===e.xValue)return e;var n=0<t-e.xValue?1:-1,r={direction:n,xValue:t};return{xValue:t,points:(0===e.points.length?[]:e.points[e.points.length-1].direction===n?e.points.slice(0,e.points.length-1):e.points).concat([r])}}(e,n.raw.touches[0].clientX))})}),ca(Ie(),function(e){r.state.dialogSwipeState.on(function(t){var n=c.get(e),r=-1*function(e){if(0===e.points.length)return 0;var t=e.points[0].direction,n=e.points[e.points.length-1].direction;return-1===t&&-1===n?-1:1===t&&1===n?1:0}(t);o(n,r)})})])])}},mm=T(function(e,t){return[{label:"the link group",items:[dm({fields:[$d("url","Type or paste URL"),$d("text","Link text"),$d("title","Link title"),$d("target","Link target"),{name:"link",spec:Md.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return A.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return A.some(Cd(t))},onExecute:function(n){var r=zu.getValue(n);Sd(t,r),e.restoreToolbar(),t.focus()}})]}]}),gm=function(e,t){return eu(t,"link","link",function(){var n,r,a=mm(e,t);e.setContextToolbar(a),n=t,r=function(){e.focusToolbar()},(Ed.os.isAndroid()?Nd:C)(r,n),Td(t).each(function(e){t.selection.select(e.dom)})})},hm=oa([{key:Qe(),value:ra({can:function(e,t){var n,r,a=t.event,o=a.originator,i=a.target;return r=i,!(Ct(n=o,e.element)&&!Ct(n,r)&&(console.warn(Qe()+" did not get interpreted by the desired target. \nOriginator: "+Xa(o)+"\nTarget: "+Xa(i)+"\nCheck the "+Qe()+" event handlers"),1))}})}]),pm=Object.freeze({__proto__:null,events:hm}),ym=k,vm=function(e){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(e?"\n"+Xa(e().element)+" is not in context.":""))}};return{debugInfo:w("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:z}},bm=vm(),wm=function(e,t){var n={};return sn(e,function(e,r){sn(e,function(e,a){var o=mn(n,a).getOr([]);n[a]=o.concat([t(r,e)])})}),n},km=function(e,t,n,r){try{var a=(i=n,c=function(n,a){var o=n[t],i=a[t],c=r.indexOf(o),s=r.indexOf(i);if(-1===c)throw new Error("The ordering for "+e+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===s)throw new Error("The ordering for "+e+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));return s>c?-1:c>s?1:0},(s=H.call(i,0)).sort(c),s);return Mn.value(a)}catch(o){return Mn.error([o])}var i,c,s},_m=function(e){return e.cHandler},xm=function(e,t){return{name:e,handler:t}},Cm=function(e,t,n){var r,a,o=y(y({},n),(r=e,a={},X(t,function(e){a[e.name()]=e.handlers(r)}),a));return wm(o,xm)},zm=function(e){var t,n=I(t=e)?{can:S,abort:z,run:t}:t;return function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var o=[e,t].concat(r);n.abort.apply(void 0,o)?t.stop():n.can.apply(void 0,o)&&n.run.apply(void 0,o)}},Sm=function(e,t,n){var r,a,o=t[n];return o?km("Event: "+n,"name",e,o).map(function(e){var t=W(e,function(e){return e.handler});return aa(t)}):(r=n,a=e,Mn.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(a,function(e){return e.name}),null,2)]))},Tm=function(e,t){var n=dn(e,function(e,n){return(1===e.length?Mn.value(e[0].handler):Sm(e,t,n)).map(function(r){var a=zm(r),o=1<e.length?K(t[n],function(t){return $(e,function(e){return e.name===t})}).join(" > "):e[0].name;return dr(n,{handler:a,purpose:o})})});return gr(n,{})},Em="alloy.base.behaviour",Nm=function(e){var t,n;return Br("custom.definition",Sr([Dr("dom","dom",ir(),Sr([Ur("tag"),Yr("styles",{}),Yr("classes",[]),Yr("attributes",{}),Wr("value"),Wr("innerHtml")])),Ur("components"),Ur("uid"),Yr("events",{}),Yr("apis",{}),Dr("eventOrder","eventOrder",((t={})[rt()]=["disabling",Em,"toggling","typeaheadevents"],t[Qe()]=[Em,"focusing","keying"],t[ct()]=[Em,"disabling","toggling","representing"],t[We()]=[Em,"representing","streaming","invalidating"],t[lt()]=[Em,"representing","item-events","tooltipping"],t[Fe()]=["focusing",Em,"item-type-events"],t[Le()]=["focusing",Em,"item-type-events"],t[Ue()]=["item-type-events","tooltipping"],t[nt()]=["receiving","reflecting","tooltipping"],n=t,ar.mergeWithThunk(w(n))),Hr()),Wr("domModification")]),e)},Dm=function(e,t){X(t,function(t){Tn(e,t)})},Am=function(e,t){X(t,function(t){Nn(e,t)})},Om=function(e,t){return n=e,a=W(r=t,function(e){return Kr(e.name(),[Ur("config"),Yr("state",Ca)])}),o=Br("component.behaviours",Sr(a),n.behaviours).fold(function(e){throw new Error(Ir(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(e){return e}),{list:r,data:ln(o,function(e){var t=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return t}})};var n,r,a,o},Rm=function(e){var t,n,r=(t=mn(e,"behaviours").getOr({}),n=K(on(t),function(e){return void 0!==t[e]}),W(n,function(e){return t[e].me}));return Om(e,r)},Pm=function(e,t,n){var r,a,o,i=y(y({},(r=e).dom),{uid:r.uid,domChildren:W(r.components,function(e){return e.element})}),c=e.domModification.fold(function(){return ba({})},ba),s={"alloy.base.modification":c},l=0<t.length?function(e,t,n,r){var a=y({},t);X(n,function(t){a[t.name()]=t.exhibit(e,r)});var o=wm(a,function(e,t){return{name:e,modification:t}}),i=function(e){return G(e,function(e,t){return y(y({},t.modification),e)},{})},c=G(o.classes,function(e,t){return t.modification.concat(e)},[]),s=i(o.attributes),l=i(o.styles);return ba({classes:c,attributes:s,styles:l})}(n,s,t,i):c;return o=l,y(y({},a=i),{attributes:y(y({},a.attributes),o.attributes),styles:y(y({},a.styles),o.styles),classes:a.classes.concat(o.classes)})},Mm=function(e,t,n){var r,a,o,i={"alloy.base.behaviour":e.events};return r=n,a=e.eventOrder,o=Cm(r,t,i),Tm(o,a).getOrDie()},Bm=function(e){var t=function(){return u},n=Oa(bm),r=Lr(Nm(e)),a=Rm(e),o=a.list,i=a.data,c=function(e){var t=bt.fromTag(e.tag);vn(t,e.attributes),Dm(t,e.classes),Vo(t,e.styles),e.innerHtml.each(function(e){return $a(t,e)});var n=e.domChildren;return Ft(t,n),e.value.each(function(e){Ld(t,e)}),e.uid,jl(t,e.uid),t}(Pm(r,o,i)),s=Mm(r,o,i),l=Oa(r.components),u={getSystem:n.get,config:function(t){var n=i;return(I(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(e){return I(i[e.name()])},spec:e,readState:function(e){return i[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(e){n.set(e)},disconnect:function(){n.set(vm(t))},element:c,syncComponents:function(){var e=Pt(c),t=ee(e,function(e){return n.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});l.set(t)},components:l.get,events:s};return u},Lm=function(t){var n,r=ym(t),a=r.events,o=e(r,["events"]),i=(n=mn(o,"components").getOr([]),W(n,Hm)),c=y(y({},o),{events:y(y({},pm),a),components:i});return Mn.value(Bm(c))},jm=function(e){var t=bt.fromText(e);return Im({element:t})},Im=function(e){var t=jr("external.component",zr([Ur("element"),Wr("uid")]),e),n=Oa(vm());t.uid.each(function(e){jl(t.element,e)});var r={getSystem:n.get,config:A.none,hasConfigured:z,connect:function(e){n.set(e)},disconnect:function(){
n.set(vm(function(){return r}))},getApis:function(){return{}},element:t.element,spec:e,readState:w("No state"),syncComponents:v,components:w([]),events:{}};return Ol(r)},Fm=Fl,Hm=function(e){return mn(e,Al).fold(function(){var t=e.hasOwnProperty("uid")?e:y({uid:Fm("")},e);return Lm(t).getOrDie()},function(e){return e})},qm=Ol,Um="alloy.item-hover",Vm="alloy.item-focus",$m=function(e){(Ba(e.element).isNone()||Fo.isFocused(e))&&(Fo.isFocused(e)||Fo.focus(e),gt(e,Um,{item:e}))},Wm=function(e){gt(e,Vm,{item:e})},Xm=w(Um),Km=w(Vm),Gm=[Ur("data"),Ur("components"),Ur("dom"),Yr("hasSubmenu",!1),Wr("toggling"),$s("itemBehaviours",[No,Fo,Hs,zu]),Yr("ignoreFocus",!1),Yr("domModification",{}),mo("builder",function(e){return{dom:e.dom,domModification:y(y({},e.domModification),{attributes:y(y(y({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ws(e.itemBehaviours,[e.toggling.fold(No.revoke,function(e){return No.config(y({aria:{mode:"checked"}},e))}),Fo.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){Wm(e)}}),Hs.config({mode:"execution"}),zu.config({store:{mode:"memory",initialValue:e.data}}),Dd("item-type-events",t(Mo(),[ca(Ue(),$m),ca(at(),Fo.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),Yr("eventOrder",{})],Ym=[Ur("dom"),Ur("components"),mo("builder",function(e){return{dom:e.dom,components:e.components,events:oa([(t=at(),ca(t,function(e,t){t.stop()}))])};var t})],Jm=w("item-widget"),Zm=w([vl({name:"widget",overrides:function(e){return{behaviours:Sa([zu.config({store:{mode:"manual",getValue:function(){return e.data},setValue:v}})])}}})]),Qm=[Ur("uid"),Ur("data"),Ur("components"),Ur("dom"),Yr("autofocus",!1),Yr("ignoreFocus",!1),$s("widgetBehaviours",[zu,Fo,Hs]),Yr("domModification",{}),Dl(Zm()),mo("builder",function(e){var t=zl(Jm(),e,Zm()),n=Sl(Jm(),e,t.internals()),r=function(t){return Tl(t,e,"widget").map(function(e){return Hs.focusIn(e),e})},a=function(t,n){return yc(n.event.target)||e.autofocus&&n.setSource(t.element),A.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:oa([pa(function(e,t){r(e).each(function(){t.stop()})}),ca(Ue(),$m),ca(at(),function(t){e.autofocus?r(t):Fo.focus(t)})]),behaviours:Ws(e.widgetBehaviours,[zu.config({store:{mode:"memory",initialValue:e.data}}),Fo.config({ignore:e.ignoreFocus,onFocus:function(e){Wm(e)}}),Hs.config({mode:"special",focusIn:e.autofocus?function(e){r(e)}:Da(),onLeft:a,onRight:a,onEscape:function(t,n){return Fo.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),A.none()):(Fo.focus(t),A.some(!0))}})])}})],eg=Fr("type",{widget:Qm,item:Gm,separator:Ym}),tg=w([wl({factory:{sketch:function(e){var t=jr("menu.spec item",eg,e);return t.builder(t)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:y(y({},t),{uid:Fl("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),ng=w([Ur("value"),Ur("items"),Ur("dom"),Ur("components"),Yr("eventOrder",{}),qs("menuBehaviours",[Ii,zu,Rd,Hs]),Jr("movement",{mode:"menu",moveOnTab:!0},Fr("mode",{grid:[ho(),mo("config",function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}})],matrix:[mo("config",function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),Ur("rowSelector")],menu:[Yr("moveOnTab",!0),mo("config",function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}})]})),Vr("markers",oo()),Yr("fakeFocus",!1),Yr("focusManager",Hi()),so("onHighlight")]),rg=w("alloy.menu-focus"),ag=Xl({name:"Menu",configFields:ng(),partFields:tg(),factory:function(e,t){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Vs(e.menuBehaviours,[Ii.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),zu.config({store:{mode:"memory",initialValue:e.value}}),Rd.config({find:A.some}),Hs.config(e.movement.config(e,e.movement))]),events:oa([ca(Km(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){Ii.highlight(e,n),t.stop(),gt(e,rg(),{menu:e,item:n})})}),ca(Xm(),function(e,t){var n=t.event.item;Ii.highlight(e,n)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),og=function(e,t){var n=Wt(t),r=Ma(n).bind(function(e){var n,r,a=function(t){return Ct(e,t)};return a(t)?A.some(t):(n=a,(r=function(e){for(var t=0;t<e.childNodes.length;t++){var a=bt.fromDom(e.childNodes[t]);if(n(a))return A.some(a);var o=r(e.childNodes[t]);if(o.isSome())return o}return A.none()})(t.dom))}),a=e(t);return r.each(function(e){Ma(n).filter(function(t){return Ct(t,e)}).fold(function(){Ra(e)},v)}),a},ig=function(e,t,n,r){var a=e.getSystem().build(r);nn(e,a,n)},cg=function(e,t,n,r){var a=sg(e);J(a,function(e){return Ct(r.element,e.element)}).each(rn)},sg=function(e){return e.components()},lg=function(e,t,n,r,a){var o=sg(e);return A.from(o[r]).map(function(t){return cg(e,0,0,t),a.each(function(t){ig(e,0,function(e,t){var n,a;a=t,Mt(n=e,r).fold(function(){It(n,a)},function(e){Bt(e,a)})},t)}),t})},ug=Ea({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,r){ig(e,0,It,r)},prepend:function(e,t,n,r){ig(e,0,jt,r)},remove:cg,replaceAt:lg,replaceBy:function(e,t,n,r,a){var o=sg(e);return Z(o,r).bind(function(t){return lg(e,0,0,t,a)})},set:function(e,t,n,r){og(function(){var t=W(r,e.getSystem().build);tn(e,t)},e.element)},contents:sg})}),fg=function(e,t,n,r){return mn(n,r).bind(function(r){return mn(e,r).bind(function(r){var a=fg(e,t,n,r);return A.some([r].concat(a))})}).getOr([])},dg=function(e,t){var n={};sn(e,function(e,t){X(e,function(e){n[e]=t})});var r=t,a=un(t,function(e,t){return{k:e,v:t}}),o=ln(a,function(e,t){return[t].concat(fg(n,r,a,t))});return ln(n,function(e){return mn(o,e).getOr([e])})},mg=function(e){return"prepared"===e.type?A.some(e.menu):A.none()},gg={init:function(){var e=Oa({}),t=Oa({}),n=Oa({}),r=Oa(A.none()),a=Oa({}),o=function(t){return function(e,t){for(var n=on(e),r=0,a=n.length;a>r;r++){var o=n[r],i=e[o];if(t(i,o,e))return A.some(i)}return A.none()}(e.get(),function(e){return e===t})},i=function(e){return c(e).bind(mg)},c=function(e){return mn(t.get(),e)},s=function(t){return mn(e.get(),t)};return{setMenuBuilt:function(e,n){var r;t.set(y(y({},t.get()),((r={})[e]={type:"prepared",menu:n},r)))},setContents:function(o,i,c,s){r.set(A.some(o)),e.set(c),t.set(i),a.set(s);var l=dg(s,c);n.set(l)},expand:function(t){return mn(e.get(),t).map(function(e){var r=mn(n.get(),t).getOr([]);return[e].concat(r)})},refresh:function(e){return mn(n.get(),e)},collapse:function(e){return mn(n.get(),e).bind(function(e){return 1<e.length?A.some(e.slice(1)):A.none()})},lookupMenu:c,lookupItem:s,otherMenus:function(e){var t=a.get();return re(on(t),e)},getPrimary:function(){return r.get().bind(i)},getMenus:function(){return t.get()},clear:function(){e.set({}),t.set({}),n.set({}),r.set(A.none())},isClear:function(){return r.get().isNone()},getTriggeringPath:function(e,t){var a=K(s(e).toArray(),function(e){return i(e).isSome()});return mn(n.get(),e).bind(function(e){var n=ne(a.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(!r.isSome())return A.none();t.push(r.getOrDie())}return A.some(t)}(ee(n,function(e,a){return c=e,s=t,l=n.slice(0,a+1),i(c).bind(function(e){return o(c).bind(function(t){return s(t).map(function(t){return{triggeredMenu:e,triggeringItem:t,triggeringPath:l}})})}).fold(function(){return r.get().is(e)?[]:[A.none()]},function(e){return[A.some(e)]});var c,s,l}))})}}},extractPreparedMenu:mg},hg=w("collapse-item"),pg=Wl({name:"TieredMenu",configFields:[fo("onExecute"),fo("onEscape"),uo("onOpenMenu"),uo("onOpenSubmenu"),so("onRepositionMenu"),so("onCollapseMenu"),Yr("highlightImmediately",!0),$r("data",[Ur("primary"),Ur("menus"),Ur("expansions")]),Yr("fakeFocus",!1),so("onHighlight"),so("onHover"),$r("markers",[Ur("backgroundMenu")].concat(ro()).concat(ao())),Ur("dom"),Yr("navigateOnHover",!0),Yr("stayInDom",!1),qs("tmenuBehaviours",[Hs,Ii,Rd,ug]),Yr("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(e){var t,n,r=Oa(A.none()),a=function(t,n,r){return ln(r,function(r,a){var o=function(){return ag.sketch(y(y({},r),{value:a,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:e.fakeFocus?{get:t=function(e){return Ii.getHighlighted(e).map(function(e){return e.element})},set:function(e,n){var r=t(e);e.getSystem().getByDom(n).fold(v,function(t){Ii.highlight(e,t)});var a=t(e);Fi(e,r,a)}}:Hi()}));var t};return a===n?{type:"prepared",menu:t.getSystem().build(o())}:{type:"notbuilt",nbMenu:o}})},o=gg.init(),i=function(e){return zu.getValue(e).value},c=function(){return ln(e.data.menus,function(e){return ee(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})})},s=function(e,t){Ii.highlight(e,t),Ii.getHighlighted(t).orThunk(function(){return Ii.getFirst(t)}).each(function(t){pt(e,t.element,at())})},l=function(e,t){return Ei(W(t,function(t){return e.lookupMenu(t).bind(function(e){return"prepared"===e.type?A.some(e.menu):A.none()})}))},u=function(t,n,r){var a=l(n,n.otherMenus(r));X(a,function(n){Am(n.element,[e.markers.backgroundMenu]),e.stayInDom||ug.remove(t,n)})},f=function(t,n){var a,o=(a=t,r.get().getOrThunk(function(){var t={},n=ti(a.element,"."+e.markers.item),o=K(n,function(e){return"true"===bn(e,"aria-haspopup")});return X(o,function(e){a.getSystem().getByDom(e).each(function(e){var n=i(e);t[n]=e})}),r.set(A.some(t)),t}));sn(o,function(e,t){var r=V(n,t);yn(e.element,"aria-expanded",r)})},d=function(t,n,r){return A.from(r[0]).bind(function(a){return n.lookupMenu(a).bind(function(a){if("notbuilt"===a.type)return A.none();var o=a.menu,i=l(n,r.slice(1));return X(i,function(t){Tn(t.element,e.markers.backgroundMenu)}),Gt(o.element)||ug.append(t,qm(o)),Am(o.element,[e.markers.backgroundMenu]),s(t,o),u(t,n,r),A.some(o)})})};(n=t=t||{})[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent";var m=function(n,r,a){void 0===a&&(a=t.HighlightSubmenu);var c=i(r);return o.expand(c).bind(function(i){return f(n,i),A.from(i[0]).bind(function(c){return o.lookupMenu(c).bind(function(s){var l=function(e,t,n){if("notbuilt"!==n.type)return n.menu;var r=e.getSystem().build(n.nbMenu());return o.setMenuBuilt(t,r),r}(n,c,s);return Gt(l.element)||ug.append(n,qm(l)),e.onOpenSubmenu(n,r,l,ne(i)),a===t.HighlightSubmenu?(Ii.highlightFirst(l),d(n,o,i)):(Ii.dehighlightAll(l),A.some(r))})})})},g=function(t,n){var r=i(n);return o.collapse(r).bind(function(r){return f(t,r),d(t,o,r).map(function(r){return e.onCollapseMenu(t,n,r),r})})},h=function(t){return function(n,r){return ii(r.getSource(),"."+e.markers.item).bind(function(e){return n.getSystem().getByDom(e).toOptional().bind(function(e){return t(n,e).map(S)})})}},p=oa([ca(rg(),function(e,t){var n=t.event.item;o.lookupItem(i(n)).each(function(){var n=t.event.menu;Ii.highlight(e,n);var r=i(t.event.item);o.refresh(r).each(function(t){return u(e,o,t)})})}),pa(function(n,r){var a=r.event.target;n.getSystem().getByDom(a).each(function(r){0===i(r).indexOf("collapse-item")&&g(n,r),m(n,r,t.HighlightSubmenu).fold(function(){e.onExecute(n,r)},v)})}),ma(function(t){var n,r;n=a(t,e.data.primary,e.data.menus),r=c(),o.setContents(e.data.primary,n,e.data.expansions,r),o.getPrimary().each(function(n){ug.append(t,qm(n)),e.onOpenMenu(t,n),e.highlightImmediately&&s(t,n)})})].concat(e.navigateOnHover?[ca(Xm(),function(n,r){var a,c,s=r.event.item;a=n,c=i(s),o.refresh(c).bind(function(e){return f(a,e),d(a,o,e)}),m(n,s,t.HighlightParent),e.onHover(n,s)})]:[])),b=function(e){return Ii.getHighlighted(e).bind(Ii.getHighlighted)},w={collapseMenu:function(e){b(e).each(function(t){g(e,t)})},highlightPrimary:function(e){o.getPrimary().each(function(t){s(e,t)})},repositionMenus:function(t){o.getPrimary().bind(function(e){return b(t).bind(function(e){var t,n=i(e),r=(t=o.getMenus(),dn(t,function(e){return e})),a=Ei(W(r,gg.extractPreparedMenu));return o.getTriggeringPath(n,function(e){return t=e,ie(a,function(e){if(!e.getSystem().isConnected())return A.none();var n=Ii.getCandidates(e);return J(n,function(e){return i(e)===t})});var t})}).map(function(t){return{primary:e,triggeringPath:t}})}).fold(function(){var n;n=t,A.from(n.components()[0]).filter(function(e){return"menu"===bn(e.element,"role")}).each(function(n){e.onRepositionMenu(t,n,[])})},function(n){var r=n.primary,a=n.triggeringPath;e.onRepositionMenu(t,r,a)})}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Vs(e.tmenuBehaviours,[Hs.config({mode:"special",onRight:h(function(e,n){return yc(n.element)?A.none():m(e,n,t.HighlightSubmenu)}),onLeft:h(function(e,t){return yc(t.element)?A.none():g(e,t)}),onEscape:h(function(t,n){return g(t,n).orThunk(function(){return e.onEscape(t,n).map(function(){return t})})}),focusIn:function(e){o.getPrimary().each(function(t){pt(e,t.element,at())})}}),Ii.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),Rd.config({find:function(e){return Ii.getHighlighted(e)}}),ug.config({})]),eventOrder:e.eventOrder,apis:w,events:p}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:dr(e,t),expansions:{}}},collapseItem:function(e){return{value:rl(hg()),meta:{text:e}}}}}),yg=function(e,t,n,r){return mn(t.routes,r.start).bind(function(e){return mn(e,r.destination)})},vg=function(e,t,n,r){return yg(0,t,0,r).bind(function(e){return e.transition.map(function(t){return{transition:t,route:e}})})},bg=function(e,t,n){var r,a,o;o=n,wg(r=e,a=t).bind(function(e){return vg(r,a,o,e)}).each(function(n){var r=n.transition;Nn(e.element,r.transitionClass),_n(e.element,t.destinationAttr)})},wg=function(e,t){var n=e.element;return wn(n,t.destinationAttr).map(function(n){return{start:bn(e.element,t.stateAttr),destination:n}})},kg=function(e,t,n,r){bg(e,t,n),kn(e.element,t.stateAttr)&&bn(e.element,t.stateAttr)!==r&&t.onFinish(e,r),yn(e.element,t.stateAttr,r)},_g=Object.freeze({__proto__:null,findRoute:yg,disableTransition:bg,getCurrentRoute:wg,jumpTo:kg,progressTo:function(e,t,n,r){var a,o;o=t,kn((a=e).element,o.destinationAttr)&&(wn(a.element,o.destinationAttr).each(function(e){yn(a.element,o.stateAttr,e)}),_n(a.element,o.destinationAttr));var i,c,s=(i=t,c=r,{start:bn(e.element,i.stateAttr),destination:c});vg(e,t,n,s).fold(function(){kg(e,t,n,r)},function(a){bg(e,t,n);var o=a.transition;Tn(e.element,o.transitionClass),yn(e.element,t.destinationAttr,r)})},getState:function(e,t){return wn(e.element,t.stateAttr)}}),xg=Object.freeze({__proto__:null,events:function(e,t){return oa([ca(Ge(),function(n,r){var a=r.event.raw;wg(n,e).each(function(r){yg(0,e,0,r).each(function(o){o.transition.each(function(o){a.propertyName===o.property&&(kg(n,e,t,r.destination),e.onTransition(n,r))})})})}),ma(function(n){kg(n,e,t,e.initialState)})])}}),Cg=[Yr("destinationAttr","data-transitioning-destination"),Yr("stateAttr","data-transitioning-state"),Ur("initialState"),so("onTransition"),so("onFinish"),Vr("routes",Mr(Mn.value,Mr(Mn.value,zr([Gr("transition",[Ur("property"),Ur("transitionClass")])]))))],zg=Ea({fields:Cg,name:"transitioning",active:xg,apis:_g,extra:{createRoutes:function(e){var t={};return sn(e,function(e,n){var r=n.split("<->");t[r[0]]=dr(r[1],e),t[r[1]]=dr(r[0],e)}),t},createBistate:function(e,t,n){return mr([{key:e,value:dr(t,n)},{key:t,value:dr(e,n)}])},createTristate:function(e,t,n,r){return mr([{key:e,value:mr([{key:t,value:r},{key:n,value:r}])},{key:t,value:mr([{key:e,value:r},{key:n,value:r}])},{key:n,value:mr([{key:e,value:r},{key:t,value:r}])}])}}}),Sg=Po("scrollable"),Tg=function(e){Tn(e,Sg)},Eg=function(e){Nn(e,Sg)},Ng=Sg,Dg=function(e){return mn(e,"format").getOr(e.title)},Ag=function(e,t,n,r,a){return{data:{value:e,text:t},type:"item",dom:{tag:"div",classes:a?[Po("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Po("format-matches"),selected:n},itemBehaviours:Sa(a?[]:[Do(e,function(e,t){(t?No.on:No.off)(e)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},Og=function(e,t,n,r){return{value:e,dom:{tag:"div"},components:[Kl.sketch({dom:{tag:"div",classes:[Po("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[Po("styles-collapse-icon")]}},jm(e)]:[jm(e)],action:function(e){var t;r&&(t=n().get(e),pg.collapseMenu(t))}}),{dom:{tag:"div",classes:[Po("styles-menu-items-container")]},components:[ag.parts.items({})],behaviours:Sa([Dd("adhoc-scrollable-menu",[ma(function(e){Uo(e.element,"overflow-y","auto"),Uo(e.element,"-webkit-overflow-scrolling","touch"),Tg(e.element)}),ga(function(e){Ko(e.element,"overflow-y"),Ko(e.element,"-webkit-overflow-scrolling"),Eg(e.element)})])])}],items:t,menuBehaviours:Sa([zg.config({initialState:"after",routes:zg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Rg=function(e){var t,n,r,a,o,i=(t=e.formats,n=function(){return c},r=Og("Styles",[].concat(W(t.items,function(e){return Ag(Dg(e),e.title,e.isSelected(),e.getPreview(),hn(t.expansions,Dg(e)))})),n,!1),a=ln(t.menus,function(e,r){var a=W(e,function(e){return Ag(Dg(e),e.title,void 0!==e.isSelected&&e.isSelected(),void 0!==e.getPreview?e.getPreview():"",hn(t.expansions,Dg(e)))});return Og(r,a,n,!0)}),o=nr(a,dr("styles",r)),{tmenu:pg.tieredData("styles",o,t.expansions)}),c=yd(pg.sketch({dom:{tag:"div",classes:[Po("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(t,n){var r=zu.getValue(n);return e.handle(n,r.value),A.none()},onEscape:function(){return A.none()},onOpenMenu:function(e,t){var n=Eu(e.element);Tu(t.element,n),zg.jumpTo(t,"current")},onOpenSubmenu:function(e,t,n){var r=Eu(e.element),a=ai(t.element,'[role="menu"]').getOrDie("hacky"),o=e.getSystem().getByDom(a).getOrDie();Tu(n.element,r),zg.progressTo(o,"before"),zg.jumpTo(n,"after"),zg.progressTo(n,"current")},onCollapseMenu:function(e,t,n){var r=ai(t.element,'[role="menu"]').getOrDie("hacky"),a=e.getSystem().getByDom(r).getOrDie();zg.progressTo(a,"after"),zg.progressTo(n,"current")},navigateOnHover:!1,highlightImmediately:!0,data:i.tmenu,markers:{backgroundMenu:Po("styles-background-menu"),menu:Po("styles-menu"),selectedMenu:Po("styles-selected-menu"),item:Po("styles-item"),selectedItem:Po("styles-selected-item")}}));return c.asSpec()},Pg=function(e){return hn(e,"items")?(n=nr(fr(t=e,["items"]),{menu:!0}),r=Mg(t.items),{item:n,menus:nr(r.menus,dr(t.title,r.items)),expansions:nr(r.expansions,dr(t.title,t.title))}):{item:e,menus:{},expansions:{}};var t,n,r},Mg=function(e){return G(e,function(e,t){var n=Pg(t);return{menus:nr(e.menus,n.menus),items:[n.item].concat(e.items),expansions:nr(e.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})},Bg=function(e){var t=function(t){return function(){return e.formatter.match(t)}},n=function(t){return function(){return e.formatter.getCssText(t)}},r=function(a){return W(a,function(a){if(hn(a,"items")){var o=r(a.items);return nr(nr(a,{isSelected:z,getPreview:w("")}),{items:o})}return hn(a,"format")?nr(l=a,{isSelected:t(l.format),getPreview:n(l.format)}):(c=rl((i=a).title),s=nr(i,{format:c,isSelected:t(c),getPreview:n(c)}),e.formatter.register(c,s),s);var i,c,s,l})};return r(e.getParam("style_formats",Ia,"array"))},Lg=function(e,t,n){var r,a,o,i=(r=e,o=(a=function(e){return ee(e,function(e){return void 0===e.items?!hn(e,"format")||r.formatter.canApply(e.format)?[e]:[]:0<a(e.items).length?[e]:[]})})(t),Mg(o));return Rg({formats:i,handle:function(t,r){e.undoManager.transact(function(){No.isOn(t)?e.formatter.remove(r):e.formatter.apply(r)}),n()}})},jg=function(e){var t=e.replace(/\|/g," ").trim();return 0<t.length?t.split(/\s+/):[]},Ig=function(e){return ee(e,function(e){return(B(e)?Ig:jg)(e)})},Fg=function(e){var t=e.getParam("toolbar",Fa,"array");return(B(t)?Ig:jg)(t)},Hg=function(e,t){var n=function(e){return function(){return nu(r=e,function(){n.execCommand(r)},{},n=t);var n,r}},r=function(e){return function(){return n=t,a=Ql(r=e),nu(r,function(){n.execCommand(r)},a,n);var n,r,a}},a=function(e,n,r){return function(){return eu(t,e,n,r)}},o=n("undo"),i=n("redo"),c=r("bold"),s=r("italic"),l=r("underline"),u=n("removeformat"),f=a("unlink","link",function(){t.execCommand("unlink",null,!1)}),d=a("unordered-list","ul",function(){t.execCommand("InsertUnorderedList",null,!1)}),m=a("ordered-list","ol",function(){t.execCommand("InsertOrderedList",null,!1)}),g=Bg(t),h=function(){return Lg(t,g,function(){t.fire("scrollIntoView")})},p=function(e,n){return{isSupported:function(){var n=t.ui.registry.getAll().buttons;return e.forall(function(e){return hn(n,e)})},sketch:n}};return{undo:p(A.none(),o),redo:p(A.none(),i),bold:p(A.none(),c),italic:p(A.none(),s),underline:p(A.none(),l),removeformat:p(A.none(),u),link:p(A.none(),function(){return gm(e,t)}),unlink:p(A.none(),f),image:p(A.none(),function(){return wd(t)}),bullist:p(A.some("bullist"),d),numlist:p(A.some("numlist"),m),fontsizeselect:p(A.none(),function(){return r={onChange:function(e){fd(n,e)},getInitialValue:function(){return ud(n)}},od(e,"font-size",function(){return pd(r)},n=t);var n,r}),forecolor:p(A.none(),function(){return r={onChange:function(e,t,r){n.undoManager.transact(function(){n.formatter.apply("forecolor",{value:r}),n.nodeChanged()})},getInitialValue:function(){return-1}},od(e,"color-levels",function(){return id(r)},n=t);var n,r}),styleselect:p(A.none(),function(){return nu("style-formats",function(n){t.fire("toReading"),e.dropup.appear(h,No.on,n)},Sa([No.config({toggleClass:Po("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),yo.config({channels:mr([Oo(qa,No.off),Oo(Ua,No.off)])})]),t)})}},qg=function(e){var t=bt.fromDom(function(e){if($t()&&j(e.target)){var t=bt.fromDom(e.target);if(Tt(t)&&Kt(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return oe(n)}}return A.from(e.target)}(e).getOr(e.target)),n=function(){return e.stopPropagation()},r=function(){return e.preventDefault()},a=b(r,n);return{target:t,x:e.clientX,y:e.clientY,stop:n,prevent:r,kill:a,raw:e}},Ug=function(e,t,r,a,o){var i,c,s=(i=r,c=a,function(e){i(e)&&c(qg(e))});return e.dom.addEventListener(t,s,o),{unbind:n(Vg,e,t,s,o)}},Vg=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},$g=S,Wg=function(e,t,n){return Ug(e,t,$g,n,!1)},Xg=function(e,t,n){return Ug(e,t,$g,n,!0)},Kg=tinymce.util.Tools.resolve("tinymce.util.Delay"),Gg=function(e){var t=e.matchMedia("(orientation: portrait)").matches;return{isPortrait:w(t)}},Yg=function(e,t){var n=bt.fromDom(e),r=null,a=Wg(n,"orientationchange",function(){Kg.clearInterval(r);var n=Gg(e);t.onChange(n),o(function(){t.onReady(n)})}),o=function(t){Kg.clearInterval(r);var n=e.innerHeight,a=0;r=Kg.setInterval(function(){n!==e.innerHeight?(Kg.clearInterval(r),t(A.some(e.innerHeight))):a>20&&(Kg.clearInterval(r),t(A.none())),a++},50)};return{onAdjustment:o,destroy:function(){a.unbind()}}},Jg=function(e,t,n){var r,a,o=e.document.createRange();return r=o,t.fold(function(e){r.setStartBefore(e.dom)},function(e,t){r.setStart(e.dom,t)},function(e){r.setStartAfter(e.dom)}),a=o,n.fold(function(e){a.setEndBefore(e.dom)},function(e,t){a.setEnd(e.dom,t)},function(e){a.setEndAfter(e.dom)}),o},Zg=function(e,t,n,r,a){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,a),o},Qg=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},eh=Qn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),th=function(e,t,n){return t(bt.fromDom(n.startContainer),n.startOffset,bt.fromDom(n.endContainer),n.endOffset)},nh=function(e,t){var n,r,a,o=(n=e,t.match({domRange:function(e){return{ltr:w(e),rtl:A.none}},relative:function(e,t){return{ltr:T(function(){return Jg(n,e,t)}),rtl:T(function(){return A.some(Jg(n,t,e))})}},exact:function(e,t,r,a){return{ltr:T(function(){return Zg(n,e,t,r,a)}),rtl:T(function(){return A.some(Zg(n,r,a,e,t))})}}}));return(a=(r=o).ltr()).collapsed?r.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return eh.rtl(bt.fromDom(e.endContainer),e.endOffset,bt.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return th(0,eh.ltr,a)}):th(0,eh.ltr,a)},rh=(eh.ltr,eh.rtl,function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}}),ah=(ac=Et,oc="text",{get:function(e){if(!ac(e))throw new Error("Can only get "+oc+" value of a "+oc+" node");return ic(e).getOr("")},getOption:ic=function(e){return ac(e)?A.from(e.dom.nodeValue):A.none()},set:function(e,t){if(!ac(e))throw new Error("Can only set raw "+oc+" value of a "+oc+" node");e.dom.nodeValue=t}}),oh=function(e){return"img"===zt(e)?1:(t=e,ah.getOption(t).fold(function(){return Pt(e).length},function(e){return e.length}));var t},ih=Qn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ch={before:ih.before,on:ih.on,after:ih.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(k,k,k)}},sh=Qn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),lh={domRange:sh.domRange,relative:sh.relative,exact:sh.exact,exactFromRange:function(e){return sh.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=e.match({domRange:function(e){return bt.fromDom(e.startContainer)},relative:function(e){return ch.getStart(e)},exact:function(e){return e}});return t=n,bt.fromDom(Ot(t).dom.defaultView)},range:rh},uh=function(e,t){var n=zt(e);return"input"===n?ch.after(e):V(["br","img"],n)?0===t?ch.before(e):ch.after(e):ch.on(e,t)},fh=function(e,t,n,r){var a,o,i,c,s,l=(o=t,i=n,c=r,(s=At(a=e).dom.createRange()).setStart(a.dom,o),s.setEnd(i.dom,c),s),u=Ct(e,n)&&t===r;return l.collapsed&&!u},dh=function(e){return A.from(e.getSelection())},mh=function(e,t,n,r,a){var o,i=Zg(e,t,n,r,a);o=i,dh(e).each(function(e){e.removeAllRanges(),e.addRange(o)})},gh=function(e,t){return nh(e,t).match({ltr:function(t,n,r,a){mh(e,t,n,r,a)},rtl:function(t,n,r,a){dh(e).each(function(o){if(o.setBaseAndExtent)o.setBaseAndExtent(t.dom,n,r.dom,a);else if(o.extend)try{s=t,l=n,u=r,f=a,(c=o).collapse(s.dom,l),c.extend(u.dom,f)}catch(i){mh(e,r,a,t,n)}else mh(e,r,a,t,n);var c,s,l,u,f})}})},hh=function(e,t,n,r,a){var o,i,c,s,l=(o=r,i=a,c=uh(t,n),s=uh(o,i),lh.relative(c,s));gh(e,l)},ph=function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return A.some(rh(bt.fromDom(t.startContainer),t.startOffset,bt.fromDom(n.endContainer),n.endOffset))}return A.none()},yh=function(e){if(null===e.anchorNode||null===e.focusNode)return ph(e);var t=bt.fromDom(e.anchorNode),n=bt.fromDom(e.focusNode);return fh(t,e.anchorOffset,n,e.focusOffset)?A.some(rh(t,e.anchorOffset,n,e.focusOffset)):ph(e)},vh=function(e){return dh(e).filter(function(e){return 0<e.rangeCount}).bind(yh)},bh=function(e,t){var n,r,a,o,i=nh(n=e,t).match({ltr:function(e,t,r,a){var o=n.document.createRange();return o.setStart(e.dom,t),o.setEnd(r.dom,a),o},rtl:function(e,t,r,a){var o=n.document.createRange();return o.setStart(r.dom,a),o.setEnd(e.dom,t),o}});return a=(r=i).getClientRects(),0<(o=0<a.length?a[0]:r.getBoundingClientRect()).width||0<o.height?A.some(o).map(Qg):A.none()},wh=function(e){return A.from(e.dom.contentWindow)},kh=function(e){return wh(e).bind(vh)},_h=function(e){return e.getFrame()},xh=function(e,t,n,r){return e[n].getOrThunk(function(){return function(e){return Wg(t,r,e)}})},Ch=function(e){var t,r=_h(e);return t=r,A.some(bt.fromDom(t.dom.contentWindow.document.body)).bind(function(t){return a=r,A.some(bt.fromDom(a.dom.contentWindow.document)).bind(function(a){return wh(r).map(function(o){var i=bt.fromDom(a.dom.documentElement),c=e.getCursorBox.getOrThunk(function(){return function(){return vh(o).map(function(e){return lh.exact(e.start,e.soffset,e.finish,e.foffset)}).bind(function(e){return bh(o,e).orThunk(function(){return vh(o).filter(function(e){return Ct(e.start,e.finish)&&e.soffset===e.foffset}).bind(function(e){var t=e.start.dom.getBoundingClientRect();return 0<t.width||0<t.height?A.some(t):A.none()})})})}}),s=e.setSelection.getOrThunk(function(){return function(e,t,n,r){hh(o,e,t,n,r)}}),l=e.clearSelection.getOrThunk(function(){return function(){dh(o).each(function(e){return e.removeAllRanges()})}});return{body:t,doc:a,win:o,html:i,getSelection:n(kh,r),setSelection:s,clearSelection:l,frame:r,onKeyup:xh(e,a,"onKeyup","keyup"),onNodeChanged:xh(e,a,"onNodeChanged","SelectionChange"),onDomChanged:e.onDomChanged,onScrollToCursor:e.onScrollToCursor,onScrollToElement:e.onScrollToElement,onToReading:e.onToReading,onToEditing:e.onToEditing,onToolbarScrollStart:e.onToolbarScrollStart,onTouchContent:e.onTouchContent,onTapContent:e.onTapContent,onTouchToolstrip:e.onTouchToolstrip,getCursorBox:c}})});var a})},zh=(cc="getWin",sc=wh,function(e){return e[cc].getOrThunk(function(){var t=_h(e);return function(){return sc(t)}})()}),Sh=function(){var e=ri("head").getOrDie(),t=ri('meta[name="viewport"]').getOrThunk(function(){var t=bt.fromTag("meta");return yn(t,"name","viewport"),It(e,t),t}),n=bn(t,"content");return{maximize:function(){yn(t,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){void 0!==n&&null!==n&&0<n.length?yn(t,"content",n):yn(t,"content","user-scalable=yes")}}},Th="data-ephox-mobile-fullscreen-style",Eh="position:absolute!important;",Nh="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Dh=Me().os.isAndroid(),Ah=function(e,t){var n,r,a,o=function(e){return function(t){var n=bn(t,"style"),r=void 0===n?"no-styles":n.trim();r!==e&&(yn(t,Th,r),yn(t,"style",e))}},i=(n="*",Qo(e,function(e){return wt(e,n)},r)),c=ee(i,function(e){return t="*",ei(e,function(e){return wt(e,t)});var t}),s=void 0!==(a=$o(t,"background-color"))&&""!==a?"background-color:"+a+"!important":"background-color:rgb(255,255,255)!important;";X(c,o("display:none!important;")),X(i,o(Eh+Nh+s)),o((!0===Dh?"":Eh)+Nh+s)(e)},Oh=function(){var e=_t("["+Th+"]");X(e,function(e){var t=bn(e,Th);"no-styles"!==t?yn(e,"style",t):_n(e,"style"),_n(e,Th)})},Rh=function(e){var t=e.raw;return void 0===t.touches||1!==t.touches.length?A.none():A.some(t.touches[0])},Ph=function(e){var t,n,r,a=Oa(A.none()),o=Oa(!1),i=(t=function(t){e.triggerEvent(it(),t),o.set(!0)},n=400,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];r=setTimeout(function(){t.apply(null,e),r=null},n)}}),c=mr([{key:Le(),value:function(e){return Rh(e).each(function(t){i.cancel();var n={x:t.clientX,y:t.clientY,target:e.target};i.schedule(e),o.set(!1),a.set(A.some(n))}),A.none()}},{key:je(),value:function(e){return i.cancel(),Rh(e).each(function(e){a.get().each(function(t){var n,r,o,i;n=e,r=t,o=Math.abs(n.clientX-r.x),i=Math.abs(n.clientY-r.y),(o>5||i>5)&&a.set(A.none())})}),A.none()}},{key:Ie(),value:function(t){return i.cancel(),a.get().filter(function(e){return Ct(e.target,t.target)}).map(function(){return o.get()?(t.prevent(),!1):e.triggerEvent(ot(),t)})}}]);return{fireIfReady:function(e,t){return mn(c,t).bind(function(t){return t(e)})}}},Mh=function(e){var t=Ph({triggerEvent:function(t,n){e.onTapContent(n)}});return{fireTouchstart:function(e){t.fireIfReady(e,"touchstart")},onTouchend:function(){return Wg(e.body,"touchend",function(e){t.fireIfReady(e,"touchend")})},onTouchmove:function(){return Wg(e.body,"touchmove",function(e){t.fireIfReady(e,"touchmove")})}}},Bh=6<=Me().os.version.major,Lh=function(e,t,n){var r=Mh(e),a=At(t),o=function(e){return!Ct(e.start,e.finish)||e.soffset!==e.foffset},i=function(){var r=e.doc.dom.hasFocus()&&e.getSelection().exists(o);n.getByDom(t).each(!0===(r||Ma(a).filter(function(e){return"input"===zt(e)}).exists(function(e){return e.dom.selectionStart!==e.dom.selectionEnd}))?No.on:No.off)},c=[Wg(e.body,"touchstart",function(t){e.onTouchContent(),r.fireTouchstart(t)}),r.onTouchmove(),r.onTouchend(),Wg(t,"touchstart",function(){e.onTouchToolstrip()}),e.onToReading(function(){Pa(e.body)}),e.onToEditing(v),e.onScrollToCursor(function(t){t.preventDefault(),e.getCursorBox().each(function(t){var n=e.win,r=t.top>n.innerHeight||t.bottom>n.innerHeight?t.bottom-n.innerHeight+50:0;0!=r&&n.scrollTo(n.pageXOffset,n.pageYOffset+r)})})].concat(1==Bh?[]:[Wg(bt.fromDom(e.win),"blur",function(){n.getByDom(t).each(No.off)}),Wg(a,"select",i),Wg(e.doc,"selectionchange",i)]);
return{destroy:function(){X(c,function(e){e.unbind()})}}},jh=function(e,t){var n=parseInt(bn(e,t),10);return isNaN(n)?0:n},Ih=function(e){return y(y({},e),{width:2})},Fh=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Hh=function(e){var t=e.getSelection();return void 0!==t&&0<t.rangeCount?function(e){if(e.collapsed){var t=bt.fromDom(e.startContainer);return Rt(t).bind(function(n){var r=lh.exact(t,e.startOffset,n,oh(n));return bh(e.startContainer.ownerDocument.defaultView,r).map(Ih).map(ae)}).getOr([])}return W(e.getClientRects(),Fh)}(t.getRangeAt(0)):[]},qh=function(e){e.focus();var t=bt.fromDom(e.document.body);(Ma().exists(function(e){return V(["input","textarea"],zt(e))})?function(e){Kg.setTimeout(function(){e()},0)}:C)(function(){Ma().each(Pa),Ra(t)})},Uh="data-"+Po("last-outer-height"),Vh=function(e,t){yn(e,Uh,t)},$h=function(e){return{top:e.top,bottom:e.top+e.height}},Wh=function(e,t){var n=jh(t,Uh),r=e.innerHeight;return n>r?A.some(n-r):A.none()},Xh=function(e,t){var n=bt.fromDom(t.document.body),r=Wg(bt.fromDom(e),"resize",function(){Wh(e,n).each(function(e){var n;(0<(n=Hh(t)).length?A.some(n[0]).map($h):A.none()).each(function(n){var r,a,o,i=(r=t,o=e,(a=n).top>r.innerHeight||a.bottom>r.innerHeight?Math.min(o,a.bottom-r.innerHeight+50):0);0!==i&&t.scrollTo(t.pageXOffset,t.pageYOffset+i)})}),Vh(n,e.innerHeight)});return Vh(n,e.innerHeight),{toEditing:function(){qh(t)},destroy:function(){r.unbind()}}},Kh=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}},Gh=function(e){var t,n,r,a=yd(Pd.sketch({dom:Jl('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:Sa([No.config({toggleClass:Po("mask-tap-icon-selected"),toggleOnExecute:!1})])})),o=(t=e,n=200,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];null===r&&(r=setTimeout(function(){t.apply(null,e),r=null},n))}});return Pd.sketch({dom:Jl('<div class="${prefix}-disabled-mask"></div>'),components:[Pd.sketch({dom:Jl('<div class="${prefix}-content-container"></div>'),components:[Kl.sketch({dom:Jl('<div class="${prefix}-content-tap-section"></div>'),components:[a.asSpec()],action:function(){o.throttle()},buttonBehaviours:Sa([No.config({toggleClass:Po("mask-tap-icon-selected")})])})]})]})},Yh=w({unbind:v}),Jh=Sr([$r("editor",[Ur("getFrame"),Wr("getBody"),Wr("getDoc"),Wr("getWin"),Wr("getSelection"),Wr("setSelection"),Wr("clearSelection"),Wr("cursorSaver"),Wr("onKeyup"),Wr("onNodeChanged"),Wr("getCursorBox"),Ur("onDomChanged"),Yr("onTouchContent",v),Yr("onTapContent",v),Yr("onTouchToolstrip",v),Yr("onScrollToCursor",Yh),Yr("onScrollToElement",Yh),Yr("onToEditing",Yh),Yr("onToReading",Yh),Yr("onToolbarScrollStart",k)]),Ur("socket"),Ur("toolstrip"),Ur("dropup"),Ur("toolbar"),Ur("container"),Ur("alloy"),Zr("win",function(e){return At(e.socket).dom.defaultView}),Zr("body",function(e){return bt.fromDom(e.socket.dom.ownerDocument.body)}),Yr("translate",k),Yr("setReadOnly",v),Yr("readOnlyOnInit",S)]),Zh=function(e){var t=jr("Getting AndroidWebapp schema",Jh,e);Uo(t.toolstrip,"width","100%");var n=Hm(Gh(function(){t.setReadOnly(t.readOnlyOnInit()),l.enter()},t.translate));t.alloy.add(n);var r={show:function(){t.alloy.add(n)},hide:function(){t.alloy.remove(n)}};It(t.container,n.element);var a,o,i,c,s,l=(a=t,o=r,i=Sh(),c=um(),s=um(),{enter:function(){o.hide(),Tn(a.container,Po("fullscreen-maximized")),Tn(a.container,Po("android-maximized")),i.maximize(),Tn(a.body,Po("android-scroll-reload")),c.set(Xh(a.win,zh(a.editor).getOrDie("no"))),Ch(a.editor).each(function(e){Ah(a.container,e.body),s.set(Lh(e,a.toolstrip,a.alloy))})},exit:function(){i.restore(),o.show(),Nn(a.container,Po("fullscreen-maximized")),Nn(a.container,Po("android-maximized")),Oh(),Nn(a.body,Po("android-scroll-reload")),s.clear(),c.clear()}});return{setReadOnly:t.setReadOnly,refreshStructure:v,enter:l.enter,exit:l.exit,destroy:v}},Qh=w([Ur("dom"),Yr("shell",!0),qs("toolbarBehaviours",[ug])]),ep=w([bl({name:"groups",overrides:function(){return{behaviours:Sa([ug.config({})])}}})]),tp=Xl({name:"Toolbar",configFields:Qh(),partFields:ep(),factory:function(e,t){var n=function(t){return e.shell?A.some(t):Tl(t,e,"groups")},r=e.shell?{behaviours:[ug.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:r.components,behaviours:Vs(e.toolbarBehaviours,r.behaviours),apis:{setGroups:function(e,t){n(e).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(e){ug.set(e,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),np=w([Ur("items"),$r("markers",W(["itemSelector"],Ur)),qs("tgroupBehaviours",[Hs])]),rp=w([wl({name:"items",unit:"item"})]),ap=Xl({name:"ToolbarGroup",configFields:np(),partFields:rp(),factory:function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Vs(e.tgroupBehaviours,[Hs.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),op="data-"+Po("horizontal-scroll"),ip=function(e){return"true"===bn(e,op)?0<(n=e).dom.scrollLeft||function(e){e.dom.scrollLeft=1;var t=0!==e.dom.scrollLeft;return e.dom.scrollLeft=0,t}(n):0<(t=e).dom.scrollTop||function(e){e.dom.scrollTop=1;var t=0!==e.dom.scrollTop;return e.dom.scrollTop=0,t}(t);var t,n},cp=function(){var e=function(e){var t=!0===e.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Jl('<div aria-label="'+e.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:Sa([Dd("adhoc-scrollable-toolbar",!0===e.scrollable?[ha(function(e){var t;Uo(e.element,"overflow-x","auto"),t=e.element,yn(t,op,"true"),Tg(e.element)})]:[])]),components:[Pd.sketch({components:[ap.parts.items({})]})],markers:{itemSelector:"."+Po("toolbar-group-item")},items:e.items}},t=Hm(tp.sketch({dom:Jl('<div class="${prefix}-toolbar"></div>'),components:[tp.parts.groups({})],toolbarBehaviours:Sa([No.config({toggleClass:Po("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Hs.config({mode:"cyclic"})]),shell:!0})),n=Hm(Pd.sketch({dom:{classes:[Po("toolstrip")]},components:[qm(t)],containerBehaviours:Sa([No.config({toggleClass:Po("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){tp.setGroups(t,a.get()),No.off(t)},a=Oa([]);return{wrapper:n,toolbar:t,createGroups:function(t){return W(t,b(ap.sketch,e))},setGroups:function(e){a.set(e),r()},setContextToolbar:function(e){No.on(t),tp.setGroups(t,e)},restoreToolbar:function(){No.isOn(t)&&r()},refresh:function(){},focus:function(){Hs.focusIn(t)}}},sp=function(e){return Hm(Kl.sketch({dom:Jl('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){e.run(function(e){e.setReadOnly(!1)})}}))},lp=function(){return Hm(Pd.sketch({dom:Jl('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:Sa([ug.config({})])}))},up=function(e,t){ug.append(e,qm(t))},fp=function(e,t){ug.remove(e,t)},dp=function(e,t,n,r){(!0===n?Aa.toAlpha:Aa.toOmega)(r),(n?up:fp)(e,t)},mp=function(e,t){return t.getAnimationRoot.fold(function(){return e.element},function(t){return t(e)})},gp=function(e){return e.dimension.property},hp=function(e,t){return e.dimension.getDimension(t)},pp=function(e,t){var n=mp(e,t);Am(n,[t.shrinkingClass,t.growingClass])},yp=function(e,t){Nn(e.element,t.openClass),Tn(e.element,t.closedClass),Uo(e.element,gp(t),"0px"),Go(e.element)},vp=function(e,t){Nn(e.element,t.closedClass),Tn(e.element,t.openClass),Ko(e.element,gp(t))},bp=function(e,t,n){n.setCollapsed(),Uo(e.element,gp(t),hp(t,e.element)),Go(e.element),pp(e,t),yp(e,t),t.onStartShrink(e),t.onShrunk(e)},wp=function(e,t,n,r){var a=r.getOrThunk(function(){return hp(t,e.element)});n.setCollapsed(),Uo(e.element,gp(t),a),Go(e.element);var o=mp(e,t);Nn(o,t.growingClass),Tn(o,t.shrinkingClass),yp(e,t),t.onStartShrink(e)},kp=function(e,t,n){var r=hp(t,e.element);("0px"===r?bp:wp)(e,t,n,A.some(r))},_p=function(e,t,n){var r=mp(e,t),a=Dn(r,t.shrinkingClass),o=hp(t,e.element);vp(e,t);var i=hp(t,e.element);(a?function(){Uo(e.element,gp(t),o),Go(e.element)}:function(){yp(e,t)})(),Nn(r,t.shrinkingClass),Tn(r,t.growingClass),vp(e,t),Uo(e.element,gp(t),i),n.setExpanded(),t.onStartGrow(e)},xp=function(e,t){var n=mp(e,t);return!0===Dn(n,t.growingClass)},Cp=function(e,t){var n=mp(e,t);return!0===Dn(n,t.shrinkingClass)},zp=Object.freeze({__proto__:null,refresh:function(e,t,n){var r;n.isExpanded()&&(Ko(e.element,gp(t)),r=hp(t,e.element),Uo(e.element,gp(t),r))},grow:function(e,t,n){n.isExpanded()||_p(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&kp(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&bp(e,t,n,A.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:xp,isShrinking:Cp,isTransitioning:function(e,t){return xp(e,t)||Cp(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?kp:_p)(e,t,n)},disableTransitions:pp}),Sp=Object.freeze({__proto__:null,exhibit:function(e,t){var n=t.expanded;return ba(n?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:dr(t.dimension.property,"0px")})},events:function(e,t){return oa([(n=Ge(),la(n)(function(n,r){r.event.raw.propertyName===e.dimension.property&&(pp(n,e),t.isExpanded()&&Ko(n.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))}))]);var n}}),Tp=[Ur("closedClass"),Ur("openClass"),Ur("shrinkingClass"),Ur("growingClass"),Wr("getAnimationRoot"),so("onShrunk"),so("onStartShrink"),so("onGrown"),so("onStartGrow"),Yr("expanded",!1),Vr("dimension",Fr("property",{width:[mo("property","width"),mo("getDimension",function(e){return Eu(e)+"px"})],height:[mo("property","height"),mo("getDimension",function(e){return Zo(e)+"px"})]}))],Ep=Ea({fields:Tp,name:"sliding",active:Sp,apis:zp,state:Object.freeze({__proto__:null,init:function(e){var t=Oa(e.expanded);return za({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:n(t.set,!1),setExpanded:n(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),Np=function(e,t){var n=Hm(Pd.sketch({dom:{tag:"div",classes:[Po("dropup")]},components:[],containerBehaviours:Sa([ug.config({}),Ep.config({closedClass:Po("dropup-closed"),openClass:Po("dropup-open"),shrinkingClass:Po("dropup-shrinking"),growingClass:Po("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){e(),t(),ug.set(n,[])},onGrown:function(){e(),t()}}),Ao(function(){r(v)})])})),r=function(e){window.requestAnimationFrame(function(){e(),Ep.shrink(n)})};return{appear:function(e,t,r){!0===Ep.hasShrunk(n)&&!1===Ep.isTransitioning(n)&&window.requestAnimationFrame(function(){t(r),ug.set(n,[e()]),Ep.grow(n)})},disappear:r,component:n,element:n.element}},Dp=function(e){var t,n;return e.raw.which===ci[0]&&!V(["input","textarea"],zt(e.target))&&(t=e.target,!ii(t,'[contenteditable="true"]',n).isSome())},Ap=function(){return Me().browser.isFirefox()},Op=zr([Vr("triggerEvent",qr),Yr("stopBackspace",!0)]),Rp=function(e,t){var n,r,a,o,i=jr("Getting GUI events settings",Op,t),c=Ph(i),s=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Wg(e,t,function(e){c.fireIfReady(e,t).each(function(t){t&&e.kill()}),i.triggerEvent(t,e)&&e.kill()})}),l=Oa(A.none()),u=Wg(e,"paste",function(e){c.fireIfReady(e,"paste").each(function(t){t&&e.kill()}),i.triggerEvent("paste",e)&&e.kill(),l.set(A.some(setTimeout(function(){i.triggerEvent(tt(),e)},0)))}),f=Wg(e,"keydown",function(e){i.triggerEvent("keydown",e)?e.kill():!0===i.stopBackspace&&Dp(e)&&e.prevent()}),d=(n=e,r=function(e){i.triggerEvent("focusin",e)&&e.kill()},Ap()?Xg(n,"focus",r):Wg(n,"focusin",r)),m=Oa(A.none()),g=(a=e,o=function(e){i.triggerEvent("focusout",e)&&e.kill(),m.set(A.some(setTimeout(function(){i.triggerEvent(et(),e)},0)))},Ap()?Xg(a,"blur",o):Wg(a,"focusout",o));return{unbind:function(){X(s,function(e){e.unbind()}),f.unbind(),d.unbind(),g.unbind(),u.unbind(),l.get().each(clearTimeout),m.get().each(clearTimeout)}}},Pp=function(e,t){var n=mn(e,"target").getOr(t);return Oa(n)},Mp=Qn([{stopped:[]},{resume:["element"]},{complete:[]}]),Bp=function(e,t,n,r,a,o){var i,c,s,l,u=e(t,r),f=(i=n,c=a,s=Oa(!1),l=Oa(!1),{stop:function(){s.set(!0)},cut:function(){l.set(!0)},isStopped:s.get,isCut:l.get,event:i,setSource:c.set,getSource:c.get});return u.fold(function(){return o.logEventNoHandlers(t,r),Mp.complete()},function(e){var n=e.descHandler;return _m(n)(f),f.isStopped()?(o.logEventStopped(t,e.element,n.purpose),Mp.stopped()):f.isCut()?(o.logEventCut(t,e.element,n.purpose),Mp.complete()):Rt(e.element).fold(function(){return o.logNoParent(t,e.element,n.purpose),Mp.complete()},function(r){return o.logEventResponse(t,e.element,n.purpose),Mp.resume(r)})})},Lp=function(e,t,n,r,a,o){return Bp(e,t,n,r,a,o).fold(S,function(r){return Lp(e,t,n,r,a,o)},z)},jp=function(e,t){var n,r,a=(n=t,r=Oa(!1),{stop:function(){r.set(!0)},cut:v,isStopped:r.get,isCut:z,event:n,setSource:x("Cannot set source of a broadcasted event"),getSource:x("Cannot get source of a broadcasted event")});return X(e,function(e){var t=e.descHandler;_m(t)(a)}),a.isStopped()},Ip=function(e,t,n,r,a){var o=Pp(n,r);return Lp(e,t,n,r,o,a)},Fp=function(){var e={};return{registerId:function(t,r,a){sn(a,function(a,o){var i,c,s=void 0!==e[o]?e[o]:{};s[r]=(i=a,c=t,{cHandler:n.apply(void 0,[i.handler].concat(c)),purpose:i.purpose}),e[o]=s})},unregisterId:function(t){sn(e,function(e){e.hasOwnProperty(t)&&delete e[t]})},filterByType:function(t){return mn(e,t).map(function(e){return dn(e,function(e,t){return{id:t,descHandler:e}})}).getOr([])},find:function(t,n,r){var a=mn(e,n);return ta(r,function(e){return t=a,Il(n=e).fold(function(){return A.none()},function(e){return t.bind(function(t){return mn(t,e)}).map(function(e){return{element:n,descHandler:e}})});var t,n},t)}}},Hp=function(){var e=Fp(),t={},n=function(e){var t=e.element;return Il(t).fold(function(){return t="uid-",n=e.element,r=rl(Bl+t),jl(n,r),r;var t,n,r},function(e){return e})},r=function(n){Il(n.element).each(function(n){delete t[n],e.unregisterId(n)})};return{find:function(t,n,r){return e.find(t,n,r)},filter:function(t){return e.filterByType(t)},register:function(a){var o=n(a);hn(t,o)&&function(e,n){var a=t[n];if(a!==e)throw new Error('The tagId "'+n+'" is already used by: '+Xa(a.element)+"\nCannot use it for: "+Xa(e.element)+"\nThe conflicting element is"+(Gt(a.element)?" ":" not ")+"already in the DOM");r(e)}(a,o);var i=[a];e.registerId(i,o,a.events),t[o]=a},unregister:r,getById:function(e){return mn(t,e)}}},qp=function(e){var t=function(t){return Rt(e.element).fold(S,function(e){return Ct(t,e)})},n=Hp(),r=function(e,r){return n.find(t,e,r)},a=Rp(e.element,{triggerEvent:function(e,t){return to(e,t.target,function(n){return o=n,Ip(r,e,a=t,a.target,o);var a,o})}}),o={debugInfo:w("real"),triggerEvent:function(e,t,n){to(e,t,function(a){return Ip(r,e,n,t,a)})},triggerFocus:function(e,t){Il(e).fold(function(){Ra(e)},function(){to(Qe(),e,function(n){var a,o,i,c,s,l;return a=r,o=Qe(),s=n,l=Pp(i={originator:t,kill:v,prevent:v,target:e},c=e),Bp(a,o,i,c,l,s),!1})})},triggerEscape:function(e,t){o.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return g(e)},getByDom:function(e){return h(e)},build:Hm,addToGui:function(e){s(e)},removeFromGui:function(e){l(e)},addToWorld:function(e){i(e)},removeFromWorld:function(e){c(e)},broadcast:function(e){f(e)},broadcastOn:function(e,t){d(e,t)},broadcastEvent:function(e,t){m(e,t)},isConnected:S},i=function(e){e.connect(o),Et(e.element)||(n.register(e),X(e.components(),i),o.triggerEvent(ct(),e.element,{target:e.element}))},c=function(e){Et(e.element)||(X(e.components(),c),n.unregister(e)),e.disconnect()},s=function(t){nn(e,t,It)},l=function(e){rn(e)},u=function(e){var t=n.filter(nt());X(t,function(t){var n=t.descHandler;_m(n)(e)})},f=function(e){u({universal:!0,data:e})},d=function(e,t){u({universal:!1,channels:e,data:t})},m=function(e,t){var r=n.filter(e);return jp(r,t)},g=function(e){return n.getById(e).fold(function(){return Mn.error(new Error('Could not find component with uid: "'+e+'" in system.'))},Mn.value)},h=function(e){var t=Il(e).getOr("not found");return g(t)};return i(e),{root:e,element:e.element,destroy:function(){a.unbind(),qt(e.element)},add:s,remove:l,getByUid:g,getByDom:h,addToWorld:i,removeFromWorld:c,broadcast:f,broadcastOn:d,broadcastEvent:m}},Up=Po("readonly-mode"),Vp=Po("edit-mode"),$p=function(e,t){var n=bt.fromTag("input");Vo(n,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),It(e,n),Ra(n),t(n),qt(n)},Wp=function(e){var t,n,r=e.getSelection();0<r.rangeCount&&(t=r.getRangeAt(0),(n=e.document.createRange()).setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),r.removeAllRanges(),r.addRange(n))},Xp=function(e,t){Ma().each(function(e){Ct(e,t)||Pa(e)}),e.focus(),Ra(bt.fromDom(e.document.body)),Wp(e)},Kp=function(e,t,n,r){var a=function(){Xp(t,r)},o=Wg(n,"keydown",function(e){V(["input","textarea"],zt(e.target))||a()});return{toReading:function(){$p(e,Pa)},toEditing:a,onToolbarTouch:v,destroy:function(){o.unbind()}}},Gp=function(e,t,n,r){var a=function(){t.run(function(e){e.refreshSelection()})},o=function(e,n){var a=e-r.dom.scrollTop;t.run(function(e){e.scrollIntoView(a,a+n)})},i=function(){t.run(function(e){e.clearSelection()})},c=function(){e.getCursorBox().each(function(e){o(e.top,e.height)}),t.run(function(e){e.syncHeight()})},s=Mh(e),l=Kh(c,300),u=[e.onKeyup(function(){i(),l.throttle()}),e.onNodeChanged(a),e.onDomChanged(l.throttle),e.onDomChanged(a),e.onScrollToCursor(function(e){e.preventDefault(),l.throttle()}),e.onScrollToElement(function(e){e.element,o(t,r)}),e.onToEditing(function(){t.run(function(e){e.toEditing()})}),e.onToReading(function(){t.run(function(e){e.toReading()})}),Wg(e.doc,"touchend",function(t){Ct(e.html,t.target)||Ct(e.body,t.target)}),Wg(n,"transitionend",function(e){var r;"height"===e.raw.propertyName&&(r=Zo(n),t.run(function(e){e.setViewportOffset(r)}),a(),c())}),Xg(n,"touchstart",function(n){var r;t.run(function(e){e.highlightSelection()}),r=n,t.run(function(e){e.onToolbarTouch(r)}),e.onTouchToolstrip()}),Wg(e.body,"touchstart",function(t){i(),e.onTouchContent(),s.fireTouchstart(t)}),s.onTouchmove(),s.onTouchend(),Wg(e.body,"click",function(e){e.kill()}),Wg(n,"touchmove",function(){e.onToolbarScrollStart()})];return{destroy:function(){X(u,function(e){e.unbind()})}}},Yp={},Jp={exports:Yp};lc=void 0,uc=Yp,fc=Jp,dc=void 0,function(e){"object"==typeof uc&&void 0!==fc?fc.exports=e():"function"==typeof lc&&lc.amd?lc([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function e(t,n,r){function a(i,c){if(!n[i]){if(!t[i]){var s="function"==typeof dc&&dc;if(!c&&s)return s(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){return a(t[i][1][e]||e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof dc&&dc,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(){g&&d&&(g=!1,d.length?m=d.concat(m):h=-1,m.length&&i())}function i(){if(!g){var e=a(o);g=!0;for(var t=m.length;t;){for(d=m,m=[];++h<t;)d&&d[h].run();h=-1,t=m.length}d=null,g=!1,function(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}(e)}}function c(e,t){this.fun=e,this.array=t}function s(){}var l,u,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(e){u=r}}();var d,m=[],g=!1,h=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new c(e,t)),1!==m.length||g||a(i)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(){return[]},f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],2:[function(e,t){(function(e){function n(){}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(a){return void i(t.promise,a)}o(t.promise,n)}else(1===e._state?o:i)(t.promise,e._value)})):e._deferreds.push(t)}function o(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void l((o=n,s=t,function(){o.apply(s,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(a){i(e,a)}var o,s}function i(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)a(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,i(t,e))})}catch(r){if(n)return;n=!0,i(t,r)}}var u,f;u=this,f=setTimeout,r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var r=new this.constructor(n);return a(this,new s(e,t,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);for(var r=t.length,a=0;a<t.length;a++)!function o(a,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var c=i.then;if("function"==typeof c)return void c.call(i,function(e){o(a,e)},n)}t[a]=i,0==--r&&e(t)}catch(s){n(s)}}(a,t[a])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,a=e.length;a>r;r++)e[r].then(t,n)})},r._immediateFn="function"==typeof e?function(t){e(t)}:function(e){f(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=r:u.Promise||(u.Promise=r)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){function a(e,t){this._id=e,this._clearFn=t}var o=e("process/browser.js").nextTick,i=Function.prototype.apply,c=Array.prototype.slice,s={},l=0;n.setTimeout=function(){return new a(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new a(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=l++,r=!(arguments.length<2)&&c.call(arguments,1);return s[t]=!0,o(function(){s[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t){var n=e("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:r.Promise||n}},{"promise-polyfill":2}]},{},[4])(4)});var Zp,Qp=Jp.exports.boltExport,ey=function(e){var t=A.none(),n=[],r=function(e){a()?i(e):n.push(e)},a=function(){return t.isSome()},o=function(e){X(e,i)},i=function(e){t.each(function(t){setTimeout(function(){e(t)},0)})};return e(function(e){a()||(t=A.some(e),o(n),n=[])}),{get:r,map:function(e){return ey(function(t){r(function(n){t(e(n))})})},isReady:a}},ty={nu:ey,pure:function(e){return ey(function(t){t(e)})}},ny=function(e){setTimeout(function(){throw e},0)},ry=function(e){var t=function(t){e().then(t,ny)};return{map:function(t){return ry(function(){return e().then(t)})},bind:function(t){return ry(function(){return e().then(function(e){return t(e).toPromise()})})},anonBind:function(t){return ry(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return ty.nu(t)},toCached:function(){var t=null;return ry(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},ay=function(e){return ry(function(){return new Qp(e)})},oy=function(e){return ry(function(){return Qp.resolve(e)})},iy=function(e,t){return ie([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return r=e<=n.width&&t<=n.height,a=n.keyboard,r?A.some(a):A.none();var r,a}).getOr({portrait:t/5,landscape:e/4})},cy=function(e){var t,n=Gg(e).isPortrait(),r=iy((t=e).screen.width,t.screen.height),a=n?r.portrait:r.landscape;return(n?e.screen.height:e.screen.width)-e.innerHeight>a?0:a},sy=function(e,t){var n=At(e).dom.defaultView;return Zo(e)+Zo(t)-cy(n)},ly=function(e,t,n){var r=sy(t,n),a=Zo(t)+Zo(n)-r;Uo(e,"padding-bottom",a+"px")},uy=Qn([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),fy="data-"+Po("position-y-fixed"),dy="data-"+Po("y-property"),my="data-"+Po("scrolling"),gy="data-"+Po("last-window-height"),hy=function(e){return jh(e,fy)},py=function(e,t){var n=bn(e,dy);return uy.fixed(e,n,t)},yy=function(e,t){return uy.scroller(e,t)},vy=function(e){var t=hy(e);return("true"===bn(e,my)?yy:py)(e,t)},by=function(e,t,n){var r=At(e).dom.defaultView.innerHeight;return yn(e,gy,r+"px"),r-t-n},wy=function(e,t,n,r){var a=At(e).dom.defaultView,o=function(e){var t=bn(e,"style");return Vo(e,{position:"absolute",top:"0px"}),yn(e,fy,"0px"),yn(e,dy,"top"),{restore:function(){yn(e,"style",t||""),_n(e,fy),_n(e,dy)}}}(n),i=Zo(n),c=Zo(r),s=function(e,t,n){var r=bn(n,"style");return Tg(n),Vo(n,{position:"absolute",height:t+"px",width:"100%",top:e+"px"}),yn(n,fy,e+"px"),yn(n,my,"true"),yn(n,dy,"top"),{restore:function(){Eg(n),yn(n,"style",r||""),_n(n,fy),_n(n,my),_n(n,dy)}}}(i,by(e,i,c),e),l=function(e){var t=bn(e,"style");return Vo(e,{position:"absolute",bottom:"0px"}),yn(e,fy,"0px"),yn(e,dy,"bottom"),{restore:function(){yn(e,"style",t||""),_n(e,fy),_n(e,dy)}}}(r),u=!0,f=function(){var t=a.innerHeight;return jh(e,gy)<t},d=function(){var a,o,i;u&&(a=Zo(n),o=Zo(r),i=by(e,a,o),yn(e,fy,a+"px"),Uo(e,"height",i+"px"),ly(t,e,r))};return ly(t,e,r),{setViewportOffset:function(t){yn(e,fy,t+"px"),d()},isExpanding:f,isShrinking:_(f),refresh:d,restore:function(){u=!1,o.restore(),s.restore(),l.restore()}}},ky=(Zp=null,{animate:function(e,t,n,r,a,o){var i=!1,c=function(e){i=!0,a(e)};Kg.clearInterval(Zp);var s=function(e){Kg.clearInterval(Zp),c(e)};Zp=Kg.setInterval(function(){var a,o,l,u=e();a=u,o=t,l=n,(Math.abs(a-o)<=l?A.none():o>a?A.some(a+l):A.some(a-l)).fold(function(){Kg.clearInterval(Zp),c(t)},function(n){var a;r(n,s),i||((a=e())!==n||Math.abs(a-t)>Math.abs(u-t))&&(Kg.clearInterval(Zp),c(t))})},o)}}),_y="data-"+Po("last-scroll-top"),xy=function(e){var t=Xo(e,"top").getOr("0");return parseInt(t,10)},Cy=function(e){return parseInt(e.dom.scrollTop,10)},zy=function(e,t){return ay(function(r){var a=n(Cy,e);yn(e,_y,a());var o=Math.abs(t-a()),i=Math.ceil(o/10);ky.animate(a,t,i,function(t,n){jh(e,_y)!==e.dom.scrollTop?n(e.dom.scrollTop):(e.dom.scrollTop=t,yn(e,_y,t))},function(){e.dom.scrollTop=t,yn(e,_y,t),r(t)},10)})},Sy=function(e,t){var n=t+hy(e)+"px";Uo(e,"top",n)},Ty=function(e,t){return t(function(t){var n=[],r=0;0===e.length?t([]):X(e,function(a,o){var i;a.get((i=o,function(a){n[i]=a,++r>=e.length&&t(n)}))})})},Ey=function(e,t,r){var a,o,i,c=t+r,s=Xo(e,"top").getOr(r),l=c-parseInt(s,10),u=e.dom.scrollTop+l;return a=e,o=u,i=c,ay(function(e){var t=n(Cy,a);ky.animate(t,o,15,function(e){a.dom.scrollTop=e,Uo(a,"top",xy(a)+15+"px")},function(){a.dom.scrollTop=o,Uo(a,"top",i+"px"),e(o)},10)})},Ny=function(e,t){return e.fold(function(e,n,r){return Uo(e,n,t+(a=r)+"px"),oy(a);var a},function(e,n){return Ey(e,t,n)})},Dy=function(e,t){var n,r=(n=ti(e,"["+fy+"]"),W(n,vy)),a=W(r,function(e){return Ny(e,t)});return Ty(a,ay)},Ay=function(e,t,n,r,a,o){var i,c,s=(i=function(n){return a=t,o=n,i=At(r=e).dom.defaultView,ay(function(e){Sy(r,o),Sy(a,o),i.scrollTo(0,o),e(o)});var r,a,o,i},c=Oa(ty.pure({})),{start:function(e){var t=ty.nu(function(t){return i(e).get(t)});c.set(t)},idle:function(e){c.get().get(function(){e()})}}),l=Kh(function(){s.idle(function(){Dy(n,r.pageYOffset).get(function(){var e;(e=Hh(o),A.from(e[0]).bind(function(e){var n=e.top-t.dom.scrollTop;return n>r.innerHeight+5||-5>n?A.some({top:n,bottom:n+e.height}):A.none()})).each(function(e){t.dom.scrollTop=t.dom.scrollTop+e.top}),s.start(0),a.refresh()})})},1e3),u=Wg(bt.fromDom(r),"scroll",function(){r.pageYOffset<0||l.throttle()});return Dy(n,r.pageYOffset).get(k),{unbind:u.unbind}},Oy=function(e){var t=e.cWin,r=e.ceBody,a=e.socket,o=e.toolstrip,i=e.contentElement,c=e.keyboardType,s=e.outerWindow,l=e.dropup,u=e.outerBody,f=wy(a,r,o,l),d=c(u,t,Yt(),i),m=Yg(s,{onChange:v,onReady:f.refresh});m.onAdjustment(function(){f.refresh()});var g=Wg(bt.fromDom(s),"resize",function(){f.isExpanding()&&f.refresh()}),h=Ay(o,a,u,s,f,t),p=function(e,t){var n=e.document,r=bt.fromTag("div");Tn(r,Po("unfocused-selections")),It(bt.fromDom(n.documentElement),r);var a=Wg(r,"touchstart",function(n){n.prevent(),Xp(e,t),i()}),o=function(e){var t=bt.fromTag("span");return Dm(t,[Po("layer-editor"),Po("unfocused-selection")]),Vo(t,{left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"}),t},i=function(){Ht(r)};return{update:function(){i();var t=Hh(e),n=W(t,o);Ft(r,n)},isActive:function(){return 0<Pt(r).length},destroy:function(){a.unbind(),qt(r)},clear:i}}(t,i),y=function(){p.clear()};return{toEditing:function(){d.toEditing(),y()},toReading:function(){d.toReading()},onToolbarTouch:function(){d.onToolbarTouch()},refreshSelection:function(){p.isActive()&&p.update()},clearSelection:y,highlightSelection:function(){p.update()},scrollIntoView:function(e,r){var o,i,c,s,u,f;o=t,c=e,s=r,u=sy(i=a,l),f=n(Wp,o),c>u||s>u?zy(i,i.dom.scrollTop-u+s).get(f):0>c&&zy(i,i.dom.scrollTop+c).get(f)},updateToolbarPadding:v,setViewportOffset:function(e){var t,r;f.setViewportOffset(e),t=a,r=e,ay(function(e){var a=n(xy,t),o=function(e){Uo(t,"top",e+"px")},i=Math.abs(r-a()),c=Math.ceil(i/10);ky.animate(a,r,c,o,function(){o(r),e(r)},10)}).get(k)},syncHeight:function(){Uo(i,"height",i.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:f.refresh,destroy:function(){f.restore(),m.destroy(),h.unbind(),g.unbind(),
d.destroy(),p.destroy(),$p(Yt(),Pa)}}},Ry=function(e,t){var n=Sh(),r=fm(),a=fm(),o=um(),i=um();return{enter:function(){t.hide();var c=bt.fromDom(document);Ch(e.editor).each(function(t){var s;r.set({socketHeight:Xo(e.socket,"height"),iframeHeight:Xo(t.frame,"height"),outerScroll:document.body.scrollTop}),a.set({exclusives:(s="."+Ng,Wg(c,"touchmove",function(e){ii(e.target,s).filter(ip).fold(function(){e.prevent()},v)}))}),Tn(e.container,Po("fullscreen-maximized")),Ah(e.container,t.body),n.maximize(),Uo(e.socket,"overflow","scroll"),Uo(e.socket,"-webkit-overflow-scrolling","touch"),Ra(t.body),o.set(Oy({cWin:t.win,ceBody:t.body,socket:e.socket,toolstrip:e.toolstrip,dropup:e.dropup.element,contentElement:t.frame,outerBody:e.body,outerWindow:e.win,keyboardType:Kp})),o.run(function(e){e.syncHeight()}),i.set(Gp(t,o,e.toolstrip,e.socket,e.dropup))})},refreshStructure:function(){o.run(function(e){e.refreshStructure()})},exit:function(){n.restore(),i.clear(),o.clear(),t.show(),r.on(function(t){t.socketHeight.each(function(t){Uo(e.socket,"height",t)}),t.iframeHeight.each(function(t){Uo(e.editor.getFrame(),"height",t)}),document.body.scrollTop=t.scrollTop}),r.clear(),a.on(function(e){e.exclusives.unbind()}),a.clear(),Nn(e.container,Po("fullscreen-maximized")),Oh(),Eg(e.toolbar),Ko(e.socket,"overflow"),Ko(e.socket,"-webkit-overflow-scrolling"),Pa(e.editor.getFrame()),Ch(e.editor).each(function(e){e.clearSelection()})}}},Py=tinymce.util.Tools.resolve("tinymce.EditorManager"),My=function(e,t,n){e.system.broadcastOn([Ha],{command:t,state:n})},By=function(e){return function(){var t=function(){e._skinLoaded=!0,e.fire("SkinLoaded")};e.initialized?t():e.on("init",t)}},Ly="toReading",jy="toEditing",Iy=function(e){return{getNotificationManagerImpl:function(){return{open:w({progressBar:{value:v},close:v,text:v,getEl:w(null),moveTo:v,moveRel:v,settings:{}}),close:v,reposition:v,getArgs:w({})}},renderUI:function(){var t,n,r,a=e.getElement(),o=(t=e,{content:(n=A.from(t.getParam("skin_url")).fold(function(){return Py.baseURL+"/skins/ui/oxide"},function(e){return e}))+"/content.mobile.min.css",ui:n+"/skin.mobile.min.css"});0==(!1===e.getParam("skin"))?(r=La.DOM.styleSheetLoader,e.contentCSS.push(o.content),r.load(o.ui,By(e)),e.on("remove",function(){return r.unload(o.ui)})):By(e)();var i,c,s,f,d,m,g,h,p,y=function(){e.fire("ScrollIntoView")},b=Me().os.isAndroid()?(i=y,c=l({classes:[Po("android-container")]}),s=cp(),f=um(),d=sp(f),m=lp(),g=Np(v,i),c.add(s.wrapper),c.add(m),c.add(g.component),{system:c,element:c.element,init:function(e){f.set(Zh(e))},exit:function(){f.run(function(e){e.exit(),ug.remove(m,d)})},setToolbarGroups:function(e){var t=s.createGroups(e);s.setGroups(t)},setContextToolbar:function(e){var t=s.createGroups(e);s.setContextToolbar(t)},focusToolbar:function(){s.focus()},restoreToolbar:function(){s.restoreToolbar()},updateMode:function(e){dp(m,d,e,c.root)},socket:m,dropup:g}):u(y),w=bt.fromDom(a);h=w,p=b.system,an(h,p,Lt);var k=a.ownerDocument.defaultView,_=Yg(k,{onChange:function(){var e,t,n;b.system.broadcastOn([qa],{width:(e=k,t=Me().os.isiOS(),n=Gg(e).isPortrait(),t&&!n?e.screen.height:e.screen.width)})},onReady:v}),x=function(t,n,r,a){!1===a&&e.selection.collapse();var o=C(t,n,r);b.setToolbarGroups(!0===a?o.readOnly:o.main),e.setMode(!0===a?"readonly":"design"),e.fire(!0===a?Ly:jy),b.updateMode(a)},C=function(e,t,n){var r=e.get();return{readOnly:r.backToMask.concat(t.get()),main:r.backToMask.concat(n.get())}},z=function(t,n){return e.on(t,n),{unbind:function(){e.off(t)}}};return e.on("init",function(){b.init({editor:{getFrame:function(){return bt.fromDom(e.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:v}},onToReading:function(e){return z(Ly,e)},onToEditing:function(e){return z(jy,e)},onScrollToCursor:function(t){return e.on("ScrollIntoView",function(e){t(e)}),{unbind:function(){e.off("ScrollIntoView"),_.destroy()}}},onTouchToolstrip:function(){c()},onTouchContent:function(){var t=bt.fromDom(e.editorContainer.querySelector("."+Po("toolbar")));Ba(t).bind(function(e){return b.system.getByDom(e).toOptional()}).each(ht),b.restoreToolbar(),c()},onTapContent:function(t){var n=t.target;"img"===zt(n)?(e.selection.select(n.dom),t.kill()):"a"===zt(n)&&b.system.getByDom(bt.fromDom(e.editorContainer)).each(function(e){Aa.isAlpha(e)&&function(e){var t=document.createElement("a");t.target="_blank",t.href=e.href,t.rel="noreferrer noopener";var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(t),t.dispatchEvent(n),document.body.removeChild(t)}(n.dom)})}},container:bt.fromDom(e.editorContainer),socket:bt.fromDom(e.contentAreaContainer),toolstrip:bt.fromDom(e.editorContainer.querySelector("."+Po("toolstrip"))),toolbar:bt.fromDom(e.editorContainer.querySelector("."+Po("toolbar"))),dropup:b.dropup,alloy:b.system,translate:v,setReadOnly:function(e){x(h,g,m,e)},readOnlyOnInit:function(){return!1}});var t,n,r,a,o,i,c=function(){b.dropup.disappear(function(){b.system.broadcastOn([Ua],{})})},s={label:"The first group",scrollable:!1,items:[nu("back",function(){e.selection.collapse(),b.exit()},{},e)]},l={label:"Back to read only",scrollable:!1,items:[nu("readonly-back",function(){x(h,g,m,!0)},{},e)]},u=Hg(b,e),f=(t=u,n=Fg(e),r={},ee(n,function(e){var n=!hn(r,e)&&hn(t,e)&&t[e].isSupported()?[t[e].sketch()]:[];return r[e]=!0,n})),d={label:"The extra group",scrollable:!1,items:[]},m=Oa([{label:"the action group",scrollable:!0,items:f},d]),g=Oa([{label:"The read only mode group",scrollable:!0,items:[]},d]),h=Oa({backToMask:[s],backToReadOnly:[l]});a=b,i=on((o=e).formatter.get()),X(i,function(e){o.formatter.formatChanged(e,function(t){My(a,e,t)})}),X(["ul","ol"],function(e){o.selection.selectorChanged(e,function(t){My(a,e,t)})})}),e.on("remove",function(){b.exit()}),e.on("detach",function(){var e,t;e=b.system,t=Pt(e.element),X(t,function(t){e.getByDom(t).each(Zt)}),qt(e.element),b.system.destroy()}),{iframeContainer:b.socket.element.dom,editorContainer:b.element.dom}}}};ja.add("mobile",Iy)}();