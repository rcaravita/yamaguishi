!function(){"use strict";function b(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}function y(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function x(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function o(t,n,e,o,r){return t(e,o)?st.some(e):I(r)&&r(e)?st.none():n(e,o,r)}function a(t,u,a){var c=u.backstage;return{open:function(t,n){var e=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),o=function(){n(),cp.hide(i)},r=ku(_p.sketch({text:t.text,level:N(["success","error","warning","warn","info"],t.type)?t.type:undefined,progress:!0===t.progressBar,icon:st.from(t.icon),closeButton:!e,onAction:o,iconProvider:c.shared.providers.icons,translationProvider:c.shared.providers.translate})),i=ku(cp.sketch(ct({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:u.backstage.shared.getSink,fireDismissalEventInstead:{}},c.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return a.add(i),0<t.timeout&&xp.setTimeout(function(){o()},t.timeout),{close:o,moveTo:function(t,n){cp.showAt(i,{anchor:"makeshift",x:t,y:n},Cu(r))},moveRel:function(t,n){var e,o;"banner"!==n?(e=function(){switch(n){case"bc-bc":return yp;case"tc-tc":return bp;case"tc-bc":return qa;case"bc-tc":default:return Ka}}(),o={anchor:"node",root:Zi(),node:st.some(ke.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},cp.showAt(i,o,Cu(r))):cp.showAt(i,u.backstage.shared.anchors.banner(),Cu(r))},text:function(t){_p.updateText(r,t)},settings:t,getEl:function(){return r.element.dom},progressBar:{value:function(t){_p.updateProgress(r,t)}}}},close:function(t){t.close()},reposition:function(t){var e;ft(t,function(t){return t.moveTo(0,0)}),0<(e=t).length&&(ot(e).each(function(t){return t.moveRel(null,"banner")}),ft(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}function i(e){var o=this;null!==this._state?Yx(function(){var t,n=o._state?e.onFulfilled:e.onRejected;if(null!==n){try{t=n(o._value)}catch(s){return void e.reject(s)}e.resolve(t)}else(o._state?e.resolve:e.reject)(o._value)}):this._deferreds.push(e)}function e(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void Jx(qx(n,t),qx(e,this),qx(r,this))}this._state=!0,this._value=t,u.call(this)}catch(s){r.call(this,s)}}function r(t){this._state=!1,this._value=t,u.call(this)}function u(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];i.call(this,e)}this._deferreds=[]}function c(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function h(t,m){var g,p,h,v,b=m.document||document,y=b.getElementById(m.handle||t),x=function(t){if(wO(t),t.button!==p)return w(t);t.deltaX=t.screenX-h,t.deltaY=t.screenY-v,t.preventDefault(),m.drag(t)},w=function(t){wO(t),bO(b).off("mousemove touchmove",x).off("mouseup touchend",w),g.remove(),m.stop&&m.stop(t)};return bO(y).on("mousedown touchstart",function(t){var n,e,o,r,i,u,a,c,s,l,f=(n=b,e=Math.max,o=n.documentElement,r=n.body,i=e(o.scrollWidth,r.scrollWidth),u=e(o.clientWidth,r.clientWidth),a=e(o.offsetWidth,r.offsetWidth),c=e(o.scrollHeight,r.scrollHeight),s=e(o.clientHeight,r.clientHeight),{width:i<a?u:i,height:c<e(o.offsetHeight,r.offsetHeight)?s:c});wO(t),t.preventDefault(),p=t.button;var d=y;h=t.screenX,v=t.screenY,l=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,g=bO("<div></div>").css({position:"absolute",top:0,left:0,width:f.width,height:f.height,zIndex:2147483647,opacity:1e-4,cursor:l}).appendTo(b.body),bO(b).on("mousemove touchmove",x).on("mouseup touchend",w),m.start(t)}),{destroy:function(){bO(y).off()}}}var t,s,l,f,d,n,at=function(){},m=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}},it=function(t){return function(){return t}},ut=function(t){return t},w=function(n){return function(t){return!n(t)}},g=function(t){return function(){throw new Error(t)}},p=it(!1),S=it(!0),v=tinymce.util.Tools.resolve("tinymce.ThemeManager"),ct=function(){return(ct=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},k=function(){return C},C=(t=function(t){return t.isNone()},{fold:function(t){return t()},is:p,isSome:p,isNone:S,getOr:l=function(t){return t},getOrThunk:s=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:it(null),getOrUndefined:it(undefined),or:l,orThunk:s,map:k,each:at,bind:k,exists:p,forall:S,filter:k,equals:t,equals_:t,toArray:function(){return[]},toString:it("none()")}),O=function(e){var t=it(e),n=function(){return r},o=function(t){return t(e)},r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:S,isNone:p,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return O(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?r:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(p,function(t){return n(e,t)})}};return r},st={some:O,none:k,from:function(t){return null===t||t===undefined?C:O(t)}},_=function(o){return function(t){return e=typeof(n=t),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===o;var n,e}},T=function(n){return function(t){return typeof t===n}},E=_("string"),D=_("object"),B=_("array"),A=T("boolean"),M=(f=undefined,function(t){return f===t}),F=function(t){return!(null===(n=t)||n===undefined);var n},I=T("function"),lt=T("number"),R=function(t,n){if(B(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},V=Array.prototype.slice,P=Array.prototype.indexOf,H=Array.prototype.push,z=function(t,n){return P.call(t,n)},N=function(t,n){return-1<z(t,n)},L=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},j=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},U=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=V.call(t,o,o+n);e.push(r)}return e},W=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},ft=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},G=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},X=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},Y=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,function(t){e=n(e,t)}),e},q=function(t,n,e){return ft(t,function(t){e=n(e,t)}),e},K=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return st.some(i);if(e(i,o))break}return st.none()}(t,n,p)},J=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return st.some(e);return st.none()},dt=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!B(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);H.apply(n,t[e])}return n},$=function(t,n){return dt(W(t,n))},Q=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Z=function(t){var n=V.call(t,0);return n.reverse(),n},tt=function(t,n){return X(t,function(t){return!N(n,t)})},nt=function(t,n){var e=V.call(t,0);return e.sort(n),e},et=function(t,n){return 0<=n&&n<t.length?st.some(t[n]):st.none()},ot=function(t){return et(t,0)},rt=function(t){return et(t,t.length-1)},mt=I(Array.from)?Array.from:function(t){return V.call(t)},gt=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return st.none()},pt=function(e){return{is:function(t){return e===t},isValue:S,isError:p,getOr:it(e),getOrThunk:it(e),getOrDie:it(e),or:function(){return pt(e)},orThunk:function(){return pt(e)},fold:function(t,n){return n(e)},map:function(t){return pt(t(e))},mapError:function(){return pt(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return st.some(e)}}},ht=function(n){return{is:p,isValue:p,isError:S,getOr:ut,getOrThunk:function(t){return t()},getOrDie:function(){return g(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t){return t(n)},map:function(){return ht(n)},mapError:function(t){return ht(t(n))},each:at,bind:function(){return ht(n)},exists:p,forall:S,toOptional:st.none}},vt={value:pt,error:ht,fromOption:function(t,n){return t.fold(function(){return ht(n)},pt)}};(n=d=d||{})[n.Error=0]="Error",n[n.Value=1]="Value";var bt,yt,xt,wt,St=function(t,n,e){return t.stype===d.Error?n(t.serror):e(t.svalue)},kt=function(t){return{stype:d.Value,svalue:t}},Ct=function(t){return{stype:d.Error,serror:t}},Ot=function(t){return t.fold(Ct,kt)},_t=function(t){return St(t,vt.error,vt.value)},Tt=kt,Et=function(t){var n=[],e=[];return ft(t,function(t){St(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},Dt=Ct,Bt=function(t,n){return t.stype===d.Value?n(t.svalue):t},At=function(t,n){return t.stype===d.Error?n(t.serror):t},Mt=function(t,n){return t.stype===d.Value?{stype:d.Value,svalue:n(t.svalue)}:t},Ft=function(t,n){return t.stype===d.Error?{stype:d.Error,serror:n(t.serror)}:t},It=Object.keys,Rt=Object.hasOwnProperty,Vt=function(t,n){for(var e=It(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},Pt=function(t,e){return Ht(t,function(t,n){return{k:n,v:e(t,n)}})},Ht=function(t,o){var r={};return Vt(t,function(t,n){var e=o(t,n);r[e.k]=e.v}),r},zt=function(t,n){var e,o,r,i,u={};return e=n,i=u,o=function(t,n){i[n]=t},r=at,Vt(t,function(t,n){(e(t,n)?o:r)(t,n)}),u},Nt=function(t,e){var o=[];return Vt(t,function(t,n){o.push(e(t,n))}),o},Lt=function(t,n){for(var e=It(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return st.some(u)}return st.none()},jt=function(t){return Nt(t,function(t){return t})},Ut=function(t,n){return Wt(t,n)?st.from(t[n]):st.none()},Wt=function(t,n){return Rt.call(t,n)},Gt=function(t,n){return Wt(t,n)&&t[n]!==undefined&&null!==t[n]},Xt=function(u){if(!B(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return ft(u,function(t,o){var n=It(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(e[r]!==undefined)throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!B(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);return{fold:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+t.length);return t[o].apply(null,e)},match:function(t){var n=It(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!Q(a,function(t){return N(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return t[r].apply(null,e)},log:function(t){console.log(t,{constructors:a,constructor:r,params:e})}}}}),e},Yt=Object.prototype.hasOwnProperty,qt=function(u){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r=t[o];for(var i in r)Yt.call(r,i)&&(e[i]=u(e[i],r[i]))}return e}},Kt=qt(function(t,n){return D(t)&&D(n)?Kt(t,n):n}),Jt=qt(function(t,n){return n}),$t=function(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}},Qt=Xt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Zt=function(t){return Qt.defaultedThunk(it(t))},tn=Qt.strict,nn=Qt.asOption,en=Qt.defaultedThunk,on=(Qt.asDefaultedOptionThunk,Qt.mergeWithThunk),rn=(Xt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),un=function(t,n){return e=n,o={},Vt(t,function(t,n){N(e,n)||(o[n]=t)}),o;var e,o},an=rn,cn=function(t){return n={},ft(t,function(t){n[t.key]=t.value}),n;var n},sn=function(t,n){var e,o,r,i,u,a=(e=[],o=[],ft(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,vt.error(dt(u))):(i=n,0===(r=a.values).length?vt.value(i):vt.value(Kt(i,Jt.apply(undefined,r))))},ln=function(t){return m(Dt,dt)(t)},fn=function(t,n){var e,o,r=Et(t);return 0<r.errors.length?ln(r.errors):(o=n,0<(e=r.values).length?Tt(Kt(o,Jt.apply(undefined,e))):Tt(o))},dn=function(t){var n=Et(t);return 0<n.errors.length?ln(n.errors):Tt(n.values)},mn=function(t){return D(t)&&100<It(t).length?" removed due to size":JSON.stringify(t,null,2)},gn=function(t,n){return Dt([{path:t,getErrorInfo:n}])},pn=Xt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),hn=function(e,o,r){return Ut(o,r).fold(function(){return t=r,n=o,gn(e,function(){return'Could not find valid *strict* value for "'+t+'" in '+mn(n)});var t,n},Tt)},vn=function(t,n,e){var o=Ut(t,n).fold(function(){return e(t)},ut);return Tt(o)},bn=function(a,c,t,s){return t.fold(function(r,e,t,o){var i=function(t){var n=o.extract(a.concat([r]),s,t);return Mt(n,function(t){return rn(e,s(t))})},u=function(t){return t.fold(function(){var t=rn(e,s(st.none()));return Tt(t)},function(t){var n=o.extract(a.concat([r]),s,t);return Mt(n,function(t){return rn(e,s(st.some(t)))})})};return t.fold(function(){return Bt(hn(a,c,r),i)},function(t){return Bt(vn(c,r,t),i)},function(){return Bt(Tt(Ut(c,r)),u)},function(t){return Bt((e=t,o=Ut(n=c,r).map(function(t){return!0===t?e(n):t}),Tt(o)),u);var n,e,o},function(t){var n=t(c),e=Mt(vn(c,r,it({})),function(t){return Kt(n,t)});return Bt(e,i)})},function(t,n){var e=n(c);return Tt(rn(t,s(e)))})},yn=function(o){return{extract:function(e,t,n){return At(o(n,t),function(t){return n=t,gn(e,function(){return n});var n})},toString:function(){return"val"}}},xn=function(t){var u=wn(t),a=Y(t,function(n,t){return t.fold(function(t){return Kt(n,an(t,!0))},it(n))},{});return{extract:function(t,n,e){var o,r=A(e)?[]:It(zt(e,function(t){return t!==undefined&&null!==t})),i=X(r,function(t){return!Gt(a,t)});return 0===i.length?u.extract(t,n,e):(o=i,gn(t,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:u.toString}},wn=function(a){return{extract:function(t,n,e){return o=t,r=e,i=n,u=W(a,function(t){return bn(o,r,t,i)}),fn(u,{});var o,r,i,u},toString:function(){return"obj{\n"+W(a,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t){return"state("+t+")"})}).join("\n")+"}"}}},Sn=function(r){return{extract:function(e,o,t){var n=W(t,function(t,n){return r.extract(e.concat(["["+n+"]"]),o,t)});return dn(n)},toString:function(){return"array("+r.toString()+")"}}},kn=function(a){return{extract:function(t,n,e){for(var o=[],r=0,i=a;r<i.length;r++){var u=i[r].extract(t,n,e);if(u.stype===d.Value)return u;o.push(u)}return dn(o)},toString:function(){return"oneOf("+W(a,function(t){return t.toString()}).join(", ")+")"}}},Cn=function(a,c){return{extract:function(e,o,r){var t,n,i=It(r),u=(t=e,n=i,Sn(yn(a)).extract(t,ut,n));return Bt(u,function(t){var n=W(t,function(t){return pn.field(t,t,tn(),c)});return wn(n).extract(e,o,r)})},toString:function(){return"setOf("+c.toString()+")"}}},On=it(yn(Tt)),_n=m(Sn,wn),Tn=pn.state,En=pn.field,Dn=function(e,n,o,r,i){return Ut(r,i).fold(function(){return t=r,n=i,gn(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+mn(t)});var t,n},function(t){return t.extract(e.concat(["branch: "+i]),n,o)})},Bn=function(r,i){return{extract:function(n,e,o){return Ut(o,r).fold(function(){return t=r,gn(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return Dn(n,e,o,i,t)})},toString:function(){return"chooseOn("+r+"). Possible values: "+It(i)}}},An=yn(Tt),Mn=function(t){return _n(t)},Fn=function(o){return{extract:function(t,n,e){return o().extract(t,n,e)},toString:function(){return o().toString()}}},In=function(n){return yn(function(t){return n(t).fold(Dt,Tt)})},Rn=function(n,t){return Cn(function(t){return Ot(n(t))},t)},Vn=function(t,n,e){return _t((o=t,r=ut,i=e,u=n.extract([o],r,i),Ft(u,function(t){return{input:i,errors:t}})));var o,r,i,u},Pn=function(t){return t.fold(function(t){throw new Error(zn(t))},ut)},Hn=function(t,n,e){return Pn(Vn(t,n,e))},zn=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,W(e,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n"))+"\n\nInput object: "+mn(t.input);var n,e},Nn=Bn,Ln=function(t,n){return Bn(t,Pt(n,wn))},jn=it(An),Un=function(e,o){return yn(function(t){var n=typeof t;return e(t)?Tt(t):Dt("Expected type: "+o+" but got: "+n)})},Wn=Un(lt,"number"),Gn=Un(E,"string"),Xn=Un(A,"boolean"),Yn=Un(I,"function"),qn=function(n){var t=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every(function(t){return qn(n[t])});case"Map":return t(n.keys(),qn)&&t(n.values(),qn);case"Set":return t(n.keys(),qn);default:return!1}},Kn=yn(function(t){return qn(t)?Tt(t):Dt("Expected value to be acceptable for sending via postMessage")}),Jn=function(n){return In(function(t){return N(n,t)?vt.value(t):vt.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})},$n=function(t){return En(t,t,tn(),On())},Qn=function(t,n){return En(t,t,tn(),n)},Zn=function(t){return Qn(t,Gn)},te=function(t,n){return En(t,t,tn(),Jn(n))},ne=function(t){return Qn(t,Yn)},ee=function(t,n){return En(t,t,tn(),wn(n))},oe=function(t,n){return En(t,t,tn(),_n(n))},re=function(t,n){return En(t,t,tn(),Sn(n))},ie=function(t){return En(t,t,nn(),On())},ue=function(t,n){return En(t,t,nn(),n)},ae=function(t){return ue(t,Wn)},ce=function(t){return ue(t,Gn)},se=function(t){return ue(t,Yn)},le=function(t,n){return ue(t,wn(n))},fe=function(t,n){return En(t,t,Zt(n),On())},de=function(t,n,e){return En(t,t,Zt(n),e)},me=function(t,n){return de(t,n,Wn)},ge=function(t,n){return de(t,n,Gn)},pe=function(t,n,e){return de(t,n,Jn(e))},he=function(t,n){return de(t,n,Xn)},ve=function(t,n){return de(t,n,Yn)},be=function(t,n,e){return de(t,n,Sn(e))},ye=function(t,n,e){return de(t,n,wn(e))},xe=function(t,n){return Tn(t,n)},we=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},Se=function(t){if(null===t||t===undefined)throw new Error("Node cannot be null or undefined");return{dom:t}},ke={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Se(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return Se(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return Se(e)},fromDom:Se,fromPoint:function(t,n,e){return st.from(t.dom.elementFromPoint(n,e)).map(Se)}},Ce=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}return undefined}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return _e(o(1),o(2))},Oe=function(){return _e(0,0)},_e=function(t,n){return{major:t,minor:n}},Te={nu:_e,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Oe():Ce(t,e)},unknown:Oe},Ee=function(t,n){var e=String(n).toLowerCase();return K(t,function(t){return t.search(e)})},De=function(t,e){return Ee(t,e).map(function(t){var n=Te.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Be=function(t,e){return Ee(t,e).map(function(t){var n=Te.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Ae=function(t,n){return-1!==t.indexOf(n)},Me=function(t,n){return o=n,r=(e=t).length-n.length,""===o||e.length>=o.length&&e.substr(r,r+o.length)===o;var e,o,r},Fe=(bt=/^\s+|\s+$/g,function(t){return t.replace(bt,"")}),Ie=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Re=function(n){return function(t){return Ae(t,n)}},Ve=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Ae(t,"edge/")&&Ae(t,"chrome")&&Ae(t,"safari")&&Ae(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ie],search:function(t){return Ae(t,"chrome")&&!Ae(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Ae(t,"msie")||Ae(t,"trident")}},{name:"Opera",versionRegexes:[Ie,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Re("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Re("firefox")},{name:"Safari",versionRegexes:[Ie,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Ae(t,"safari")||Ae(t,"mobile/"))&&Ae(t,"applewebkit")}}],Pe=[{name:"Windows",search:Re("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Ae(t,"iphone")||Ae(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Re("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Re("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Re("linux"),versionRegexes:[]},{name:"Solaris",search:Re("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Re("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Re("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],He={browsers:it(Ve),oses:it(Pe)},ze="Firefox",Ne=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(ze),isSafari:o("Safari")}},Le={unknown:function(){return Ne({current:undefined,version:Te.unknown()})},nu:Ne,edge:it("Edge"),chrome:it("Chrome"),ie:it("IE"),opera:it("Opera"),firefox:it(ze),safari:it("Safari")},je="Windows",Ue="Android",We="Solaris",Ge="FreeBSD",Xe="ChromeOS",Ye=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(je),isiOS:o("iOS"),isAndroid:o(Ue),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(We),isFreeBSD:o(Ge),isChromeOS:o(Xe)}},qe={unknown:function(){return Ye({current:undefined,version:Te.unknown()})},nu:Ye,windows:it(je),ios:it("iOS"),android:it(Ue),linux:it("Linux"),osx:it("OSX"),solaris:it(We),freebsd:it(Ge),chromeos:it(Xe)},Ke=function(t,n){var e,o,r,i,u,a,c,s,l,f,d,m,g=He.browsers(),p=He.oses(),h=De(g,t).fold(Le.unknown,Le.nu),v=Be(p,t).fold(qe.unknown,qe.nu);return{browser:h,os:v,deviceType:(o=h,r=t,i=n,u=(e=v).isiOS()&&!0===/ipad/i.test(r),a=e.isiOS()&&!u,c=e.isiOS()||e.isAndroid(),s=c||i("(pointer:coarse)"),l=u||!a&&c&&i("(min-device-width:768px)"),f=a||c&&!l,d=o.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),m=!f&&!l&&!d,{isiPad:it(u),isiPhone:it(a),isTablet:it(l),isPhone:it(f),isTouch:it(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:it(d),isDesktop:it(m)})}},Je=function(t){return window.matchMedia(t).matches},$e=$t(function(){return Ke(navigator.userAgent,Je)}),Qe=function(){return $e()},Ze=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(o.matches!==undefined)return o.matches(n);if(o.msMatchesSelector!==undefined)return o.msMatchesSelector(n);if(o.webkitMatchesSelector!==undefined)return o.webkitMatchesSelector(n);if(o.mozMatchesSelector!==undefined)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},to=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},no=function(t,n){return t.dom===n.dom},eo=function(t,n){return e=t.dom,o=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(o)&r);var e,o,r},oo=function(t,n){return Qe().browser.isIE()?eo(t,n):(e=n,(o=t.dom)!==(r=e.dom)&&o.contains(r));var e,o,r},ro=function(t){return I(t)?t:p},io=function(t,n,e){for(var o=t.dom,r=ro(e);o.parentNode;){o=o.parentNode;var i=ke.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return st.none()},uo=function(t,n,e){var o=n(t),r=ro(e);return o.orThunk(function(){return r(t)?st.none():io(t,n,r)})},ao=function(t,n){return no(t.element,n.event.target)},co=function(t){if(!Gt(t,"can")&&!Gt(t,"abort")&&!Gt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return Hn("Extracting event.handler",xn([fe("can",S),fe("abort",p),fe("run",at)]),t)},so=function(e){var n,o,r,i,t=(o=function(t){return t.can},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(n,function(t,n){return t&&o(n).apply(undefined,e)},!0)}),u=(r=n=e,i=function(t){return t.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(r,function(t,n){return t||i(n).apply(undefined,e)},!1)});return co({can:t,abort:u,run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];ft(e,function(t){t.run.apply(undefined,n)})}})},lo=it,fo=lo("touchstart"),mo=lo("touchmove"),go=lo("touchend"),po=lo("touchcancel"),ho=lo("mousedown"),vo=lo("mousemove"),bo=lo("mouseout"),yo=lo("mouseup"),xo=lo("mouseover"),wo=lo("focusin"),So=lo("focusout"),ko=lo("keydown"),Co=lo("keyup"),Oo=lo("input"),_o=lo("change"),To=lo("click"),Eo=lo("transitionend"),Do=lo("selectstart"),Bo=function(t){return it("alloy."+t)},Ao={tap:Bo("tap")},Mo=Bo("focus"),Fo=Bo("blur.post"),Io=Bo("paste.post"),Ro=Bo("receive"),Vo=Bo("execute"),Po=Bo("focus.item"),Ho=Ao.tap,zo=Bo("longpress"),No=Bo("sandbox.close"),Lo=Bo("typeahead.cancel"),jo=Bo("system.init"),Uo=Bo("system.touchmove"),Wo=Bo("system.touchend"),Go=Bo("system.scroll"),Xo=Bo("system.resize"),Yo=Bo("system.attached"),qo=Bo("system.detached"),Ko=Bo("system.dismissRequested"),Jo=Bo("system.repositionRequested"),$o=Bo("focusmanager.shifted"),Qo=Bo("slotcontainer.visibility"),Zo=Bo("change.tab"),tr=Bo("dismiss.tab"),nr=Bo("highlight"),er=Bo("dehighlight"),or=function(t,n){ar(t,t.element,n,{})},rr=function(t,n,e){ar(t,t.element,n,e)},ir=function(t){or(t,Vo())},ur=function(t,n,e){ar(t,n,e,{})},ar=function(t,n,e,o){var r=ct({target:n},o);t.getSystem().triggerEvent(e,n,r)},cr=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},sr=cn,lr=function(t,n){return{key:t,value:co({abort:n})}},fr=function(t){return{key:t,value:co({run:function(t,n){n.event.prevent()}})}},dr=function(t,n){return{key:t,value:co({run:n})}},mr=function(t,e,o){return{key:t,value:co({run:function(t,n){e.apply(undefined,[t,n].concat(o))}})}},gr=function(t){return function(e){return{key:t,value:co({run:function(t,n){ao(t,n)&&e(t,n)}})}}},pr=function(t,n,e){var o,r,i=n.partUids[e];return r=i,dr(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){cr(t,t.element,o,n)})})},hr=function(t,r){return dr(t,function(n,t){var e=t.event,o=n.getSystem().getByDom(e.target).fold(function(){return uo(e.target,function(t){return n.getSystem().getByDom(t).toOptional()},p).getOr(n)},function(t){return t});r(n,o,t)})},vr=function(t){return dr(t,function(t,n){n.cut()})},br=function(t,n){return gr(t)(n)},yr=gr(Yo()),xr=gr(qo()),wr=gr(jo()),Sr=(yt=Vo(),function(t){return dr(yt,t)}),kr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),Cr=function(n){return function(t){return t.dom.nodeType===n}},Or=Cr(1),_r=Cr(3),Tr=Cr(9),Er=Cr(11),Dr=function(t){return ke.fromDom(t.dom.ownerDocument)},Br=function(t){return Tr(t)?t:Dr(t)},Ar=function(t){return ke.fromDom(Br(t).dom.documentElement)},Mr=function(t){return ke.fromDom(Br(t).dom.defaultView)},Fr=function(t){return st.from(t.dom.parentNode).map(ke.fromDom)},Ir=Fr,Rr=function(t){return st.from(t.dom.offsetParent).map(ke.fromDom)},Vr=function(t){return W(t.dom.childNodes,ke.fromDom)},Pr=function(t,n){var e=t.dom.childNodes;return st.from(e[n]).map(ke.fromDom)},Hr=function(t){return Er(t)&&F(t.dom.host)},zr=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode),Nr=it(zr),Lr=zr?function(t){return ke.fromDom(t.dom.getRootNode())}:Br,jr=function(t){return Hr(t)?t:ke.fromDom(Br(t).dom.body)},Ur=function(t){var n=Lr(t);return Hr(n)?st.some(n):st.none()},Wr=function(t){return ke.fromDom(t.dom.host)},Gr=function(t){return F(t.dom.shadowRoot)},Xr=function(n,e){Fr(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},Yr=function(t,n){var e;(e=t,st.from(e.dom.nextSibling).map(ke.fromDom)).fold(function(){Fr(t).each(function(t){Kr(t,n)})},function(t){Xr(t,n)})},qr=function(n,e){Pr(n,0).fold(function(){Kr(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})},Kr=function(t,n){t.dom.appendChild(n.dom)},Jr=function(n,t){ft(t,function(t){Kr(n,t)})},$r=function(t){t.dom.textContent="",ft(Vr(t),function(t){Qr(t)})},Qr=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Zr=function(t){var n,e=Vr(t);0<e.length&&(n=t,ft(e,function(t){Xr(n,t)})),Qr(t)},ti=function(t){return t.dom.innerHTML},ni=function(t,n){var e,o,r=Dr(t).dom,i=ke.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,Vr(ke.fromDom(o)));Jr(i,u),$r(t),Kr(t,i)},ei=function(t,n,e){if(!(E(e)||A(e)||lt(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},oi=function(t,n,e){ei(t.dom,n,e)},ri=function(t,n){var e=t.dom.getAttribute(n);return null===e?undefined:e},ii=function(t,n){return st.from(ri(t,n))},ui=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},ai=function(t,n){t.dom.removeAttribute(n)},ci=function(t){return n=t,e=!1,ke.fromDom(n.dom.cloneNode(e));var n,e},si=function(t){return Hr(t)?"#shadow-root":(n=ci(t),e=ke.fromTag("div"),o=ke.fromDom(n.dom.cloneNode(!0)),Kr(e,o),ti(e));var n,e,o},li=sr([{key:Mo(),value:co({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target;return o=u,!(no(e=i,t.element)&&!no(e,o)&&(console.warn(Mo()+" did not get interpreted by the desired target. \nOriginator: "+si(i)+"\nTarget: "+si(u)+"\nCheck the "+Mo()+" event handlers"),1))}})}]),fi=Object.freeze({__proto__:null,events:li}),di=0,mi=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++di+String(n)},gi=it("alloy-id-"),pi=it("data-alloy-id"),hi=gi(),vi=pi(),bi=function(t,n){Object.defineProperty(t.dom,vi,{value:n,writable:!0})},yi=function(t){var n=Or(t)?t.dom[vi]:null;return st.from(n)},xi=mi,wi=ut,Si=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+si(n().element)+" is not in context.":""))}};return{debugInfo:it("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:p}},ki=Si(),Ci=function(t){return W(t,function(t){return Me(t,"/*")?t.substring(0,t.length-"/*".length):t})},Oi=function(t,n){
var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Ci(i)}},t},_i=mi("alloy-premade"),Ti=function(t){return an(_i,t)},Ei=function(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(void 0,x([t.getApis(),t],n))},e=(n=o.toString()).indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,e-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ci(i.slice(1))}},t;var t,n,e,r,i},Di={init:function(){return Bi({readState:function(){return"No State required"}})}},Bi=function(t){return t},Ai=function(t,r){var i={};return Vt(t,function(t,o){Vt(t,function(t,n){var e=Ut(i,n).getOr([]);i[n]=e.concat([r(o,t)])})}),i},Mi=function(t){return{classes:t.classes!==undefined?t.classes:[],attributes:t.attributes!==undefined?t.attributes:{},styles:t.styles!==undefined?t.styles:{}}},Fi=function(t){return t.cHandler},Ii=function(t,n){return{name:t,handler:n}},Ri=function(t,n,e){var o,r,i=ct(ct({},e),(o=t,r={},ft(n,function(t){r[t.name()]=t.handlers(o)}),r));return Ai(i,Ii)},Vi=function(t){var n,i=I(n=t)?{can:S,abort:p,run:n}:n;return function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];var r=[t,n].concat(e);i.abort.apply(undefined,r)?n.stop():i.can.apply(undefined,r)&&i.run.apply(undefined,r)}},Pi=function(t,n,e){var o,r,i=n[e];return i?function(u,a,t,c){try{var n=nt(t,function(t,n){var e=t[a],o=n[a],r=c.indexOf(e),i=c.indexOf(o);if(-1===r)throw new Error("The ordering for "+u+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(c,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(c,null,2));return r<i?-1:i<r?1:0});return vt.value(n)}catch(e){return vt.error([e])}}("Event: "+e,"name",t,i).map(function(t){var n=W(t,function(t){return t.handler});return so(n)}):(o=e,r=t,vt.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(r,function(t){return t.name}),null,2)]))},Hi=function(t,i){var n=Nt(t,function(o,r){return(1===o.length?vt.value(o[0].handler):Pi(o,i,r)).map(function(t){var n=Vi(t),e=1<o.length?X(i[r],function(n){return L(o,function(t){return t.name===n})}).join(" > "):o[0].name;return an(r,{handler:n,purpose:e})})});return sn(n,{})},zi="alloy.base.behaviour",Ni=function(t){var n,e;return Vn("custom.definition",wn([En("dom","dom",tn(),wn([$n("tag"),fe("styles",{}),fe("classes",[]),fe("attributes",{}),ie("value"),ie("innerHtml")])),$n("components"),$n("uid"),fe("events",{}),fe("apis",{}),En("eventOrder","eventOrder",((n={})[Vo()]=["disabling",zi,"toggling","typeaheadevents"],n[Mo()]=[zi,"focusing","keying"],n[jo()]=[zi,"disabling","toggling","representing"],n[Oo()]=[zi,"representing","streaming","invalidating"],n[qo()]=[zi,"representing","item-events","tooltipping"],n[ho()]=["focusing",zi,"item-type-events"],n[fo()]=["focusing",zi,"item-type-events"],n[xo()]=["item-type-events","tooltipping"],n[Ro()]=["receiving","reflecting","tooltipping"],e=n,Qt.mergeWithThunk(it(e))),jn()),ie("domModification")]),t)},Li=function(t,n){var e=ri(t,n);return e===undefined||""===e?[]:e.split(" ")},ji=function(t){return t.dom.classList!==undefined},Ui=function(t,n){return r=n,i=Li(e=t,o="class").concat([r]),oi(e,o,i.join(" ")),!0;var e,o,r,i},Wi=function(t,n){return r=n,0<(i=X(Li(e=t,o="class"),function(t){return t!==r})).length?oi(e,o,i.join(" ")):ai(e,o),!1;var e,o,r,i},Gi=function(t,n){ji(t)?t.dom.classList.add(n):Ui(t,n)},Xi=function(t){0===(ji(t)?t.dom.classList:Li(t,"class")).length&&ai(t,"class")},Yi=function(t,n){ji(t)?t.dom.classList.remove(n):Wi(t,n),Xi(t)},qi=function(t,n){return ji(t)&&t.dom.classList.contains(n)},Ki=function(n,t){ft(t,function(t){Gi(n,t)})},Ji=function(n,t){ft(t,function(t){Yi(n,t)})},$i=function(t){return t.style!==undefined&&I(t.style.getPropertyValue)},Qi=function(t){var n=_r(t)?t.dom.parentNode:t.dom;if(n===undefined||null===n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Ur(ke.fromDom(n)).fold(function(){return r.body.contains(n)},(e=Qi,o=Wr,function(t){return e(o(t))}))},Zi=function(){return tu(ke.fromDom(document))},tu=function(t){var n=t.dom.body;if(null===n||n===undefined)throw new Error("Body is not available yet");return ke.fromDom(n)},nu=function(t,n,e){if(!E(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);$i(t)&&t.style.setProperty(n,e)},eu=function(t,n){$i(t)&&t.style.removeProperty(n)},ou=function(t,n,e){var o=t.dom;nu(o,n,e)},ru=function(t,n){var e=t.dom;Vt(n,function(t,n){nu(e,n,t)})},iu=function(t,n){var e=t.dom;Vt(n,function(t,n){t.fold(function(){eu(e,n)},function(t){nu(e,n,t)})})},uu=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Qi(t)?o:au(e,n)},au=function(t,n){return $i(t)?t.style.getPropertyValue(n):""},cu=function(t,n){var e=t.dom,o=au(e,n);return st.from(o).filter(function(t){return 0<t.length})},su=function(t,n,e){var o=ke.fromTag(t);return ou(o,n,e),cu(o,n).isSome()},lu=function(t,n){var e=t.dom;eu(e,n),ii(t,"style").map(Fe).is("")&&ai(t,"style")},fu=function(t){return t.dom.offsetWidth},du=function(t){return t.dom.value},mu=function(t,n){if(n===undefined)throw new Error("Value.set was undefined");t.dom.value=n},gu=function(t){var n,e,o,r=ke.fromTag(t.tag);n=r,e=t.attributes,o=n.dom,Vt(e,function(t,n){ei(o,n,t)}),Ki(r,t.classes),ru(r,t.styles),t.innerHtml.each(function(t){return ni(r,t)});var i=t.domChildren;return Jr(r,i),t.value.each(function(t){mu(r,t)}),t.uid,bi(r,t.uid),r},pu=function(t,n){return e=t,r=W(o=n,function(t){return le(t.name(),[$n("config"),fe("state",Di)])}),i=Vn("component.behaviours",wn(r),e.behaviours).fold(function(t){throw new Error(zn(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(t){return t}),{list:o,data:Pt(i,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})};var e,o,r,i},hu=function(t){var n,e,o=(n=Ut(t,"behaviours").getOr({}),e=X(It(n),function(t){return n[t]!==undefined}),W(e,function(t){return n[t].me}));return pu(t,o)},vu=function(t,n,e){var o,r,i,u=ct(ct({},(o=t).dom),{uid:o.uid,domChildren:W(o.components,function(t){return t.element})}),a=t.domModification.fold(function(){return Mi({})},Mi),l={"alloy.base.modification":a};return i=0<n.length?function(n,t,e,o){var r=ct({},l);ft(e,function(t){r[t.name()]=t.exhibit(n,o)});var i=Ai(r,function(t,n){return{name:t,modification:n}}),u=function(t){return Y(t,function(t,n){return ct(ct({},n.modification),t)},{})},a=Y(i.classes,function(t,n){return n.modification.concat(t)},[]),c=u(i.attributes),s=u(i.styles);return Mi({classes:a,attributes:c,styles:s})}(e,0,n,u):a,ct(ct({},r=u),{attributes:ct(ct({},r.attributes),i.attributes),styles:ct(ct({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},bu=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return o=e,r=t.eventOrder,i=Ri(o,n,u),Hi(i,r).getOrDie()},yu=function(t){var n,e,o,r,i,u,a,c,s,l,f,d,m,g=wi(t),p=g.events,h=y(g,["events"]),v=(n=Ut(h,"components").getOr([]),W(n,ku)),b=ct(ct({},h),{events:ct(ct({},fi),p),components:v});return vt.value((o=function(){return m},r=we(ki),i=Pn(Ni(e=b)),a=(u=hu(e)).list,c=u.data,s=vu(i,a,c),l=gu(s),f=bu(i,a,c),d=we(i.components),m={getSystem:r.get,config:function(t){var n=c;return(I(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return I(c[t.name()])},spec:e,readState:function(t){return c[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return i.apis},connect:function(t){r.set(t)},disconnect:function(){r.set(Si(o))},element:l,syncComponents:function(){var t=Vr(l),n=$(t,function(t){return r.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});d.set(n)},components:d.get,events:f}))},xu=function(t){var n=ke.fromText(t);return wu({element:n})},wu=function(t){var n=Hn("external.component",xn([$n("element"),ie("uid")]),t),e=we(Si());n.uid.each(function(t){bi(n.element,t)});var o={getSystem:e.get,config:st.none,hasConfigured:p,connect:function(t){e.set(t)},disconnect:function(){e.set(Si(function(){return o}))},getApis:function(){return{}},element:n.element,spec:t,readState:it("No state"),syncComponents:at,components:it([]),events:{}};return Ti(o)},Su=xi,ku=function(n){return Ut(n,_i).fold(function(){var t=n.hasOwnProperty("uid")?n:ct({uid:Su("")},n);return yu(t).getOrDie()},function(t){return t})},Cu=Ti,Ou=function(o,r){var t=function(t){var n=r(t);if(n<=0||null===n){var e=uu(t,o);return parseFloat(e)||0}return n},i=function(r,t){return q(t,function(t,n){var e=uu(r,n),o=e===undefined?0:parseInt(e,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!lt(n)&&!n.match(/^[0-9]+$/))throw new Error(o+".set accepts only positive integer values. Value was "+n);var e=t.dom;$i(e)&&(e.style[o]=n+"px")},get:t,getOuter:t,aggregate:i,max:function(t,n,e){var o=i(t,e);return o<n?n-o:0}}},_u=Ou("height",function(t){var n=t.dom;return Qi(t)?n.getBoundingClientRect().height:n.offsetHeight}),Tu=function(t){return _u.get(t)},Eu=function(t){return _u.getOuter(t)},Du=function(e,o){return{left:e,top:o,translate:function(t,n){return Du(e+t,o+n)}}},Bu=Du,Au=function(t,n){return t!==undefined?t:n!==undefined?n:0},Mu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return Bu(e.offsetLeft,e.offsetTop);var i=Au(null==o?void 0:o.pageYOffset,r.scrollTop),u=Au(null==o?void 0:o.pageXOffset,r.scrollLeft),a=Au(r.clientTop,e.clientTop),c=Au(r.clientLeft,e.clientLeft);return Fu(t).translate(u-c,i-a)},Fu=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?Bu(o.offsetLeft,o.offsetTop):Qi(t)?(n=e.getBoundingClientRect(),Bu(n.left,n.top)):Bu(0,0)},Iu=Ou("width",function(t){return t.dom.offsetWidth}),Ru=function(t){return Iu.get(t)},Vu=function(t){return Iu.getOuter(t)},Pu=function(t){var n=ke.fromDom(function(t){if(Nr()&&F(t.target)){var n=ke.fromDom(t.target);if(Or(n)&&Gr(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return ot(e)}}return st.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=m(o,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:o,kill:r,raw:t}},Hu=function(t,n,e,o,r){var i,u,a=(i=e,u=o,function(t){i(t)&&u(Pu(t))});return t.dom.addEventListener(n,a,r),{unbind:b(zu,t,n,a,r)}},zu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Nu=function(t){var n=t!==undefined?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Bu(e,o)},Lu=function(t,n,e){var o=(e!==undefined?e.dom:document).defaultView;o&&o.scrollTo(t,n)},ju=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Uu=function(t){var n,e,o=t===undefined?window:t,r=o.document,i=Nu(ke.fromDom(r));return e=(n=o)===undefined?window:n,st.from(e.visualViewport).fold(function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight;return ju(i.left,i.top,n,e)},function(t){return ju(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)})},Wu=function(o,t){return o.view(t).fold(it([]),function(t){var n=o.owner(t),e=Wu(o,n);return[t].concat(e)})},Gu=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?st.none():st.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(ke.fromDom)},owner:Dr}),Xu=function(o){var t,n,e,r,i=ke.fromDom(document),u=Nu(i);return(t=o,e=(n=Gu).owner(t),r=Wu(n,e),st.some(r)).fold(b(Mu,o),function(t){var n=Fu(o),e=Y(t,function(t,n){var e=Fu(n);return{left:t.left+e.left,top:t.top+e.top}},{left:0,top:0});return Bu(e.left+n.left+u.left,e.top+n.top+u.top)})},Yu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},qu=function(t){var n=Mu(t),e=Vu(t),o=Eu(t);return Yu(n.left,n.top,e,o)},Ku=function(t){var n=Xu(t),e=Vu(t),o=Eu(t);return Yu(n.left,n.top,e,o)},Ju=function(){return Uu(window)},$u=function(t,n,e){for(var o=t.dom,r=I(e)?e:p;o.parentNode;){o=o.parentNode;var i=ke.fromDom(o);if(n(i))return st.some(i);if(r(i))break}return st.none()},Qu=function(t,n,e){return o(function(t,n){return n(t)},$u,t,n,e)},Zu=function(t,n,e){return Qu(t,n,e).isSome()},ta=function(t,n,e){return $u(t,function(t){return Ze(t,n)},e)},na=function(t,n){return e=n,r=(o=t)===undefined?document:o.dom,to(r)?st.none():st.from(r.querySelector(e)).map(ke.fromDom);var e,o,r},ea=function(t,n,e){return o(Ze,ta,t,n,e)},oa=function(){var n=mi("aria-owns");return{id:n,link:function(t){oi(t,"aria-owns",n)},unlink:function(t){ai(t,"aria-owns")}}},ra=function(n,t){return Qu(t,function(t){if(!Or(t))return!1;var n=ri(t,"id");return n!==undefined&&-1<n.indexOf("aria-owns")}).bind(function(t){var n=ri(t,"id"),e=Lr(t);return na(e,'[aria-owns="'+n+'"]')}).exists(function(t){return ia(n,t)})},ia=function(n,t){return Zu(t,function(t){return no(t,n.element)},p)||ra(n,t)},ua="unknown";(wt=xt=xt||{})[wt.STOP=0]="STOP",wt[wt.NORMAL=1]="NORMAL",wt[wt.LOGGING=2]="LOGGING";var aa,ca,sa=we({}),la=["alloy/data/Fields","alloy/debugging/Debugging"],fa=function(n,t,e){var o,r,i,u;switch(Ut(sa.get(),n).orThunk(function(){var t=It(sa.get());return gt(t,function(t){return-1<n.indexOf(t)?st.some(sa.get()[t]):st.none()})}).getOr(xt.NORMAL)){case xt.NORMAL:return e(da());case xt.LOGGING:var a=(o=n,r=t,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();N(["mousemove","mouseover","mouseout",jo()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:W(i,function(t){return N(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+si(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case xt.STOP:return!0}},da=it({logEventCut:at,logEventStopped:at,logNoParent:at,logEventNoHandlers:at,logEventResponse:at,write:at}),ma=it([$n("menu"),$n("selectedMenu")]),ga=it([$n("item"),$n("selectedItem")]),pa=(it(wn(ga().concat(ma()))),it(wn(ga()))),ha=ee("initSize",[$n("numColumns"),$n("numRows")]),va=function(){return ee("markers",[$n("backgroundMenu")].concat(ma()).concat(ga()))},ba=function(t){return ee("markers",W(t,$n))},ya=function(t,n,e){return function(){var t=new Error;if(t.stack!==undefined){var n=t.stack.split("\n");K(n,function(n){return 0<n.indexOf("alloy")&&!L(la,function(t){return-1<n.indexOf(t)})}).getOr(ua)}}(),En(n,n,e,In(function(e){return vt.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(undefined,t)})}))},xa=function(t){return ya(0,t,Zt(at))},wa=function(t){return ya(0,t,Zt(st.none))},Sa=function(t){return ya(0,t,tn())},ka=function(t){return ya(0,t,tn())},Ca=function(t,n){return xe(t,it(n))},Oa=function(t){return xe(t,ut)},_a=it(ha),Ta=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},Ea=Xt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Da=Ea.southeast,Ba=Ea.southwest,Aa=Ea.northeast,Ma=Ea.northwest,Fa=Ea.south,Ia=Ea.north,Ra=Ea.east,Va=Ea.west,Pa=function(e,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],function(t){return Ut(n,t).map(function(n){return function(t){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(e)})})},Ha=function(t){return t.x},za=function(t,n){return t.x+t.width/2-n.width/2},Na=function(t,n){return t.x+t.width-n.width},La=function(t,n){return t.y-n.height},ja=function(t){return t.y+t.height},Ua=function(t,n){return t.y+t.height/2-n.height/2},Wa=function(t,n,e){return Ta(Ha(t),ja(t),e.southeast(),Da(),Pa(t,{left:1,top:3}),"layout-se")},Ga=function(t,n,e){return Ta(Na(t,n),ja(t),e.southwest(),Ba(),Pa(t,{right:0,top:3}),"layout-sw")},Xa=function(t,n,e){return Ta(Ha(t),La(t,n),e.northeast(),Aa(),Pa(t,{left:1,bottom:2}),"layout-ne")},Ya=function(t,n,e){return Ta(Na(t,n),La(t,n),e.northwest(),Ma(),Pa(t,{right:0,bottom:2}),"layout-nw")},qa=function(t,n,e){return Ta(za(t,n),La(t,n),e.north(),Ia(),Pa(t,{bottom:2}),"layout-n")},Ka=function(t,n,e){return Ta(za(t,n),ja(t),e.south(),Fa(),Pa(t,{top:3}),"layout-s")},Ja=function(t,n,e){return Ta((o=t).x+o.width,Ua(t,n),e.east(),Ra(),Pa(t,{left:0}),"layout-e");var o},$a=function(t,n,e){return Ta((o=n,t.x-o.width),Ua(t,n),e.west(),Va(),Pa(t,{right:1}),"layout-w");var o},Qa=function(){return[Wa,Ga,Xa,Ya,Ka,qa,Ja,$a]},Za=function(){return[Ga,Wa,Ya,Xa,Ka,qa,Ja,$a]},tc=function(){return[Xa,Ya,Wa,Ga,qa,Ka]},nc=function(){return[Ya,Xa,Ga,Wa,qa,Ka]},ec=function(){return[Wa,Ga,Xa,Ya,Ka,qa]},oc=function(){return[Ga,Wa,Ya,Xa,Ka,qa]},rc=Object.freeze({__proto__:null,events:function(c){return sr([dr(Ro(),function(r,t){var n,e,i=c.channels,o=It(i),u=t,a=(n=o,(e=u).universal?n:X(n,function(t){return N(e.channels,t)}));ft(a,function(t){var n=i[t],e=n.schema,o=Hn("channel["+t+"] data\nReceiver: "+si(r.element),e,u.data);n.onReceive(r,o)})})])}}),ic=[Qn("channels",Rn(vt.value,xn([Sa("onReceive"),fe("schema",jn())])))],uc=function(n,e,o){return wr(function(t){o(t,n,e)})},ac=function(t,n,e,o,r,i){var u=xn(t),a=le(n,[ue("config",xn(t))]);return lc(u,a,n,e,o,r,i)},cc=function(r,i,u){var t,n,e,o,a,c;return t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:it(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(undefined,[e,t.config,t.state].concat(n))})},n=u,o=(e=i.toString()).indexOf(")")+1,a=e.indexOf("("),c=e.substring(a+1,o-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:n,parameters:Ci(c.slice(0,1).concat(c.slice(3)))}},t},sc=function(t){return{key:t,value:undefined}},lc=function(e,t,o,r,n,i,u){var a=function(t){return Gt(t,o)?t[o]():st.none()},c=Pt(n,function(t,n){return cc(o,t,n)}),s=Pt(i,Oi),l=ct(ct(ct({},s),c),{revoke:b(sc,o),config:function(t){var n=Hn(o+"-config",e,t);return{key:o,value:{config:n,me:l,configAsRaw:$t(function(){return Hn(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:it(t),exhibit:function(t,e){return a(t).bind(function(n){return Ut(r,"exhibit").map(function(t){return t(e,n.config,n.state)})}).getOr(Mi({}))},name:it(o),handlers:function(t){return a(t).map(function(t){return Ut(r,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return l},fc=cn,dc=xn([$n("fields"),$n("name"),fe("active",{}),fe("apis",{}),fe("state",Di),fe("extra",{})]),mc=function(t){var n=Hn("Creating behaviour: "+t.name,dc,t);return ac(n.fields,n.name,n.active,n.apis,n.extra,n.state)},gc=xn([$n("branchKey"),$n("branches"),$n("name"),fe("active",{}),fe("apis",{}),fe("state",Di),fe("extra",{})]),pc=function(t){var n,e,o,r,i,u,a,c,s=Hn("Creating behaviour: "+t.name,gc,t);return n=Ln(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=le(e,[ue("config",a=n)]),lc(a,c,e,o,r,i,u)},hc=it(undefined),vc=mc({fields:ic,name:"receiving",active:rc}),bc=Object.freeze({__proto__:null,exhibit:function(t,n){return Mi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),yc=function(t){return t.dom.focus()},xc=function(t){return void 0===t&&(t=ke.fromDom(document)),st.from(t.dom.activeElement).map(ke.fromDom)},wc=function(n){return xc(Lr(n)).filter(function(t){return n.dom.contains(t.dom)})},Sc=function(t,e){var o=Lr(e),n=xc(o).bind(function(n){var r,i,t=function(t){return no(n,t)};return t(e)?st.some(e):(r=t,(i=function(t){for(var n=0;n<t.childNodes.length;n++){var e=ke.fromDom(t.childNodes[n]);if(r(e))return st.some(e);var o=i(t.childNodes[n]);if(o.isSome())return o}return st.none()})(e.dom))}),r=t(e);return n.each(function(n){xc(o).filter(function(t){return no(t,n)}).fold(function(){yc(n)},at)}),r},kc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},Cc=function(t,n){var e=function(t){return t+"px"};iu(t,{position:st.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},Oc=Xt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),_c=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=n.x-e,p=n.y-o,h=r-(g+n.width),v=i-(p+n.height),b=st.some(g),y=st.some(p),x=st.some(h),w=st.some(v),S=st.none();return u=function(){return kc(t,b,y,S,S)},a=function(){return kc(t,S,y,x,S)},c=function(){return kc(t,b,S,S,w)},s=function(){return kc(t,S,S,x,w)},l=function(){return kc(t,b,y,S,S)},f=function(){return kc(t,b,S,S,w)},d=function(){return kc(t,b,y,S,S)},m=function(){return kc(t,S,y,x,S)},n.direction.fold(u,a,c,s,l,f,d,m)},Tc=function(t,n){var e=b(Xu,n),o=t.fold(e,e,function(){var t=Nu();return Xu(n).translate(-t.left,-t.top)}),r=Vu(n),i=Eu(n);return Yu(o.left,o.top,r,i)},Ec=function(t,n,e){var o=Bu(n,e);return t.fold(it(o),it(o),function(){var t=Nu();return o.translate(-t.left,-t.top)})},Dc=(Oc.none,Oc.relative),Bc=Oc.fixed,Ac=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},Mc=function(t,n,e){return Math.min(Math.max(t,n),e)},Fc=Xt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ic=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E,D,B,A,M,F,I,R,V=t.x,P=t.y,H=t.bubble.offset,z=H.left,N=H.top,L=(r=o,i=t.boundsRestriction,u=H,c=(a=function(n,e){var o="top"===n||"bottom"===n?u.top:u.left;return Ut(i,n).bind(ut).bind(function(t){return"left"===n||"top"===n?e<=t?st.some(t):st.none():t<=e?st.some(t):st.none()}).map(function(t){return t+o}).getOr(e)})("left",r.x),s=a("top",r.y),l=a("right",r.right),f=a("bottom",r.bottom),Yu(c,s,l-c,f-s)),j=L.y,U=L.bottom,W=L.x,G=L.right,X=P+N,Y=(d=V+z,m=X,g=n,p=e,v=(h=L).x,b=h.y,y=h.width,x=h.height,S=b<=m,k=(w=v<=d)&&S,C=d+g<=v+y&&m+p<=b+x,O=Math.abs(Math.min(g,w?v+y-d:v-(d+g))),_=Math.abs(Math.min(p,S?b+x-m:b-(m+p))),T=Math.max(h.x,h.right-g),E=Math.max(h.y,h.bottom-p),{originInBounds:k,sizeInBounds:C,limitX:Mc(d,h.x,T),limitY:Mc(m,h.y,E),deltaW:O,deltaH:_}),q=Y.originInBounds,K=Y.sizeInBounds,J=Y.limitX,$=Y.limitY,Q=Y.deltaW,Z=Y.deltaH,tt=it($+Z-j),nt=(B=D=it(U-$),A=tt,t.direction.fold(D,D,A,A,D,A,B,B)),et=it(J+Q-W),ot=it(G-J),rt={x:J,y:$,width:Q,height:Z,maxHeight:nt,maxWidth:(M=t.direction,I=F=ot,R=et,M.fold(F,R,F,R,I,I,F,R)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:X};return q&&K?Fc.fit(rt):Fc.nofit(rt,Q,Z)},Rc=function(t,n,e,o){lu(n,"max-height"),lu(n,"max-width");var r,i,u,a,c,s,l,f,d,m={width:Vu(r=n),height:Eu(r)};return i=o.preference,u=t,a=m,c=e,s=o.bounds,l=a.width,f=a.height,d=function(t,o,r,i){var n=t(u,a,c);return Ic(n,l,f,s).fold(Fc.fit,function(t,n,e){return i<e||r<n?Fc.nofit(t,n,e):Fc.nofit(o,r,i)})},q(i,function(t,n){var e=b(d,n);return t.fold(Fc.fit,e)},Fc.nofit({x:u.x,y:u.y,width:a.width,height:a.height,maxHeight:a.height,maxWidth:a.width,direction:Da(),classes:{on:[],off:[]},label:"none",candidateYforTest:u.y},-1,-1)).fold(ut,ut)},Vc=function(t,n,e){var o,r;Cc(t,(o=e.origin,r=n,o.fold(function(){return kc("absolute",st.some(r.x),st.some(r.y),st.none(),st.none())},function(t,n,e,o){return _c("absolute",r,t,n,e,o)},function(t,n,e,o){return _c("fixed",r,t,n,e,o)})))},Pc=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=_u.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),ou(e,"max-height",r+"px")},Hc=it(function(t,n){Pc(t,n),ru(t,{"overflow-x":"hidden","overflow-y":"auto"})}),zc=it(function(t,n){Pc(t,n)}),Nc=function(t,n,e){return t[n]===undefined?e:t[n]},Lc=function(t,n,e,o,r,i){var u,a=Nc(i,"maxHeightFunction",Hc()),c=Nc(i,"maxWidthFunction",at),s=t.anchorBox,l=t.origin,f={bounds:(u=l,r.fold(function(){return u.fold(Ju,Ju,Yu)},function(e){return u.fold(e,e,function(){var t=e(),n=Ec(u,t.x,t.y);return Yu(n.left,n.top,t.width,t.height)})})),origin:l,preference:o,maxHeightFunction:a,maxWidthFunction:c};jc(s,n,e,f)},jc=function(t,n,e,o){var r,i,u,a,c,s,l=Rc(t,n,e,o);Vc(n,l,o),r=n,i=l.classes,Ji(r,i.off),Ki(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},Uc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Wc=function(t,n,e){var r=function(t){return Ut(e,t).getOr([])},o=function(t,n,e){var o=tt(Uc,e);return{offset:Bu(t,n),classesOn:$(e,r),classesOff:$(o,r)}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(t,-n/2,["valignCentre","right"])},innerEast:function(){return o(-t,-n/2,["valignCentre","left"])}}},Gc=function(){return Wc(0,0,{})},Xc=function(n,e){return function(t){return"rtl"===Yc(t)?e:n}},Yc=function(t){return"rtl"===uu(t,"direction")?"rtl":"ltr"};(ca=aa=aa||{}).TopToBottom="toptobottom",ca.BottomToTop="bottomtotop";var qc,Kc,Jc,$c,Qc,Zc="data-alloy-vertical-dir",ts=function(t){return Zu(t,function(t){return Or(t)&&ri(t,"data-alloy-vertical-dir")===aa.BottomToTop})},ns=function(){return le("layouts",[$n("onLtr"),$n("onRtl"),ie("onBottomLtr"),ie("onBottomRtl")])},es=function(n,t,e,o,r,i,u){var a=u.map(ts).getOr(!1),c=t.layouts.map(function(t){return t.onLtr(n)}),s=t.layouts.map(function(t){return t.onRtl(n)}),l=a?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(n)})}).or(c).getOr(r):c.getOr(e),f=a?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(n)})}).or(s).getOr(i):s.getOr(o);return Xc(l,f)(n)},os=[$n("hotspot"),ie("bubble"),fe("overrides",{}),ns(),Ca("placement",function(t,n,e){var o=n.hotspot,r=Tc(e,o.element),i=es(t.element,n,ec(),oc(),tc(),nc(),st.some(n.hotspot.element));return st.some({anchorBox:r,bubble:n.bubble.getOr(Gc()),overrides:n.overrides,layouts:i,placer:st.none()})})],rs=[$n("x"),$n("y"),fe("height",0),fe("width",0),fe("bubble",Gc()),fe("overrides",{}),ns(),Ca("placement",function(t,n,e){var o=Ec(e,n.x,n.y),r=Yu(o.left,o.top,n.width,n.height),i=es(t.element,n,Qa(),Za(),Qa(),Za(),st.none());return st.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:st.none()})})],is=Xt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),us=function(t){return t.fold(ut,function(t,n,e){return t.translate(-n,-e)})},as=function(t){return t.fold(ut,ut)},cs=function(t){return q(t,function(t,n){return t.translate(n.left,n.top)},Bu(0,0))},ss=function(t){var n=W(t,as);return cs(n)},ls=is.screen,fs=is.absolute,ds=function(t,n,e){var o,r,i=Dr(t.element),u=Nu(i),a=(o=t,r=Mr(e.root).dom,st.from(r.frameElement).map(ke.fromDom).filter(function(t){var n=Dr(t),e=Dr(o.element);return no(n,e)}).map(Mu).getOr(u));return fs(a,u.left,u.top)},ms=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=ls(Bu(r,i));return st.some({point:c,width:u,height:a})},gs=function(t,l,f,d,m){return t.map(function(t){var n,e,o,r=[l,t.point],i=(n=function(){return ss(r)},e=function(){return ss(r)},o=function(){return t=W(r,us),cs(t);var t},d.fold(n,e,o)),u={x:i.left,y:i.top,width:t.width,height:t.height},a=(f.showAbove?tc:ec)(),c=(f.showAbove?nc:oc)(),s=es(m,f,a,c,a,c,st.none());return{anchorBox:u,bubble:f.bubble.getOr(Gc()),overrides:f.overrides,layouts:s,placer:st.none()}})},ps=[$n("node"),$n("root"),ie("bubble"),ns(),fe("overrides",{}),fe("showAbove",!1),Ca("placement",function(r,i,u){var a=ds(r,0,i);return i.node.filter(Qi).bind(function(t){var n=t.dom.getBoundingClientRect(),e=ms(n.left,n.top,n.width,n.height),o=i.node.getOr(r.element);return gs(e,a,i,u,o)})})],hs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},vs=Xt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),bs=(vs.before,vs.on,vs.after,function(t){return t.fold(ut,ut,ut)}),ys=Xt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),xs={domRange:ys.domRange,relative:ys.relative,exact:ys.exact,exactFromRange:function(t){return ys.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return ke.fromDom(t.startContainer)},relative:function(t){return bs(t)},exact:function(t){return t}});return Mr(n)},range:hs},ws=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold(function(t){o.setStartBefore(t.dom)},function(t,n){o.setStart(t.dom,n)},function(t){o.setStartAfter(t.dom)}),r=i,e.fold(function(t){r.setEndBefore(t.dom)},function(t,n){r.setEnd(t.dom,n)},function(t){r.setEndAfter(t.dom)}),i},Ss=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},ks=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Cs=Xt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Os=function(t,n,e){return n(ke.fromDom(e.startContainer),e.startOffset,ke.fromDom(e.endContainer),e.endOffset)},_s=function(t,n){var r,e,o,i=(r=t,n.match({domRange:function(t){return{ltr:it(t),rtl:st.none}},relative:function(t,n){return{ltr:$t(function(){return ws(r,t,n)}),rtl:$t(function(){return st.some(ws(r,n,t))})}},exact:function(t,n,e,o){return{ltr:$t(function(){return Ss(r,t,n,e,o)}),rtl:$t(function(){return st.some(Ss(r,e,o,t,n))})}}}));return(o=(e=i).ltr()).collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Cs.rtl(ke.fromDom(t.endContainer),t.endOffset,ke.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Os(0,Cs.ltr,o)}):Os(0,Cs.ltr,o)},Ts=(Cs.ltr,Cs.rtl,qc=_r,Kc="text",{get:function(t){if(!qc(t))throw new Error("Can only get "+Kc+" value of a "+Kc+" node");return Jc(t).getOr("")},getOption:Jc=function(t){return qc(t)?st.from(t.dom.nodeValue):st.none()},set:function(t,n){if(!qc(t))throw new Error("Can only set raw "+Kc+" value of a "+Kc+" node");t.dom.nodeValue=n}}),Es=function(t){return Ts.getOption(t)},Ds=["img","br"],Bs=function(t){return Es(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")}).isSome()||N(Ds,kr(t))},As=function(t,i){var u=function(t){for(var n=Vr(t),e=n.length-1;0<=e;e--){var o=n[e];if(i(o))return st.some(o);var r=u(o);if(r.isSome())return r}return st.none()};return u(t)},Ms=function(t,n){return e=n,r=(o=t)===undefined?document:o.dom,to(r)?[]:W(r.querySelectorAll(e),ke.fromDom);var e,o,r},Fs=function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=Dr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=no(t,e)&&n===o;return s.collapsed&&!l},Is=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return st.some(hs(ke.fromDom(n.startContainer),n.startOffset,ke.fromDom(e.endContainer),e.endOffset))}return st.none()},Rs=function(t){if(null===t.anchorNode||null===t.focusNode)return Is(t);var n=ke.fromDom(t.anchorNode),e=ke.fromDom(t.focusNode);return Fs(n,t.anchorOffset,e,t.focusOffset)?st.some(hs(n,t.anchorOffset,e,t.focusOffset)):Is(t)},Vs=function(t){return n=t,st.from(n.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(Rs);var n},Ps=function(t,n){var i,e,o,r;return 0<(r=0<(o=(e=_s(i=t,n).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom,o),r.setEnd(t.dom,n),r}})).getClientRects()).length?o[0]:e.getBoundingClientRect()).width||0<r.height?st.some(r).map(ks
):st.none()},Hs=function(t,n){return{element:t,offset:n}},zs=function(t,n){var e=Vr(t);if(0===e.length)return Hs(t,n);if(n<e.length)return Hs(e[n],0);var o,r=e[e.length-1],i=_r(r)?(o=r,Ts.get(o).length):Vr(r).length;return Hs(r,i)},Ns=function(t,n){return(_r(t)?Hs:zs)(t,n)},Ls=function(t,n){return n.getSelection.getOrThunk(function(){return function(){return Vs(t)}})().map(function(t){var n=Ns(t.start,t.soffset),e=Ns(t.finish,t.foffset);return xs.range(n.element,n.offset,e.element,e.offset)})},js=[ie("getSelection"),$n("root"),ie("bubble"),ns(),fe("overrides",{}),fe("showAbove",!1),Ca("placement",function(t,n,e){var o=Mr(n.root).dom,r=ds(t,0,n),i=Ls(o,n).bind(function(t){return Ps(o,xs.exactFromRange(t)).orThunk(function(){var n=ke.fromText("\ufeff");return Xr(t.start,n),Ps(o,xs.exact(n,0,n,1)).map(function(t){return Qr(n),t})}).bind(function(t){return ms(t.left,t.top,t.width,t.height)})}),u=Ls(o,n).bind(function(t){return Or(t.start)?st.some(t.start):Ir(t.start)}).getOr(t.element);return gs(i,r,n,e,u)})],Us=function(t){return t.x+t.width},Ws=function(t,n){return t.x-n.width},Gs=function(t,n){return t.y-n.height+t.height},Xs=function(t){return t.y},Ys=function(t,n,e){return Ta(Us(t),Xs(t),e.southeast(),Da(),Pa(t,{left:0,top:2}),"link-layout-se")},qs=function(t,n,e){return Ta(Ws(t,n),Xs(t),e.southwest(),Ba(),Pa(t,{right:1,top:2}),"link-layout-sw")},Ks=function(t,n,e){return Ta(Us(t),Gs(t,n),e.northeast(),Aa(),Pa(t,{left:0,bottom:3}),"link-layout-ne")},Js=function(t,n,e){return Ta(Ws(t,n),Gs(t,n),e.northwest(),Ma(),Pa(t,{right:1,bottom:3}),"link-layout-nw")},$s=function(){return[Ys,qs,Ks,Js]},Qs=function(){return[qs,Ys,Js,Ks]},Zs=[$n("item"),ns(),fe("overrides",{}),Ca("placement",function(t,n,e){var o=Tc(e,n.item.element),r=es(t.element,n,$s(),Qs(),$s(),Qs(),st.none());return st.some({anchorBox:o,bubble:Gc(),overrides:n.overrides,layouts:r,placer:st.none()})})],tl=Ln("anchor",{selection:js,node:ps,hotspot:os,submenu:Zs,makeshift:rs}),nl=function(t,n,e,o,r){var i={anchorBox:e.anchorBox,origin:n};Lc(i,r.element,e.bubble,e.layouts,o,e.overrides)},el=function(t,n,e,o,r,i){var u=i.map(qu);return ol(t,n,e,o,r,u)},ol=function(c,s,t,n,l,f){var d=Hn("positioning anchor.info",tl,n);Sc(function(){ou(l.element,"position","fixed");var t=cu(l.element,"visibility");ou(l.element,"visibility","hidden");var n,e,o,r,i=s.useFixed()?(r=document.documentElement,Bc(0,0,r.clientWidth,r.clientHeight)):(e=Mu((n=c).element),o=n.element.dom.getBoundingClientRect(),Dc(e.left,e.top,o.width,o.height)),u=d.placement,a=f.map(it).or(s.getBounds);u(c,d,i).each(function(t){t.placer.getOr(nl)(c,i,t,a,l)}),t.fold(function(){lu(l.element,"visibility")},function(t){ou(l.element,"visibility",t)}),cu(l.element,"left").isNone()&&cu(l.element,"top").isNone()&&cu(l.element,"right").isNone()&&cu(l.element,"bottom").isNone()&&cu(l.element,"position").is("fixed")&&lu(l.element,"position")},l.element)},rl=Object.freeze({__proto__:null,position:function(t,n,e,o,r){el(t,n,e,o,r,st.none())},positionWithin:el,positionWithinBounds:ol,getMode:function(t,n){return n.useFixed()?"fixed":"absolute"}}),il=[fe("useFixed",p),ie("getBounds")],ul=mc({fields:il,name:"positioning",active:bc,apis:rl}),al=function(t){or(t,qo());var n=t.components();ft(n,al)},cl=function(t){var n=t.components();ft(n,cl),or(t,Yo())},sl=function(t,n){Kr(t.element,n.element)},ll=function(n,t){var e,o=n.components();ft((e=n).components(),function(t){return Qr(t.element)}),$r(e.element),e.syncComponents();var r=tt(o,t);ft(r,function(t){al(t),n.getSystem().removeFromWorld(t)}),ft(t,function(t){t.getSystem().isConnected()?sl(n,t):(n.getSystem().addToWorld(t),sl(n,t),Qi(n.element)&&cl(t)),n.syncComponents()})},fl=function(t,n){dl(t,n,Kr)},dl=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Qi(t.element)&&cl(n),t.syncComponents()},ml=function(t){al(t),Qr(t.element),t.getSystem().removeFromWorld(t)},gl=function(n){var t=Fr(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()});ml(n),t.each(function(t){t.syncComponents()})},pl=function(t){var n=t.components();ft(n,ml),$r(t.element),t.syncComponents()},hl=function(t,n){vl(t,n,Kr)},vl=function(t,n,e){e(t,n.element);var o=Vr(n.element);ft(o,function(t){n.getByDom(t).each(cl)})},bl=function(n){var t=Vr(n.element);ft(t,function(t){n.getByDom(t).each(al)}),Qr(n.element)},yl=function(t,n,e,o){e.get().each(function(){pl(t)});var r=n.getAttachPoint(t);fl(r,t);var i=t.getSystem().build(o);return fl(t,i),e.set(i),i},xl=function(t,n,e,o){var r=yl(t,n,e,o);return n.onOpen(t,r),r},wl=function(n,e,o){o.get().each(function(t){pl(n),gl(n),e.onClose(n,t),o.clear()})},Sl=function(t,n,e){return e.isOpen()},kl=function(t,n){var e,o,r,i,u=n.getAttachPoint(t);ou(t.element,"position",ul.getMode(u)),e=t,o="visibility",r=n.cloakVisibilityAttr,i="hidden",cu(e.element,o).fold(function(){ai(e.element,r)},function(t){oi(e.element,r,t)}),ou(e.element,o,i)},Cl=function(t,n){var e,o,r,i;e=t.element,L(["top","left","right","bottom"],function(t){return cu(e,t).isSome()})||lu(t.element,"position"),o=t,r="visibility",i=n.cloakVisibilityAttr,ii(o.element,i).fold(function(){return lu(o.element,r)},function(t){return ou(o.element,r,t)})},Ol=Object.freeze({__proto__:null,cloak:kl,decloak:Cl,open:xl,openWhileCloaked:function(t,n,e,o,r){kl(t,n),xl(t,n,e,o),r(),Cl(t,n)},close:wl,isOpen:Sl,isPartOf:function(n,e,t,o){return Sl(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return yl(t,n,e,o)})}}),_l=Object.freeze({__proto__:null,events:function(n,e){return sr([dr(No(),function(t){wl(t,n,e)})])}}),Tl=[xa("onOpen"),xa("onClose"),$n("isPartOf"),$n("getAttachPoint"),fe("cloakVisibilityAttr","data-precloak-visibility")],El=mc({fields:Tl,name:"sandboxing",active:_l,apis:Ol,state:Object.freeze({__proto__:null,init:function(){var n=we(st.none()),t=it("not-implemented");return Bi({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(st.none())},set:function(t){n.set(st.some(t))},get:function(){return n.get()}})}})}),Dl=it("dismiss.popups"),Bl=it("reposition.popups"),Al=it("mouse.released"),Ml=xn([fe("isExtraPart",p),le("fireEventInstead",[fe("event",Ko())])]),Fl=function(t){var e=Hn("Dismissal",Ml,t),n={};return n[Dl()]={schema:xn([$n("target")]),onReceive:function(n,t){El.isOpen(n)&&(El.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return El.close(n)},function(t){return or(n,t.event)}))}},n},Il=xn([le("fireEventInstead",[fe("event",Jo())]),ne("doReposition")]),Rl=function(t){var e=Hn("Reposition",Il,t),n={};return n[Bl()]={onReceive:function(n){El.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(t){return or(n,t.event)})}},n},Vl=function(t,n,e){n.store.manager.onLoad(t,n,e)},Pl=function(t,n,e){n.store.manager.onUnload(t,n,e)},Hl=Object.freeze({__proto__:null,onLoad:Vl,onUnload:Pl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),zl=Object.freeze({__proto__:null,events:function(n,e){var t=n.resetOnDom?[yr(function(t){Vl(t,n,e)}),xr(function(t){Pl(t,n,e)})]:[uc(n,e,Vl)];return sr(t)}}),Nl=function(){var t=we(null);return Bi({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Ll=function(){var i=we({}),u=we({});return Bi({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return Ut(i.get(),t).orThunk(function(){return Ut(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};ft(t,function(n){o[n.value]=n,Ut(n,"meta").each(function(t){Ut(t,"text").each(function(t){r[t]=n})})}),i.set(ct(ct({},n),o)),u.set(ct(ct({},e),r))},clear:function(){i.set({}),u.set({})}})},jl=Object.freeze({__proto__:null,memory:Nl,dataset:Ll,manual:function(){return Bi({readState:at})},init:function(t){return t.store.manager.state(t)}}),Ul=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Wl=[ie("initialValue"),$n("getFallbackEntry"),$n("getDataKey"),$n("setValue"),Ca("manager",{setValue:Ul,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){Ul(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:Ll})],Gl=[$n("getValue"),fe("setValue",at),ie("initialValue"),Ca("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n){return n.store.getValue(t)},onLoad:function(n,e){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:at,state:Di.init})],Xl=[ie("initialValue"),Ca("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:Nl})],Yl=[de("store",{mode:"memory"},Ln("mode",{memory:Xl,manual:Gl,dataset:Wl})),xa("onSetValue"),fe("resetOnDom",!1)],ql=mc({fields:Yl,name:"representing",active:zl,apis:Hl,extra:{setValueFrom:function(t,n){var e=ql.getValue(n);ql.setValue(t,e)}},state:jl}),Kl=function(o,t){return ye(o,{},W(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,En(n,n,nn(),yn(function(){return Dt("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([xe("dump",ut)]))},Jl=function(t){return t.dump},$l=function(t,n){return ct(ct({},t.dump),fc(n))},Ql=Kl,Zl=$l,tf="placeholder",nf=Xt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ef=function(t){return Wt(t,"uiType")},of=function(t,n,e,o){return ef(e)&&e.uiType===tf?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?nf.single(!0,it(i)):Ut(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+It(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(t){return t.replace()})):nf.single(!1,it(e));var r,i,u},rf=function(i,u,a,c){return of(i,0,a,c).fold(function(t,n){var e=ef(a)?n(u,a.config,a.validated):n(u),o=Ut(e,"components").getOr([]),r=$(o,function(t){return rf(i,u,t,c)});return[ct(ct({},e),{components:r})]},function(t,n){if(ef(a)){var e=n(u,a.config,a.validated);return a.validated.preprocess.getOr(ut)(e)}return n(u)})},uf=function(n,e,t,o){var r,i,u,a=Pt(o,function(t,n){return o=t,r=!1,{name:it(e=n),required:function(){return o.fold(function(t){return t},function(t){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),c=(r=n,i=e,u=a,$(t,function(t){return rf(r,i,t,u)}));return Vt(a,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),c},af=nf.single,cf=nf.multiple,sf=it(tf),lf=Xt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ff=fe("factory",{sketch:ut}),df=fe("schema",[]),mf=$n("name"),gf=En("pname","pname",en(function(t){return"<alloy."+mi(t.name)+">"}),jn()),pf=xe("schema",function(){return[ie("preprocess")]}),hf=fe("defaults",it({})),vf=fe("overrides",it({})),bf=wn([ff,df,mf,gf,hf,vf]),yf=wn([ff,df,mf,hf,vf]),xf=wn([ff,df,mf,gf,hf,vf]),wf=wn([ff,pf,mf,$n("unit"),gf,hf,vf]),Sf=function(t){return t.fold(st.some,st.none,st.some,st.some)},kf=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Cf=function(e,o){return function(t){var n=Hn("Converting part type",o,t);return e(n)}},Of=Cf(lf.required,bf),_f=Cf(lf.external,yf),Tf=Cf(lf.optional,xf),Ef=Cf(lf.group,wf),Df=it("entirety"),Bf=Object.freeze({__proto__:null,required:Of,external:_f,optional:Tf,group:Ef,asNamedPart:Sf,name:kf,asCommon:function(t){return t.fold(ut,ut,ut,ut)},original:Df}),Af=function(t,n,e,o){return Kt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Mf=function(r,t){var n={};return ft(t,function(t){Sf(t).each(function(e){var o=Ff(r,e.pname);n[e.name]=function(t){var n=Hn("Part: "+e.name+" in "+r,wn(e.schema),t);return ct(ct({},o),{config:t,validated:n})}})}),n},Ff=function(t,n){return{uiType:sf(),owner:t,name:n}},If=function(t,n,e){return{uiType:sf(),owner:t,name:n,config:e,validated:{}}},Rf=function(t){return $(t,function(t){return t.fold(st.none,st.some,st.none,st.none).map(function(t){return ee(t.name,t.schema.concat([Oa(Df())]))}).toArray()})},Vf=function(t){return W(t,kf)},Pf=function(t,n,e){return o=n,i={},r={},ft(e,function(t){t.fold(function(o){i[o.pname]=af(!0,function(t,n,e){return o.factory.sketch(Af(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=it(t.factory.sketch(Af(o,t,n[Df()]),n))},function(o){i[o.pname]=af(!1,function(t,n,e){return o.factory.sketch(Af(t,o,n,e))})},function(r){i[r.pname]=cf(!0,function(n,t,e){var o=n[r.name];return W(o,function(t){return r.factory.sketch(Kt(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:it(i),externals:it(r)};var o,i,r},Hf=function(t,n,e){return uf(st.some(t),n,n.components,e)},zf=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Nf=function(t,n,e){return zf(t,n,e).getOrDie("Could not find part: "+e)},Lf=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=it(i.getByUid(r[t]))}),o},jf=function(t,n){var e=t.getSystem();return Pt(n.partUids,function(t){return it(e.getByUid(t))})},Uf=function(t){return It(t.partUids)},Wf=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=it(i.getByUid(r[t]).getOrDie())}),o},Gf=function(n,t){var e=Vf(t);return cn(W(e,function(t){return{key:t,value:n+"-"+t}}))},Xf=function(n){return En("partUids","partUids",on(function(t){return Gf(t.uid,n)}),jn())},Yf=Object.freeze({__proto__:null,generate:Mf,generateOne:If,schemas:Rf,names:Vf,substitutes:Pf,components:Hf,defaultUids:Gf,defaultUidsSchema:Xf,getAllParts:jf,getAllPartNames:Uf,getPart:zf,getPartOrDie:Nf,getParts:Lf,getPartsOrDie:Wf}),qf=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[ee("parts",i)]:[]).concat([$n("uid"),fe("dom",{}),fe("components",[]),Oa("originalSpec"),fe("debug.sketcher",{})]).concat(u));return Hn(t+" [SpecSchema]",xn(a.concat(n)),e)},Kf=function(t,n,e,o,r){var i=Jf(r),u=Rf(e),a=Xf(e),c=qf(t,n,i,u,[a]),s=Pf(0,c,e);return o(c,Hf(t,c,s.internals()),i,s.externals())},Jf=function(t){return Wt(t,"uid")?t:ct(ct({},t),{uid:xi("uid")})},$f=xn([$n("name"),$n("factory"),$n("configFields"),fe("apis",{}),fe("extraApis",{})]),Qf=xn([$n("name"),$n("factory"),$n("configFields"),$n("partFields"),fe("apis",{}),fe("extraApis",{})]),Zf=function(t){var i=Hn("Sketcher for "+t.name,$f,t),n=Pt(i.apis,Ei),e=Pt(i.extraApis,Oi);return ct(ct({name:i.name,configFields:i.configFields,sketch:function(t){return n=i.name,e=i.configFields,o=i.factory,r=Jf(t),o(qf(n,e,r,[],[]),r);var n,e,o,r}},n),e)},td=function(t){var n=Hn("Sketcher for "+t.name,Qf,t),e=Mf(n.name,n.partFields),o=Pt(n.apis,Ei),r=Pt(n.extraApis,Oi);return ct(ct({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Kf(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},nd=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},ed=function(t,n){return t?st.some(n):st.none()},od=function(t){return"input"===kr(t)&&"radio"!==ri(t,"type")||"textarea"===kr(t)},rd=Object.freeze({__proto__:null,getCurrent:function(t,n){return n.find(t)}}),id=[$n("find")],ud=mc({fields:id,name:"composing",apis:rd}),ad=function(e,o,t,r){var n=Ms(e.element,"."+o.highlightClass);ft(n,function(n){L(r,function(t){return t.element===n})||(Yi(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),or(t,er())}))})},cd=function(t,n,e,o){ad(t,n,0,[o]),sd(t,n,e,o)||(Gi(o.element,n.highlightClass),n.onHighlight(t,o),or(o,nr()))},sd=function(t,n,e,o){return qi(o.element,n.highlightClass)},ld=function(t,n,e,o){var r=Ms(t.element,"."+n.itemClass);return st.from(r[o]).fold(function(){return vt.error(new Error("No element found with index "+o))},t.getSystem().getByDom)},fd=function(n,t){return na(n.element,"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},dd=function(n,t){var e=Ms(n.element,"."+t.itemClass);return(0<e.length?st.some(e[e.length-1]):st.none()).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},md=function(e,n,t,o){var r=Ms(e.element,"."+n.itemClass);return J(r,function(t){return qi(t,n.highlightClass)}).bind(function(t){var n=Ac(t,o,0,r.length-1);return e.getSystem().getByDom(r[n]).toOptional()})},gd=function(n,t){var e=Ms(n.element,"."+t.itemClass);return nd(W(e,function(t){return n.getSystem().getByDom(t).toOptional()}))},pd=Object.freeze({__proto__:null,dehighlightAll:function(t,n){return ad(t,n,0,[])},dehighlight:function(t,n,e,o){sd(t,n,e,o)&&(Yi(o.element,n.highlightClass),n.onDehighlight(t,o),or(o,er()))},highlight:cd,highlightFirst:function(n,e,o){fd(n,e).each(function(t){cd(n,e,o,t)})},highlightLast:function(n,e,o){dd(n,e).each(function(t){cd(n,e,o,t)})},highlightAt:function(n,e,o,t){ld(n,e,o,t).fold(function(t){throw t},function(t){cd(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=gd(n,e);K(r,t).each(function(t){cd(n,e,o,t)})},isHighlighted:sd,getHighlighted:function(n,t){return na(n.element,"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},getFirst:fd,getLast:dd,getPrevious:function(t,n){return md(t,n,0,-1)},getNext:function(t,n){return md(t,n,0,1)},getCandidates:gd}),hd=[$n("highlightClass"),$n("itemClass"),xa("onHighlight"),xa("onDehighlight")],vd=mc({fields:hd,name:"highlighting",apis:pd}),bd=[8],yd=[9],xd=[13],wd=[27],Sd=[32],kd=[37],Cd=[38],Od=[39],_d=[40],Td=function(t,n,e){var o=Z(t.slice(0,n)),r=Z(t.slice(n+1));return K(o.concat(r),e)},Ed=function(t,n,e){var o=Z(t.slice(0,n));return K(o,e)},Dd=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return K(r.concat(o),e)},Bd=function(t,n,e){var o=t.slice(n+1);return K(o,e)},Ad=function(e){return function(t){var n=t.raw;return N(e,n.which)}},Md=function(t){return function(n){return Q(t,function(t){return t(n)})}},Fd=function(t){return!0===t.raw.shiftKey},Id=function(t){return!0===t.raw.ctrlKey},Rd=w(Fd),Vd=function(t,n){return{matches:t,classification:n}},Pd=function(t,n,e){n.exists(function(n){return e.exists(function(t){return no(t,n)})})||rr(t,$o(),{prevFocus:n,newFocus:e})},Hd=function(){var r=function(t){return wc(t.element)};return{get:r,set:function(t,n){var e=r(t);t.getSystem().triggerFocus(n,t.element);var o=r(t);Pd(t,e,o)}}},zd=function(){var r=function(t){return vd.getHighlighted(t).map(function(t){return t.element})};return{get:r,set:function(n,t){var e=r(n);n.getSystem().getByDom(t).fold(at,function(t){vd.highlight(n,t)});var o=r(n);Pd(n,e,o)}}};(Qc=$c=$c||{}).OnFocusMode="onFocus",Qc.OnEnterOrSpaceMode="onEnterOrSpace",Qc.OnApiMode="onApi";var Nd,Ld,jd,Ud=function(t,n,e,o,a){var c=function(n,e,t,o,r){var i,u;return i=t(n,e,o,r),u=e.event,K(i,function(t){return t.matches(u)}).map(function(t){return t.classification}).bind(function(t){return t(n,e,o,r)})},r={schema:function(){return t.concat([fe("focusManager",Hd()),de("focusInside","onFocus",In(function(t){return N(["onFocus","onEnterOrSpace","onApi"],t)?vt.value(t):vt.error("Invalid value for focusInside")})),Ca("handler",r),Ca("state",n),Ca("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==$c.OnFocusMode?st.none():a(i).map(function(e){return dr(Mo(),function(t,n){e(t,i,u),n.stop()})}),n=[dr(ko(),function(o,r){c(o,r,e,i,u).fold(function(){var n,e,t;n=o,e=r,t=Ad(Sd.concat(xd))(e.event),i.focusInside===$c.OnEnterOrSpaceMode&&t&&ao(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(){r.stop()})}),dr(Co(),function(t,n){c(t,n,o,i,u).each(function(){n.stop()})})];return sr(t.toArray().concat(n))}};return r},Wd=function(t){var n=[ie("onEscape"),ie("onEnter"),fe("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),fe("firstTabstop",0),fe("useTabstopAt",S),ie("visibilitySelector")].concat([t]),i=function(t,n){var e=t.visibilitySelector.bind(function(t){return ea(n,t)}).getOr(n);return 0<Tu(e)},e=function(n,e){var o,t,r;o=e,t=Ms(n.element,o.selector),r=X(t,function(t){return i(o,t)}),st.from(r[o.firstTabstop]).each(function(t){e.focusManager.set(n,t)})},a=function(n,t,e,o,r){return r(t,e,function(t){return i(n=o,e=t)&&n.useTabstopAt(e);var n,e}).fold(function(){return o.cyclic?st.some(!0):st.none()},function(t){return o.focusManager.set(n,t),st.some(!0)})},r=function(n,t,e,o){var r,i,u=Ms(n.element,e.selector);return r=n,(i=e).focusManager.get(r).bind(function(t){return ea(t,i.selector)}).bind(function(t){return J(u,b(no,t)).bind(function(t){return a(n,u,t,e,o)})})},o=it([Vd(Md([Fd,Ad(yd)]),function(t,n,e){var o=e.cyclic?Td:Ed;return r(t,0,e,o)}),Vd(Ad(yd),function(t,n,e){var o=e.cyclic?Dd:Bd;return r(t,0,e,o)}),Vd(Ad(wd),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),Vd(Md([Rd,Ad(xd)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),u=it([]);return Ud(n,Di.init,o,u,function(){return st.some(e)})},Gd=Wd(xe("cyclic",p)),Xd=Wd(xe("cyclic",S)),Yd=function(t,n,e){return od(e)&&Ad(Sd)(n.event)?st.none():(ur(t,e,Vo()),st.some(!0))},qd=function(){return st.some(!0)},Kd=[fe("execute",Yd),fe("useSpace",!1),fe("useEnter",!0),fe("useControlEnter",!1),fe("useDown",!1)],Jd=function(t,n,e){return e.execute(t,n,t.element)},$d=Ud(Kd,Di.init,function(t,n,e){var o=e.useSpace&&!od(t.element)?Sd:[],r=e.useEnter?xd:[],i=e.useDown?_d:[],u=o.concat(r).concat(i);return[Vd(Ad(u),Jd)].concat(e.useControlEnter?[Vd(Md([Id,Ad(xd)]),Jd)]:[])},function(t,n,e){return e.useSpace&&!od(t.element)?[Vd(Ad(Sd),qd)]:[]},function(){return st.none()}),Qd=function(){var e=we(st.none());return Bi({readState:function(){return e.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(st.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(t){return t.numRows})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns})}})},Zd=Object.freeze({__proto__:null,flatgrid:Qd,init:function(t){return t.state(t)}}),tm=function(i){return function(t,n,e,o){var r=i(t.element);return rm(r,t,n,e,o)}},nm=function(t,n){var e=Xc(t,n);return tm(e)},em=function(t,n){var e=Xc(n,t);return tm(e)},om=function(r){return function(t,n,e,o){return rm(r,t,n,e,o)}},rm=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element,t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},im=om,um=om,am=om,cm=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n},sm=function(t,n,e){var o,r=Ms(t,e),i=X(r,cm);return J(o=i,function(t){return no(t,n)}).map(function(t){return{index:t,candidates:o}})},lm=function(t,n){return J(t,function(t){return no(n,t)})},fm=function(e,t,o,n){return n(Math.floor(t/o),t%o).bind(function(t){var n=t.row*o+t.column;return 0<=n&&n<e.length?st.some(e[n]):st.none()})},dm=function(r,t,i,u,a){return fm(r,t,u,function(t,n){var e=t===i-1?r.length-t*u:u,o=Ac(n,a,0,e-1);return st.some({row:t,column:o})})},mm=function(i,t,u,a,c){return fm(i,t,a,function(t,n){var e=Ac(t,c,0,u-1),o=e===u-1?i.length-e*a:a,r=Mc(n,0,o-1);return st.some({row:e,column:r})})},gm=[$n("selector"),fe("execute",Yd),wa("onEscape"),fe("captureTab",!1),_a()],pm=function(n,e){na(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},hm=function(r){return function(t,n,e,o){return sm(t,n,e.selector).bind(function(t){return r(t.candidates,t.index,o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}},vm=function(t,n,e){return e.captureTab?st.some(!0):st.none()},bm=hm(function(t,n,e,o){return dm(t,n,e,o,-1)}),ym=hm(function(t,n,e,o){return dm(t,n,e,o,1)}),xm=hm(function(t,n,e,o){return mm(t,n,e,o,-1)}),wm=hm(function(t,n,e,o){return mm(t,n,e,o,1)}),Sm=it([Vd(Ad(kd),nm(bm,ym)),Vd(Ad(Od),em(bm,ym)),Vd(Ad(Cd),im(xm)),Vd(Ad(_d),um(wm)),Vd(Md([Fd,Ad(yd)]),vm),Vd(Md([Rd,Ad(yd)]),vm),Vd(Ad(wd),function(t,n,e){return e.onEscape(t,n)}),Vd(Ad(Sd.concat(xd)),function(n,e,o){return t=n,(r=o).focusManager.get(t).bind(function(t){return ea(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var t,r})]),km=it([Vd(Ad(Sd),qd)]),Cm=Ud(gm,Qd,Sm,km,function(){return st.some(pm)}),Om=function(t,n,e,i){var u=function(t,n,e){var o,r=Ac(n,i,0,e.length-1);return r===t?st.none():(o=e[r],"button"===kr(o)&&"disabled"===ri(o,"disabled")?u(t,r,e):st.from(e[r]))};return sm(t,e,n).bind(function(t){var n=t.index,e=t.candidates;return u(n,n,e)})},_m=[$n("selector"),fe("getInitial",st.none),fe("execute",Yd),wa("onEscape"),fe("executeOnMove",!1),fe("allowVertical",!0)],Tm=function(n,e,o){return t=n,(r=o).focusManager.get(t).bind(function(t){return ea(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var t,r},Em=function(n,e){e.getInitial(n).orThunk(function(){return na(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})},Dm=function(t,n,e){return Om(t,e.selector,n,-1)},Bm=function(t,n,e){return Om(t,e.selector,n,1)},Am=function(r){return function(t,n,e,o){return r(t,n,e,o).bind(function(){return e.executeOnMove?Tm(t,n,e):st.some(!0)})}},Mm=function(t,n,e){return e.onEscape(t,n)},Fm=it([Vd(Ad(Sd),qd)]),Im=Ud(_m,Di.init,function(t,n,e){var o=kd.concat(e.allowVertical?Cd:[]),r=Od.concat(e.allowVertical?_d:[]);return[Vd(Ad(o),Am(nm(Dm,Bm))),Vd(Ad(r),Am(em(Dm,Bm))),Vd(Ad(xd),Tm),Vd(Ad(Sd),Tm),Vd(Ad(wd),Mm)]},Fm,function(){return st.some(Em)}),Rm=function(t,n,e){return st.from(t[n]).bind(function(t){return st.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},Vm=function(t,n,e,o){var r=t[n].length,i=Ac(e,o,0,r-1);return Rm(t,n,i)},Pm=function(t,n,e,o){var r=Ac(e,o,0,t.length-1),i=t[r].length,u=Mc(n,0,i-1);return Rm(t,r,u)},Hm=function(t,n,e,o){var r=t[n].length,i=Mc(e+o,0,r-1);return Rm(t,n,i)},zm=function(t,n,e,o){var r=Mc(e+o,0,t.length-1),i=t[r].length,u=Mc(n,0,i-1);return Rm(t,r,u)},Nm=[ee("selectors",[$n("row"),$n("cell")]),fe("cycles",!0),fe("previousSelector",st.none),fe("execute",Yd)],Lm=function(n,e){e.previousSelector(n).orThunk(function(){var t=e.selectors;return na(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})},jm=function(t,n){return function(e,o,i){var u=i.cycles?t:n;return ea(o,i.selectors.row).bind(function(t){var n=Ms(t,i.selectors.cell);return lm(n,o).bind(function(o){var r=Ms(e,i.selectors.row);return lm(r,t).bind(function(t){var n,e=(n=i,W(r,function(t){return Ms(t,n.selectors.cell)}));return u(e,t,o).map(function(t){return t.cell})})})})}},Um=jm(function(t,n,e){return Vm(t,n,e,-1)},function(t,n,e){return Hm(t,n,e,-1)}),Wm=jm(function(t,n,e){return Vm(t,n,e,1)},function(t,n,e){return Hm(t,n,e,1)}),Gm=jm(function(t,n,e){return Pm(t,e,n,-1)},function(t,n,e){return zm(t,e,n,-1)}),Xm=jm(function(t,n,e){return Pm(t,e,n,1)},function(t,n,e){return zm(t,e,n,1)}),Ym=it([Vd(Ad(kd),nm(Um,Wm)),Vd(Ad(Od),em(Um,Wm)),Vd(Ad(Cd),im(Gm)),Vd(Ad(_d),um(Xm)),Vd(Ad(Sd.concat(xd)),function(n,e,o){return wc(n.element).bind(function(t){return o.execute(n,e,t)})})]),qm=it([Vd(Ad(Sd),qd)]),Km=Ud(Nm,Di.init,Ym,qm,function(){return st.some(Lm)}),Jm=[$n("selector"),fe("execute",Yd),fe("moveOnTab",!1)],$m=function(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})},Qm=function(n,e){na(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},Zm=function(t,n,e){return Om(t,e.selector,n,-1)},tg=function(t,n,e){return Om(t,e.selector,n,1)},ng=it([Vd(Ad(Cd),am(Zm)),Vd(Ad(_d),am(tg)),Vd(Md([Fd,Ad(yd)]),function(t,n,e,o){return e.moveOnTab?am(Zm)(t,n,e,o):st.none()}),Vd(Md([Rd,Ad(yd)]),function(t,n,e,o){return e.moveOnTab?am(tg)(t,n,e,o):st.none()}),Vd(Ad(xd),$m),Vd(Ad(Sd),$m)]),eg=it([Vd(Ad(Sd),qd)]),og=Ud(Jm,Di.init,ng,eg,function(){return st.some(Qm)}),rg=[wa("onSpace"),wa("onEnter"),wa("onShiftEnter"),wa("onLeft"),wa("onRight"),wa("onTab"),wa("onShiftTab"),wa("onUp"),wa("onDown"),wa("onEscape"),fe("stopSpaceKeyup",!1),ie("focusIn")],ig=Ud(rg,Di.init,function(t,n,e){return[Vd(Ad(Sd),e.onSpace),Vd(Md([Rd,Ad(xd)]),e.onEnter),Vd(Md([Fd,Ad(xd)]),e.onShiftEnter),Vd(Md([Fd,Ad(yd)]),e.onShiftTab),Vd(Md([Rd,Ad(yd)]),e.onTab),Vd(Ad(Cd),e.onUp),Vd(Ad(_d),e.onDown),Vd(Ad(kd),e.onLeft),Vd(Ad(Od),e.onRight),Vd(Ad(Sd),e.onSpace),Vd(Ad(wd),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[Vd(Ad(Sd),qd)]:[]},function(t){return t.focusIn}),ug=Gd.schema(),ag=Xd.schema(),cg=Im.schema(),sg=Cm.schema(),lg=Km.schema(),fg=$d.schema(),dg=og.schema(),mg=ig.schema(),gg=pc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ug,cyclic:ag,flow:cg,flatgrid:sg,matrix:lg,execution:fg,menu:dg,special:mg}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){Gt(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Zd}),pg=function(t,n,e,o){var r=t.getSystem().build(o);dl(t,r,e)},hg=function(t,n,e,o){var r=vg(t);K(r,function(t){return no(o.element,t.element)}).each(gl)},vg=function(t){return t.components()},bg=function(n,t,e,r,o){var i=vg(n);return st.from(i[r]).map(function(t){return hg(n,0,0,t),o.each(function(t){pg(n,0,function(t,n){var e,o;o=n,Pr(e=t,r).fold(function(){Kr(e,o)},function(t){Xr(t,o)})},t)}),t})},yg=mc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){pg(t,0,Kr,o)},prepend:function(t,n,e,o){pg(t,0,qr,o)},remove:hg,replaceAt:bg,replaceBy:function(n,t,e,o,r){var i=vg(n);return J(i,o).bind(function(t){return bg(n,0,0,t,r)})},set:function(n,t,e,o){Sc(function(){var t=W(o,n.getSystem().build);ll(n,t)},n.element)},contents:vg})}),xg=function(t,n){var e,o;return{key:t,value:{config:{},me:(e=t,o=sr(n),mc({fields:[$n("enabled")],name:e,active:{events:it(o)}})),configAsRaw:it({}),initialConfig:{},state:Di}}},wg=function(t,n){n.ignore||(yc(t.element),n.onFocus(t))},Sg=Object.freeze({__proto__:null,focus:wg,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=Lr(n).dom,n.dom===e.activeElement;var n,e}}),kg=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return Mi(e)},events:function(e){return sr([dr(Mo(),function(t,n){wg(t,e),n.stop()})].concat(e.stopMousedown?[dr(ho(),function(t,n){n.event.prevent()})]:[]))}}),Cg=[xa("onFocus"),fe("stopMousedown",!1),fe("ignore",!1)],Og=mc({fields:Cg,name:"focusing",active:kg,apis:Sg}),_g=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Tg=function(n,t,e){t.toggleClass.each(function(t){(e.get()?Gi:Yi)(n.element,t)})},Eg=function(t,n,e){Ag(t,n,e,!e.get())},Dg=function(t,n,e){e.set(!0),Tg(t,n,e),_g(t,n,e)},Bg=function(t,n,e){e.set(!1),Tg(t,n,e),_g(t,n,e)},Ag=function(t,n,e,o){(o?Dg:Bg)(t,n,e)},Mg=function(t,n,e){Ag(t,n,e,n.selected)},Fg=Object.freeze({__proto__:null,onLoad:Mg,toggle:Eg,isOn:function(t,n,e){return e.get()},on:Dg,off:Bg,set:Ag}),Ig=Object.freeze({__proto__:null,exhibit:function(){return Mi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Eg,Sr(function(t){r(t,e,o)})),u=uc(t,n,Mg);return sr(dt([t.toggleOnExecute?[i]:[],[u]]))}}),Rg=function(t,n,e){oi(t.element,"aria-expanded",e)},Vg=[fe("selected",!1),ie("toggleClass"),fe("toggleOnExecute",!0),de("aria",{mode:"none"},Ln("mode",{pressed:[fe("syncWithExpanded",!1),Ca("update",function(t,n,e){oi(t.element,"aria-pressed",e),n.syncWithExpanded&&Rg(t,n,e)})],checked:[Ca("update",function(t,n,e){oi(t.element,"aria-checked",e)})],expanded:[Ca("update",Rg)],selected:[Ca("update",function(t,n,e){oi(t.element,"aria-selected",e)})],none:[Ca("update",at)]}))],Pg=mc({fields:Vg,name:"toggling",active:Ig,apis:Fg,state:(Nd=!1,{init:function(){var n=we(Nd);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Nd)},readState:function(){return n.get()}}}})}),Hg=function(){var t=function(t,n){n.stop(),ir(t)};return[dr(To(),t),dr(Ho(),t),vr(fo()),vr(ho())]},zg=function(t){return sr(dt([t.map(function(e){return Sr(function(t,n){e(t),n.stop()})}).toArray(),Hg()]))},Ng="alloy.item-hover",Lg="alloy.item-focus",jg=function(t){(wc(t.element).isNone()||Og.isFocused(t))&&(Og.isFocused(t)||Og.focus(t),rr(t,Ng,{item:t}))},Ug=function(t){rr(t,Lg,{item:t})},Wg=it(Ng),Gg=it(Lg),Xg=[$n("data"),$n("components"),$n("dom"),fe("hasSubmenu",!1),ie("toggling")
,Ql("itemBehaviours",[Pg,Og,gg,ql]),fe("ignoreFocus",!1),fe("domModification",{}),Ca("builder",function(t){return{dom:t.dom,domModification:ct(ct({},t.domModification),{attributes:ct(ct(ct({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Zl(t.itemBehaviours,[t.toggling.fold(Pg.revoke,function(t){return Pg.config(ct({aria:{mode:"checked"}},t))}),Og.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Ug(t)}}),gg.config({mode:"execution"}),ql.config({store:{mode:"memory",initialValue:t.data}}),xg("item-type-events",x(Hg(),[dr(xo(),jg),dr(Po(),Og.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),fe("eventOrder",{})],Yg=[$n("dom"),$n("components"),Ca("builder",function(t){return{dom:t.dom,components:t.components,events:sr([(n=Po(),dr(n,function(t,n){n.stop()}))])};var n})],qg=it("item-widget"),Kg=it([Of({name:"widget",overrides:function(t){return{behaviours:fc([ql.config({store:{mode:"manual",getValue:function(){return t.data},setValue:at}})])}}})]),Jg=[$n("uid"),$n("data"),$n("components"),$n("dom"),fe("autofocus",!1),fe("ignoreFocus",!1),Ql("widgetBehaviours",[ql,Og,gg]),fe("domModification",{}),Xf(Kg()),Ca("builder",function(e){var t=Pf(qg(),e,Kg()),n=Hf(qg(),e,t.internals()),o=function(t){return zf(t,e,"widget").map(function(t){return gg.focusIn(t),t})},r=function(t,n){return od(n.event.target)||e.autofocus&&n.setSource(t.element),st.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:sr([Sr(function(t,n){o(t).each(function(){n.stop()})}),dr(xo(),jg),dr(Po(),function(t){e.autofocus?o(t):Og.focus(t)})]),behaviours:Zl(e.widgetBehaviours,[ql.config({store:{mode:"memory",initialValue:e.data}}),Og.config({ignore:e.ignoreFocus,onFocus:function(t){Ug(t)}}),gg.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:hc(),onLeft:r,onRight:r,onEscape:function(t,n){return Og.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),st.none()):(Og.focus(t),st.some(!0))}})])}})],$g=Ln("type",{widget:Jg,item:Xg,separator:Yg}),Qg=it([Ef({factory:{sketch:function(t){var n=Hn("menu.spec item",$g,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:ct(ct({},n),{uid:xi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Zg=it([$n("value"),$n("items"),$n("dom"),$n("components"),fe("eventOrder",{}),Kl("menuBehaviours",[vd,ql,ud,gg]),de("movement",{mode:"menu",moveOnTab:!0},Ln("mode",{grid:[_a(),Ca("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[Ca("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),$n("rowSelector")],menu:[fe("moveOnTab",!0),Ca("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),Qn("markers",pa()),fe("fakeFocus",!1),fe("focusManager",Hd()),xa("onHighlight")]),tp=it("alloy.menu-focus"),np=td({name:"Menu",configFields:Zg(),partFields:Qg(),factory:function(t,n){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:$l(t.menuBehaviours,[vd.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),ql.config({store:{mode:"memory",initialValue:t.value}}),ud.config({find:st.some}),gg.config(t.movement.config(t,t.movement))]),events:sr([dr(Gg(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){vd.highlight(n,t),e.stop(),rr(n,tp(),{menu:n,item:t})})}),dr(Wg(),function(t,n){var e=n.event.item;vd.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ep=function(e,o,r,t){return Ut(r,t).bind(function(t){return Ut(e,t).bind(function(t){var n=ep(e,o,r,t);return st.some([t].concat(n))})}).getOr([])},op=function(t,n){var e={};Vt(t,function(t,n){ft(t,function(t){e[t]=n})});var o=n,r=Ht(n,function(t,n){return{k:t,v:n}}),i=Pt(r,function(t,n){return[n].concat(ep(e,o,r,n))});return Pt(e,function(t){return Ut(i,t).getOr([t])})},rp=function(t){return"prepared"===t.type?st.some(t.menu):st.none()},ip={init:function(){var i=we({}),u=we({}),a=we({}),c=we(st.none()),s=we({}),r=function(t,o,r){return e(t).bind(function(n){return e=t,Lt(i.get(),function(t){return t===e}).bind(function(t){return o(t).map(function(t){return{triggeredMenu:n,triggeringItem:t,triggeringPath:r}})});var e})},e=function(t){return n(t).bind(rp)},n=function(t){return Ut(u.get(),t)},l=function(t){return Ut(i.get(),t)};return{setMenuBuilt:function(t,n){var e;u.set(ct(ct({},u.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){c.set(st.some(t)),i.set(e),u.set(n),s.set(o);var r=op(o,e);a.set(r)},expand:function(e){return Ut(i.get(),e).map(function(t){var n=Ut(a.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return Ut(a.get(),t)},collapse:function(t){return Ut(a.get(),t).bind(function(t){return 1<t.length?st.some(t.slice(1)):st.none()})},lookupMenu:n,lookupItem:l,otherMenus:function(t){var n=s.get();return tt(It(n),t)},getPrimary:function(){return c.get().bind(e)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),a.set({}),c.set(st.none())},isClear:function(){return c.get().isNone()},getTriggeringPath:function(t,o){var n=X(l(t).toArray(),function(t){return e(t).isSome()});return Ut(a.get(),t).bind(function(t){var e=Z(n.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return st.none();n.push(o.getOrDie())}return st.some(n)}($(e,function(t,n){return r(t,o,e.slice(0,n+1)).fold(function(){return c.get().is(t)?[]:[st.none()]},function(t){return[st.some(t)]})}))})}}},extractPreparedMenu:rp},up=it("collapse-item"),ap=Zf({name:"TieredMenu",configFields:[ka("onExecute"),ka("onEscape"),Sa("onOpenMenu"),Sa("onOpenSubmenu"),xa("onRepositionMenu"),xa("onCollapseMenu"),fe("highlightImmediately",!0),ee("data",[$n("primary"),$n("menus"),$n("expansions")]),fe("fakeFocus",!1),xa("onHighlight"),xa("onHover"),va(),$n("dom"),fe("navigateOnHover",!0),fe("stayInDom",!1),Kl("tmenuBehaviours",[gg,vd,ud,yg]),fe("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(a){var c,t,i=we(st.none()),s=ip.init(),e=function(t){var o,r,n,e=(o=t,r=a.data.primary,n=a.data.menus,Pt(n,function(t,n){var e=function(){return np.sketch(ct(ct({},t),{value:n,markers:a.markers,fakeFocus:a.fakeFocus,onHighlight:a.onHighlight,focusManager:(a.fakeFocus?zd:Hd)()}))};return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})),i=u();return s.setContents(a.data.primary,e,a.data.expansions,i),s.getPrimary()},l=function(t){return ql.getValue(t).value},u=function(){return Pt(a.data.menus,function(t){return $(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},f=function(n,t){vd.highlight(n,t),vd.getHighlighted(t).orThunk(function(){return vd.getFirst(t)}).each(function(t){ur(n,t.element,Po())})},d=function(n,t){return nd(W(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?st.some(t.menu):st.none()})}))},m=function(n,t,e){var o=d(t,t.otherMenus(e));ft(o,function(t){Ji(t.element,[a.markers.backgroundMenu]),a.stayInDom||yg.remove(n,t)})},g=function(t,o){var r,n=(r=t,i.get().getOrThunk(function(){var e={},t=Ms(r.element,"."+a.markers.item),n=X(t,function(t){return"true"===ri(t,"aria-haspopup")});return ft(n,function(t){r.getSystem().getByDom(t).each(function(t){var n=l(t);e[n]=t})}),i.set(st.some(e)),e}));Vt(n,function(t,n){var e=N(o,n);oi(t.element,"aria-expanded",e)})},p=function(o,r,i){return st.from(i[0]).bind(function(t){return r.lookupMenu(t).bind(function(t){if("notbuilt"===t.type)return st.none();var n=t.menu,e=d(r,i.slice(1));return ft(e,function(t){Gi(t.element,a.markers.backgroundMenu)}),Qi(n.element)||yg.append(o,Cu(n)),Ji(n.element,[a.markers.backgroundMenu]),f(o,n),m(o,r,i),st.some(n)})})};(t=c=c||{})[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";var h=function(r,i,u){void 0===u&&(u=c.HighlightSubmenu);var t=l(i);return s.expand(t).bind(function(o){return g(r,o),st.from(o[0]).bind(function(e){return s.lookupMenu(e).bind(function(t){var n=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return s.setMenuBuilt(n,o),o}(r,e,t);return Qi(n.element)||yg.append(r,Cu(n)),a.onOpenSubmenu(r,i,n,Z(o)),u===c.HighlightSubmenu?(vd.highlightFirst(n),p(r,s,o)):(vd.dehighlightAll(n),st.some(i))})})})},o=function(n,e){var t=l(e);return s.collapse(t).bind(function(t){return g(n,t),p(n,s,t).map(function(t){return a.onCollapseMenu(n,e,t),t})})},n=function(e){return function(n,t){return ea(t.getSource(),"."+a.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOptional().bind(function(t){return e(n,t).map(S)})})}},r=sr([dr(tp(),function(e,o){var t=o.event.item;s.lookupItem(l(t)).each(function(){var t=o.event.menu;vd.highlight(e,t);var n=l(o.event.item);s.refresh(n).each(function(t){return m(e,s,t)})})}),Sr(function(n,t){var e=t.event.target;n.getSystem().getByDom(e).each(function(t){0===l(t).indexOf("collapse-item")&&o(n,t),h(n,t,c.HighlightSubmenu).fold(function(){a.onExecute(n,t)},at)})}),yr(function(n){e(n).each(function(t){yg.append(n,Cu(t)),a.onOpenMenu(n,t),a.highlightImmediately&&f(n,t)})})].concat(a.navigateOnHover?[dr(Wg(),function(t,n){var e,o,r=n.event.item;e=t,o=l(r),s.refresh(o).bind(function(t){return g(e,t),p(e,s,t)}),h(t,r,c.HighlightParent),a.onHover(t,r)})]:[])),v=function(t){return vd.getHighlighted(t).bind(vd.getHighlighted)},b={collapseMenu:function(n){v(n).each(function(t){o(n,t)})},highlightPrimary:function(n){s.getPrimary().each(function(t){f(n,t)})},repositionMenus:function(o){s.getPrimary().bind(function(n){return v(o).bind(function(t){var n=l(t),e=jt(s.getMenus()),o=nd(W(e,ip.extractPreparedMenu));return s.getTriggeringPath(n,function(t){return e=t,gt(o,function(t){if(!t.getSystem().isConnected())return st.none();var n=vd.getCandidates(t);return K(n,function(t){return l(t)===e})});var e})}).map(function(t){return{primary:n,triggeringPath:t}})}).fold(function(){var t;t=o,st.from(t.components()[0]).filter(function(t){return"menu"===ri(t.element,"role")}).each(function(t){a.onRepositionMenu(o,t,[])})},function(t){var n=t.primary,e=t.triggeringPath;a.onRepositionMenu(o,n,e)})}};return{uid:a.uid,dom:a.dom,markers:a.markers,behaviours:$l(a.tmenuBehaviours,[gg.config({mode:"special",onRight:n(function(t,n){return od(n.element)?st.none():h(t,n,c.HighlightSubmenu)}),onLeft:n(function(t,n){return od(n.element)?st.none():o(t,n)}),onEscape:n(function(t,n){return o(t,n).orThunk(function(){return a.onEscape(t,n).map(function(){return t})})}),focusIn:function(n){s.getPrimary().each(function(t){ur(n,t.element,Po())})}}),vd.config({highlightClass:a.markers.selectedMenu,itemClass:a.markers.menu}),ud.config({find:function(t){return vd.getHighlighted(t)}}),yg.config({})]),eventOrder:a.eventOrder,apis:b,events:r}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:an(t,n),expansions:{}}},collapseItem:function(t){return{value:mi(up()),meta:{text:t}}}}}),cp=Zf({name:"InlineView",configFields:[$n("lazySink"),xa("onShow"),xa("onHide"),se("onEscape"),Kl("inlineBehaviours",[El,ql,vc]),le("fireDismissalEventInstead",[fe("event",Ko())]),le("fireRepositionEventInstead",[fe("event",Jo())]),fe("getRelated",st.none),fe("isExtraPart",p),fe("eventOrder",st.none)],factory:function(m,t){var o=function(t,n,e,o){r(t,n,e,function(){return o.map(qu)})},r=function(t,n,e,o){var r=m.lazySink(t).getOrDie();El.openWhileCloaked(t,e,function(){return ul.positionWithinBounds(r,n,t,o())}),ql.setValue(t,st.some({mode:"position",anchor:n,getBounds:o}))},i=function(t,n,e,o){var r,i,u,a,c,s,l,f,d=(r=m,i=t,u=n,c=o,s=function(){return r.lazySink(i)},l="horizontal"===(a=e).type?{layouts:{onLtr:ec,onRtl:oc}}:{},f=function(t){return 2===t.length?l:{}},ap.sketch({dom:{tag:"div"},data:a.data,markers:a.menu.markers,highlightImmediately:a.menu.highlightImmediately,onEscape:function(){return El.close(i),r.onEscape.map(function(t){return t(i)}),st.some(!0)},onExecute:function(){return st.some(!0)},onOpenMenu:function(t,n){ul.positionWithinBounds(s().getOrDie(),u,n,c())},onOpenSubmenu:function(t,n,e,o){var r=s().getOrDie();ul.position(r,ct({anchor:"submenu",item:n},f(o)),e)},onRepositionMenu:function(t,n,e){var o=s().getOrDie();ul.positionWithinBounds(o,u,n,c()),ft(e,function(t){var n=f(t.triggeringPath);ul.position(o,ct({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}}));El.open(t,d),ql.setValue(t,st.some({mode:"menu",menu:d}))},n=function(e){El.isOpen(e)&&ql.getValue(e).each(function(t){switch(t.mode){case"menu":El.getState(e).each(function(t){ap.repositionMenus(t)});break;case"position":var n=m.lazySink(e).getOrDie();ul.positionWithinBounds(n,t.anchor,e,t.getBounds())}})},e={setContent:function(t,n){El.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,st.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){i(t,n,e,function(){return st.none()})},showMenuWithinBounds:i,hide:function(t){El.isOpen(t)&&(ql.setValue(t,st.none()),El.close(t))},getContent:function(t){return El.getState(t)},reposition:n,isOpen:El.isOpen};return{uid:m.uid,dom:m.dom,behaviours:$l(m.inlineBehaviours,[El.config({isPartOf:function(t,n,e){return ia(n,e)||(o=t,r=e,m.getRelated(o).exists(function(t){return ia(t,r)}));var o,r},getAttachPoint:function(t){return m.lazySink(t).getOrDie()},onOpen:function(t){m.onShow(t)},onClose:function(t){m.onHide(t)}}),ql.config({store:{mode:"memory",initialValue:st.none()}}),vc.config({channels:ct(ct({},Fl(ct({isExtraPart:t.isExtraPart},m.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Rl(ct(ct({},m.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:n})))})]),eventOrder:m.eventOrder,apis:e}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),sp=function(t){return t.x},lp=function(t,n){return t.x+t.width/2-n.width/2},fp=function(t,n){return t.x+t.width-n.width},dp=function(t){return t.y},mp=function(t,n){return t.y+t.height-n.height},gp=function(t,n,e){return Ta(fp(t,n),mp(t,n),e.innerSoutheast(),Ma(),Pa(t,{right:0,bottom:3}),"layout-inner-se")},pp=function(t,n,e){return Ta(sp(t),mp(t,n),e.innerSouthwest(),Aa(),Pa(t,{left:1,bottom:3}),"layout-inner-sw")},hp=function(t,n,e){return Ta(fp(t,n),dp(t),e.innerNortheast(),Ba(),Pa(t,{right:0,top:2}),"layout-inner-ne")},vp=function(t,n,e){return Ta(sp(t),dp(t),e.innerNorthwest(),Da(),Pa(t,{left:1,top:2}),"layout-inner-nw")},bp=function(t,n,e){return Ta(lp(t,n),dp(t),e.innerNorth(),Fa(),Pa(t,{top:2}),"layout-inner-n")},yp=function(t,n,e){return Ta(lp(t,n),mp(t,n),e.innerSouth(),Ia(),Pa(t,{bottom:3}),"layout-inner-s")},xp=tinymce.util.Tools.resolve("tinymce.util.Delay"),wp=Zf({name:"Button",factory:function(t){var n=zg(t.action),e=t.dom.tag,o=function(n){return Ut(t.dom,"attributes").bind(function(t){return Ut(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Zl(t.buttonBehaviours,[Og.config({}),gg.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return ct({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[fe("uid",undefined),$n("dom"),fe("components",[]),Ql("buttonBehaviours",[Og,gg]),ie("action"),ie("role"),fe("eventOrder",{})]}),Sp=function(t){var n=t.uid!==undefined&&Gt(t,"uid")?t.uid:xi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return ct(ct({},t),{uid:n})}}},kp=function(t){return st.from(t()["temporary-placeholder"]).getOr("!not found!")},Cp=function(t,n){return st.from(n()[t.toLowerCase()]).getOrThunk(function(){return kp(n)})},Op={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},_p=Zf({name:"Notification",factory:function(n){var t,e,o=Sp({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:fc([yg.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=Sp({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:fc([yg.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){yg.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])})},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=o.get(t),yg.set(e,[xu(n)]))}},c=dt([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return st.from(Op[t])}).toArray()]),s=Sp(wp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Cp("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(t=c,e=n.iconProvider,gt(t,function(t){return st.from(e()[t.toLowerCase()])}).getOrThunk(function(){return kp(e)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:fc([yg.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:fc([Og.config({}),xg("notification-events",[dr(wo(),function(t){s.getOpt(t).each(Og.focus)})])]),components:l.concat(n.progress?[u.asSpec()]:[]).concat(n.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[ie("level"),$n("progress"),$n("icon"),$n("onAction"),$n("text"),$n("iconProvider"),$n("translationProvider"),he("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),Tp=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&clearTimeout(r),r=setTimeout(function(){e.apply(null,t),r=null},o)}}},Ep=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Dp=function(o,t,n,e,r){var i=Ep(o,function(t){return e=t,(n=o).isBlock(e)||N(["BR","IMG","HR","INPUT"],e.nodeName)||"false"===n.getContentEditable(e);var n,e});return st.from(i.backwards(t,n,e,r))},Bp=function(e,n){return Ap(ke.fromDom(e.selection.getNode())).getOrThunk(function(){var t=ke.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Kr(t,ke.fromDom(n.extractContents())),n.insertNode(t.dom),Fr(t).each(function(t){return t.dom.normalize()}),As(t,Bs).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===kr(n=t)?1:Es(n).fold(function(){return Vr(n).length},function(t){return t.length}))}),t})},Ap=function(t){return ea(t,"[data-mce-autocompleter]")},Mp=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Fp=function(t){return""!==t&&-1!==" \xa0\f\n\r\t\x0B".indexOf(t)},Ip=function(t,n){return t.substring(n.length)},Rp=function(t,o,r,i){if(void 0===i&&(i=0),!(n=o).collapsed||3!==n.startContainer.nodeType)return st.none();var n,e=t.getParent(o.startContainer,t.isBlock)||t.getRoot();return Dp(t,o.startContainer,o.startOffset,function(t,i,n){return function(t,n,e){for(var o=i-1;0<=o;o--){var r=t.charAt(o);if(Fp(r))return st.none();if(r===e)break}return st.some(o)}(n,0,r).getOr(i)},e).bind(function(t){var n=o.cloneRange();if(n.setStart(t.container,t.offset),n.setEnd(o.endContainer,o.endOffset),n.collapsed)return st.none();var e=Mp(n);return 0!==e.lastIndexOf(r)||Ip(e,r).length<i?st.none():st.some({text:Ip(e,r),range:n,triggerChar:r})})},Vp=function(o,t,r,n){return void 0===n&&(n=0),Ap(ke.fromDom(t.startContainer)).fold(function(){return Rp(o,t,r,n)},function(t){var n=o.createRng();n.selectNode(t.dom);var e=Mp(n);return st.some({range:n,text:Ip(e,r),triggerChar:r})})},Pp=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var o=function(t,n){rr(t,ko(),{raw:n})};t.on("keydown",function(n){var t=function(){return e.getView().bind(vd.getHighlighted)};8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===n.which?(t().each(ir),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each(vd.highlightFirst)},function(t){o(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&Ap(ke.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},Hp=tinymce.util.Tools.resolve("tinymce.util.Promise"),zp=function(t,n){return{container:t,offset:n}},Np=function(t){if(3===t.nodeType)return zp(t,t.data.length);var n=t.childNodes;return 0<n.length?Np(n[n.length-1]):zp(t,n.length)},Lp=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?Lp(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?Np(e[e.length-1]):zp(t,n)},jp=function(r){return function(t){var n,e,o=Lp(t.startContainer,t.startOffset);return!Dp(n=r,(e=o).container,e.offset,function(t,n){return 0===n?-1:n},n.getRoot()).filter(function(t){var n=t.container.data.charAt(t.offset-1);return!Fp(n)}).isSome()}},Up=function(n,e){var o,r,t=e(),i=n.selection.getRng();return o=n.dom,r=i,gt(t.triggerChars,function(t){return Vp(o,r,t)}).bind(function(t){return Wp(n,e,t)})},Wp=function(n,t,e,o){void 0===o&&(o={});var r=t(),i=n.selection.getRng().startContainer.nodeValue,u=X(r.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk(function(){return jp(n.dom)})(e.range,i,e.text)});if(0===u.length)return st.none();var a=Hp.all(W(u,function(n){return n.fetch(e.text,n.maxResults,o).then(function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}})}));return st.some({lookupData:a,context:e})},Gp=wn([Zn("type"),ce("text")]),Xp=wn([fe("type","autocompleteitem"),fe("active",!1),fe("disabled",!1),fe("meta",{}),Zn("value"),ce("text"),ce("icon")]),Yp=wn([Zn("type"),Zn("ch"),me("minChars",1),fe("columns",1),me("maxResults",10),se("matches"),ne("fetch"),ne("onAction"),be("highlightOn",[],Gn)]),qp=[he("disabled",!1),ce("tooltip"),ce("icon"),ce("text"),ve("onSetup",function(){return at})],Kp=wn([Zn("type"),ne("onAction")].concat(qp)),Jp=function(t){return Vn("toolbarbutton",Kp,t)},$p=[he("active",!1)].concat(qp),Qp=wn($p.concat([Zn("type"),ne("onAction")])),Zp=function(t){return Vn("ToggleButton",Qp,t)},th=[ve("predicate",p),pe("scope","node",["node","editor"]),pe("position","selection",["node","selection","line"])],nh=qp.concat([fe("type","contextformbutton"),fe("primary",!1),ne("onAction"),xe("original",ut)]),eh=$p.concat([fe("type","contextformbutton"),fe("primary",!1),ne("onAction"),xe("original",ut)]),oh=qp.concat([fe("type","contextformbutton")]),rh=$p.concat([fe("type","contextformtogglebutton")]),ih=Ln("type",{contextformbutton:nh,contextformtogglebutton:eh}),uh=wn([fe("type","contextform"),ve("initValue",function(){return""}),ce("label"),re("commands",ih),ue("launch",Ln("type",{contextformbutton:oh,contextformtogglebutton:rh}))].concat(th)),ah=wn([fe("type","contexttoolbar"),Zn("items")].concat(th)),ch=function(t){var n,e,o=t.ui.registry.getAll().popups,r=Pt(o,function(t){return Vn("Autocompleter",Yp,t).fold(function(t){throw new Error(zn(t))},function(t){return t})}),i=(n=Nt(r,function(t){return t.ch}),e={},ft(n,function(t){e[t]={}}),It(e)),u=jt(r);return{dataset:r,triggerChars:i,lookupByChar:function(n){return X(u,function(t){return t.ch===n})}}};(jd=Ld=Ld||{})[jd.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",jd[jd.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var sh,lh,fh=Ld,dh="tox-menu-nav__js",mh="tox-collection__item",gh="tox-swatch",ph={normal:dh,color:gh},hh="tox-collection__item--enabled",vh="tox-collection__item-label",bh="tox-collection__item-caret",yh="tox-collection__item--active",xh="tox-collection__item-container",wh="tox-collection__item-container--row",Sh=function(t){return Ut(ph,t).getOr(dh)},kh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Ch=function(t){var n=kh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Sh(t)}},Oh=[np.parts.items({})],_h=function(t,n,e){var o=kh(e);return{dom:{tag:"div",classes:dt([[o.tieredMenu]])},markers:Ch(e)}},Th=function(e,o){return function(t){var n=U(t,o);return W(n,function(t){return{dom:e,components:t}})}},Eh=function(t,e){var o=[],r=[];return ft(t,function(t,n){e(t,n)?(0<r.length&&o.push(r),r=[],Wt(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),0<r.length&&o.push(r),W(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},Dh=function(n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[np.parts.items({preprocess:function(t){return"auto"!==n&&1<n?Th({tag:"div",classes:["tox-collection__group"]},n)(t):Eh(t,function(t,n){return"separator"===e[n].type})}})]}},Bh=function(t){return L(t,function(t){return"icon"in t&&t.icon!==undefined})},Ah=function(t){return console.error(zn(t)),console.log(t),st.none()},Mh=function(t,n,e){var o,r=(o=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[np.parts.items({preprocess:function(t){return Eh(t,function(t,n){return"separator"===o[n].type})}})]});return{value:t,dom:r.dom,components:r.components,items:e}},Fh=function(t,n,e,o,r){var i,u,a,c,s,l;return"color"===r?{value:t,dom:(i=o,a={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[np.parts.items({preprocess:"auto"!==i?Th({tag:"div",classes:["tox-swatches__row"]},i):ut})]}]}).dom,components:a.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(a=Dh(o,e)).dom,components:a.components,items:e}:"normal"===r&&1===o?{value:t,dom:(a=Dh(1,e)).dom,components:a.components,items:e}:"normal"===r?{value:t,dom:(a=Dh(o,e)).dom,components:a.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:(c=n,s=o,l=kh(r),{tag:"div",classes:dt([[l.menu,"tox-menu-"+s+"-column"],c?[l.hasIcons]:[]])}),components:Oh,items:e}:{value:t,dom:(u=o,a={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[np.parts.items({preprocess:Th({tag:"div",classes:["tox-collection__group"]},u)})]}).dom,components:a.components,items:e}},Ih=[Zn("type"),Zn("src"),ce("alt"),be("classes",[],Gn)],Rh=wn(Ih),Vh=[Zn("type"),Zn("text"),ce("name"),be("classes",["tox-collection__item-label"],Gn)],Ph=wn(Vh),Hh=Fn(function(){return Nn("type",{cardimage:Rh,cardtext:Ph,cardcontainer:zh})}),zh=wn([Zn("type"),ge("direction","horizontal"),ge("align","left"),ge("valign","middle"),re("items",Hh)]),Nh=[he("disabled",!1),ce("text"),ce("shortcut"),En("value","value",en(function(){return mi("menuitem-value")}),jn()),fe("meta",{})],Lh=wn([Zn("type"),ce("label"),re("items",Hh),ve("onSetup",function(){return at}),ve("onAction",at)].concat(Nh)),jh=wn([Zn("type"),he("active",!1),ce("icon")].concat(Nh)),Uh=wn([Zn("type"),te("fancytype",["inserttable","colorswatch"]),ve("onAction",at)]),Wh=wn([Zn("type"),ve("onSetup",function(){return at}),ve("onAction",at),ce("icon")].concat(Nh)),Gh=wn([Zn("type"),ne("getSubmenuItems"),ve("onSetup",function(){return at}),ce("icon")].concat(Nh)),Xh=wn([Zn("type"),ce("icon"),he("active",!1),ve("onSetup",function(){return at}),ne("onAction")].concat(Nh)),Yh=function(t,o,n){var r=Ms(t.element,"."+n);if(0<r.length){var e=J(r,function(t){var n=t.dom.getBoundingClientRect().top,e=r[0].dom.getBoundingClientRect().top;return Math.abs(n-e)>o}).getOr(r.length);return st.some({numColumns:e,numRows:Math.ceil(r.length/e)})}return st.none()},qh=function(t,n){return fc([xg(t,n)])},Kh=function(t){return qh(mi("unnamed-events"),t)},Jh=mi("tooltip.exclusive"),$h=mi("tooltip.show"),Qh=mi("tooltip.hide"),Zh=function(t){t.getSystem().broadcastOn([Jh],{})},tv=Object.freeze({__proto__:null,hideAllExclusive:Zh,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&yg.set(t,o)})}}),nv=Object.freeze({__proto__:null,events:function(r,i){var e=function(n){i.getTooltip().each(function(t){gl(t),r.onHide(n,t),i.clearTooltip()}),i.clearTimer()};return sr(dt([[dr($h,function(o){i.resetTimer(function(){var t,n,e;t=o,i.isShowing()||(Zh(t),n=r.lazySink(t).getOrDie(),e=t.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:sr("normal"===r.mode?[dr(xo(),function(){or(t,$h)}),dr(bo(),function(){or(t,Qh)})]:[]),behaviours:fc([yg.config({})])}),i.setTooltip(e),fl(n,e),r.onShow(t,e),ul.position(n,r.anchor(t),e))},r.delay)}),dr(Qh,function(t){i.resetTimer(function(){e(t)},r.delay)}),dr(Ro(),function(t,n){n.universal||N(n.channels,Jh)&&e(t)}),xr(function(t){e(t)})],"normal"===r.mode?[dr(wo(),function(t){or(t,$h)}),dr(Fo(),function(t){or(t,Qh)}),dr(xo(),function(t){or(t,$h)}),dr(bo(),function(t){or(t,Qh)})]:[dr(nr(),function(t){or(t,$h)}),dr(er(),function(t){or(t,Qh)})]]))}}),ev=[$n("lazySink"),$n("tooltipDom"),fe("exclusive",!0),fe("tooltipComponents",[]),fe("delay",300),pe("mode","normal",["normal","follow-highlight"]),fe("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:it([Ka,qa,Wa,Xa,Ga,Ya]),onRtl:it([Ka,qa,Wa,Xa,Ga,Ya])}}}),xa("onHide"),xa("onShow")],ov=mc({fields:ev,name:"tooltipping",active:nv,state:Object.freeze({__proto__:null,init:function(){var e=we(st.none()),n=we(st.none()),o=function(){e.get().each(function(t){clearTimeout(t)})},t=it("not-implemented");return Bi({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(st.some(t))},clearTooltip:function(){n.set(st.none())},clearTimer:o,resetTimer:function(t,n){o(),e.set(st.some(setTimeout(function(){t()},n)))},readState:t})}}),apis:tv}),rv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),iv=tinymce.util.Tools.resolve("tinymce.util.I18n"),uv=["input","button","textarea","select"],av=function(t,n){(n.disabled()?mv:gv)(t,n)},cv=function(t,n){return!0===n.useNative&&N(uv,kr(t.element))},sv=function(t){oi(t.element,"disabled","disabled")},lv=function(t){ai(t.element,"disabled")},fv=function(t){oi(t.element,"aria-disabled","true")},dv=function(t){oi(t.element,"aria-disabled","false")},mv=function(n,t){t.disableClass.each(function(t){Gi(n.element,t)}),(cv(n,t)?sv:fv)(n),t.onDisabled(n)},gv=function(n,t){t.disableClass.each(function(t){Yi(n.element,t)}),(cv(n,t)?lv:dv)(n),t.onEnabled(n)},pv=function(t,n){return cv(t,n)?ui(t.element,"disabled"):"true"===ri(t.element,"aria-disabled")},hv=Object.freeze({__proto__:null,enable:gv,disable:mv,isDisabled:pv,onLoad:av,set:function(t,n,e,o){(o?mv:gv)(t,n)}}),vv=Object.freeze({__proto__:null,exhibit:function(t,n){return Mi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(n,t){return sr([lr(Vo(),function(t){return pv(t,n)}),uc(n,t,av)])}}),bv=[ve("disabled",p),fe("useNative",!0),ie("disableClass"),xa("onDisabled"),xa("onEnabled")],yv=mc({fields:bv,name:"disabling",active:vv,apis:hv}),
xv=tinymce.util.Tools.resolve("tinymce.EditorManager"),wv=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Sv=function(t){return t.getParam("width",rv.DOM.getStyle(t.getElement(),"width"))},kv=function(t){return st.from(t.getParam("min_width")).filter(lt)},Cv=function(t){return st.from(t.getParam("min_height")).filter(lt)},Ov=function(t){return st.from(t.getParam("max_width")).filter(lt)},_v=function(t){return st.from(t.getParam("max_height")).filter(lt)},Tv=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Ev=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=E(n),r=B(n)&&0<n.length;return!Bv(t)&&(r||o||e)},Dv=function(n){var t=j(9,function(t){return n.getParam("toolbar"+(t+1),!1,"string")}),e=X(t,function(t){return"string"==typeof t});return 0<e.length?st.some(e):st.none()},Bv=function(t){return Dv(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},S)};(lh=sh=sh||{})["default"]="wrap",lh.floating="floating",lh.sliding="sliding",lh.scrolling="scrolling";var Av,Mv,Fv=function(t){return t.getParam("toolbar_mode","","string")};(Mv=Av=Av||{}).auto="auto",Mv.top="top",Mv.bottom="bottom";var Iv,Rv,Vv,Pv=function(t){return t.getParam("toolbar_location",Av.auto,"string")},Hv=function(t){return Pv(t)===Av.bottom},zv=function(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?na(Zi(),n):st.none()},Nv=function(t){return t.inline&&zv(t).isSome()},Lv=function(t){return zv(t).getOrThunk(function(){return jr(Lr(ke.fromDom(t.getElement())))})},jv=function(t){return t.inline&&!Tv(t)&&!Ev(t)&&!Bv(t)},Uv=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Nv(t)&&!jv(t)},Wv="silver.readonly",Gv=wn([Qn("readonly",Xn)]),Xv=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([Dl()],{target:e}),t.uiMothership.broadcastOn([Dl()],{target:e})),t.mothership.broadcastOn([Wv],{readonly:n}),t.uiMothership.broadcastOn([Wv],{readonly:n})},Yv=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&Xv(n,!0)}),t.on("SwitchMode",function(){return Xv(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},qv=function(){var t;return vc.config({channels:((t={})[Wv]={schema:Gv,onReceive:function(t,n){yv.set(t,n.readonly)}},t)})},Kv=function(t){return yv.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Jv=function(t){return yv.config({disabled:t})},$v=function(t){return yv.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Qv=function(t){return yv.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Zv=function(t,n){var e=t.getApi(n);return function(t){t(e)}},tb=function(e,o){return yr(function(t){Zv(e,t)(function(t){var n=e.onSetup(t);I(n)&&o.set(n)})})},nb=function(n,e){return xr(function(t){return Zv(n,t)(e.get())})},eb=((Iv={})[Vo()]=["disabling","alloy.base.behaviour","toggling","item-events"],Iv),ob=function(t){return $(t,function(t){return t.toArray()})},rb=function(t,n,e,o){var r,i,u=we(at);return{type:"item",dom:n.dom,components:ob(n.optComponents),data:t.data,eventOrder:eb,hasSubmenu:t.triggersSubmenu,itemBehaviours:fc([xg("item-events",[(r=t,i=e,Sr(function(t,n){Zv(r,t)(r.onAction),r.triggersSubmenu||i!==fh.CLOSE_ON_EXECUTE||(t.getSystem().isConnected()&&or(t,No()),n.stop())})),tb(t,u),nb(t,u)]),Kv(function(){return t.disabled||o.isDisabled()}),qv(),yg.config({})].concat(t.itemBehaviours))}},ib=function(t){return{value:t.value,meta:ct({text:t.text.getOr("")},t.meta)}},ub=tinymce.util.Tools.resolve("tinymce.Env"),ab=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},cb=function(t){return{dom:{tag:"div",classes:[vh]},components:[xu(iv.translate(t))]}},sb=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},lb=function(t,n){return{dom:{tag:"div",classes:[vh]},components:[{dom:{tag:t.tag,styles:t.styles},components:[xu(iv.translate(n))]}]}},fb=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=ub.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=W(o,function(t){var n=t.toLowerCase().trim();return Wt(e,n)?e[n]:t}),ub.mac?r.join(""):r.join("+"))}};var n,e,o,r},db=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Cp("checkmark",t)}}},mb=function(t,n){var e=n.map(function(t){return{attributes:{title:iv.translate(t)}}}).getOr({});return ct({tag:"div",classes:[dh,mh].concat(t?["tox-collection__item-icon-rtl"]:[])},e)},gb=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],pb=["list-bull-circle","list-bull-default","list-bull-square"],hb=function(t,r,n,i){void 0===i&&(i=st.none());var e,o,u,a,c,s,l,f,d,m,g,p=iv.isRtl()&&t.iconContent.exists(function(t){return N(pb,t)}),h=t.iconContent.map(function(t){return iv.isRtl()&&N(gb,t)?t+"-rtl":t}).map(function(t){return n=t,e=r.icons,o=i,st.from(e()[n.toLowerCase()]).or(o).getOrThunk(function(){return kp(e)});var n,e,o}),v=st.from(t.meta).fold(function(){return cb},function(t){return Wt(t,"style")?b(lb,t.style):cb});return"color"===t.presets?(l=t.ariaLabel,f=t.value,d=r,{dom:(m=h.getOr(""),g={tag:"div",attributes:l.map(function(t){return{title:d.translate(t)}}).getOr({}),classes:["tox-swatch"]},ct(ct({},g),"custom"===f?{tag:"button",classes:x(g.classes,["tox-swatches__picker-btn"]),innerHtml:m}:"remove"===f?{classes:x(g.classes,["tox-swatch--remove"]),innerHtml:m}:{attributes:ct(ct({},g.attributes),{"data-mce-color":f}),styles:{"background-color":f}})),optComponents:[]}):(e=t,o=v,u=p,a=n?h.or(st.some("")).map(ab):st.none(),c=e.checkMark,s=e.htmlContent.fold(function(){return e.textContent.map(o)},function(t){return st.some(sb(t,[vh]))}),{dom:mb(u,e.ariaLabel),optComponents:[a,s,e.shortcutContent.map(fb),c,e.caret]})},vb=function(t,n){return Ut(t,"tooltipWorker").map(function(t){return[ov.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:zc}}},mode:"follow-highlight",onShow:function(n){t(function(t){ov.setComponents(n,[wu({element:ke.fromDom(t)})])})}})]}).getOr([])},bb=function(t,n){var e,o=(e=iv.translate(t),rv.DOM.encode(e));if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return o},yb=function(t,a){return W(t,function(t){switch(t.type){case"cardcontainer":return r=yb((o=t).items,a),i="vertical"===o.direction?"tox-collection__item-container--column":wh,u="left"===o.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[xh,i,u,function(){switch(o.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:r};case"cardimage":return e=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:e,alt:t.alt.getOr("")}}};case"cardtext":var n=t.name.exists(function(t){return N(a.cardText.highlightOn,t)})?st.from(a.cardText.matchText).getOr(""):"";return sb(bb(t.text,n),t.classes)}var e,o,r,i,u})},xb=Mf(qg(),Kg()),wb=function(t){return{value:t}},Sb=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,kb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Cb=function(t){return Sb.test(t)||kb.test(t)},Ob=function(t){var n={value:t.value.replace(Sb,function(t,n,e,o){return n+n+e+e+o+o})},e=kb.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},_b=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},Tb=function(t){var n=_b(t.red)+_b(t.green)+_b(t.blue);return wb(n)},Eb=Math.min,Db=Math.max,Bb=Math.round,Ab=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Mb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Fb=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Ib=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},Rb=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=Db(0,Eb(i,1)),u=Db(0,Eb(u,1));if(0===i)return n=e=o=Bb(255*u),Fb(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=Bb(255*(n+l)),e=Bb(255*(e+l)),o=Bb(255*(o+l)),Fb(n,e,o,1)},Vb=function(t){var n=Ob(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Fb(e,o,r,1)},Pb=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Fb(r,i,u,a)},Hb=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},zb=Fb(255,0,0,1),Nb=function(t,n){return t.fire("ResizeContent",n)},Lb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),jb="tinymce-custom-colors",Ub="choiceitem",Wb=[{type:Ub,text:"Light Green",value:"#BFEDD2"},{type:Ub,text:"Light Yellow",value:"#FBEEB8"},{type:Ub,text:"Light Red",value:"#F8CAC6"},{type:Ub,text:"Light Purple",value:"#ECCAFA"},{type:Ub,text:"Light Blue",value:"#C2E0F4"},{type:Ub,text:"Green",value:"#2DC26B"},{type:Ub,text:"Yellow",value:"#F1C40F"},{type:Ub,text:"Red",value:"#E03E2D"},{type:Ub,text:"Purple",value:"#B96AD9"},{type:Ub,text:"Blue",value:"#3598DB"},{type:Ub,text:"Dark Turquoise",value:"#169179"},{type:Ub,text:"Orange",value:"#E67E23"},{type:Ub,text:"Dark Red",value:"#BA372A"},{type:Ub,text:"Dark Purple",value:"#843FA1"},{type:Ub,text:"Dark Blue",value:"#236FA1"},{type:Ub,text:"Light Gray",value:"#ECF0F1"},{type:Ub,text:"Medium Gray",value:"#CED4D9"},{type:Ub,text:"Gray",value:"#95A5A6"},{type:Ub,text:"Dark Gray",value:"#7E8C8D"},{type:Ub,text:"Navy Blue",value:"#34495E"},{type:Ub,text:"Black",value:"#000000"},{type:Ub,text:"White",value:"#ffffff"}],Gb=function(e){void 0===e&&(e=10);var t,n=Lb.getItem(jb),o=E(n)?JSON.parse(n):[],r=e-(t=o).length<0?t.slice(0,e):t,i=function(t){r.splice(t,1)};return{add:function(t){var n;(-1===(n=z(r,t))?st.none():st.some(n)).each(i),r.unshift(t),r.length>e&&r.pop(),Lb.setItem(jb,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Xb=function(t){return!1!==t.getParam("custom_colors")},Yb=function(t){var n=t.getParam("color_map");return n!==undefined?function(t){var n=[],u=document.createElement("canvas");u.height=1,u.width=1;for(var a=u.getContext("2d"),c=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},e=0;e<t.length;e+=2)n.push({text:t[e+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();a.clearRect(0,0,u.width,u.height),a.fillStyle="#FFFFFF",a.fillStyle=t,a.fillRect(0,0,1,1);var n=a.getImageData(0,0,1,1).data,e=n[0],o=n[1],r=n[2],i=n[3];return"#"+c(e,i)+c(o,i)+c(r,i)}(t[e]),type:"choiceitem"});return n}(n):Wb},qb=function(t){Gb.add(t)},Kb=function(i){i.addCommand("mceApplyTextcolor",function(t,n){var e,o,r;o=t,r=n,(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e;e=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})})},Jb=function(t){var n,e;return e=(n=Yb(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))),t.getParam("color_cols",e,"number")},$b=function(n,e,t,o){"custom"===t?oy(n)(function(t){t.each(function(t){qb(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))},Qb=function(t,n){return t.concat(W(Gb.state(),function(t){return{type:Ub,text:t,value:t}}).concat((o={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[o,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[o])));var e,o},Zb=function(n,e){return function(t){t(Qb(n,e))}},ty=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},ny=function(i,e,u,t,o){i.ui.registry.addSplitButton(e,{tooltip:t,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(e){var t,o,r;return st.from((o=u,(t=i).dom.getParents(t.selection.getStart(),function(t){var n;(n=t.style["forecolor"===o?"color":"background-color"])&&(r=r||n)}),r)).bind(function(t){return function(t){if("transparent"===t)return st.some(Fb(0,0,0,0));var n=Ab.exec(t);if(null!==n)return st.some(Pb(n[1],n[2],n[3],"1"));var e=Mb.exec(t);return null!==e?st.some(Pb(e[1],e[2],e[3],e[4])):st.none()}(t).map(function(t){var n=Tb(t).value;return Ae(e.toLowerCase(),n)})}).getOr(!1)},columns:Jb(i),fetch:Zb(Yb(i),Xb(i)),onAction:function(){null!==o.get()&&$b(i,u,o.get(),at)},onItemAction:function(t,n){$b(i,u,n,function(t){var n;o.set(t),n={name:e,color:t},i.fire("TextColorChange",n)})},onSetup:function(n){null!==o.get()&&ty(n,e,o.get());var t=function(t){t.name===e&&ty(n,t.name,t.color)};return i.on("TextColorChange",t),function(){i.off("TextColorChange",t)}}})},ey=function(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){$b(n,e,t.value,at)}}]}})},oy=function(i){return function(t,n){var e,o={colorpicker:n},r=(e=t,function(t){var n=t.getData();e(st.from(n.colorpicker)),t.close()});i.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:r,onClose:at,onCancel:function(){t(st.none())}})}},ry=function(t,n,e,o,r,i,u,a){var c=Bh(n),s=iy(n,e,o,"color"!==r?"normal":"color",i,u,a);return Fh(t,c,s,o,r)},iy=function(e,o,r,i,u,a,c){return nd(W(e,function(n){return"choiceitem"===n.type?Vn("choicemenuitem",jh,n).fold(Ah,function(t){return st.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=hb({presets:e,textContent:n?t.text:st.none(),htmlContent:st.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:st.none(),checkMark:n?st.some(db(u.icons)):st.none(),caret:st.none(),value:t.value},u,a);return Kt(rb({data:ib(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Pg.set(n,t)},isActive:function(){return Pg.isOn(n)},isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},onAction:function(){return o(t.value)},onSetup:function(t){return t.setActive(r),at},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:hh,toggleOnExecute:!1,selected:t.active}})}(t,1===r,i,o,a(n.value),u,c,Bh(e)))}):st.none()}))},uy=function(t,n){var e=Ch(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},ay=mi("cell-over"),cy=mi("cell-execute"),sy=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(n,e,t){var o,r=function(t){return rr(t,cy,{row:n,col:e})},i=function(t,n){n.stop(),r(t)};return ku({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=t,o)},behaviours:fc([xg("insert-table-picker-cell",[dr(xo(),Og.focus),dr(Vo(),r),dr(To(),i),dr(Ho(),i)]),Pg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Og.config({onFocus:function(t){return rr(t,ay,{row:n,col:e})}})])})}(r,u,t));o.push(i)}return o},ly={inserttable:function(o){var t=mi("size-label"),i=sy(t,10,10),u=Sp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[xu("0x0")],behaviours:fc([yg.config({})])});return{type:"widget",data:{value:mi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[xb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:$(i,function(t){return W(t,Cu)}).concat(u.asSpec()),behaviours:fc([xg("insert-table-picker",[hr(ay,function(t,n,e){var o=e.event.row,r=e.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Pg.set(t[i][u],i<=n&&u<=e)}(i,o,r,10,10),yg.set(u.get(t),[xu(r+1+"x"+(o+1))])}),hr(cy,function(t,n,e){o.onAction({numRows:e.event.row+1,numColumns:e.event.col+1}),or(t,No())})]),gg.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=Qb(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r=ry(mi("menu-value"),e,function(t){n.onAction({value:t})},o,"color",fh.CLOSE_ON_EXECUTE,p,t.shared.providers),i=ct(ct({},r),{markers:Ch("color"),movement:uy(o,"color")});return{type:"widget",data:{value:mi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[xb.widget(np.sketch(i))]}}},fy=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=hb({presets:o,textContent:st.none(),htmlContent:e?t.text.map(function(t){return bb(t,n)}):st.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:st.none(),checkMark:st.none(),caret:st.none(),value:t.value},u.providers,a,t.icon);return rb({data:ib(t),disabled:t.disabled,getApi:it({}),onAction:function(){return r(t.value,t.meta)},onSetup:it(at),triggersSubmenu:!1,itemBehaviours:vb(t.meta,u)},c,i,u.providers)},dy=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:ct({tag:"div",classes:[mh,"tox-collection__group-heading"]},n),components:[]}},my=function(t,n,e,o){void 0===o&&(o=!0);var r=hb({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:st.none(),ariaLabel:t.text,caret:st.none(),checkMark:st.none(),shortcutContent:t.shortcut},e,o);return rb({data:ib(t),getApi:function(n){return{isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},gy=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,u,a=r?(u=e.icons,{dom:{tag:"div",classes:[bh],innerHtml:Cp("chevron-down",u)}}):(i=e.icons,{dom:{tag:"div",classes:[bh],innerHtml:Cp("chevron-right",i)}}),c=hb({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:st.none(),ariaLabel:t.text,caret:st.some(a),checkMark:st.none(),shortcutContent:t.shortcut},e,o);return rb({data:ib(t),getApi:function(n){return{isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},disabled:t.disabled,onAction:at,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,n,e)},py=function(t,n,e,o){void 0===o&&(o=!0);var r=hb({iconContent:t.icon,textContent:t.text,htmlContent:st.none(),ariaLabel:t.text,checkMark:st.some(db(e.icons)),caret:st.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Kt(rb({data:ib(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Pg.set(n,t)},isActive:function(){return Pg.isOn(n)},isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:hh,toggleOnExecute:!1,selected:t.active}})},hy=function(n,e){return t=ly,o=n.fancytype,(Object.prototype.hasOwnProperty.call(t,o)?st.some(t[o]):st.none()).map(function(t){return t(n,e)});var t,o},vy=function(t,n,e,o){var r={dom:mb(!1,t.label),optComponents:[st.some({dom:{tag:"div",classes:[xh,wh]},components:yb(t.items,o)})]};return rb({data:ib(ct({text:st.none()},t)),disabled:t.disabled,getApi:function(e){return{isDisabled:function(){return yv.isDisabled(e)},setDisabled:function(n){yv.set(e,n),ft(Ms(e.element,"*"),function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(yv)&&yv.set(t,n)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:st.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(Vv=Rv=Rv||{})[Vv.ContentFocus=0]="ContentFocus",Vv[Vv.UiFocus=1]="UiFocus";var by,yy,xy,wy,Sy=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?ct(ct({},t),{shortcut:st.none(),icon:t.text.isSome()?st.none():t.icon}):t};switch(t.type){case"menuitem":return Vn("menuitem",Wh,t).fold(Ah,function(t){return st.some(my(u(t),n,i,o))});case"nestedmenuitem":return Vn("nestedmenuitem",Gh,t).fold(Ah,function(t){return st.some(gy(u(t),n,i,o,r))});case"togglemenuitem":return Vn("togglemenuitem",Xh,t).fold(Ah,function(t){return st.some(py(u(t),n,i,o))});case"separator":return Vn("separatormenuitem",Gp,t).fold(Ah,function(t){return st.some(dy(t))});case"fancymenuitem":return Vn("fancymenuitem",Uh,t).fold(Ah,function(t){return hy(u(t),e)});default:return console.error("Unknown item in general menu",t),st.none()}},ky=function(t,e,o,n,r,i,u){var a=1===n,c=!a||Bh(t);return nd(W(t,function(t){switch(t.type){case"separator":return Vn("Autocompleter.Separator",Gp,t).fold(Ah,function(t){return st.some(dy(t))});case"cardmenuitem":return Vn("cardmenuitem",Lh,t).fold(Ah,function(n){return st.some(vy(ct(ct({},n),{onAction:function(t){n.onAction(t),o(n.value,n.meta)}}),r,i,{itemBehaviours:vb(n.meta,i),cardText:{matchText:e,highlightOn:u}}))});case"autocompleteitem":default:return Vn("Autocompleter.Item",Xp,t).fold(Ah,function(t){return st.some(fy(t,e,a,"normal",o,r,i,c))})}}))},Cy=function(t,n,e,o,r){var i=Bh(n),u=nd(W(n,function(t){var n=function(t){return Sy(t,e,o,r?!t.hasOwnProperty("text"):i,r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(ct(ct({},t),{disabled:!0})):n(t)}));return(r?Mh:Fh)(t,i,u,1,"normal")},Oy=function(t){return ap.singleData(t.value,t)},_y=function(d,c){var e=we(st.none()),s=we(!1),m=ku(cp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:fc([xg("dismissAutocompleter",[dr(Ko(),function(){return f()})])]),lazySink:c.getSink})),o=function(){return e.get().isSome()},l=function(){o()&&cp.hide(m)},f=function(){var t;o()&&(t=e.get().map(function(t){return t.element}),Ap(t.getOr(ke.fromDom(d.selection.getNode()))).each(Zr),l(),e.set(st.none()),s.set(!1))},r=$t(function(){return ch(d)}),g=function(t,n,e,o){t.matchLength=n.text.length;var r,i,u,a,c,s,l,f=gt(e,function(t){return st.from(t.columns)}).getOr(1);cp.showAt(m,{anchor:"node",root:ke.fromDom(d.getBody()),node:st.from(t.element)},np.sketch((r=Fh("autocompleter-value",!0,o,f,"normal"),i=f,a="normal",c=((u=Rv.ContentFocus)===Rv.ContentFocus?zd:Hd)(),s=uy(i,a),l=Ch(a),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:l.selectedItem,item:l.item},movement:s,fakeFocus:u===Rv.ContentFocus,focusManager:c,menuBehaviours:Kh("auto"!==i?[]:[yr(function(o){Yh(o,4,l.item).each(function(t){var n=t.numColumns,e=t.numRows;gg.setGridSize(o,e,n)})})])}))),cp.getContent(m).each(vd.highlightFirst)},p=function(t){var n;n=t,e.get().map(function(t){return Vp(d.dom,d.selection.getRng(),t.triggerChar).bind(function(t){return Wp(d,r,t,n)})}).getOrThunk(function(){return Up(d,r)}).fold(f,function(a){var t,n;t=a.context,o()||(n=Bp(d,t.range),e.set(st.some({triggerChar:t.triggerChar,element:n,matchLength:t.text.length})),s.set(!1)),a.lookupData.then(function(u){e.get().map(function(t){var n,e,o,r,i=a.context;t.triggerChar===i.triggerChar&&(e=i.triggerChar,r=gt(o=u,function(t){return st.from(t.columns)}).getOr(1),0<(n=$(o,function(i){var t=i.items;return ky(t,i.matchText,function(o,r){var t=d.selection.getRng();Vp(d.dom,t,e).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var n=t.range,e={hide:function(){f()},reload:function(t){l(),p(t)}};s.set(!0),i.onAction(e,n,o,r),s.set(!1)})},r,fh.BUBBLE_TO_SANDBOX,c,i.highlightOn)})).length?g(t,i,u,n):(10<=i.text.length-t.matchLength?f:l)())})})})},t={onKeypress:Tp(function(t){27!==t.which&&p()},50),cancelIfNecessary:f,isMenuOpen:function(){return cp.isOpen(m)},isActive:o,isProcessingAction:s.get,getView:function(){return cp.getContent(m)}};!1===d.hasPlugin("rtc")&&Pp(t,d)},Ty=S,Ey=function(t,n,e){return Hu(t,n,Ty,e,!1)},Dy=function(t,n,e){return Hu(t,n,Ty,e,!0)},By=Pu,Ay=function(t,n,e){return ea(t,n,e).isSome()},My=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=setTimeout(function(){e.apply(null,t),r=null},o)}}},Fy=function(t){var n=t.raw;return n.touches===undefined||1!==n.touches.length?st.none():st.some(n.touches[0])},Iy=function(e){var u=we(st.none()),o=we(!1),r=My(function(t){e.triggerEvent(zo(),t),o.set(!0)},400),i=cn([{key:fo(),value:function(e){return Fy(e).each(function(t){r.cancel();var n={x:t.clientX,y:t.clientY,target:e.target};r.schedule(e),o.set(!1),u.set(st.some(n))}),st.none()}},{key:mo(),value:function(t){return r.cancel(),Fy(t).each(function(i){u.get().each(function(t){var n,e,o,r;n=i,e=t,o=Math.abs(n.clientX-e.x),r=Math.abs(n.clientY-e.y),(5<o||5<r)&&u.set(st.none())})}),st.none()}},{key:go(),value:function(n){return r.cancel(),u.get().filter(function(t){return no(t.target,n.target)}).map(function(){return o.get()?(n.prevent(),!1):e.triggerEvent(Ho(),n)})}}]);return{fireIfReady:function(n,t){return Ut(i,t).bind(function(t){return t(n)})}}},Ry=function(){return Qe().browser.isFirefox()},Vy=xn([ne("triggerEvent"),fe("stopBackspace",!0)]),Py=function(n,t){var e,o,r,i,u=Hn("Getting GUI events settings",Vy,t),a=Iy(u),c=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Ey(n,t,function(n){a.fireIfReady(n,t).each(function(t){t&&n.kill()}),u.triggerEvent(t,n)&&n.kill()})}),s=we(st.none()),l=Ey(n,"paste",function(n){a.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),u.triggerEvent("paste",n)&&n.kill(),s.set(st.some(setTimeout(function(){u.triggerEvent(Io(),n)},0)))}),f=Ey(n,"keydown",function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==bd[0]||N(["input","textarea"],kr(n.target))||Ay(n.target,'[contenteditable="true"]')||t.prevent()}),d=(e=n,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},Ry()?Dy(e,"focus",o):Ey(e,"focusin",o)),m=we(st.none()),g=(r=n,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(st.some(setTimeout(function(){u.triggerEvent(Fo(),t)},0)))},Ry()?Dy(r,"blur",i):Ey(r,"focusout",i));return{unbind:function(){ft(c,function(t){t.unbind()}),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},Hy=function(t,n){var e=Ut(t,"target").getOr(n);return we(e)},zy=Xt([{stopped:[]},{resume:["element"]},{complete:[]}]),Ny=function(t,o,n,e,r,i){var u,a,c,s,l=t(o,e),f=(u=n,a=r,c=we(!1),s=we(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold(function(){return i.logEventNoHandlers(o,e),zy.complete()},function(n){var e=n.descHandler;return Fi(e)(f),f.isStopped()?(i.logEventStopped(o,n.element,e.purpose),zy.stopped()):f.isCut()?(i.logEventCut(o,n.element,e.purpose),zy.complete()):Fr(n.element).fold(function(){return i.logNoParent(o,n.element,e.purpose),zy.complete()},function(t){return i.logEventResponse(o,n.element,e.purpose),zy.resume(t)})})},Ly=function(n,e,o,t,r,i){return Ny(n,e,o,t,r,i).fold(S,function(t){return Ly(n,e,o,t,r,i)},p)},jy=function(t,n){var e,o,r=(e=n,o=we(!1),{stop:function(){o.set(!0)},cut:at,isStopped:o.get,isCut:p,event:e,setSource:g("Cannot set source of a broadcasted event"),getSource:g("Cannot get source of a broadcasted event")});return ft(t,function(t){var n=t.descHandler;Fi(n)(r)}),r.isStopped()},Uy=function(t,n,e,o,r){var i=Hy(e,o);return Ly(t,n,e,o,i,r)},Wy=function(){var a={};return{registerId:function(i,u,t){Vt(t,function(t,n){var e,o,r=a[n]!==undefined?a[n]:{};r[u]=(e=t,o=i,{cHandler:b.apply(undefined,[e.handler].concat(o)),purpose:e.purpose}),a[n]=r})},unregisterId:function(n){Vt(a,function(t){t.hasOwnProperty(n)&&delete t[n]})},filterByType:function(t){return Ut(a,t).map(function(t){return Nt(t,function(t,n){return{id:n,descHandler:t}})}).getOr([])},find:function(t,n,e){var r=Ut(a,n);return uo(e,function(t){return e=r,yi(o=t).fold(function(){return st.none()},function(n){return e.bind(function(t){return Ut(t,n)}).map(function(t){return{element:o,descHandler:t}})});var e,o},t)}}},Gy=function(){var o=Wy(),r={},i=function(o){var t=o.element;return yi(t).fold(function(){return t="uid-",n=o.element,e=mi(hi+t),bi(n,e),e;var t,n,e},function(t){return t})},u=function(t){yi(t.element).each(function(t){delete r[t],o.unregisterId(t)})};return{find:function(t,n,e){return o.find(t,n,e)},filter:function(t){return o.filterByType(t)},register:function(t){var n=i(t);Gt(r,n)&&function(t,n){var e=r[n];if(e!==t)throw new Error('The tagId "'+n+'" is already used by: '+si(e.element)+"\nCannot use it for: "+si(t.element)+"\nThe conflicting element is"+(Qi(e.element)?" ":" not ")+"already in the DOM");u(t)}(t,n);var e=[t];o.registerId(e,n,t.events),r[n]=t},unregister:u,getById:function(t){return Ut(r,t)}}},Xy=Zf({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=y(n,["attributes"]);return{uid:t.uid,dom:ct({tag:"div",attributes:ct({role:"presentation"},e)},o),components:t.components,behaviours:Jl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[fe("components",[]),Kl("containerBehaviours",[]),fe("events",{}),fe("domModification",{}),fe("eventOrder",{})]}),Yy=function(e){var o=function(n){return Fr(e.element).fold(S,function(t){return no(n,t)})},r=Gy(),s=function(t,n){return r.find(o,t,n)},t=Py(e.element,{triggerEvent:function(o,r){return fa(o,r.target,function(t){return e=t,Uy(s,o,n=r,n.target,e);var n,e})}}),i={debugInfo:it("real"),triggerEvent:function(n,e,o){fa(n,e,function(t){return Uy(s,n,o,e,t)})},triggerFocus:function(a,c){yi(a).fold(function(){yc(a)},function(){fa(Mo(),a,function(t){var n,e,o,r,i,u;return n=s,e=Mo(),i=t,u=Hy(o={originator:c,kill:at,prevent:at,target:a},r=a),Ny(n,e,o,r,u,i),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:ku,addToGui:function(t){a(t)},removeFromGui:function(t){c(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){u(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:S},n=function(t){t.connect(i),_r(t.element)||(r.register(t),ft(t.components(),n),i.triggerEvent(jo(),t.element,{target:t.element}))},u=function(t){_r(t.element)||(ft(t.components(),u),r.unregister(t)),t.disconnect()},a=function(t){fl(e,t)},c=function(t){gl(t)},l=function(e){var t=r.filter(Ro());ft(t,function(t){var n=t.descHandler;Fi(n)(e)})},f=function(t){l({universal:!0,data:t})},d=function(t,n){l({universal:!1,channels:t,data:n})},m=function(t,n){var e=r.filter(t);return jy(e,n)},g=function(t){return r.getById(t).fold(function(){return vt.error(new Error('Could not find component with uid: "'+t+'" in system.'))},vt.value)},p=function(t){var n=yi(t).getOr("not found");return g(n)};return n(e),{root:e,element:e.element,destroy:function(){t.unbind(),Qr(e.element)},add:a,remove:c,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:u,broadcast:f,broadcastOn:d,broadcastEvent:m}},qy=it([fe("prefix","form-field"),Kl("fieldBehaviours",[ud,ql])]),Ky=it([Tf({schema:[$n("dom")],name:"label"}),Tf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[$n("text")],name:"aria-descriptor"}),Of({factory:{sketch:function(t){var n=un(t,["factory"]);return t.factory.sketch(n)}},schema:[$n("factory")],name:"field"})]),Jy=td({name:"FormField",configFields:qy(),partFields:Ky(),factory:function(r,t){var n=$l(r.fieldBehaviours,[ud.config({find:function(t){return zf(t,r,"field")}}),ql.config({store:{mode:"manual",getValue:function(t){return ud.getCurrent(t).bind(ql.getValue)},setValue:function(t,n){ud.getCurrent(t).each(function(t){ql.setValue(t,n)})}}})]),e=sr([yr(function(t){var o=Lf(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=mi(r.prefix);o.label().each(function(t){oi(t.element,"for",n),oi(e.element,"id",n)})
,o["aria-descriptor"]().each(function(t){var n=mi(r.prefix);oi(t.element,"id",n),oi(e.element,"aria-describedby",n)})})})]),o={getField:function(t){return zf(t,r,"field")},getLabel:function(t){return zf(t,r,"label")}};return{uid:r.uid,dom:r.dom,components:t,behaviours:n,events:e,apis:o}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),$y=Object.freeze({__proto__:null,exhibit:function(t,n){return Mi({attributes:cn([{key:n.tabAttr,value:"true"}])})}}),Qy=[fe("tabAttr","data-alloy-tabstop")],Zy=mc({fields:Qy,name:"tabstopping",active:$y}),tx=tinymce.util.Tools.resolve("tinymce.html.Entities"),nx=function(t,n,e,o){var r=ex(t,n,e,o);return Jy.sketch(r)},ex=function(t,n,e,o){return{dom:ox(e),components:t.toArray().concat([n]),fieldBehaviours:fc(o)}},ox=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},rx=function(t,n){return Jy.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},ix=mi("form-component-change"),ux=mi("form-close"),ax=mi("form-cancel"),cx=mi("form-action"),sx=mi("form-submit"),lx=mi("form-block"),fx=mi("form-unblock"),dx=mi("form-tabchange"),mx=mi("form-resize"),gx=function(u,a){var t,n,e,o=u.label.map(function(t){return rx(t,a)}),r=function(o){return function(n,e){ea(e.event.target,"[data-collection-item-value]").each(function(t){o(n,e,t,ri(t,"data-collection-item-value"))})}},i=r(function(t,n,e,o){n.stop(),a.isDisabled()||rr(t,cx,{name:u.name,value:o})}),c=[dr(xo(),r(function(t,n,e){yc(e)})),dr(To(),i),dr(Ho(),i),dr(wo(),r(function(t,n,e){na(t.element,"."+yh).each(function(t){Yi(t,yh)}),Gi(e,yh)})),dr(So(),r(function(t){na(t.element,"."+yh).each(function(t){Yi(t,yh)})})),Sr(r(function(t,n,e,o){rr(t,cx,{name:u.name,value:o})}))],s=function(t,n){return W(Ms(t.element,".tox-collection__item"),n)},l=Jy.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==u.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:ut},behaviours:fc([yv.config({disabled:a.isDisabled,onDisabled:function(t){s(t,function(t){Gi(t,"tox-collection__item--state-disabled"),oi(t,"aria-disabled",!0)})},onEnabled:function(t){s(t,function(t){Yi(t,"tox-collection__item--state-disabled"),ai(t,"aria-disabled")})}}),qv(),yg.config({}),ql.config({store:{mode:"memory",initialValue:[]},onSetValue:function(o,t){var n,e,r,i;n=o,e=W(t,function(t){var n=iv.translate(t.text),e=1===u.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},i=n.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item'+(a.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+tx.encodeAllRaw(t.value)+'" title="'+i+'" aria-label="'+i+'">'+o+e+"</div>"}),r="auto"!==u.columns&&1<u.columns?U(e,u.columns):[e],i=W(r,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}),ni(n.element,i.join("")),"auto"===u.columns&&Yh(o,5,"tox-collection__item").each(function(t){var n=t.numRows,e=t.numColumns;gg.setGridSize(o,n,e)}),or(o,mx)}}),Zy.config({}),gg.config((n=u.columns,e="normal",1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===e?".tox-swatches__row":".tox-collection__group",cell:"color"===e?"."+gh:"."+mh}})),xg("collection-events",c)]),eventOrder:((t={})[Vo()]=["disabling","alloy.base.behaviour","collection-events"],t)});return nx(o,l,["tox-form__group--collection"],[])},px=it([ie("data"),fe("inputAttributes",{}),fe("inputStyles",{}),fe("tag","input"),fe("inputClasses",[]),xa("onSetValue"),fe("styles",{}),fe("eventOrder",{}),Kl("inputBehaviours",[ql,Og]),fe("selectOnFocus",!0)]),hx=function(t){return fc([Og.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=du(n);n.dom.setSelectionRange(0,e.length)}:at})])},vx=function(t){return{tag:t.tag,attributes:ct({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},bx=Zf({name:"Input",configFields:px(),factory:function(t){return{uid:t.uid,dom:vx(t),components:[],behaviours:ct(ct({},hx(n=t)),$l(n.inputBehaviours,[ql.config({store:ct(ct({mode:"manual"},n.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return du(t.element)},setValue:function(t,n){du(t.element)!==n&&mu(t.element,n)}}),onSetValue:n.onSetValue})])),eventOrder:t.eventOrder};var n}}),yx={},xx={exports:yx};by=undefined,yy=yx,xy=xx,wy=undefined,function(t){"object"==typeof yy&&void 0!==xy?xy.exports=t():"function"==typeof by&&by.amd?by([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function l(i,u,a){function c(n,t){if(!u[n]){if(!i[n]){var e="function"==typeof wy&&wy;if(!t&&e)return e(n,!0);if(s)return s(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=u[n]={exports:{}};i[n][0].call(r.exports,function(t){return c(i[n][1][t]||t)},r,r.exports,l,i,u,a)}return u[n].exports}for(var s="function"==typeof wy&&wy,t=0;t<a.length;t++)c(a[t]);return c}({1:[function(t,n){function e(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(s===setTimeout)return setTimeout(t,0);if((s===e||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function i(){g&&d&&(g=!1,d.length?m=d.concat(m):p=-1,m.length&&u())}function u(){if(!g){var t=r(i);g=!0;for(var n=m.length;n;){for(d=m,m=[];++p<n;)d&&d[p].run();p=-1,n=m.length}d=null,g=!1,function(t){if(l===clearTimeout)return clearTimeout(t);if((l===o||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}(t)}}function a(t,n){this.fun=t,this.array=n}function c(){}var s,l,f=n.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:e}catch(t){s=e}try{l="function"==typeof clearTimeout?clearTimeout:o}catch(t){l=o}}();var d,m=[],g=!1,p=-1;f.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];m.push(new a(t,n)),1!==m.length||g||r(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(){return[]},f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],2:[function(t,e){(function(n){function c(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],l(t,this)}function o(e,o){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var t,n=1===e._state?o.onFulfilled:o.onRejected;if(null!==n){try{t=n(e._value)}catch(f){return void a(o.promise,f)}u(o.promise,t)}else(1===e._state?u:a)(o.promise,e._value)})):e._deferreds.push(o)}function u(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void s(t);if("function"==typeof e)return void l((o=e,r=n,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=n,s(t)}catch(u){a(t,u)}var o,r}function a(t,n){t._state=2,t._value=n,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)o(t,t._deferreds[n]);t._deferreds=null}function r(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,u(n,t))},function(t){e||(e=!0,a(n,t))})}catch(c){if(e)return;e=!0,a(n,c)}}var t,f;t=this,f=setTimeout,i.prototype["catch"]=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(c);return o(this,new r(t,n,e)),e},i.all=function(t){var a=Array.prototype.slice.call(t);return new i(function(o,r){if(0===a.length)return o([]);for(var i=a.length,t=0;t<a.length;t++)!function u(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){u(n,t)},r)}a[n]=t,0==--i&&o(a)}catch(c){r(c)}}(t,a[t])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(t){t(n)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(r){return new i(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},i._immediateFn="function"==typeof n?function(t){n(t)}:function(t){f(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==e&&e.exports?e.exports=i:t.Promise||(t.Promise=i)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(c,t,s){(function(t,n){function e(t,n){this._id=t,this._clearFn=n}var o=c("process/browser.js").nextTick,r=Function.prototype.apply,i=Array.prototype.slice,u={},a=0;s.setTimeout=function(){return new e(r.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new e(r.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},s.setImmediate="function"==typeof t?t:function(t){var n=a++,e=!(arguments.length<2)&&i.call(arguments,1);return u[n]=!0,o(function(){u[n]&&(e?t.apply(null,e):t.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(t){delete u[t]}}).call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n){var e=t("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:o.Promise||e}},{"promise-polyfill":2}]},{},[4])(4)});var wx,Sx,kx=xx.exports.boltExport,Cx=function(t){var e=st.none(),n=[],o=function(t){r()?u(t):n.push(t)},r=function(){return e.isSome()},i=function(t){ft(t,u)},u=function(n){e.each(function(t){setTimeout(function(){n(t)},0)})};return t(function(t){r()||(e=st.some(t),i(n),n=[])}),{get:o,map:function(e){return Cx(function(n){o(function(t){n(e(t))})})},isReady:r}},Ox={nu:Cx,pure:function(n){return Cx(function(t){t(n)})}},_x=function(t){setTimeout(function(){throw t},0)},Tx=function(e){var t=function(t){e().then(t,_x)};return{map:function(t){return Tx(function(){return e().then(t)})},bind:function(n){return Tx(function(){return e().then(function(t){return n(t).toPromise()})})},anonBind:function(t){return Tx(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return Ox.nu(t)},toCached:function(){var t=null;return Tx(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},Ex=function(t){return Tx(function(){return new kx(t)})},Dx=function(t){return Tx(function(){return kx.resolve(t)})},Bx=["input","textarea"],Ax=function(t){var n=kr(t);return N(Bx,n)},Mx=function(t,n){var e=n.getRoot(t).getOr(t.element);Yi(e,n.invalidClass),n.notify.each(function(n){Ax(t.element)&&oi(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){ni(t,n.validHtml)}),n.onValid(t)})},Fx=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element);Gi(r,t.invalidClass),t.notify.each(function(t){Ax(n.element)&&oi(n.element,"aria-invalid",!0),t.getContainer(n).each(function(t){ni(t,o)}),t.onInvalid(n,o)})},Ix=function(n,t){return t.validator.fold(function(){return Dx(vt.value(!0))},function(t){return t.validate(n)})},Rx=function(n,e){return e.notify.each(function(t){t.onValidate(n)}),Ix(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return Fx(n,e,0,t),vt.error(t)},function(t){return Mx(n,e),vt.value(t)}):vt.error("No longer in system")})},Vx=Object.freeze({__proto__:null,markValid:Mx,markInvalid:Fx,query:Ix,run:Rx,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return qi(e,n.invalidClass)}}),Px=Object.freeze({__proto__:null,events:function(n){return n.validator.map(function(t){return sr([dr(t.onEvent,function(t){Rx(t,n).get(ut)})].concat(t.validateOnLoad?[yr(function(t){Rx(t,n).get(at)})]:[]))}).getOr({})}}),Hx=[$n("invalidClass"),fe("getRoot",st.none),le("notify",[fe("aria","alert"),fe("getContainer",st.none),fe("validHtml",""),xa("onValid"),xa("onInvalid"),xa("onValidate")]),le("validator",[$n("validate"),fe("onEvent","input"),fe("validateOnLoad",!0)])],zx=mc({fields:Hx,name:"invalidating",active:Px,apis:Vx,extra:{validation:function(e){return function(t){var n=ql.getValue(t);return Dx(e(n))}}}}),Nx=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Lx=[Qn("others",Rn(vt.value,jn()))],jx=mc({fields:Lx,name:"coupling",apis:Nx,state:Object.freeze({__proto__:null,init:function(){var i={},t=it({});return Bi({readState:t,getOrCreate:function(e,o,r){var t=It(o.others);if(t)return Ut(i,r).getOrThunk(function(){var t=Ut(o.others,r).getOrDie("No information found for coupled component: "+r)(e),n=e.getSystem().build(t);return i[r]=n});throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),Ux=it("sink"),Wx=it(Tf({name:Ux(),overrides:it({dom:{tag:"div"},behaviours:fc([ul.config({useFixed:S})]),events:sr([vr(ko()),vr(ho()),vr(To())])})}));(Sx=wx=wx||{})[Sx.HighlightFirst=0]="HighlightFirst",Sx[Sx.HighlightNone=1]="HighlightNone";var Gx,Xx,Yx,qx,Kx,Jx,$x,Qx,Zx,tw,nw,ew,ow,rw=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})},iw=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h,v=rw(t,e);return(c=v,l=o,f=r,d=u,m=n,g=s=e,p=(0,(a=t).fetch)(g).map(m),h=sw(s,a),p.map(function(t){return t.bind(function(t){return st.from(ap.sketch(ct(ct({},f.menu()),{uid:xi(""),data:t,highlightImmediately:d===wx.HighlightFirst,onOpenMenu:function(t,n){var e=h().getOrDie();ul.position(e,c,n),El.decloak(l)},onOpenSubmenu:function(t,n,e){var o=h().getOrDie();ul.position(o,{anchor:"submenu",item:n},e),El.decloak(l)},onRepositionMenu:function(t,n,e){var o=h().getOrDie();ul.position(o,c,n),ft(e,function(t){ul.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return Og.focus(s),El.close(l),st.some(!0)}})))})})).map(function(t){return t.fold(function(){El.isOpen(o)&&El.close(o)},function(t){El.cloak(o),El.open(o,t),i(o)}),o})},uw=function(t,n,e,o){return El.close(o),Dx(o)},aw=function(t,n,e,o,r,i){var u=jx.getCoupled(e,"sandbox");return(El.isOpen(u)?uw:iw)(t,n,e,u,o,r,i)},cw=function(t,n,e){var o,r,i=ud.getCurrent(n).getOr(n),u=Ru(t.element);e?ou(i.element,"min-width",u+"px"):(o=i.element,r=u,Iu.set(o,r))},sw=function(n,t){return n.getSystem().getByUid(t.uid+"-"+Ux()).map(function(t){return function(){return vt.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return vt.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},lw=function(t){El.getState(t).each(function(t){ap.repositionMenus(t)})},fw=function(o,r,i){var u=oa(),t=sw(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id,role:"listbox"}},behaviours:Zl(o.sandboxBehaviours,[ql.config({store:{mode:"memory",initialValue:r}}),El.config({onOpen:function(t,n){var e=rw(o,r);u.link(r.element),o.matchWidth&&cw(e.hotspot,n,o.useMinWidth),o.onOpen(e,t,n),i!==undefined&&i.onOpen!==undefined&&i.onOpen(t,n)},onClose:function(t,n){u.unlink(r.element),i!==undefined&&i.onClose!==undefined&&i.onClose(t,n)},isPartOf:function(t,n,e){return ia(n,e)||ia(r,e)},getAttachPoint:function(){return t().getOrDie()}}),ud.config({find:function(t){return El.getState(t).bind(function(t){return ud.getCurrent(t)})}}),vc.config({channels:ct(ct({},Fl({isExtraPart:p})),Rl({doReposition:lw}))})])}},dw=function(t){var n=jx.getCoupled(t,"sandbox");lw(n)},mw=function(){return[fe("sandboxClasses",[]),Ql("sandboxBehaviours",[ud,vc,El,ql])]},gw=it([$n("dom"),$n("fetch"),xa("onOpen"),wa("onExecute"),fe("getHotspot",st.some),fe("getAnchorOverrides",it({})),ns(),Kl("dropdownBehaviours",[Pg,jx,gg,Og]),$n("toggleClass"),fe("eventOrder",{}),ie("lazySink"),fe("matchWidth",!1),fe("useMinWidth",!1),ie("role")].concat(mw())),pw=it([_f({schema:[va()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Wx()]),hw=td({name:"Dropdown",configFields:gw(),partFields:pw(),factory:function(n,t,e,o){var r,i,u=function(t){El.getState(t).each(function(t){ap.highlightPrimary(t)})},a={expand:function(t){Pg.isOn(t)||aw(n,function(t){return t},t,o,at,wx.HighlightNone).get(at)},open:function(t){Pg.isOn(t)||aw(n,function(t){return t},t,o,at,wx.HighlightFirst).get(at)},isOpen:Pg.isOn,close:function(t){Pg.isOn(t)&&aw(n,function(t){return t},t,o,at,wx.HighlightFirst).get(at)},repositionMenus:function(t){Pg.isOn(t)&&dw(t)}},c=function(t){return ir(t),st.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:$l(n.dropdownBehaviours,[Pg.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),jx.config({others:{sandbox:function(t){return fw(n,t,{onOpen:function(){return Pg.on(t)},onClose:function(){return Pg.off(t)}})}}}),gg.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){var n;return hw.isOpen(t)?(n=jx.getCoupled(t,"sandbox"),u(n)):hw.open(t),st.some(!0)},onEscape:function(t){return hw.isOpen(t)?(hw.close(t),st.some(!0)):st.none()}}),Og.config({})]),events:zg(st.some(function(t){aw(n,function(t){return t},t,o,u,wx.HighlightFirst).get(at)})),eventOrder:ct(ct({},n.eventOrder),((r={})[Vo()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:a,domModification:{attributes:ct(ct({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}})),"button"===n.dom.tag?{type:(i="type",Ut(n.dom,"attributes").bind(function(t){return Ut(t,i)}).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),vw=mc({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return sr([lr(Do(),S)])},exhibit:function(){return Mi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),bw=mi("color-input-change"),yw=mi("color-swatch-change"),xw=mi("color-picker-cancel"),ww=function(e,n,o){var r,i,t=Jy.parts.field({factory:bx,inputClasses:["tox-textfield"],onSetValue:function(t){return zx.run(t).get(at)},inputBehaviours:fc([yv.config({disabled:n.providers.isDisabled}),qv(),Zy.config({}),zx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Fr(t.element)},notify:{onValid:function(t){var n=ql.getValue(t);rr(t,bw,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=ql.getValue(t);if(0===n.length)return Dx(vt.value(!0));var e=ke.fromTag("span");ou(e,"background-color",n);var o=cu(e,"background-color").fold(function(){return vt.error("blah")},function(){return vt.value(n)});return Dx(o)}}})]),selectOnFocus:!1}),u=e.label.map(function(t){return rx(t,n.providers)}),a=function(t,n){rr(t,yw,{value:n})},c=Sp((r={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Ga,Wa,Ka]},onLtr:function(){return[Wa,Ga,Ka]}},components:[],fetch:Zb(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,e){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return or(n,xw)},function(t){a(n,t),qb(t)})},"#ffffff"):a(n,"remove"===e?"":e)})}},i=n,hw.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:fc([Jv(i.providers.isDisabled),qv(),vw.config({}),Zy.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(n){return Ex(function(t){return r.fetch(t)}).map(function(t){return st.from(Oy(Kt(ry(mi("menu-value"),t,function(t){r.onItemAction(n,t)},r.columns,r.presets,fh.CLOSE_ON_EXECUTE,p,i.providers),{movement:uy(r.columns,r.presets)})))})},parts:{menu:_h(0,0,r.presets)}})));return Jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:fc([xg("form-field-events",[dr(bw,function(t,n){c.getOpt(t).each(function(t){ou(t.element,"background-color",n.event.color)}),rr(t,ix,{name:e.name})}),dr(yw,function(n,e){Jy.getField(n).each(function(t){ql.setValue(t,e.event.value),ud.getCurrent(n).each(Og.focus)})}),dr(xw,function(t){Jy.getField(t).each(function(){ud.getCurrent(t).each(Og.focus)})})])])})},Sw=function(t,n,e){return{hue:t,saturation:n,value:e}},kw=mi("rgb-hex-update"),Cw=mi("slider-update"),Ow=mi("palette-update"),_w=Tf({schema:[$n("dom")],name:"label"}),Tw=function(n){return Tf({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(o){return{events:sr([mr(fo(),function(t,n,e){return o(t,e)},[t]),mr(ho(),function(t,n,e){return o(t,e)},[t]),mr(vo(),function(t,n,e){e.mouseIsDown.get()&&o(t,e)},[t])])}})}})},Ew=Tw("top-left"),Dw=Tw("top"),Bw=Tw("top-right"),Aw=Tw("right"),Mw=Tw("bottom-right"),Fw=Tw("bottom"),Iw=Tw("bottom-left"),Rw=[_w,Tw("left"),Aw,Dw,Fw,Ew,Bw,Iw,Mw,Of({name:"thumb",defaults:it({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:sr([pr(fo(),t,"spectrum"),pr(mo(),t,"spectrum"),pr(go(),t,"spectrum"),pr(ho(),t,"spectrum"),pr(vo(),t,"spectrum"),pr(yo(),t,"spectrum")])}}}),Of({schema:[xe("mouseIsDown",function(){return we(!1)})],name:"spectrum",overrides:function(e){var o=e.model.manager,r=function(n,t){return o.getValueFromEvent(t).map(function(t){return o.setValueFrom(n,e,t)})};return{behaviours:fc([gg.config({mode:"special",onLeft:function(t){return o.onLeft(t,e)},onRight:function(t){return o.onRight(t,e)},onUp:function(t){return o.onUp(t,e)},onDown:function(t){return o.onDown(t,e)}}),Og.config({})]),events:sr([dr(fo(),r),dr(mo(),r),dr(ho(),r),dr(vo(),function(t,n){e.mouseIsDown.get()&&r(t,n)})])}}})],Vw=it("slider.change.value"),Pw=function(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?n.clientX!==undefined?st.some(n).map(function(t){return Bu(t.clientX,t.clientY)}):st.none():n.touches!==undefined&&1===n.touches.length?st.some(n.touches[0]).map(function(t){return Bu(t.clientX,t.clientY)}):st.none()},Hw=function(t){return t.model.minX},zw=function(t){return t.model.minY},Nw=function(t){return t.model.minX-1},Lw=function(t){return t.model.minY-1},jw=function(t){return t.model.maxX},Uw=function(t){return t.model.maxY},Ww=function(t){return t.model.maxX+1},Gw=function(t){return t.model.maxY+1},Xw=function(t,n,e){return n(t)-e(t)},Yw=function(t){return Xw(t,jw,Hw)},qw=function(t){return Xw(t,Uw,zw)},Kw=function(t){return Yw(t)/2},Jw=function(t){return qw(t)/2},$w=function(t){return t.stepSize},Qw=function(t){return t.snapToGrid},Zw=function(t){return t.snapStart},tS=function(t){return t.rounded},nS=function(t,n){return t[n+"-edge"]!==undefined},eS=function(t){return nS(t,"left")},oS=function(t){return nS(t,"right")},rS=function(t){return nS(t,"top")},iS=function(t){return nS(t,"bottom")},uS=function(t){return t.model.value.get()},aS=function(t){return{x:t}},cS=function(t){return{y:t}},sS=function(t,n){return{x:t,y:n}},lS=function(t,n){rr(t,Vw(),{value:n})},fS=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},dS=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},mS=function(t,n,e){return Math.max(n,Math.min(e,t))},gS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=mS(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold(function(){var t=h-v,n=Math.round(t/y)*y;return mS(v+n,v-1,b+1)},function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)})):c?Math.round(C):C},pS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},hS="left",vS=function(t){return t.element.dom.getBoundingClientRect()},bS=function(t,n){return t[n]},yS=function(t){var n=vS(t);return bS(n,hS)},xS=function(t){var n=vS(t);return bS(n,"right")},wS=function(t){var n=vS(t);return bS(n,"top")},SS=function(t){var n=vS(t);return bS(n,"bottom")},kS=function(t){var n=vS(t);return bS(n,"width")},CS=function(t){var n=vS(t);return bS(n,"height")},OS=function(t,n,e){return(t+n)/2-e},_S=function(t,n){var e=vS(t),o=vS(n),r=bS(e,hS),i=bS(e,"right"),u=bS(o,hS);return OS(r,i,u)},TS=function(t,n){var e=vS(t),o=vS(n),r=bS(e,"top"),i=bS(e,"bottom"),u=bS(o,"top");return OS(r,i,u)},ES=function(t,n){rr(t,Vw(),{value:n})},DS=function(t){return{x:t}},BS=function(t,n,e){var o={min:Hw(n),max:jw(n),range:Yw(n),value:e,step:$w(n),snap:Qw(n),snapStart:Zw(n),rounded:tS(n),hasMinEdge:eS(n),hasMaxEdge:oS(n),minBound:yS(t),maxBound:xS(t),screenRange:kS(t)};return gS(o)},AS=function(i){return function(t,n){return e=t,r=(0<i?dS:fS)(uS(o=n).x,Hw(o),jw(o),$w(o)),ES(e,DS(r)),st.some(r).map(S);var e,o,r}},MS=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=kS(u=n),d=s.bind(function(t){return st.some(_S(t,u))}).getOr(0),m=l.bind(function(t){return st.some(_S(t,u))}).getOr(f),g={min:Hw(a),max:jw(a),range:Yw(a),value:c,hasMinEdge:eS(a),hasMaxEdge:oS(a),minBound:yS(u),minOffset:0,maxBound:xS(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},pS(g));return yS(n)-yS(t)+p},FS=AS(-1),IS=AS(1),RS=st.none,VS=st.none,PS={"top-left":st.none(),top:st.none(),"top-right":st.none(),right:st.some(function(t,n){lS(t,aS(Ww(n)))}),"bottom-right":st.none(),bottom:st.none(),"bottom-left":st.none(),left:st.some(function(t,n){lS(t,aS(Nw(n)))})},HS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=BS(t,n,e),r=DS(o);return ES(t,r),o},setToMin:function(t,n){var e=Hw(n);ES(t,DS(e))},setToMax:function(t,n){var e=jw(n);ES(t,DS(e))},findValueOfOffset:BS,getValueFromEvent:function(t){return Pw(t).map(function(t){return t.left})},findPositionOfValue:MS,setPositionFromValue:function(t,n,e,o){var r=uS(e),i=MS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Ru(n.element)/2;ou(n.element,"left",i-u+"px")},onLeft:FS,onRight:IS,onUp:RS,onDown:VS,edgeActions:PS}),zS=function(t,n){rr(t,Vw(),{value:n})},NS=function(t){return{y:t}},LS=function(t,n,e){var o={min:zw(n),max:Uw(n),range:qw(n),value:e,step:$w(n),snap:Qw(n),snapStart:Zw(n),rounded:tS(n),hasMinEdge:rS(n),hasMaxEdge:iS(n),minBound:wS(t),maxBound:SS(t),screenRange:CS(t)};return gS(o)},jS=function(i){return function(t,n){return e=t,r=(0<i?dS:fS)(uS(o=n).y,zw(o),Uw(o),$w(o)),zS(e,NS(r)),st.some(r).map(S);var e,o,r}},US=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=CS(u=n),d=s.bind(function(t){return st.some(TS(t,u))}).getOr(0),m=l.bind(function(t){return st.some(TS(t,u))}).getOr(f),g={min:zw(a),max:Uw(a),range:qw(a),value:c,hasMinEdge:rS(a),hasMaxEdge:iS(a),minBound:wS(u),minOffset:0,maxBound:SS(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},pS(g));return wS(n)-wS(t)+p},WS=st.none,GS=st.none,XS=jS(-1),YS=jS(1),qS={"top-left":st.none(),top:st.some(function(t,n){lS(t,cS(Lw(n)))}),"top-right":st.none(),right:st.none(),"bottom-right":st.none(),bottom:st.some(function(t,n){lS(t,cS(Gw(n)))}),"bottom-left":st.none(),left:st.none()},KS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=LS(t,n,e),r=NS(o);return zS(t,r),o},setToMin:function(t,n){var e=zw(n);zS(t,NS(e))},setToMax:function(t,n){var e=Uw(n);zS(t,NS(e))},findValueOfOffset:LS,getValueFromEvent:function(t){return Pw(t).map(function(t){return t.top})},findPositionOfValue:US,setPositionFromValue:function(t,n,e,o){var r=uS(e),i=US(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Tu(n.element)/2;ou(n.element,"top",i-u+"px")},onLeft:WS,onRight:GS,onUp:XS,onDown:YS,edgeActions:qS}),JS=function(t,n){rr(t,Vw(),{value:n})},$S=function(t,n){return{x:t,y:n}},QS=function(c,s){return function(t,n){return o=t,r=n,i=0<c?dS:fS,u=(e=s)?uS(r).x:i(uS(r).x,Hw(r),jw(r),$w(r)),a=e?i(uS(r).y,zw(r),Uw(r),$w(r)):uS(r).y,JS(o,$S(u,a)),st.some(u).map(S);var e,o,r,i,u,a}},ZS=Pw,tk=QS(-1,!1),nk=QS(1,!1),ek=QS(-1,!0),ok=QS(1,!0),rk={"top-left":st.some(function(t,n){lS(t,sS(Nw(n),Lw(n)))}),top:st.some(function(t,n){lS(t,sS(Kw(n),Lw(n)))}),"top-right":st.some(function(t,n){lS(t,sS(Ww(n),Lw(n)))}),right:st.some(function(t,n){lS(t,sS(Ww(n),Jw(n)))}),"bottom-right":st.some(function(t,n){lS(t,sS(Ww(n),Gw(n)))}),bottom:st.some(function(t,n){lS(t,sS(Kw(n),Gw(n)))}),"bottom-left":st.some(function(t,n){lS(t,sS(Nw(n),Gw(n)))}),left:st.some(function(t,n){lS(t,sS(Nw(n),Jw(n)))})},ik=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=BS(t,n,e.left),r=LS(t,n,e.top),i=$S(o,r);return JS(t,i),i},setToMin:function(t,n){var e=Hw(n),o=zw(n);JS(t,$S(e,o))},setToMax:function(t,n){var e=jw(n),o=Uw(n);JS(t,$S(e,o))},getValueFromEvent:ZS,setPositionFromValue:function(t,n,e,o){var r=uS(e),i=MS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=US(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Ru(n.element)/2,c=Tu(n.element)/2;ou(n.element,"left",i-a+"px"),ou(n.element,"top",u-c+"px")},onLeft:tk,onRight:nk,onUp:ek,onDown:ok,edgeActions:rk}),uk=td({name:"Slider",configFields:[fe("stepSize",1),fe("onChange",at),fe("onChoose",at),fe("onInit",at),fe("onDragStart",at),fe("onDragEnd",at),fe("snapToGrid",!1),fe("rounded",!0),ie("snapStart"),Qn("model",Ln("mode",{x:[fe("minX",0),fe("maxX",100),xe("value",function(t){return we(t.mode.minX)}),$n("getInitialValue"),Ca("manager",HS)],y:[fe("minY",0),fe("maxY",100),xe("value",function(t){return we(t.mode.minY)}),$n("getInitialValue"),Ca("manager",KS)],xy:[fe("minX",0),fe("maxX",100),fe("minY",0),fe("maxY",100),xe("value",function(t){return we({x:t.mode.minX,y:t.mode.minY})}),$n("getInitialValue"),Ca("manager",ik)]})),Kl("sliderBehaviours",[gg,ql]),xe("mouseIsDown",function(){return we(!1)})],partFields:Rw,factory:function(r,t){var n,i=function(t){return Nf(t,r,"thumb")},u=function(t){return Nf(t,r,"spectrum")},e=function(t){return zf(t,r,"left-edge")},o=function(t){return zf(t,r,"right-edge")},a=function(t){return zf(t,r,"top-edge")},c=function(t){return zf(t,r,"bottom-edge")},s=r.model,l=s.manager,f=function(t,n){l.setPositionFromValue(t,n,r,{getLeftEdge:e,getRightEdge:o,getTopEdge:a,getBottomEdge:c,getSpectrum:u})},d=function(t,n){s.value.set(n);var e=i(t);return f(t,e),r.onChange(t,e,n),st.some(!0)},m=function(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&zf(e,r,"thumb").each(function(t){var n=s.value.get();r.onChoose(e,t,n)})},g=function(t,n){n.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))},p=function(t,n){n.stop(),r.onDragEnd(t,i(t)),m(t)};return{uid:r.uid,dom:r.dom,components:t,behaviours:$l(r.sliderBehaviours,[gg.config({mode:"special",focusIn:function(t){return zf(t,r,"spectrum").map(gg.focusIn).map(S)}}),ql.config({store:{mode:"manual",getValue:function(){return s.value.get()}}}),vc.config({channels:((n={})[Al()]={onReceive:m},n)})]),events:sr([dr(Vw(),function(t,n){d(t,n.event.value)}),yr(function(t){var n=s.getInitialValue();s.value.set(n);var e=i(t);f(t,e);var o=u(t);r.onInit(t,e,o,s.value.get())}),
dr(fo(),g),dr(go(),p),dr(ho(),g),dr(yo(),p)]),apis:{resetToMin:function(t){l.setToMin(t,r)},resetToMax:function(t){l.setToMax(t,r)},changeValue:d,refresh:f},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),ak=[Kl("formBehaviours",[ql])],ck=function(t){return"<alloy.field."+t+">"},sk=function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:$l(o.formBehaviours,[ql.config({store:{mode:"manual",getValue:function(t){var n=jf(t,o);return Pt(n,function(t,o){return t().bind(function(t){var n,e;return n=ud.getCurrent(t),e=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+si(t.element)),n.fold(function(){return vt.error(e)},vt.value)}).map(ql.getValue)})},setValue:function(e,t){Vt(t,function(n,t){zf(e,o,t).each(function(t){ud.getCurrent(t).each(function(t){ql.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return zf(t,o,n).bind(ud.getCurrent)}}}},lk={getField:Ei(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var e,n=(e=[],{field:function(t,n){return e.push(t),If("form",ck(t),n)},record:function(){return e}}),o=t(n),r=n.record(),i=W(r,function(t){return Of({name:t,pname:ck(t)})});return Kf("form",ak,i,sk,o)}},fk=mi("valid-input"),dk=mi("invalid-input"),mk=mi("validating-input"),gk="colorcustom.rgb.",pk=function(d,m,g,p){var h=function(t,n,e,o,r){var i,u,a=d(gk+"range"),c=[Jy.parts.label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),Jy.parts.field({data:r,factory:bx,inputAttributes:ct({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:fc([(i=n,u=t,zx.config({invalidClass:m("invalid"),notify:{onValidate:function(t){rr(t,mk,{type:i})},onValid:function(t){rr(t,fk,{type:i,value:ql.getValue(t)})},onInvalid:function(t){rr(t,dk,{type:i,value:ql.getValue(t)})}},validator:{validate:function(t){var n=ql.getValue(t),e=u(n)?vt.value(!0):vt.error(d("aria.input.invalid"));return Dx(e)},validateOnLoad:!1}})),Zy.config({})]),onSetValue:function(t){zx.isInvalid(t)&&zx.run(t).get(at)}})],s="hex"!==n?[Jy.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:c.concat(s)}},v=function(t,n){var e=n.red,o=n.green,r=n.blue;ql.setValue(t,{red:e,green:o,blue:r})},b=Sp({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),y=function(t,n){b.getOpt(t).each(function(t){ou(t.element,"background-color","#"+n.value)})};return Zf({factory:function(){var e={red:we(st.some(255)),green:we(st.some(255)),blue:we(st.some(255)),hex:we(st.some("ffffff"))},o=function(t){return e[t].get()},i=function(t,n){e[t].set(n)},r=function(t){var n=t.red,e=t.green,o=t.blue;i("red",st.some(n)),i("green",st.some(e)),i("blue",st.some(o))},n=function(t,n){var e=n.event;"hex"!==e.type?i(e.type,st.none()):p(t)},u=function(r,t,n){var e=parseInt(n,10);i(t,st.some(e)),o("red").bind(function(e){return o("green").bind(function(n){return o("blue").map(function(t){return Fb(e,n,t,1)})})}).each(function(t){var n,e,o=(n=r,e=Tb(t),lk.getField(n,"hex").each(function(t){Og.isFocused(t)||ql.setValue(n,{hex:e.value})}),e);y(r,o)})},a=function(t,n){var e=n.event;"hex"===e.type?function(t,n){g(t);var e=wb(n);i("hex",st.some(n));var o=Vb(e);v(t,o),r(o),rr(t,kw,{hex:e}),y(t,e)}(t,e.value):u(t,e.type,e.value)},t=function(t){return{label:d(gk+t+".label"),description:d(gk+t+".description")}},c=t("red"),s=t("green"),l=t("blue"),f=t("hex");return Kt(lk.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",Jy.sketch(h(Ib,"red",c.label,c.description,255))),t.field("green",Jy.sketch(h(Ib,"green",s.label,s.description,255))),t.field("blue",Jy.sketch(h(Ib,"blue",l.label,l.description,255))),t.field("hex",Jy.sketch(h(Cb,"hex",f.label,f.description,"ffffff"))),b.asSpec()],formBehaviours:fc([zx.config({invalidClass:m("form-invalid")}),xg("rgb-form-events",[dr(fk,a),dr(dk,n),dr(mk,n)])])}}),{apis:{updateHex:function(t,n){var e,o;ql.setValue(t,{hex:n.value}),e=t,o=Vb(n),v(e,o),r(o),y(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},hk=function(t,e){var o=uk.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[e("sv-palette-spectrum")]}}),r=uk.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette-thumb")],innerHtml:"<div class="+e("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))};return Zf({factory:function(){var t=it({x:0,y:0}),n=fc([ud.config({find:st.some}),Og.config({})]);return uk.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[o,r],onChange:function(t,n,e){rr(t,Ow,{value:e})},onInit:function(t,n,e){i(e.element.dom,Hb(zb))},sliderBehaviours:n})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element.dom,i(r,Hb(o))}},extraApis:{}})},vk=function(f,d){return Zf({name:"ColourPicker",configFields:[$n("dom"),fe("onValidHex",at),fe("onInvalidHex",at)],factory:function(t){var u,h,n,e,o,r=pk(f,d,t.onValidHex,t.onInvalidHex),i=hk(0,d),v={paletteRgba:we(zb)},a=Sp(i.sketch({})),c=Sp(r.sketch({})),s=function(t,e){a.getOpt(t).each(function(t){var n=Vb(e);v.paletteRgba.set(n),i.setRgba(t,n)})},l=function(t,n){c.getOpt(t).each(function(t){r.updateHex(t,n)})},b=function(n,e,t){ft(t,function(t){t(n,e)})};return{uid:t.uid,dom:t.dom,components:[a.asSpec(),(n=d,e=uk.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=uk.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}}),uk.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:it({y:0})},components:[e,o],sliderBehaviours:fc([Og.config({})]),onChange:function(t,n,e){rr(t,Cw,{value:e})}})),c.asSpec()],behaviours:fc([xg("colour-picker-events",[dr(Ow,(h=[l],function(t,n){var e,o,r,i,u,a,c,s,l,f=n.event.value,d=(i=r=0,u=(e=v.paletteRgba.get()).red/255,a=e.green/255,c=e.blue/255,(s=Math.min(u,Math.min(a,c)))===(l=Math.max(u,Math.max(a,c)))?Sw(0,0,100*(i=s)):(r=60*((r=u===s?3:c===s?1:5)-(u===s?a-c:c===s?u-a:c-u)/(l-s)),o=(l-s)/l,i=l,Sw(Math.round(r),Math.round(100*o),Math.round(100*i)))),m=Sw(d.hue,f.x,100-f.y),g=Rb(m),p=Tb(g);b(t,p,h)})),dr(Cw,(u=[s,l],function(t,n){var e,o,r,i=(e=n.event.value.y,o=Sw((100-e)/100*360,100,100),r=Rb(o),Tb(r));b(t,i,u)}))]),ud.config({find:function(t){return c.getOpt(t)}}),gg.config({mode:"acyclic"})])}}})},bk=function(){return ud.config({find:st.some})},yk=function(t){return ud.config({find:t.getOpt})},xk=function(t){return ud.config({find:function(n){return Pr(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})},wk={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Sk=function(t){return wk[t]},kk=tinymce.util.Tools.resolve("tinymce.Resource"),Ck=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ok=wn([fe("preprocess",ut),fe("postprocess",ut)]),_k=function(t,n,e){return ql.config(Kt({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},Tk=function(t,n,e){return _k(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},Ek=function(r,t){var i=Hn("RepresentingConfigs.memento processors",Ok,t);return ql.config({store:{mode:"manual",getValue:function(t){var n=r.get(t),e=ql.getValue(n);return i.postprocess(e)},setValue:function(t,n){var e=i.preprocess(n),o=r.get(t);ql.setValue(o,e)}}})},Dk=_k,Bk=function(t){return Tk(t,ti,ni)},Ak=function(t){return ql.config({store:{mode:"memory",initialValue:t}})},Mk=function(i,u){var n=function(t,n){n.stop()},e=function(t){return function(n,e){ft(t,function(t){t(n,e)})}},o=function(t,n){var e;yv.isDisabled(t)||(e=n.event.raw,a(t,e.dataTransfer.files))},r=function(t,n){var e=n.event.raw.target;a(t,e.files)},a=function(t,n){var e,o,r;ql.setValue(t,(e=n,o=u,r=Ck.explode(o.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),X(mt(e),function(n){return L(r,function(t){return Me(n.name.toLowerCase(),"."+t.toLowerCase())})}))),rr(t,ix,{name:i.name})},c=Sp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:fc([xg("input-file-events",[vr(To()),vr(Ho())])])}),t=i.label.map(function(t){return rx(t,u)}),s=Jy.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:fc([Ak([]),bk(),yv.config({}),Pg.config({toggleClass:"dragenter",toggleOnExecute:!1}),xg("dropzone-events",[dr("dragenter",e([n,Pg.toggle])),dr("dragleave",e([n,Pg.toggle])),dr("dragover",n),dr("drop",e([n,o])),dr(_o(),r)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:u.translate("Drop an image here")}},wp.sketch({dom:{tag:"button",innerHtml:u.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element.dom.click()},buttonBehaviours:fc([Zy.config({}),Jv(u.isDisabled),qv()])})]}]}}}});return nx(t,s,["tox-form__group--stretched"],[])},Fk=mi("alloy-fake-before-tabstop"),Ik=mi("alloy-fake-after-tabstop"),Rk=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:fc([Og.config({ignore:!0}),Zy.config({})])}},Vk=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Rk([Fk]),t,Rk([Ik])],behaviours:fc([xk(1)])}},Pk=function(t,n){rr(t,ko(),{raw:{which:9,shiftKey:n}})},Hk=function(t,n){var e=n.element;qi(e,Fk)?Pk(t,!0):qi(e,Ik)&&Pk(t,!1)},zk=function(t){return Ay(t,["."+Fk,"."+Ik].join(","),p)},Nk=!(Qe().browser.isIE()||Qe().browser.isEdge()),Lk=function(t,n){var o,r,e=Nk&&t.sandboxed,i=ct(ct({},t.label.map(function(t){return{title:t}}).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(o=e,r=we(""),{getValue:function(){return r.get()},setValue:function(t,n){var e;o?oi(t.element,"srcdoc",n):(oi(t.element,"src","javascript:''"),(e=t.element.dom.contentWindow.document).open(),e.write(n),e.close()),r.set(n)}}),a=t.label.map(function(t){return rx(t,n)}),c=Jy.parts.field({factory:{sketch:function(t){return Vk({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:fc([Zy.config({}),Og.config({}),Dk(st.none(),u.getValue,u.setValue)])})}}});return nx(a,c,["tox-form__group--stretched"],[])},jk=function(t,n){return Gk(document.createElement("canvas"),t,n)},Uk=function(t){var n=jk(t.width,t.height);return Wk(n).drawImage(t,0,0),n},Wk=function(t){return t.getContext("2d")},Gk=function(t,n,e){return t.width=n,t.height=e,t},Xk=function(t){return t.naturalWidth||t.width},Yk=function(t){return t.naturalHeight||t.height},qk=window.Promise?window.Promise:(Gx=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Jx(t,qx(e,this),qx(r,this))},Xx=window,Yx=Gx.immediateFn||"function"==typeof Xx.setImmediate&&Xx.setImmediate||function(t){return setTimeout(t,1)},qx=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(o,t)}},Kx=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jx=function(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(f){if(o)return;o=!0,e(f)}},Gx.prototype["catch"]=function(t){return this.then(null,t)},Gx.prototype.then=function(e,o){var r=this;return new Gx(function(t,n){i.call(r,new c(e,o,t,n))})},Gx.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=Array.prototype.slice.call(1===t.length&&Kx(t[0])?t[0]:t);return new Gx(function(o,r){if(0===a.length)return o([]);for(var i=a.length,u=function(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){u(n,t)},r)}a[n]=t,0==--i&&o(a)}catch(l){r(l)}},t=0;t<a.length;t++)u(t,a[t])})},Gx.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Gx?n:new Gx(function(t){t(n)})},Gx.reject=function(e){return new Gx(function(t,n){n(e)})},Gx.race=function(r){return new Gx(function(t,n){for(var e=0,o=r;e<o.length;e++)o[e].then(t,n)})},Gx),Kk=function(g){return new qk(function(t,n){(function(){var t=g.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return st.none();for(var e=n[1],o=t[1],r=atob(o),i=r.length,u=Math.ceil(i/1024),a=new Array(u),c=0;c<u;++c){for(var s=1024*c,l=Math.min(1024+s,i),f=new Array(l-s),d=s,m=0;d<l;++m,++d)f[m]=r[d].charCodeAt(0);a[c]=new Uint8Array(f)}return st.some(new Blob(a,{type:e}))})().fold(function(){n("uri is not base64: "+g)},t)})},Jk=function(t,o,r){return o=o||"image/png",I(HTMLCanvasElement.prototype.toBlob)?new qk(function(n,e){t.toBlob(function(t){t?n(t):e()},o,r)}):Kk(t.toDataURL(o,r))},$k=function(t){return a=t,new qk(function(t,n){var e=URL.createObjectURL(a),o=new Image,r=function(){o.removeEventListener("load",i),o.removeEventListener("error",u)},i=function(){r(),t(o)},u=function(){r(),n("Unable to load data of type "+a.type+": "+e)};o.addEventListener("load",i),o.addEventListener("error",u),o.src=e,o.complete&&setTimeout(i,0)}).then(function(t){Qk(t);var n=jk(Xk(t),Yk(t));return Wk(n).drawImage(t,0,0),n});var a},Qk=function(t){URL.revokeObjectURL(t.src)},Zk=function(t,n,e){var o=n.type,r=it(o),i=it(e),u=function(o,r){return t.then(function(t){return e=r,n=(n=o)||"image/png",t.toDataURL(n,e);var n,e})};return{getType:r,toBlob:function(){return qk.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return Jk(t,n,e)})},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(Uk)}}},tC=function(n,t){return Jk(n,t).then(function(t){return Zk(qk.resolve(n),t,n.toDataURL())})},nC=function(n){return e=n,new qk(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}).then(function(t){return Zk($k(n),n,t)});var e},eC=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o},oC=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},rC=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],iC=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},uC=function(n,e){return n.toCanvas().then(function(t){return aC(t,n.getType(),e)})},aC=function(t,n,e){var o=Wk(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),tC(t,n)},cC=function(t,n,e){var o=Wk(t),r=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),r=o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),tC(t,n)},sC=function(e){return function(t,n){return uC(t,e(oC(),n))}},lC=($x=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return uC(t,$x)}),fC=sC(function(t,n){return n=eC(255*n,-255,255),iC(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),dC=sC(function(t,n){var e;return n=eC(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?rC[n]:rC[Math.floor(n)]*(1-e)+rC[Math.floor(n)+1]*e)+127,iC(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),mC=(Qx=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=Qx,(n=t).toCanvas().then(function(t){return cC(t,n.getType(),e)});var n,e}),gC=(Zx=function(t,n){return 255*Math.pow(t/255,1-n)},function(n,e){return n.toCanvas().then(function(t){return function(t,n,e){for(var o=Wk(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Zx(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),tC(t,n)}(t,n.getType(),e)})}),pC=function(t,n,e){var o=Xk(t),r=Yk(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=hC(t,i,u);return a?c.then(function(t){return pC(t,n,e)}):c},hC=function(u,a,c){return new qk(function(t){var n=Xk(u),e=Yk(u),o=Math.floor(n*a),r=Math.floor(e*c),i=jk(o,r);Wk(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)})},vC=function(t,n,e){var o=jk(t.width,t.height),r=Wk(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||Gk(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),tC(o,n)},bC=function(t,n,e){var o=jk(t.width,t.height),r=Wk(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),tC(o,n)},yC=function(t,n,e,o,r,i){var u=jk(r,i);return Wk(u).drawImage(t,-e,-o),tC(u,n)},xC=function(t){return lC(t)},wC=function(t){return mC(t)},SC=function(t,n){return gC(t,n)},kC=function(t,n,e,o){return uC(t,(r=oC(),u=e,a=o,i=eC(i=n,0,2),u=eC(u,0,2),a=eC(a,0,2),iC(r,[i,0,0,0,0,0,u,0,0,0,0,0,a,0,0,0,0,0,1,0,0,0,0,0,1])));var r,i,u,a},CC=function(t,n){return fC(t,n)},OC=function(t,n){return dC(t,n)},_C=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return bC(t,e.getType(),o)});var e,o},TC=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then(function(t){return yC(t,i.getType(),u,a,c,s)});var i,u,a,c,s},EC=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return pC(t,r,i).then(function(t){return tC(t,o.getType())})});var o,r,i},DC=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return vC(t,e.getType(),o)});var e,o},BC=function(t,n){return ct({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},AC=function(t,n){return BC(Cp(t,n),{})},MC=function(t,n){return BC(Cp(t,n),{behaviours:fc([yg.config({})])})},FC=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:fc([yg.config({})])}},IC=mi("toolbar.button.execute"),RC=((tw={})[Vo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],tw),VC=mi("update-menu-text"),PC=mi("update-menu-icon"),HC=function(n,e,o){var t=we(at),r=n.text.map(function(t){return Sp(FC(t,e,o.providers))}),i=n.icon.map(function(t){return Sp(MC(t,o.providers.icons))}),u=function(t,n){var e=ql.getValue(t);return Og.focus(e),rr(e,"keydown",{raw:n.event.raw}),hw.close(e),st.some(!0)},a=n.role.fold(function(){return{}},function(t){return{role:t}}),c=n.tooltip.fold(function(){return{}},function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}});return Sp(hw.sketch(ct(ct(ct({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[e,e+"--select"].concat(W(n.classes,function(t){return e+"--"+t})),attributes:ct({},c)},components:ob([i.map(function(t){return t.asSpec()}),r.map(function(t){return t.asSpec()}),st.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:Cp("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:fc(x(n.dropdownBehaviours,[Jv(function(){return n.disabled||o.providers.isDisabled()}),qv(),vw.config({}),yg.config({}),xg("dropdown-events",[tb(n,t),nb(n,t)]),xg("menubutton-update-display-text",[dr(VC,function(n,e){r.bind(function(t){return t.getOpt(n)}).each(function(t){yg.set(t,[xu(o.providers.translate(e.event.text))])})}),dr(PC,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){yg.set(t,[MC(e.event.icon,o.providers.icons)])})})])])),eventOrder:Kt(RC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:fc([gg.config({mode:"special",onLeft:u,onRight:u})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:_h(0,n.columns,n.presets)},fetch:function(t){return Ex(b(n.fetch,t))}}))).asSpec()},zC=function(t){return"separator"===t.type},NC={type:"separator"},LC=function(t,e){var n=q(t,function(t,n){return E(n)?""===n?t:"|"===n?0<t.length&&!zC(t[t.length-1])?t.concat([NC]):t:Wt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[]);return 0<n.length&&zC(n[n.length-1])&&n.pop(),n},jC=function(t,n){return Wt(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=UC(r,o),{item:e,menus:Kt(i.menus,an(e.value,i.items)),expansions:Kt(i.expansions,an(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i},UC=function(t,r){var n=LC(E(t)?t.split(" "):t,r);return Y(n,function(t,n){var e=function(t){if(zC(t))return t;var n=Ut(t,"value").getOrThunk(function(){return mi("generated-menu-item")});return Kt({value:n},t)}(n),o=jC(e,r);return{menus:Kt(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Kt(t.expansions,o.expansions)}},{menus:{},expansions:{},items:[]})},WC=function(t,e,o,n){var r=mi("primary-menu"),i=UC(t,o.shared.providers.menuItems());if(0===i.items.length)return st.none();var u=Cy(r,i.items,e,o,n),a=Pt(i.menus,function(t,n){return Cy(n,t,e,o,!1)}),c=Kt(a,an(r,u));return st.from(ap.tieredData(r,c,i.expansions))},GC=function(e){return{isDisabled:function(){return yv.isDisabled(e)},setDisabled:function(t){return yv.set(e,t)},setActive:function(t){var n=e.element;t?(Gi(n,"tox-tbtn--enabled"),oi(n,"aria-pressed",!0)):(Yi(n,"tox-tbtn--enabled"),ai(n,"aria-pressed"))},isActive:function(){return qi(e.element,"tox-tbtn--enabled")}}},XC=function(e,t,o,n){return HC({text:e.text,icon:e.icon,tooltip:e.tooltip,role:n,fetch:function(t,n){e.fetch(function(t){n(WC(t,fh.CLOSE_ON_EXECUTE,o,!1))})},onSetup:e.onSetup,getApi:GC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Zy.config({})]},t,o.shared)},YC=function(n,r,i){return function(t){t(W(n,function(t){var n,e,o=t.text.fold(function(){return{}},function(t){return{text:t}});return ct(ct({type:t.type,active:!1},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),i.shared.getSink().each(function(t){r().getOpt(t).each(function(t){yc(t.element),rr(t,cx,{name:e.name,value:e.storage.get()})})})},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})}))}},qC=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold(function(){return{}},function(t){return{action:t}}),a=ct({buttonBehaviours:fc([Jv(function(){return t.disabled||i.isDisabled()}),qv(),Zy.config({}),xg("button press",[fr("click"),fr("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Kt(a,{dom:o});return Kt(c,{components:r})},KC=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return AC(t,e.icons)}),u=ob([i]);return qC(t,n,o,r,u,e)},JC=function(t,n,e,o){void 0===o&&(o=[]);var r=KC(t,st.some(n),e,o);return wp.sketch(r)},$C=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return AC(t,e.icons)}):st.none(),a=u.isSome()?ob([u]):[],c=u.isSome()?{}:{innerHtml:i},s=x(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),l=ct(ct({tag:"button",classes:s},c),{attributes:{title:i}});return qC(t,n,o,l,a,e)},QC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=$C(t,st.some(n),e,o,r);return wp.sketch(i)},ZC=function(n,e){return function(t){"custom"===e?rr(t,cx,{name:n,value:{}}):"submit"===e?or(t,sx):"cancel"===e?or(t,ax):console.error("Unknown button type: ",e)}},tO=function(n,t,e){if("menu"===t){var o=n,r=ct(ct({},n),{onSetup:function(t){return t.setDisabled(n.disabled),at},fetch:YC(o.items,function(){return i},e)}),i=Sp(XC(r,"tox-tbtn",e,st.none()));return i.asSpec()}if("custom"===(c=t)||"cancel"===c||"submit"===c){var u=ZC(n.name,t),a=ct(ct({},n),{borderless:!1});return QC(a,u,e.shared.providers,[])}var c;console.error("Unknown footer button type: ",t)},nO=function(t,n){var e,o,r=ZC(t.name,"custom");return e=st.none(),o=Jy.parts.field(ct({factory:wp},$C(t,st.some(r),n,[Ak(""),bk()]))),nx(e,o,[],[])},eO=it([fe("field1Name","field1"),fe("field2Name","field2"),Sa("onLockedChange"),ba(["lockClass"]),fe("locked",!1),Ql("coupledFieldBehaviours",[ud,ql])]),oO=function(t,n){return Of({factory:Jy,name:t,overrides:function(o){return{fieldBehaviours:fc([xg("coupled-input-behaviour",[dr(Oo(),function(e){zf(e,o,n).bind(ud.getCurrent).each(function(n){zf(e,o,"lock").each(function(t){Pg.isOn(t)&&o.onLockedChange(e,n,t)})})})])])}}})},rO=it([oO("field1","field2"),oO("field2","field1"),Of({factory:wp,schema:[$n("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:fc([Pg.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),iO=td({name:"FormCoupledInputs",configFields:eO(),partFields:rO(),factory:function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:Zl(o.coupledFieldBehaviours,[ud.config({find:st.some}),ql.config({store:{mode:"manual",getValue:function(t){var n=Wf(t,o,["field1","field2"]),e={};return e[o.field1Name]=ql.getValue(n.field1()),e[o.field2Name]=ql.getValue(n.field2()),e},setValue:function(t,n){var e=Wf(t,o,["field1","field2"]);Gt(n,o.field1Name)&&ql.setValue(e.field1(),n[o.field1Name]),Gt(n,o.field2Name)&&ql.setValue(e.field2(),n[o.field2Name])}}})]),apis:{getField1:function(t){return zf(t,o,"field1")},getField2:function(t){return zf(t,o,"field2")},getLock:function(t){return zf(t,o,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),uO=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return vt.error(t);var e=parseFloat(n[1]),o=n[2];return vt.value({value:e,unit:o})},aO=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?st.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?st.some(t.value):st.some(t.value/e[t.unit]*e[n]):st.none()},cO=function(){return st.none()},sO=function(t,n){var e,o,r,i=uO(t).toOptional();return o=uO(n).toOptional(),r=function(t,o){return aO(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return aO(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(cO)},((e=i).isSome()&&o.isSome()?st.some(r(e.getOrDie(),o.getOrDie())):st.none()).getOr(cO)},lO=function(e,o){var a=cO,r=mi("ratio-event"),t=iO.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:o.translate(e.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Cp("lock",o.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Cp("unlock",o.icons)}}],buttonBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()}}),qv(),Zy.config({})])}),n=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},i=function(n){return Jy.parts.field({factory:bx,inputClasses:["tox-textfield"],inputBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()}}),qv(),Zy.config({}),xg("size-input-events",[dr(wo(),function(t){rr(t,r,{isField1:n})}),dr(_o(),function(t){rr(t,ix,{name:e.name})})])]),selectOnFocus:!1})},u=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:o.translate(t)}}},c=iO.parts.field1(n([Jy.parts.label(u("Width")),i(!0)])),s=iO.parts.field2(n([Jy.parts.label(u("Height")),i(!1)]));return iO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,n([u("&nbsp;"),t])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,i){uO(ql.getValue(t)).each(function(t){a(t).each(function(t){var n,e,o,r;ql.setValue(i,(o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},-1!==(r=(n=t).value.toFixed((e=n.unit)in o?o[e]:1)).indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+n.unit))})})},coupledFieldBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){iO.getField1(t).bind(Jy.getField).each(yv.disable),iO.getField2(t).bind(Jy.getField).each(yv.disable),iO.getLock(t).each(yv.disable)},onEnabled:function(t){iO.getField1(t).bind(Jy.getField).each(yv.enable),iO.getField2(t).bind(Jy.getField).each(yv.enable),iO.getLock(t).each(yv.enable)}}),qv(),xg("size-input-events2",[dr(r,function(t,n){var e=n.event.isField1,o=e?iO.getField1(t):iO.getField2(t),r=e?iO.getField2(t):iO.getField1(t),i=o.map(ql.getValue).getOr(""),u=r.map(ql.getValue).getOr("");a=sO(i,u)})])])})},fO={undo:it(mi("undo")),redo:it(mi("redo")),zoom:it(mi("zoom")),back:it(mi("back")),apply:it(mi("apply")),swap:it(mi("swap")),transform:it(mi("transform")),tempTransform:it(mi("temp-transform")),transformApply:it(mi("transform-apply"))},dO=it("save-state"),mO=it("disable"),gO=it("enable"),pO={formActionEvent:cx,saveState:dO,disable:mO,enable:gO},hO=function(r,c){var t=function(t,n,e,o){return Sp(QC({name:t,text:t,disabled:e,primary:o,icon:st.none(),borderless:!1},n,c))},n=function(t,n,e,o){return Sp(JC({name:t,icon:st.some(t),tooltip:st.some(n),disabled:o,primary:!1,borderless:!1},e,c))},u=function(t,e){t.map(function(t){var n=t.get(e);n.hasConfigured(yv)&&yv.disable(n)})},a=function(t,e){t.map(function(t){var n=t.get(e);n.hasConfigured(yv)&&yv.enable(n)})},s={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},e=at,i=function(t,n,e){rr(t,n,e)},l=function(t){return or(t,pO.disable())},f=function(t){return or(t,pO.enable())},d=function(t,n){l(t),i(t,fO.transform(),{transform:n}),f(t)},o=function(t){return function(){J.getOpt(t).each(function(t){yg.set(t,[q])})}},m=function(t,n){l(t),i(t,fO.transformApply(),{transform:n,swap:o(t)}),f(t)},g=function(){return t("Back",function(t){return i(t,fO.back(),{swap:o(t)})},!1,!1)},p=function(){return Sp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:fc([yv.config({})])})},h=function(){return t("Apply",function(t){return i(t,
fO.apply(),{swap:o(t)})},!0,!0)},v=[g(),p(),t("Apply",function(t){m(t,function(t){var n=r.getRect();return TC(t,n.x,n.y,n.w,n.h)}),r.hideCrop()},!1,!0)],b=Xy.sketch({dom:s,components:v.map(function(t){return t.asSpec()}),containerBehaviours:fc([xg("image-tools-crop-buttons-events",[dr(pO.disable(),function(t){u(v,t)}),dr(pO.enable(),function(t){a(v,t)})])])}),y=Sp(lO({name:"size",label:st.none(),constrain:!0,disabled:!1},c)),x=[g(),p(),y,p(),t("Apply",function(a){y.getOpt(a).each(function(t){var n,e,o=ql.getValue(t),r=parseInt(o.width,10),i=parseInt(o.height,10),u=(n=r,e=i,function(t){return EC(t,n,e)});m(a,u)})},!1,!0)],w=Xy.sketch({dom:s,components:x.map(function(t){return t.asSpec()}),containerBehaviours:fc([xg("image-tools-resize-buttons-events",[dr(pO.disable(),function(t){u(x,t)}),dr(pO.enable(),function(t){a(x,t)})])])}),S=function(n,e){return function(t){return n(t,e)}},k=S(_C,"h"),C=S(_C,"v"),O=S(DC,-90),_=S(DC,90),T=function(t,n){var e,o;o=n,l(e=t),i(e,fO.tempTransform(),{transform:o}),f(e)},E=[g(),p(),n("flip-horizontally","Flip horizontally",function(t){T(t,k)},!1),n("flip-vertically","Flip vertically",function(t){T(t,C)},!1),n("rotate-left","Rotate counterclockwise",function(t){T(t,O)},!1),n("rotate-right","Rotate clockwise",function(t){T(t,_)},!1),p(),h()],D=Xy.sketch({dom:s,components:E.map(function(t){return t.asSpec()}),containerBehaviours:fc([xg("image-tools-fliprotate-buttons-events",[dr(pO.disable(),function(t){u(E,t)}),dr(pO.enable(),function(t){a(E,t)})])])}),B=function(t,n,e,o,r){var i=uk.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:c.translate(t)}}),u=uk.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),a=uk.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Sp(uk.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:it({x:o})},components:[i,u,a],sliderBehaviours:fc([Og.config({})]),onChoose:n}))},A=function(t,n,e,o,r){return[g(),(i=n,B(t,function(t,n,e){var o=S(i,e.x/100);d(t,o)},e,o,r)),h()];var i},M=function(t,n,e,o,r){var i=A(t,n,e,o,r);return Xy.sketch({dom:s,components:i.map(function(t){return t.asSpec()}),containerBehaviours:fc([xg("image-tools-filter-panel-buttons-events",[dr(pO.disable(),function(t){u(i,t)}),dr(pO.enable(),function(t){a(i,t)})])])})},F=[g(),p(),h()],I=Xy.sketch({dom:s,components:F.map(function(t){return t.asSpec()})}),R=M("Brightness",CC,-100,0,100),V=M("Contrast",OC,-100,0,100),P=M("Gamma",SC,-100,0,100),H=function(t){return B(t,function(l){var t=z.getOpt(l),n=L.getOpt(l),e=N.getOpt(l);t.each(function(s){n.each(function(c){e.each(function(t){var n,e,o,r=ql.getValue(s).x/100,i=ql.getValue(t).x/100,u=ql.getValue(c).x/100,a=(n=r,e=i,o=u,function(t){return kC(t,n,e,o)});d(l,a)})})})},0,100,200)},z=H("R"),N=H("G"),L=H("B"),j=[g(),z,N,L,h()],U=Xy.sketch({dom:s,components:j.map(function(t){return t.asSpec()})}),W=function(n,e,o){return function(t){i(t,fO.swap(),{transform:e,swap:function(){J.getOpt(t).each(function(t){yg.set(t,[n]),o(t)})}})}},G=st.some(wC),X=st.some(xC),Y=[n("crop","Crop",W(b,st.none(),function(){r.showCrop()}),!1),n("resize","Resize",W(w,st.none(),function(t){y.getOpt(t).each(function(t){var n=r.getMeasurements(),e=n.width,o=n.height;ql.setValue(t,{width:e,height:o})})}),!1),n("orientation","Orientation",W(D,st.none(),e),!1),n("brightness","Brightness",W(R,st.none(),e),!1),n("sharpen","Sharpen",W(I,G,e),!1),n("contrast","Contrast",W(V,st.none(),e),!1),n("color-levels","Color levels",W(U,st.none(),e),!1),n("gamma","Gamma",W(P,st.none(),e),!1),n("invert","Invert",W(I,X,e),!1)],q=Xy.sketch({dom:s,components:Y.map(function(t){return t.asSpec()})}),K=Xy.sketch({dom:{tag:"div"},components:[q],containerBehaviours:fc([yg.config({})])}),J=Sp(K);return{memContainer:J,getApplyButton:function(t){return J.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})}}},vO=tinymce.util.Tools.resolve("tinymce.geom.Rect"),bO=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),yO=tinymce.util.Tools.resolve("tinymce.util.Observable"),xO=tinymce.util.Tools.resolve("tinymce.util.VK"),wO=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]},SO=0,kO=function(s,e,l,o,r){var t,n="tox-",u="tox-crid-"+SO++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],f=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},c=function(t,n,e,o){var r,i=n.x,u=n.y,a=n.w,c=n.h;i+=e*t.deltaX,u+=o*t.deltaY,(a+=e*t.deltaW)<20&&(a=20),(c+=o*t.deltaH)<20&&(c=20),r=s=vO.clamp({x:i,y:u,w:a,h:c},l,"move"===t.name),r=f(l,r),p.fire("updateRect",{rect:r}),g(r)},d=function(n){var t=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),bO("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};Ck.each(a,function(t){bO("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)},m=function(t){d(s=t)},g=function(t){var n,e;m((n=l,{x:(e=t).x+n.x,y:e.y+n.y,w:e.w,h:e.h}))};bO('<div id="'+u+'" class="'+n+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),Ck.each(i,function(t){bO("#"+u,o).append('<div id="'+u+"-"+t+'"class="'+n+'croprect-block" style="display: none" data-mce-bogus="all">')}),Ck.each(a,function(t){bO("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="'+n+"croprect-handle "+n+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),t=Ck.map(a,function(n){var e;return h(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=s},drag:function(t){c(n,e,t.deltaX,t.deltaY)}})}),d(s),bO(o).on("focusin focusout",function(t){bO(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),bO(o).on("keydown",function(n){var i;Ck.each(a,function(t){if(n.target.id===u+"-"+t.name)return i=t,!1});var t=function(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),c(i,e,o,r)};switch(n.keyCode){case xO.LEFT:t(n,0,s,-10,0);break;case xO.RIGHT:t(n,0,s,10,0);break;case xO.UP:t(n,0,s,0,-10);break;case xO.DOWN:t(n,0,s,0,10);break;case xO.ENTER:case xO.SPACEBAR:n.preventDefault(),r()}});var p=Ck.extend({toggleVisibility:function(t){var n=Ck.map(a,function(t){return"#"+u+"-"+t.name}).concat(Ck.map(i,function(t){return"#"+u+"-"+t})).join(",");t?bO(n,o).show():bO(n,o).hide()},setClampRect:function(t){l=t,d(s)},setRect:m,getInnerRect:function(){return f(l,s)},setInnerRect:g,setViewPortRect:function(t){e=t,d(s)},destroy:function(){Ck.each(t,function(t){t.destroy()}),t=[]}},yO);return p},CO=function(n){var l=Sp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=we(1),d=we(st.none()),m=we({x:0,y:0,w:1,h:1}),c=we({x:0,y:0,w:1,h:1}),s=function(t,s){g.getOpt(t).each(function(t){var e=f.get(),o=Ru(t.element),r=Tu(t.element),i=s.dom.naturalWidth*e,u=s.dom.naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};ru(s,n),l.getOpt(t).each(function(t){ru(t.element,n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})},e=function(t,n){var e,a=ke.fromTag("img");return oi(a,"src",n),e=a.dom,new Hp(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}).then(function(){return g.getOpt(t).map(function(t){var n=wu({element:a});yg.replaceAt(t,1,st.some(n));var e=c.get(),o={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight};c.set(o);var r,u,i=vO.inflate(o,-20,-20);return m.set(i),e.w===o.w&&e.h===o.h||(r=t,u=a,g.getOpt(r).each(function(t){var n=Ru(t.element),e=Tu(t.element),o=u.dom.naturalWidth,r=u.dom.naturalHeight,i=Math.min(n/o,e/r);1<=i?f.set(1):f.set(i)})),s(t,a),a})})},t=Xy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:fc([xg("image-panel-crop-events",[yr(function(t){g.getOpt(t).each(function(t){var n=t.element.dom,e=kO({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,at);e.toggleVisibility(!1),e.on("updateRect",function(t){var n=t.rect,e=f.get(),o={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};m.set(o)}),d.set(st.some(e))})})])])}],containerBehaviours:fc([yg.config({}),xg("image-panel-events",[yr(function(t){e(t,n)})])])}),g=Sp(t);return{memContainer:g,updateSrc:e,zoom:function(t,n){var e=f.get(),o=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);f.set(o),g.getOpt(t).each(function(t){var n=t.components()[1].element;s(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=c.get();return{width:t.w,height:t.h}}}},OO=function(t,n,e,o,r){return JC({name:t,icon:st.some(n),disabled:e,tooltip:st.some(t),primary:!1,borderless:!1},o,r)},_O=function(t,n){n?yv.enable(t):yv.disable(t)},TO=function(t){var e,o,n,r,i=we(t),u=we(st.none()),a=(o=-1,{data:e=[],add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(n())return e[--o]},redo:function(){if(r())return e[++o]},canUndo:n=function(){return 0<o},canRedo:r=function(){return-1!==o&&o<e.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},l=function(t){URL.revokeObjectURL(t.url)},f=function(){u.get().each(l),u.set(st.none())},d=function(t){var n,e=s(t);return c(e),n=a.add(e).removed,Ck.each(n,l),e.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().fold(function(){return i.get()},function(t){return t})},updateTempState:function(t){var n=s(t);return f(),u.set(st.some(n)),n.url},addTempState:function(t){var n=s(t);return u.set(st.some(n)),n.url},applyTempState:function(n){return u.get().fold(at,function(t){d(t.blob),n()})},destroyTempState:f,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},EO=function(t,n){var e,o,r,u=TO(t.currentState),i=function(t){var n=u.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),rr(t,pO.formActionEvent,{name:pO.saveState(),value:n.undoEnabled})},a=function(t){return t.toBlob()},c=function(t){rr(t,pO.formActionEvent,{name:pO.disable(),value:{}})},s=function(t){h.getApplyButton(t).each(function(t){yv.enable(t)}),rr(t,pO.formActionEvent,{name:pO.enable(),value:{}})},l=function(t,n){return c(t),g.updateSrc(t,n)},f=function(n,t,e,o,r){return c(n),nC(t).then(e).then(a).then(o).then(function(t){return l(n,t).then(function(t){return i(n),r(),s(n),t})})["catch"](function(t){return console.log(t),s(n),t})},d=function(t,n,e){var o=u.getBlobState().blob;f(t,o,n,function(t){return u.updateTempState(t)},e)},m=function(t){var n=u.getBlobState().url;return u.destroyTempState(),i(t),n},g=CO(t.currentState.url),p=(o=Sp(OO("Undo","undo",!0,function(t){rr(t,fO.undo(),{direction:1})},e=n)),r=Sp(OO("Redo","redo",!0,function(t){rr(t,fO.redo(),{direction:1})},e)),{container:Xy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),r.asSpec(),OO("Zoom in","zoom-in",!1,function(t){rr(t,fO.zoom(),{direction:1})},e),OO("Zoom out","zoom-out",!1,function(t){rr(t,fO.zoom(),{direction:-1})},e)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){_O(t,n)}),r.getOpt(t).each(function(t){_O(t,e)})}}),h=hO(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[h.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:fc([ql.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),xg("image-tools-events",[dr(fO.undo(),function(t){var n=u.undo();l(t,n).then(function(){s(t),i(t)})}),dr(fO.redo(),function(t){var n=u.redo();l(t,n).then(function(){s(t),i(t)})}),dr(fO.zoom(),function(t,n){var e=n.event.direction;g.zoom(t,e)}),dr(fO.back(),function(t,n){var e,o;o=m(e=t),l(e,o).then(function(){s(e)}),(0,n.event.swap)(),g.hideCrop()}),dr(fO.apply(),function(t,n){u.applyTempState(function(){m(t),(0,n.event.swap)()})}),dr(fO.transform(),function(t,n){return d(t,n.event.transform,at)}),dr(fO.tempTransform(),function(t,n){return e=t,o=n.event.transform,r=u.getTempState().blob,void f(e,r,o,function(t){return u.addTempState(t)},at);var e,o,r}),dr(fO.transformApply(),function(t,n){return e=t,o=n.event.transform,r=n.event.swap,i=u.getBlobState().blob,void f(e,i,o,function(t){var n=u.addBlobState(t);return m(e),n},r);var e,o,r,i}),dr(fO.swap(),function(n,t){var e;e=n,p.updateButtonUndoStates(e,!1,!1);var o=t.event.transform,r=t.event.swap;o.fold(function(){r()},function(t){d(n,t,r)})})]),bk()])}},DO=function(t){return!Wt(t,"items")},BO="data-value",AO=function(n,e,t,o){return W(t,function(t){return DO(t)?{type:"togglemenuitem",text:t.text,value:t.value,active:t.value===o,onAction:function(){ql.setValue(n,t.value),rr(n,ix,{name:e}),Og.focus(n)}}:{type:"nestedmenuitem",text:t.text,getSubmenuItems:function(){return AO(n,e,t.items,o)}}})},MO=function(t,n){return gt(t,function(t){return DO(t)?ed(t.value===n,t):MO(t.items,n)})},FO=Zf({name:"HtmlSelect",configFields:[$n("options"),Kl("selectBehaviours",[Og,ql]),fe("selectClasses",[]),fe("selectAttributes",{}),ie("data")],factory:function(e){var t=W(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),n=e.data.map(function(t){return an("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:t,behaviours:$l(e.selectBehaviours,[Og.config({}),ql.config({store:ct({mode:"manual",getValue:function(t){return du(t.element)},setValue:function(t,n){K(e.options,function(t){return t.value===n}).isSome()&&mu(t.element,n)}},n)})])}}}),IO=function(n,e){var t=n.label.map(function(t){return rx(t,e)}),o=[yv.config({disabled:function(){return n.disabled||e.isDisabled()}}),qv(),gg.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(t){return or(t,sx),st.some(!0)}}),xg("textfield-change",[dr(Oo(),function(t){rr(t,ix,{name:n.name})}),dr(Io(),function(t){rr(t,ix,{name:n.name})})]),Zy.config({})],r=n.validation.map(function(o){return zx.config({getRoot:function(t){return Fr(t.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=ql.getValue(t),e=o.validator(n);return Dx(!0===e?vt.value(n):vt.error(e))},validateOnLoad:o.validateOnLoad}})}).toArray(),i=n.placeholder.fold(it({}),function(t){return{placeholder:e.translate(t)}}),u=n.inputMode.fold(it({}),function(t){return{inputmode:t}}),a=ct(ct({},i),u),c=Jy.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:a,inputClasses:[n.classname],inputBehaviours:fc(dt([o,r])),selectOnFocus:!1,factory:bx}),s=(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),l=[yv.config({disabled:function(){return n.disabled||e.isDisabled()},onDisabled:function(t){Jy.getField(t).each(yv.disable)},onEnabled:function(t){Jy.getField(t).each(yv.enable)}}),qv()];return nx(t,c,s,l)},RO=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return sr([dr(t.event,e),xr(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[dr(t,function(){return n.cancel()})]}).getOr([])))}}),VO=function(){var n=we(null);return Bi({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},PO=Object.freeze({__proto__:null,throttle:VO,init:function(t){return t.stream.streams.state(t)}}),HO=[Qn("stream",Ln("mode",{throttle:[$n("delay"),fe("stopEvent",!0),Ca("streams",{setup:function(t,n){var e=t.stream,o=Tp(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:VO})]})),fe("event","input"),ie("cancelEvent"),Sa("onStream")],zO=mc({fields:HO,name:"streaming",active:RO,state:PO}),NO=function(t,n,e){var o=ql.getValue(e);ql.setValue(n,o),jO(n)},LO=function(t,n){var e=t.element,o=du(e),r=e.dom;"number"!==ri(e,"type")&&n(r,o)},jO=function(t){LO(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},UO=function(t,n,o){if(t.selectsOver){var e=ql.getValue(n),r=t.getDisplayText(e),i=ql.getValue(o);return 0===t.getDisplayText(i).indexOf(r)?st.some(function(){var t,e;NO(0,n,o),t=n,e=r.length,LO(t,function(t,n){return t.setSelectionRange(e,n.length)})}):st.none()}return st.none()},WO=it("alloy.typeahead.itemexecute"),GO=it([ie("lazySink"),$n("fetch"),fe("minChars",5),fe("responseTime",1e3),xa("onOpen"),fe("getHotspot",st.some),fe("getAnchorOverrides",it({})),fe("layouts",st.none()),fe("eventOrder",{}),ye("model",{},[fe("getDisplayText",function(t){return t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.value}),fe("selectsOver",!0),fe("populateFromBrowse",!0)]),xa("onSetValue"),wa("onExecute"),xa("onItemExecute"),fe("inputClasses",[]),fe("inputAttributes",{}),fe("inputStyles",{}),fe("matchWidth",!0),fe("useMinWidth",!1),fe("dismissOnBlur",!0),ba(["openClass"]),ie("initialData"),Kl("typeaheadBehaviours",[Og,ql,zO,gg,Pg,jx]),xe("previewing",function(){return we(!0)})].concat(px()).concat(mw())),XO=it([_f({schema:[va()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(n,e){o.previewing.get()?n.getSystem().getByUid(o.uid).each(function(t){UO(o.model,t,e).fold(function(){return vd.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&NO(o.model,t,e)}),o.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(o.uid).toOptional().map(function(t){return rr(t,WO(),{item:n}),!0})},onHover:function(t,n){o.previewing.set(!1),t.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&NO(o.model,t,n)})}}}})]),YO=td({name:"Typeahead",configFields:GO(),partFields:XO(),factory:function(r,t,n,i){var e=function(t,n,e){r.previewing.set(!1);var o=jx.getCoupled(t,"sandbox");El.isOpen(o)?ud.getCurrent(o).each(function(t){vd.getHighlighted(t).fold(function(){e(t)},function(){cr(o,t.element,"keydown",n)})}):iw(r,u(t),t,o,i,function(t){ud.getCurrent(t).each(e)},wx.HighlightFirst).get(at)},o=hx(r),u=function(o){return function(t){return t.map(function(t){var n=jt(t.menus),e=$(n,function(t){return X(t.items,function(t){return"item"===t.type})});return ql.getState(o).update(W(e,function(t){return t.data})),t})}},a=[Og.config({}),ql.config({onSetValue:r.onSetValue,store:ct({mode:"dataset",getDataKey:function(t){return du(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){mu(t.element,r.model.getDisplayText(n))}},r.initialData.map(function(t){return an("initialValue",t)}).getOr({}))}),zO.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t){var n,e=jx.getCoupled(t,"sandbox");Og.isFocused(t)&&du(t.element).length>=r.minChars&&(n=ud.getCurrent(e).bind(function(t){return vd.getHighlighted(t).map(ql.getValue)}),r.previewing.set(!0),iw(r,u(t),t,e,i,function(){ud.getCurrent(e).each(function(t){n.fold(function(){r.model.selectsOver&&vd.highlightFirst(t)},function(n){vd.highlightBy(t,function(t){return ql.getValue(t).value===n.value}),vd.getHighlighted(t).orThunk(function(){return vd.highlightFirst(t),st.none()})})})},wx.HighlightFirst).get(at))},cancelEvent:Lo()}),gg.config({mode:"special",onDown:function(t,n){return e(t,n,vd.highlightFirst),st.some(!0)},onEscape:function(t){var n=jx.getCoupled(t,"sandbox");return El.isOpen(n)?(El.close(n),st.some(!0)):st.none()},onUp:function(t,n){return e(t,n,vd.highlightLast),st.some(!0)},onEnter:function(n){var t=jx.getCoupled(n,"sandbox"),e=El.isOpen(t);if(e&&!r.previewing.get())return ud.getCurrent(t).bind(function(t){return vd.getHighlighted(t)}).map(function(t){return rr(n,WO(),{item:t}),!0});var o=ql.getValue(n);return or(n,Lo()),r.onExecute(t,n,o),e&&El.close(t),st.some(!0)}}),Pg.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),jx.config({others:{sandbox:function(t){return fw(r,t,{onOpen:function(){return Pg.on(t)},onClose:function(){return Pg.off(t)}})}}}),xg("typeaheadevents",[Sr(function(t){var n=at;aw(r,u(t),t,i,n,wx.HighlightFirst).get(at)}),dr(WO(),function(t,n){var e=jx.getCoupled(t,"sandbox");NO(r.model,t,n.event.item),or(t,Lo()),r.onItemExecute(t,e,n.event.item,ql.getValue(t)),El.close(e),jO(t)})].concat(r.dismissOnBlur?[dr(Fo(),function(t){var n=jx.getCoupled(t,"sandbox");wc(n.element).isNone()&&El.close(n)})]:[]))];return{uid:r.uid,dom:vx(Kt(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:ct(ct({},o),$l(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),qO=function(i){return ct(ct({},i),{toCached:function(){return qO(i.toCached())},bindFuture:function(n){return qO(i.bind(function(t){return t.fold(function(t){return Dx(vt.error(t))},function(t){return n(t)})}))},bindResult:function(n){return qO(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return qO(i.map(function(t){return t.map(n)}))},mapError:function(n){return qO(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return qO(Ex(function(n){var e=!1,o=setTimeout(function(){e=!0,n(vt.error(r()))},t);i.get(function(t){e||(clearTimeout(o),n(t))})}))}})},KO=function(t){return qO(Ex(t))},JO={type:"separator"},$O=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:at}},QO=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:undefined},onAction:at}},ZO=function(t,n){return o=t,e=X(n,function(t){return t.type===o}),W(e,$O);var e,o},t_=function(t,n){var e=t.toLowerCase();return X(n,function(t){var n=t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.text;return Ae(n.toLowerCase(),e)||Ae(t.value.toLowerCase(),e)})},n_=function(u,t,a){var n=ql.getValue(t),c=n.meta.text!==undefined?n.meta.text:n.value;return a.getLinkInformation().fold(function(){return[]},function(t){var n,e,o,r,i=t_(c,(n=a.getHistory(u),W(n,function(t){return QO(t,t)})));return"file"===u?(e=[i,t_(c,ZO("header",t.targets)),t_(c,dt([(r=t,st.from(r.anchorTop).map(function(t){return QO("<top>",t)}).toArray()),ZO("anchor",t.targets),(o=t,st.from(o.anchorBottom).map(function(t){return QO("<bottom>",t)}).toArray())]))],q(e,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(JO,n)},[])):i})},e_=mi("aria-invalid"),o_=function(r,o,i){var t,n,e,u,a,c=o.shared.providers,s=function(t){var n=ql.getValue(t);i.addToHistory(n.value,r.filetype)},l=Jy.parts.field({factory:YO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":e_,type:"url"},minChars:0,responseTime:0,fetch:function(t){var n=n_(r.filetype,t,i),e=WC(n,fh.BUBBLE_TO_SANDBOX,o,!1);return Dx(e)},getHotspot:function(t){return h.getOpt(t)},onSetValue:function(t){t.hasConfigured(zx)&&zx.run(t).get(at)},typeaheadBehaviours:fc(dt([i.getValidationHandler().map(function(e){return zx.config({getRoot:function(t){return Fr(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){d.getOpt(t).each(function(t){oi(t.element,"title",c.translate(n))})}},validator:{validate:function(t){var n=ql.getValue(t);return KO(function(o){e({type:r.filetype,url:n.value},function(t){var n,e;"invalid"===t.status?(n=vt.error(t.message),o(n)):(e=vt.value(t.message),o(e))})})},validateOnLoad:!1}})}).toArray(),[yv.config({disabled:function(){return r.disabled||c.isDisabled()}}),Zy.config({}),xg("urlinput-events",dt(["file"===r.filetype?[dr(Oo(),function(t){rr(t,ix,{name:r.name})})]:[],[dr(_o(),function(t){rr(t,ix,{name:r.name}),s(t)}),dr(Io(),function(t){rr(t,ix,{name:r.name}),s(t)})]]))]])),eventOrder:((t={})[Oo()]=["streaming","urlinput-events","invalidating"],t),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:o.shared.getSink,parts:{menu:_h(0,0,"normal")},onExecute:function(t,n){rr(n,sx,{})},onItemExecute:function(t){s(t),rr(t,ix,{name:r.name})}}),f=r.label.map(function(t){return rx(t,c)}),d=Sp((n="invalid",e=st.some(e_),void 0===(u="warning")&&(u=n),void 0===a&&(a=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:Cp(u,c.icons),attributes:ct({title:c.translate(a),"aria-live":"polite"},e.fold(function(){return{}},function(t){return{id:t}}))}})),m=Sp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[d.asSpec()]}),g=i.getUrlPicker(r.filetype),p=mi("browser.url.event"),h=Sp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,m.asSpec()],behaviours:fc([yv.config({disabled:function(){return r.disabled||c.isDisabled()}})])}),v=Sp(QC({name:r.name,icon:st.some("browse"),text:r.label.getOr(""),disabled:r.disabled,primary:!1,borderless:!0},function(t){return or(t,p)},c,[],["tox-browse-url"]));return Jy.sketch({dom:ox([]),components:f.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:dt([[h.asSpec()],g.map(function(){return v.asSpec()}).toArray()])}]),fieldBehaviours:fc([yv.config({disabled:function(){return r.disabled||c.isDisabled()},onDisabled:function(t){Jy.getField(t).each(yv.disable),v.getOpt(t).each(yv.disable)},onEnabled:function(t){Jy.getField(t).each(yv.enable),v.getOpt(t).each(yv.enable)}}),qv(),xg("url-input-events",[dr(p,function(o){ud.getCurrent(o).each(function(n){var t=ql.getValue(n),e=ct({fieldname:r.name},t);g.each(function(t){t(e).get(function(t){ql.setValue(n,t),rr(o,ix,{name:r.name})})})})})])])})},r_=function(r){return function(n,e,o){return Ut(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}},i_={bar:r_(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(e.items,o.interpreter)};var e,o}),collection:r_(function(t,n){return gx(t,n.shared.providers)}),alertbanner:r_(function(t,n){return e=t,o=n.shared.providers,Xy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[wp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Cp(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){rr(t,cx,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o}),input:r_(function(t,n){return e=t,o=n.shared.providers,IO({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:st.none(),maximized:e.maximized},o);var e,o}),textarea:r_(function(t,n){return e=t,o=n.shared.providers,IO({name:e.name,multiline:!0,label:e.label,inputMode:st.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:st.none(),maximized:e.maximized},o);var e,o}),label:r_(function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=W(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:fc([bk(),yg.config({}),Bk(st.none()),gg.config({mode:"acyclic"})])};var e,o,r,i}),iframe:(nw=function(t,n){return Lk(t,n.shared.providers)},function(t,n,e){var o=Kt(n,{source:"dynamic"});return r_(nw)(t,o,e)}),button:r_(function(t,n){return nO(t,n.shared.providers)}),checkbox:r_(function(t,n){return e=t,o=n.shared.providers,r=ql.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),i=function(t){return t.element.dom.click(),st.some(!0)},u=Jy.parts.field({factory:{sketch:ut},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:fc([bk(),yv.config({disabled:function(){return e.disabled||o.isDisabled()}}),Zy.config({}),Og.config({}),r,gg.config({mode:"special",onEnter:i,onSpace:i,stopSpaceKeyup:!0}),xg("checkbox-events",[dr(_o(),function(t){rr(t,ix,{name:e.name})})])])}),a=Jy.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:fc([vw.config({})])}),s=Sp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(c=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:Cp("checked"===t?"selected":"unselected",o.icons)}}})("checked"),c("unchecked")]}),Jy.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[u,s.asSpec(),a],fieldBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Jy.getField(t).each(yv.disable)},onEnabled:function(t){Jy.getField(t).each(yv.enable)}}),qv()])});var e,o,r,i,u,a,c,s}),colorinput:r_(function(t,n){return ww(t,n.shared,n.colorinput)}),colorpicker:r_(function(){var t=vk(Sk,function(t){return"tox-"+t}),r=Sp(t.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){rr(t,cx,{name:"hex-valid",value:!0})},onInvalidHex:function(t){rr(t,cx,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[r.asSpec()],behaviours:fc([ql.config({store:{mode:"manual",getValue:function(t){var n=r.get(t);return ud.getCurrent(n).bind(function(t){return ql.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),o=r.get(t);ud.getCurrent(o).fold(function(){console.log("Can not find form")},function(t){ql.setValue(t,{hex:st.from(e[1]).getOr("")}),lk.getField(t,"hex").each(function(t){or(t,Oo())})})}}}),bk()])}}),dropzone:r_(function(t,n){return Mk(t,n.shared.providers)}),grid:r_(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:W(e.items,o.interpreter)};var e,o}),listbox:r_(function(t,n){return o=t,e=(r=n).shared.providers,i=ot(o.items).filter(DO),u=o.label.map(function(t){return rx(t,e)}),a={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Jy.parts.field({dom:{},factory:{sketch:function(t){return HC({uid:t.uid,text:i.map(function(t){return t.text}),icon:st.none(),tooltip:o.label,role:st.none(),fetch:function(t,n){var e=AO(t,o.name,o.items,ql.getValue(t));n(WC(e,fh.CLOSE_ON_EXECUTE,r,!1))},onSetup:it(at),getApi:it({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Zy.config({}),ql.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return ri(t.element,BO)},setValue:function(n,t){MO(o.items,t).each(function(t){oi(n.element,BO,t.value),rr(n,VC,{text:t.text})})}}})]},"tox-listbox",r.shared)}}})]},Jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:dt([u.toArray(),[a]]),fieldBehaviours:fc([yv.config({disabled:it(o.disabled),onDisabled:function(t){Jy.getField(t).each(yv.disable)},onEnabled:function(t){Jy.getField(t).each(yv.enable)}})])});var o,r,e,i,u,a}),selectbox:r_(function(t,n){return e=t,o=n.shared.providers,r=W(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),i=e.label.map(function(t){return rx(t,o)}),u=Jy.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:FO,selectBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()}}),Zy.config({}),xg("selectbox-change",[dr(_o(),function(t){rr(t,ix,{name:e.name})})])])}),a=1<e.size?st.none():st.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Cp("chevron-down",o.icons)
}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:dt([[u],a.toArray()])},Jy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:dt([i.toArray(),[c]]),fieldBehaviours:fc([yv.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){Jy.getField(t).each(yv.disable)},onEnabled:function(t){Jy.getField(t).each(yv.enable)}}),qv()])});var e,o,r,i,u,a,c}),sizeinput:r_(function(t,n){return lO(t,n.shared.providers)}),urlinput:r_(function(t,n){return o_(t,n,n.urlinput)}),customeditor:r_(function(e){var o=we(st.none()),n=Sp({dom:{tag:e.tag}}),r=we(st.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:fc([xg("custom-editor-events",[yr(function(t){n.getOpt(t).each(function(n){var t;t=e,(Object.prototype.hasOwnProperty.call(t,"init")?e.init(n.element.dom):kk.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set(st.none()),o.set(st.some(n))})})})]),ql.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){o.get().fold(function(){r.set(st.some(n))},function(t){return t.setValue(n)})}}}),bk()]),components:[n.asSpec()]}}),htmlpanel:r_(function(t){return"presentation"===t.presets?Xy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Xy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:fc([Zy.config({}),Og.config({})])})}),imagetools:r_(function(t,n){return EO(t,n.shared.providers)}),table:r_(function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:W(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:W(r,c)})],behaviours:fc([Zy.config({}),Og.config({})])};var e,o,r,i,u,a,c}),panel:r_(function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:W(e.items,o.shared.interpreter)};var e,o})},u_={field:function(t,n){return n}},a_=function(n,t,e){var o=Kt(e,{shared:{interpreter:function(t){return c_(n,t,o)}}});return c_(n,t,o)},c_=function(n,e,o){return Ut(i_,e.type).fold(function(){return console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},s_={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},l_=function(t,n,e){var o=Wc(-12,12,s_),r={maxHeightFunction:zc()};return function(){return e()?{anchor:"node",root:jr(t()),node:st.from(t()),bubble:o,layouts:{onRtl:function(){return[vp]},onLtr:function(){return[hp]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[Wa]},onLtr:function(){return[Ga]}},overrides:r}}},f_=function(t,n,e){return function(){return e()?{anchor:"node",root:jr(t()),node:st.from(t()),layouts:{onRtl:function(){return[bp]},onLtr:function(){return[bp]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Ka]},onLtr:function(){return[Ka]}}}}},d_=function(t,n,e){var o,r,i,u=Nv(t),a=function(){return ke.fromDom(t.getBody())},c=function(){return ke.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:l_(c,n,s),banner:f_(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return st.some(xs.range(ke.fromDom(t.startContainer),t.startOffset,ke.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},m_=function(t){return{colorPicker:function(t,n){oy(r)(t,n)},hasCustomColors:function(){return Xb(o)},getColors:function(){return Yb(e)},getColorCols:(n=e=o=r=t,function(){return Jb(n)})};var n,e,o,r},g_=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],p_=function(t){return q(t,function(t,n){if(Wt(n,"items")){var e=p_(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Wt(n,"inline")||Wt(n,"block")||Wt(n,"selector")){var o="custom-"+(E(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return ct(ct({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},h_=function(i){return t=i,st.from(t.getParam("style_formats")).filter(B).map(function(t){var n,e,o,r=(n=i,e=p_(t),o=function(t){ft(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})},n.formatter?o(e.customFormats):n.on("init",function(){o(e.customFormats)}),e.formats);return i.getParam("style_formats_merge",!1,"boolean")?g_.concat(r):r}).getOr(g_);var t},v_=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Kt(t,o)},b_=function(c,t,s,l){var f=function(t){return W(t,function(t){var n,e,o,r,i,u=It(t);if(Gt(t,"items")){var a=f(t.items);return Kt(Kt(t,{type:"submenu"}),{getStyleItems:function(){return a}})}return Gt(t,"format")?v_(t,s,l):1===u.length&&N(u,"title")?Kt(t,{type:"separator"}):(r={type:"formatter",format:o="custom-"+(e=E((n=t).name)?n.name:mi(n.title)),isSelected:s(o),getStylePreview:l(o)},i=Kt(n,r),c.formatter.register(e,i),i)})};return f(t)},y_=Ck.trim,x_=function(e){return function(t){if(F(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}},w_=x_("true"),S_=x_("false"),k_=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},C_=function(t){return t.innerText||t.textContent},O_=function(t){return(n=t)&&"A"===n.nodeName&&(n.id||n.name)!==undefined&&T_(t);var n},__=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},T_=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return w_(t)}return!1}(t)&&!S_(t)},E_=function(t){return __(t)&&T_(t)},D_=function(t){var n,e,o=(n=t).id?n.id:mi("h");return k_("header",C_(t),"#"+o,__(e=t)?parseInt(e.nodeName.substr(1),10):0,function(){t.id=o})},B_=function(t){var n=t.id||t.name,e=C_(t);return k_("anchor",e||"#"+n,"#"+n,0,at)},A_=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,W(Ms(ke.fromDom(e),n),function(t){return t.dom})},M_=function(t){return 0<y_(t.title).length},F_=function(t){var n=A_(t);return X(W(X(n,E_),D_).concat(W(X(n,O_),B_)),M_)},I_="tinymce-url-history",R_=function(t){return E(t)&&/^https?/.test(t)},V_=function(t){return D(t)&&Lt(t,function(t){return!(B(n=t)&&n.length<=5&&Q(n,R_));var n}).isNone()},P_=function(){var t,n=Lb.getItem(I_);if(null===n)return{};try{t=JSON.parse(n)}catch(s){if(s instanceof SyntaxError)return console.log("Local storage "+I_+" was not valid JSON",s),{};throw s}return V_(t)?t:(console.log("Local storage "+I_+" was not valid format",t),{})},H_=function(t){var n=P_();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},z_=function(n,t){var e,o,r;R_(n)&&(e=P_(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=X(o,function(t){return t!==n}),e[t]=[n].concat(r).slice(0,5),function(t){if(!V_(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Lb.setItem(I_,JSON.stringify(t))}(e))},N_=function(t){return!!t},L_=function(t){return Pt(Ck.makeMap(t,/[, ]/),N_)},j_=function(t){return st.from(t.getParam("file_picker_callback")).filter(I)},U_=function(t,n){var e,o,r,i,u=(e=t,o=st.some(e.getParam("file_picker_types")).filter(N_),r=st.some(e.getParam("file_browser_callback_types")).filter(N_),i=o.or(r).map(L_),j_(e).fold(p,function(){return i.fold(S,function(t){return 0<It(t).length&&t})}));return A(u)?u?j_(t):st.none():u[n]?j_(t):st.none()},W_=function(t){return st.from(t).filter(E).getOrUndefined()},G_=function(t){return st.from((e=(n=t).getParam("file_picker_validator_handler",undefined,"function"))===undefined?n.getParam("filepicker_validator_handler",undefined,"function"):e);var n,e},X_=function(n){return{getHistory:H_,addToHistory:z_,getLinkInformation:function(){return!1===(t=n).getParam("typeahead_urls")?st.none():st.some({targets:F_(t.getBody()),anchorTop:W_(t.getParam("anchor_top","#top")),anchorBottom:W_(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return G_(n)},getUrlPicker:function(t){return U_(r=n,i=t).map(function(o){return function(n){return Ex(function(e){var t=ct({filetype:i,fieldname:n.fieldname},st.from(n.meta).getOr({}));o.call(r,function(t,n){if(!E(t))throw new Error("Expected value to be string");if(n!==undefined&&!D(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var r,i}}},Y_=function(t,n,e){var o,r,i,u,a,c,s,l,f,d,m,g=we(!1),p={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=we(Hv(n)?"bottom":"top")).get,setDockingMode:o.set},h={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:iv.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return c_(u_,t,h)},anchors:d_(n,e,p.isPositionedAtTop),header:p,getSink:function(){return vt.value(t)}},urlinput:X_(n),styleselect:(i=n,u=function(t){return function(){return i.formatter.match(t)}},a=function(n){return function(){var t=i.formatter.get(n);return t!==undefined?st.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:i.dom.parseStyle(i.formatter.getCssText(n))}):st.none()}},c=function(t){var n=t.items;return n!==undefined&&0<n.length?$(n,c):[t.format]},s=we([]),l=we([]),f=we([]),d=we([]),m=we(!1),i.on("PreInit",function(){var t=h_(i),n=b_(i,t,u,a);s.set(n),l.set($(n,c))}),i.on("addStyleModifications",function(t){var n=b_(i,t.items,u,a);f.set(n),m.set(t.replace),d.set($(n,c))}),{getData:function(){var t=m.get()?[]:s.get(),n=f.get();return t.concat(n)},getFlattenedKeys:function(){var t=m.get()?[]:l.get(),n=d.get();return t.concat(n)}}),colorinput:m_(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return g.get()},setContextMenuState:function(t){return g.set(t)}};return h},q_=it(function(t,n){var e,o,r;e=t,o=Math.floor(n),r=Iu.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),ou(e,"max-width",r+"px")}),K_="contexttoolbar-hide",J_=it([$n("dom"),fe("shell",!0),Kl("toolbarBehaviours",[yg])]),$_=it([Tf({name:"groups",overrides:function(){return{behaviours:fc([yg.config({})])}}})]),Q_=td({name:"Toolbar",configFields:J_(),partFields:$_(),factory:function(n,t){var e=function(t){return n.shell?st.some(t):zf(t,n,"groups")},o=n.shell?{behaviours:[yg.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:o.components,behaviours:$l(n.toolbarBehaviours,o.behaviours),apis:{setGroups:function(t,n){e(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){yg.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),Z_=function(t,n,e){return{within:t,extra:n,withinWidth:e}},tT=function(t,n,o){var e,r=(e=function(t,n){var e=o(t);return st.some({element:t,start:n,finish:n+e,width:e})},q(t,function(n,t){return e(t,n.len).fold(it(n),function(t){return{len:t.finish,list:n.list.concat([t])}})},{len:0,list:[]}).list),i=X(r,function(t){return t.finish<=n}),u=Y(i,function(t,n){return t+n.width},0);return{within:i,extra:r.slice(i.length),withinWidth:u}},nT=function(t){return W(t,function(t){return t.element})},eT=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=tT(n,t,e)).extra.length?st.some(r):st.none()).getOrThunk(function(){return tT(n,t-e(o),e)}),g=m.within,p=m.extra,h=m.withinWidth;return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=nT(g.concat(l)),Z_(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=nT(g).concat([a]),Z_(s,nT(u),c)):(i=h,Z_(nT(g),[],i))},oT=function(t,n){var e=W(n,function(t){return Cu(t)});Q_.setGroups(t,e)},rT=function(t,n,e){var o=Nf(t,n,"primary"),r=jx.getCoupled(t,"overflowGroup");ou(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=gt(i,function(n){return wc(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()})});e([]),oT(o,i);var a=Ru(o.element),c=eT(a,n.builtGroups.get(),function(t){return Ru(t.element)},r);0===c.extra.length?(yg.remove(o,r),e([])):(oT(o,c.within),e(c.extra)),lu(o.element,"visibility"),fu(o.element),u.each(Og.focus)},iT=it([Kl("splitToolbarBehaviours",[jx]),xe("builtGroups",function(){return we([])})]),uT=it([ba(["overflowToggledClass"]),se("getOverflowBounds"),$n("lazySink"),xe("overflowGroups",function(){return we([])})].concat(iT())),aT=it([Of({factory:Q_,schema:J_(),name:"primary"}),_f({schema:J_(),name:"overflow"}),_f({name:"overflow-button"}),_f({name:"overflow-group"})]),cT=it([ba(["toggledClass"]),$n("lazySink"),ne("fetch"),se("getBounds"),le("fireDismissalEventInstead",[fe("event",Ko())]),ns()]),sT=it([_f({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:fc([Pg.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),_f({factory:Q_,schema:J_(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:fc([gg.config({mode:"cyclic",onEscape:function(t){return zf(t,n,"button").each(Og.focus),st.none()}})])}}})]),lT=function(t,n){var e=jx.getCoupled(t,"toolbarSandbox");El.isOpen(e)?El.close(e):El.open(e,n.toolbar())},fT=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),i=e.lazySink(t).getOrDie();ul.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:q_()}},n,r)},dT=function(t,n,e,o,r){Q_.setGroups(n,r),fT(t,n,e,o),Pg.on(t)},mT=td({name:"FloatingToolbarButton",factory:function(u,t,a,n){return ct(ct({},wp.sketch(ct(ct({},n.button()),{action:function(t){lT(t,n)},buttonBehaviours:Zl({dump:n.button().buttonBehaviours},[jx.config({others:{toolbarSandbox:function(t){return o=t,e=a,r=u,{dom:{tag:"div",attributes:{id:(i=oa()).id}},behaviours:fc([gg.config({mode:"special",onEscape:function(t){return El.close(t),st.some(!0)}}),El.config({onOpen:function(t,n){r.fetch().get(function(t){dT(o,n,r,e.layouts,t),i.link(o.element),gg.focusIn(n)})},onClose:function(){Pg.off(o),Og.focus(o),i.unlink(o.element)},isPartOf:function(t,n,e){return ia(n,e)||ia(o,e)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),vc.config({channels:ct(ct({},Fl(ct({isExtraPart:p},r.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Rl({doReposition:function(){El.getState(jx.getCoupled(o,"toolbarSandbox")).each(function(t){fT(o,t,r,e.layouts)})}}))})])};var o,e,r,i}}})])}))),{apis:{setGroups:function(n,e){El.getState(jx.getCoupled(n,"toolbarSandbox")).each(function(t){dT(n,t,u,a.layouts,e)})},reposition:function(n){El.getState(jx.getCoupled(n,"toolbarSandbox")).each(function(t){fT(n,t,u,a.layouts)})},toggle:function(t){lT(t,n)},getToolbar:function(t){return El.getState(jx.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return El.isOpen(jx.getCoupled(t,"toolbarSandbox"))}}})},configFields:cT(),partFields:sT(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),gT=it([$n("items"),ba(["itemSelector"]),Kl("tgroupBehaviours",[gg])]),pT=it([Ef({name:"items",unit:"item"})]),hT=td({name:"ToolbarGroup",configFields:gT(),partFields:pT(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:$l(t.tgroupBehaviours,[gg.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),vT=function(t){return W(t,function(t){return Cu(t)})},bT=function(t,e,o){rT(t,o,function(n){o.overflowGroups.set(n),e.getOpt(t).each(function(t){mT.setGroups(t,vT(n))})})},yT=td({name:"SplitFloatingToolbar",configFields:uT(),partFields:aT(),factory:function(e,t,n,o){var r=Sp(mT.sketch({fetch:function(){return Ex(function(t){t(vT(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[Ga,Wa]},onRtl:function(){return[Wa,Ga]},onBottomLtr:function(){return[Ya,Xa]},onBottomRtl:function(){return[Xa,Ya]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:$l(e.splitToolbarBehaviours,[jx.config({others:{overflowGroup:function(){return hT.sketch(ct(ct({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(W(n,t.getSystem().build)),bT(t,r,e)},refresh:function(t){return bT(t,r,e)},toggle:function(t){r.getOpt(t).each(function(t){mT.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(mT.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){mT.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(mT.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),xT=function(n,t){return t.getAnimationRoot.fold(function(){return n.element},function(t){return t(n)})},wT=function(t){return t.dimension.property},ST=function(t,n){return t.dimension.getDimension(n)},kT=function(t,n){var e=xT(t,n);Ji(e,[n.shrinkingClass,n.growingClass])},CT=function(t,n){Yi(t.element,n.openClass),Gi(t.element,n.closedClass),ou(t.element,wT(n),"0px"),fu(t.element)},OT=function(t,n){Yi(t.element,n.closedClass),Gi(t.element,n.openClass),lu(t.element,wT(n))},_T=function(t,n,e){e.setCollapsed(),ou(t.element,wT(n),ST(n,t.element)),fu(t.element),kT(t,n),CT(t,n),n.onStartShrink(t),n.onShrunk(t)},TT=function(t,n,e,o){var r=o.getOrThunk(function(){return ST(n,t.element)});e.setCollapsed(),ou(t.element,wT(n),r),fu(t.element);var i=xT(t,n);Yi(i,n.growingClass),Gi(i,n.shrinkingClass),CT(t,n),n.onStartShrink(t)},ET=function(t,n,e){var o=ST(n,t.element);("0px"===o?_T:TT)(t,n,e,st.some(o))},DT=function(t,n,e){var o=xT(t,n),r=qi(o,n.shrinkingClass),i=ST(n,t.element);OT(t,n);var u=ST(n,t.element);(r?function(){ou(t.element,wT(n),i),fu(t.element)}:function(){CT(t,n)})(),Yi(o,n.shrinkingClass),Gi(o,n.growingClass),OT(t,n),ou(t.element,wT(n),u),e.setExpanded(),n.onStartGrow(t)},BT=function(t,n){var e=xT(t,n);return!0===qi(e,n.growingClass)},AT=function(t,n){var e=xT(t,n);return!0===qi(e,n.shrinkingClass)},MT=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&(lu(t.element,wT(n)),o=ST(n,t.element),ou(t.element,wT(n),o))},grow:function(t,n,e){e.isExpanded()||DT(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&ET(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&_T(t,n,e,st.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:BT,isShrinking:AT,isTransitioning:function(t,n){return BT(t,n)||AT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?ET:DT)(t,n,e)},disableTransitions:kT}),FT=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.expanded;return Mi(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:an(n.dimension.property,"0px")})},events:function(e,o){return sr([br(Eo(),function(t,n){n.event.raw.propertyName===e.dimension.property&&(kT(t,e),o.isExpanded()&&lu(t.element,e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),IT=[$n("closedClass"),$n("openClass"),$n("shrinkingClass"),$n("growingClass"),ie("getAnimationRoot"),xa("onShrunk"),xa("onStartShrink"),xa("onGrown"),xa("onStartGrow"),fe("expanded",!1),Qn("dimension",Ln("property",{width:[Ca("property","width"),Ca("getDimension",function(t){return Ru(t)+"px"})],height:[Ca("property","height"),Ca("getDimension",function(t){return Tu(t)+"px"})]}))],RT=mc({fields:IT,name:"sliding",active:FT,apis:MT,state:Object.freeze({__proto__:null,init:function(t){var n=we(t.expanded);return Bi({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:b(n.set,!1),setExpanded:b(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),VT=it([ba(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),xa("onOpened"),xa("onClosed")].concat(iT())),PT=it([Of({factory:Q_,schema:J_(),name:"primary"}),Of({factory:Q_,schema:J_(),name:"overflow",overrides:function(n){return{toolbarBehaviours:fc([RT.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){zf(t,n,"overflow-button").each(function(t){Pg.off(t),Og.focus(t)}),n.onClosed(t)},onGrown:function(t){gg.focusIn(t),n.onOpened(t)},onStartGrow:function(t){zf(t,n,"overflow-button").each(Pg.on)}}),gg.config({mode:"acyclic",onEscape:function(t){return zf(t,n,"overflow-button").each(Og.focus),st.some(!0)}})])}}}),_f({name:"overflow-button",overrides:function(t){return{buttonBehaviours:fc([Pg.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),_f({name:"overflow-group"})]),HT=function(n,e){zf(n,e,"overflow-button").bind(function(){return zf(n,e,"overflow")}).each(function(t){zT(n,e),RT.toggleGrow(t)})},zT=function(t,n){zf(t,n,"overflow").each(function(e){rT(t,n,function(t){var n=W(t,function(t){return Cu(t)});Q_.setGroups(e,n)}),zf(t,n,"overflow-button").each(function(t){RT.hasGrown(e)&&Pg.on(t)}),RT.refresh(e)})},NT=td({name:"SplitSlidingToolbar",configFields:VT(),partFields:PT(),factory:function(o,t,n,e){var r="alloy.toolbar.toggle";return{uid:o.uid,dom:o.dom,components:t,behaviours:$l(o.splitToolbarBehaviours,[jx.config({others:{overflowGroup:function(t){return hT.sketch(ct(ct({},e["overflow-group"]()),{items:[wp.sketch(ct(ct({},e["overflow-button"]()),{action:function(){or(t,r)}}))]}))}}}),xg("toolbar-toggle-events",[dr(r,function(t){HT(t,o)})])]),apis:{setGroups:function(t,n){var e;e=W(n,t.getSystem().build),o.builtGroups.set(e),zT(t,o)},refresh:function(t){return zT(t,o)},toggle:function(t){return HT(t,o)},isOpen:function(t){return zf(t,o,"overflow").map(RT.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),LT=it(mi("toolbar-height-change")),jT=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:ct({tag:"div",classes:["tox-toolbar__group"]},n),components:[hT.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:fc([Zy.config({}),Og.config({})])}},UT=function(t){return hT.sketch(jT(t))},WT=function(e,t){var n=yr(function(t){var n=W(e.initGroups,UT);Q_.setGroups(t,n)});return fc([Qv(e.providers.isDisabled),qv(),gg.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),xg("toolbar-events",[n])])},GT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":jT({title:st.none(),items:[]}),"overflow-button":KC({name:"more",icon:st.some("more-drawer"),disabled:!1,tooltip:st.some("More..."),primary:!1,borderless:!1},st.none(),t.providers)},splitToolbarBehaviours:WT(t,n)}},XT=function(i){var t=GT(i),n=yT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return yT.sketch(ct(ct({},t),{lazySink:i.getSink,getOverflowBounds:function(){var t=i.moreDrawerData.lazyHeader().element,n=Ku(t),e=Ar(t),o=Ku(e),r=Math.max(e.dom.scrollHeight,o.height);return Yu(n.x+4,o.y,n.width-8,r)},parts:ct(ct({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:i.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},YT=function(t){var n=NT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=NT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=GT(t);return NT.sketch(ct(ct({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([LT()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([LT()],{type:"closed"})}}))},qT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return Q_.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===sh.scrolling?["tox-toolbar--scrolling"]:[])},components:[Q_.parts.groups({})],toolbarBehaviours:WT(t,n)})},KT=wn([Zn("type"),Qn("items",kn([Mn([Zn("name"),re("items",Gn)]),Gn]))].concat(qp)),JT=[ce("text"),ce("tooltip"),ce("icon"),ne("fetch"),ve("onSetup",function(){return at})],$T=wn(x([Zn("type")],JT)),QT=function(t){return Vn("menubutton",$T,t)},ZT=wn([Zn("type"),ce("tooltip"),ce("icon"),ce("text"),se("select"),ne("fetch"),ve("onSetup",function(){return at}),pe("presets","normal",["normal","color","listpreview"]),fe("columns",1),ne("onAction"),ne("onItemAction")]),tE=Object.freeze({__proto__:null,events:function(i,u){var r=function(o,r){i.updateState.each(function(t){var n=t(o,r);u.set(n)}),i.renderComponents.each(function(t){var n=t(r,u.get()),e=W(n,o.getSystem().build);ll(o,e)})};return sr([dr(Ro(),function(t,n){var e,o=n;o.universal||(e=i.channel,N(o.channels,e)&&r(t,o.data))}),yr(function(n){i.initialData.each(function(t){r(n,t)})})])}}),nE=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),eE=[$n("channel"),ie("renderComponents"),ie("updateState"),ie("initialData")],oE=mc({fields:eE,name:"reflecting",active:tE,apis:nE,state:Object.freeze({__proto__:null,init:function(){var n=we(st.none());return{readState:function(){return n.get().fold(function(){return"none"},function(t){return t})},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(st.none())}}}})}),rE=it([$n("toggleClass"),$n("fetch"),Sa("onExecute"),fe("getHotspot",st.some),fe("getAnchorOverrides",it({})),ns(),Sa("onItemExecute"),ie("lazySink"),$n("dom"),xa("onOpen"),Kl("splitDropdownBehaviours",[jx,gg,Og]),fe("matchWidth",!1),fe("useMinWidth",!1),fe("eventOrder",{}),ie("role")].concat(mw())),iE=Of({factory:wp,schema:[$n("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:fc([Og.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(ir)},buttonBehaviours:fc([Pg.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),uE=Of({factory:wp,schema:[$n("dom")],name:"button",defaults:function(){return{buttonBehaviours:fc([Og.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),aE=it([iE,uE,Tf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[$n("text")],name:"aria-descriptor"}),_f({schema:[va()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),Wx()]),cE=td({name:"SplitDropdown",configFields:rE(),partFields:aE(),factory:function(o,t,n,e){var r,i=function(t){ud.getCurrent(t).each(function(t){vd.highlightFirst(t),gg.focusIn(t)})},u=function(t){aw(o,function(t){return t},t,e,i,wx.HighlightFirst).get(at)},a=function(t){var n=Nf(t,o,"button");return ir(n),st.some(!0)},c=ct(ct({},sr([yr(function(e){zf(e,o,"aria-descriptor").each(function(t){var n=mi("aria");oi(t.element,"id",n),oi(e.element,"aria-describedby",n)})})])),zg(st.some(u))),s={repositionMenus:function(t){Pg.isOn(t)&&dw(t)}};return{uid:o.uid,dom:o.dom,components:t,apis:s,eventOrder:ct(ct({},o.eventOrder),((r={})[Vo()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:$l(o.splitDropdownBehaviours,[jx.config({others:{sandbox:function(t){var n=Nf(t,o,"arrow");return fw(o,t,{onOpen:function(){Pg.on(n),Pg.on(t)},onClose:function(){Pg.off(n),Pg.off(t)}})}}}),gg.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),st.some(!0)}}),Og.config({}),Pg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),sE=function(n){return{isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},lE=function(n){return{setActive:function(t){Pg.set(n,t)},isActive:function(){return Pg.isOn(n)},isDisabled:function(){return yv.isDisabled(n)},setDisabled:function(t){return yv.set(n,t)}}},fE=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},dE=mi("focus-button"),mE=["checklist","ordered-list"],gE=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],pE=function(n,e,t,o,r,i){var u,a=function(t){return iv.isRtl()&&N(mE,t)?t+"-rtl":t},c=iv.isRtl()&&n.exists(function(t){return N(gE,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:fE(t,i)},components:ob([n.map(function(t){return AC(a(t),i.icons)}),e.map(function(t){return FC(t,"tox-tbtn",i)})]),eventOrder:((u={})[ho()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:fc([Qv(i.isDisabled),qv(),xg("common-button-display-events",[dr(ho(),function(t,n){n.event.prevent(),or(t,dE)})])].concat(o.map(function(t){return oE.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t){return ob([t.icon.map(function(t){return AC(a(t),i.icons)}),t.text.map(function(t){return FC(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},hE=function(t,n,e){var o,r=we(at),i=pE(t.icon,t.text,t.tooltip,st.none(),st.none(),e);return wp.sketch({dom:i.dom,components:i.components,eventOrder:RC,buttonBehaviours:fc([xg("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Sr(function(n){Zv(o,n)(function(t){rr(n,IC,{buttonApi:t}),o.onAction(t)})})),tb(n,r),nb(n,r)]),Qv(function(){return t.disabled||e.isDisabled()}),qv()].concat(n.toolbarButtonBehaviours))})},vE=function(t,n,e){return hE(t,{toolbarButtonBehaviours:[].concat(0<e.length?[xg("toolbarButtonWith",e)]:[]),getApi:sE,onSetup:t.onSetup},n)},bE=function(t,n,e){return Kt(hE(t,{toolbarButtonBehaviours:[yg.config({}),Pg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[xg("toolbarToggleButtonWith",e)]:[]),getApi:lE,onSetup:t.onSetup},n))},yE=function(n,t){var e,o,r,i,u=mi("channel-update-split-dropdown-display"),a=function(e){return{isDisabled:function(){return yv.isDisabled(e)},setDisabled:function(t){return yv.set(e,t)},setIconFill:function(t,n){na(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){oi(t,"fill",n)})},setIconStroke:function(t,n){na(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){oi(t,"stroke",n)})},setActive:function(n){oi(
e.element,"aria-pressed",n),na(e.element,"span").each(function(t){e.getSystem().getByDom(t).each(function(t){return Pg.set(t,n)})})},isActive:function(){return na(e.element,"span").exists(function(t){return e.getSystem().getByDom(t).exists(Pg.isOn)})}}},c=we(at),s={getApi:a,onSetup:n.onSetup};return cE.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:ct({"aria-pressed":!1},fE(n.tooltip,t.providers))},onExecute:function(t){n.onAction(a(t))},onItemExecute:function(){},splitDropdownBehaviours:fc([$v(t.providers.isDisabled),qv(),xg("split-dropdown-events",[dr(dE,Og.focus),tb(s,c),nb(s,c)]),vw.config({})]),eventOrder:((e={})[Yo()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(o=a,r=n,i=t.providers,function(n){return Ex(function(t){return r.fetch(t)}).map(function(t){return st.from(Oy(Kt(ry(mi("menu-value"),t,function(t){r.onItemAction(o(n),t)},r.columns,r.presets,fh.CLOSE_ON_EXECUTE,r.select.getOr(p),i),{movement:uy(r.columns,r.presets),menuBehaviours:Kh("auto"!==r.columns?[]:[yr(function(o){Yh(o,4,Sh(r.presets)).each(function(t){var n=t.numRows,e=t.numColumns;gg.setGridSize(o,n,e)})})])})))})}),parts:{menu:_h(0,n.columns,n.presets)},components:[cE.parts.button(pE(n.icon,n.text,st.none(),st.some(u),st.some([Pg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),cE.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Cp("chevron-down",t.providers.icons)},buttonBehaviours:fc([$v(t.providers.isDisabled),qv()])}),cE.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},xE=function(i,u){return dr(IC,function(t,n){var e,o=i.get(t),r=(e=o,{hide:function(){return or(e,No())},getValue:function(){return ql.getValue(e)}});u.onAction(r,n.event.buttonApi)})},wE=function(t,n,e){var o,r,i,u,a,c,s,l,f,d,m,g,p={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(s=t,f=p,(d=(l=n).original).primary,m=y(d,["primary"]),g=Pn(Zp(ct(ct({},m),{type:"togglebutton",onAction:at}))),bE(g,f.backstage.shared.providers,[xE(s,l)])):(o=t,i=p,(u=(r=n).original).primary,a=y(u,["primary"]),c=Pn(Jp(ct(ct({},a),{type:"button",onAction:at}))),vE(c,i.backstage.shared.providers,[xE(o,r)]))},SE=function(t,n){var e,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),a=Sp(bx.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:fc([gg.config({mode:"special",onEnter:function(t){return c.findPrimary(t).map(function(t){return ir(t),!0})},onLeft:function(t,n){return n.cut(),st.none()},onRight:function(t,n){return n.cut(),st.none()}})])})),c=(e=a,o=t.commands,r=n,i=W(o,function(t){return Sp(wE(e,t,r))}),{asSpecs:function(){return W(i,function(t){return t.asSpec()})},findPrimary:function(e){return gt(o,function(t,n){return t.primary?st.from(i[n]).bind(function(t){return t.getOpt(e)}).filter(w(yv.isDisabled)):st.none()})}});return[{title:st.none(),items:[a.asSpec()]},{title:st.none(),items:c.asSpecs()}]},kE=function(t,n){var e,o,r,i,u,a=Uu(window),c=qu(ke.fromDom(t.getContentAreaContainer())),s=Tv(t)||Ev(t)||Bv(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width;if(t.inline&&!s)return Yu(f,a.y,d,a.height);var m=function(t,n,e,o){var r=ke.fromDom(t.getContainer()),i=na(r,".tox-editor-header").getOr(r),u=qu(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=qu(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom;return Yu(f,g,d,p-g)},CE=function(n,t){var e=X(t,function(t){return t.predicate(n.dom)}),o=G(e,function(t){return"contexttoolbar"===t.type});return{contextToolbars:o.pass,contextForms:o.fail}},OE=function(t,n,e){var o=CE(t,n);if(0<o.contextForms.length)return st.some({elem:t,toolbars:[o.contextForms[0]]});var r=CE(t,e);if(0<r.contextForms.length)return st.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t;var n=function(n){return L(t,function(t){return t.position===n})},e=function(n){return X(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=W(e("selection"),function(t){return ct(ct({},t),{position:"node"})});return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return st.some({elem:t,toolbars:i})}return st.none()},_E=function(t,n,i){return t(n)?st.none():io(n,function(t){var n=CE(t,i.inNodeScope),e=n.contextToolbars,o=n.contextForms,r=0<o.length?o:function(t){if(t.length<=1)return t;var n=function(n){return K(t,function(t){return t.position===n})};return n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return X(t,function(t){return t.position===n})})}(e);return 0<r.length?st.some({elem:t,toolbars:r}):st.none()},t)},TE=function(e,r){var t={},i=[],u=[],a={},c={},o=function(n,e){var o=Pn(Vn("ContextForm",uh,e));(t[n]=o).launch.map(function(t){a["form:"+n]=ct(ct({},e.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){r(o)}})}),"editor"===o.scope?u.push(o):i.push(o),c[n]=o},s=function(n,e){Vn("ContextToolbar",ah,e).each(function(t){"editor"===e.scope?u.push(t):i.push(t),c[n]=t})},n=It(e);return ft(n,function(t){var n=e[t];"contextform"===n.type?o(t,n):"contexttoolbar"===n.type&&s(t,n)}),{forms:t,inNodeScope:i,inEditorScope:u,lookupTable:c,formNavigators:a}},EE=mi("forward-slide"),DE=mi("backward-slide"),BE=mi("change-slide-event"),AE="tox-pop--resizing",ME=function(t,n,e){var u,a,r,c,s,o=e.dataset,i="basic"===o.type?function(){return W(o.data,function(t){return v_(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:(u=n,a=e,r=function(t,n,e,o){var r=u.shared.providers.translate(t.title);if("separator"===t.type)return st.some({type:"separator",text:r});if("submenu"!==t.type)return st.some(ct({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:e,onAction:a.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));var i=$(t.getStyleItems(),function(t){return c(t,n,o)});return 0===n&&i.length<=0?st.none():st.some({type:"nestedmenuitem",text:r,disabled:i.length<=0,getSubmenuItems:function(){return $(t.getStyleItems(),function(t){return c(t,n,o)})}})},c=function(t,n,e){var o="formatter"===t.type&&a.isInvalid(t);return 0===n?o?[]:r(t,n,!1,e).toArray():r(t,n,o,e).toArray()},{validateItems:s=function(t){var n=a.getCurrentValue(),e=a.shouldHide?0:1;return $(t,function(t){return c(t,e,n)})},getFetch:function(r,i){return function(t,n){var e=i(),o=s(e);n(WC(o,fh.CLOSE_ON_EXECUTE,r,!1))}}}),getStyleItems:i}},FE=function(o,t,n){var e=ME(0,t,n),r=e.items,i=e.getStyleItems;return HC({text:n.icon.isSome()?st.none():st.some(""),icon:n.icon,tooltip:st.from(n.tooltip),role:st.none(),fetch:r.getFetch(t,i),onSetup:function(e){return n.setInitialValue.each(function(t){return t(e.getComponent())}),n.nodeChangeHandler.map(function(t){var n=t(e.getComponent());return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}).getOr(at)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)};(ow=ew=ew||{})[ow.SemiColon=0]="SemiColon",ow[ow.Space=1]="Space";var IE,RE,VE,PE,HE,zE,NE=function(t,n,e,o){var r,i;return{type:"basic",data:(i=t.getParam(n,e,"string"),r=o===ew.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),W(r,function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}}))}},LE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],jE=function(e){var n=function(t){var n=K(LE,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});rr(t,PC,{icon:"align-"+n})},t=st.some(function(t){return function(){return n(t)}}),o=st.some(n),r={type:"basic",data:LE};return{tooltip:"Align",icon:st.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:st.none,getPreviewFor:function(){return function(){return st.none()}},onAction:function(n){return function(){return K(LE,function(t){return t.format===n.format}).each(function(t){return e.execCommand(t.command)})}},setInitialValue:o,nodeChangeHandler:t,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},UE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],WE=function(t){var n=t.split(/\s*,\s*/);return W(n,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},GE=function(t){var n;return 0===t.indexOf("-apple-system")&&(n=WE(t.toLowerCase()),Q(UE,function(t){return-1<n.indexOf(t.toLowerCase())}))},XE=function(r){var i=function(){var e=function(t){return t?WE(t)[0]:""},t=r.queryCommandValue("FontName"),n=u.data,o=t?t.toLowerCase():"";return{matchOpt:K(n,function(t){var n=t.format;return n.toLowerCase()===o||e(n).toLowerCase()===e(o).toLowerCase()}).orThunk(function(){return GE(o)?st.from({title:"System Font",format:o}):st.none()}),font:t}},n=function(t){var n=i(),e=n.matchOpt,o=n.font,r=e.fold(function(){return o},function(t){return t.title});rr(t,VC,{text:r})},t=st.some(function(t){return function(){return n(t)}}),e=st.some(n),u=NE(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",ew.SemiColon);return{tooltip:"Fonts",icon:st.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getCurrentValue:function(){return i().matchOpt},getPreviewFor:function(t){return function(){return st.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},setInitialValue:e,nodeChangeHandler:t,dataset:u,shouldHide:!1,isInvalid:p}},YE={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},qE={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},KE=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):Ut(qE,t).getOr(t);var e,o,r},JE=function(e){var i=function(){var o=st.none(),r=u.data,i=e.queryCommandValue("FontSize");if(i)for(var t=function(t){var n=KE(i,t),e=Ut(YE,n).getOr("");o=K(r,function(t){return t.format===i||t.format===n||t.format===e})},n=3;o.isNone()&&0<=n;n--)t(n);return{matchOpt:o,size:i}},t=it(st.none),n=function(t){var n=i(),e=n.matchOpt,o=n.size,r=e.fold(function(){return o},function(t){return t.title});rr(t,VC,{text:r})},o=st.some(function(t){return function(){return n(t)}}),r=st.some(n),u=NE(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",ew.Space);return{tooltip:"Font sizes",icon:st.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getPreviewFor:t,getCurrentValue:function(){return i().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},setInitialValue:r,nodeChangeHandler:o,dataset:u,shouldHide:!1,isInvalid:p}},$E=function(t,n){var e=n(),o=W(e,function(t){return t.format});return st.from(t.formatter.closest(o)).bind(function(n){return K(e,function(t){return t.format===n})}).orThunk(function(){return ed(t.formatter.match("p"),{title:"Paragraph",format:"p"})})},QE=function(t){var n=we(st.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(st.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(st.some(t))}}},ZE=function(){return QE(function(t){return t.destroy()})},tD=function(){return QE(function(t){return t.unbind()})},nD=function(o,r){return function(n){var e=tD(),t=function(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive);e.set(t)};return o.initialized?t():o.on("init",t),e.clear}},eD=function(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}},oD=function(e){var n=function(t){var n=$E(e,function(){return r.data}).fold(function(){return"Paragraph"},function(t){return t.title});rr(t,VC,{text:n})},t=st.some(function(t){return function(){return n(t)}}),o=st.some(n),r=NE(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",ew.SemiColon);return{tooltip:"Blocks",icon:st.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:st.none,getPreviewFor:function(n){return function(){var t=e.formatter.get(n);return st.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))})}},onAction:eD(e),setInitialValue:o,nodeChangeHandler:t,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},rD=function(r,t){var n=function(t){var e=function(t){var n=t.items;return n!==undefined&&0<n.length?$(n,e):[{title:t.title,format:t.format}]},n=$(h_(r),e),o=$E(r,function(){return n}).fold(function(){return"Paragraph"},function(t){return t.title});rr(t,VC,{text:o})},e=st.some(function(t){return function(){return n(t)}}),o=st.some(n);return{tooltip:"Formats",icon:st.none(),isSelectedFor:function(t){return function(){return r.formatter.match(t)}},getCurrentValue:st.none,getPreviewFor:function(n){return function(){var t=r.formatter.get(n);return t!==undefined?st.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:r.dom.parseStyle(r.formatter.getCssText(n))}):st.none()}},onAction:eD(r),setInitialValue:o,nodeChangeHandler:e,shouldHide:r.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!r.formatter.canApply(t.format)},dataset:t}},iD=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],uD=function(r,i){return function(t,n,e){var o=r(t).mapError(function(t){return zn(t)}).getOrDie();return i(o,n,e)}},aD={button:uD(Jp,function(t,n){return e=t,o=n.backstage.shared.providers,vE(e,o,[]);var e,o}),togglebutton:uD(Zp,function(t,n){return e=t,o=n.backstage.shared.providers,bE(e,o,[]);var e,o}),menubutton:uD(QT,function(t,n){return XC(t,"tox-tbtn",n.backstage,st.none())}),splitbutton:uD(function(t){return Vn("SplitButton",ZT,t)},function(t,n){return yE(t,n.backstage.shared)}),grouptoolbarbutton:uD(function(t){return Vn("GroupToolbarButton",KT,t)},function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[Zc]=n.backstage.shared.header.isPositionedAtTop()?aa.TopToBottom:aa.BottomToTop,o);switch(Fv(e)){case sh.floating:return r=t,i=n.backstage,u=function(t){return fD(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,st.none())},a=l,c=i.shared,mT.sketch({lazySink:c.getSink,fetch:function(){return Ex(function(t){t(W(u(r.items),UT))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:pE(r.icon,r.text,r.tooltip,st.none(),st.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=ct({type:"advanced"},o.styleselect),FE(e,o,rD(e,r));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,FE(e,o,JE(e));var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,FE(e,o,XE(e));var e,o},formatButton:function(t,n){return e=t,o=n.backstage,FE(e,o,oD(e));var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,FE(e,o,jE(e));var e,o}},cD={styleselect:aD.styleSelectButton,fontsizeselect:aD.fontsizeSelectButton,fontselect:aD.fontSelectButton,formatselect:aD.formatButton,align:aD.alignMenuButton},sD=function(t){var n,e,o,r=t.toolbar,i=t.buttons;return!1===r?[]:r===undefined||!0===r?(e=i,o=W(iD,function(t){var n=X(t.items,function(t){return Wt(e,t)||Wt(cD,t)});return{name:t.name,items:n}}),X(o,function(t){return 0<t.items.length})):E(r)?(n=r.split("|"),W(n,function(t){return{items:t.trim().split(" ")}})):R(r,function(t){return Wt(t,"name")&&Wt(t,"items")})?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},lD=function(r,n,i,u,a,t){return Ut(n,i.toLowerCase()).orThunk(function(){return t.bind(function(t){return gt(t,function(t){return Ut(n,t+i.toLowerCase())})})}).fold(function(){return Ut(cD,i.toLowerCase()).map(function(t){return t(r,a)}).orThunk(function(){return st.none()})},function(t){return"grouptoolbarbutton"!==t.type||u?(e=a,o=r,Ut(aD,(n=t).type).fold(function(){return console.error("skipping button defined by",n),st.none()},function(t){return st.some(t(n,e,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),st.none());var n,e,o})},fD=function(e,o,r,i){var t=sD(o),n=W(t,function(t){var n=$(t.items,function(t){return 0===t.trim().length?[]:lD(e,o.buttons,t,o.allowToolbarGroups,r,i).toArray()});return{title:st.from(e.translate(t.name)),items:n}});return X(n,function(t){return 0<t.items.length})},dD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},mD={maxHeightFunction:zc(),maxWidthFunction:q_()},gD={onLtr:function(){return[qa,Ka,Xa,Wa,Ya,Ga,bp,yp,hp,gp,vp,pp]},onRtl:function(){return[qa,Ka,Ya,Ga,Xa,Wa,bp,yp,vp,pp,hp,gp]}},pD={onLtr:function(){return[Ka,Wa,Ga,Xa,Ya,qa,bp,yp,hp,gp,vp,pp]},onRtl:function(){return[Ka,Ga,Wa,Ya,Xa,qa,bp,yp,vp,pp,hp,gp]}},hD=function(c,t,e,s){var n,o,l=Qe().deviceType.isTouch,u=ku((n={sink:e,onEscape:function(){return c.focus(),st.some(!0)}},o=we([]),cp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){o.set([]),cp.getContent(t).each(function(t){lu(t.element,"visibility")}),Yi(t.element,AE),lu(t.element,"width")},inlineBehaviours:fc([xg("context-toolbar-events",[br(Eo(),function(t){Yi(t.element,AE),lu(t.element,"width")}),dr(BE,function(t,n){var e=t.element;lu(e,"width");var o=Ru(e);cp.setContent(t,n.event.contents),Gi(e,AE);var r=Ru(e);ou(e,"width",o+"px"),cp.getContent(t).each(function(t){n.event.focus.bind(function(t){return yc(t),wc(e)}).orThunk(function(){return gg.focusIn(t),xc(Lr(e))})}),xp.setTimeout(function(){ou(t.element,"width",r+"px")},0)}),dr(EE,function(n,t){cp.getContent(n).each(function(t){o.set(o.get().concat([{bar:t,focus:xc(Lr(n.element))}]))}),rr(n,BE,{contents:t.event.forwardContents,focus:st.none()})}),dr(DE,function(n){rt(o.get()).each(function(t){o.set(o.get().slice(0,o.get().length-1)),rr(n,BE,{contents:Cu(t.bar),focus:t.focus})})})]),gg.config({mode:"special",onEscape:function(t){return rt(o.get()).fold(function(){return n.onEscape()},function(){return or(t,DE),st.some(!0)})}})]),lazySink:function(){return vt.value(n.sink)}}))),f=function(){return kE(c,s.backstage.shared)},a=function(){if(l()&&s.backstage.isContextMenuOpen())return!0;var t,n,e,o,r,i,u=(t=g.get().filter(function(t){return Qi(ke.fromDom(t))}).map(function(t){return t.getBoundingClientRect()}).getOrThunk(function(){return c.selection.getRng().getBoundingClientRect()}),n=c.inline?Nu().top:Ku(ke.fromDom(c.getBody())).y,{y:t.top+n,bottom:t.bottom+n}),a=f();return e=u.y,o=u.bottom,r=a.y,i=a.bottom,!(Math.max(e,r)<=Math.min(o,i))},d=function(){m.set(st.none()),cp.hide(u)},r=function(){cp.hide(u)},i=function(){m.get().each(function(t){var n=u.element;lu(n,"display"),a()?ou(n,"display","none"):ul.positionWithinBounds(e,t,u,st.some(f()))})},m=we(st.none()),g=we(st.none()),p=we(null),h=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:fc([gg.config({mode:"acyclic"}),xg("pop-dialog-wrap-events",[yr(function(t){c.shortcuts.add("ctrl+F9","focus statusbar",function(){return gg.focusIn(t)})}),xr(function(){c.shortcuts.remove("ctrl+F9")})])])}},v=$t(function(){return TE(t,function(t){var n=b([t]);rr(u,EE,{forwardContents:h(n)})})}),b=function(t){var n=c.ui.registry.getAll().buttons,e=v(),o=ct(ct({},n),e.formNavigators),r=Fv(c)===sh.scrolling?sh.scrolling:sh["default"],i=dt(W(t,function(t){return"contexttoolbar"===t.type?fD(c,{buttons:o,toolbar:t.items,allowToolbarGroups:!1},s,st.some(["form:"])):(n=t,e=s.backstage.shared.providers,SE(n,e));var n,e}));return qT({type:r,uid:mi("context-toolbar"),initGroups:i,onEscape:st.none,cyclicKeying:!0,providers:s.backstage.shared.providers})};c.on("contexttoolbar-show",function(n){var t=v();Ut(t.lookupTable,n.toolbarKey).each(function(t){x([t],n.target===c?st.none():st.some(n)),cp.getContent(u).each(gg.focusIn)})});var y=function(t,n){var e,o,r="node"===t?s.backstage.shared.anchors.node(n):s.backstage.shared.anchors.cursor();return Kt(r,(e=t,o=l(),"line"===e?{bubble:Wc(12,0,dD),layouts:{onLtr:function(){return[Ja]},onRtl:function(){return[$a]}},overrides:mD}:{bubble:Wc(0,12,dD),layouts:o?pD:gD,overrides:mD}))},x=function(t,n){var e,o,r,i;S(),l()&&s.backstage.isContextMenuOpen()||(e=b(t),o=n.map(ke.fromDom),r=y(t[0].position,o),m.set(st.some(r)),g.set(n),i=u.element,lu(i,"display"),cp.showWithinBounds(u,r,h(e),function(){return st.some(f())}),a()&&ou(i,"display","none"))},w=function(){var t,n,e,o,r,i,u;c.hasFocus()&&(t=v(),n=t,e=c,r=ke.fromDom(e.getBody()),i=function(t){return no(t,r)},u=ke.fromDom(e.selection.getNode()),(i(o=u)||oo(r,o)?OE(u,n.inNodeScope,n.inEditorScope).orThunk(function(){return _E(i,u,n)}):st.none()).fold(d,function(t){x(t.toolbars,st.some(t.elem.dom))}))},S=function(){var t=p.get();null!==t&&(xp.clearTimeout(t),p.set(null))},k=function(){S(),p.set(xp.setEditorTimeout(c,w,0))};c.on("init",function(){c.on(K_,r),c.on("ScrollContent ScrollWindow longpress",i),c.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){k()}),c.on("focusout",function(){xp.setEditorTimeout(c,function(){wc(e.element).isNone()&&wc(u.element).isNone()&&d()},0)}),c.on("SwitchMode",function(){c.mode.isReadOnly()&&d()}),c.on("AfterProgressState",function(t){t.state?d():c.hasFocus()&&k()}),c.on("NodeChange",function(){wc(u.element).fold(k,at)})})},vD=Yf,bD=Bf,yD=it([fe("shell",!1),$n("makeItem"),fe("setupItem",at),Ql("listBehaviours",[yg])]),xD=Tf({name:"items",overrides:function(){return{behaviours:fc([yg.config({})])}}}),wD=it([xD]),SD=td({name:it("CustomList")(),configFields:yD(),partFields:wD(),factory:function(s,t){var n=s.shell?{behaviours:[yg.config({})],components:[]}:{behaviours:[],components:t},e=function(t){return s.shell?st.some(t):zf(t,s,"items")};return{uid:s.uid,dom:s.dom,components:n.components,behaviours:$l(s.listBehaviours,n.behaviours),apis:{setItems:function(a,c){e(a).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(n){var t=yg.contents(n),e=c.length,o=e-t.length,r=0<o?j(o,function(){return s.makeItem()}):[],i=t.slice(e);ft(i,function(t){return yg.remove(n,t)}),ft(r,function(t){return yg.append(n,t)});var u=yg.contents(n);ft(u,function(t,n){s.setupItem(a,t,c[n],n)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),kD=it([]),CD=Object.freeze({__proto__:null,setup:at,isDocked:p,getBehaviours:kD}),OD=function(t){return(cu(t,"position").is("fixed")?st.none():Rr(t)).orThunk(function(){var e=ke.fromTag("span");return Fr(t).bind(function(t){Kr(t,e);var n=Rr(e);return Qr(e),n})})},_D=function(t){return OD(t).map(Mu).getOrThunk(function(){return Bu(0,0)})},TD=Xt([{"static":[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),ED=function(t,n){var e=t.element;Gi(e,n.transitionClass),Yi(e,n.fadeOutClass),Gi(e,n.fadeInClass),n.onShow(t)},DD=function(t,n){var e=t.element;Gi(e,n.transitionClass),Yi(e,n.fadeInClass),Gi(e,n.fadeOutClass),n.onHide(t)},BD=function(t,o,r){return Q(t,function(t){switch(t){case"bottom":return e=r,o.bottom<=e.bottom;case"top":return n=r,o.y>=n.y}var n,e})},AD=function(n,t){return t.getInitialPosition().map(function(t){return Yu(t.bounds.x,t.bounds.y,Ru(n),Tu(n))})},MD=function(r,t,n){n.setInitialPosition(st.some({style:function(){var t={},n=r.dom;if($i(n))for(var e=0;e<n.style.length;e++){var o=n.style.item(e);t[o]=n.style[o]}return t}(),position:uu(r,"position")||"static",bounds:t}))},FD=function(e,o,r){return r.getInitialPosition().bind(function(t){switch(r.setInitialPosition(st.none()),t.position){case"static":return st.some(TD["static"]());case"absolute":var n=OD(e).map(qu).getOrThunk(function(){return qu(Zi())});return st.some(TD.absolute(kc("absolute",Ut(t.style,"left").map(function(){return o.x-n.x}),Ut(t.style,"top").map(function(){return o.y-n.y}),Ut(t.style,"right").map(function(){return n.right-o.right}),Ut(t.style,"bottom").map(function(){return n.bottom-o.bottom}))));default:return st.none()}})},ID=function(t,n,e){var o,r,i,u=t.element;return cu(u,"position").is("fixed")?(r=n,AD(o=u,i=e).filter(function(t){return BD(i.getModes(),t,r)}).bind(function(t){return FD(o,t,i)})):function(t,n,e){var o=qu(t);if(BD(e.getModes(),o,n))return st.none();MD(t,o,e);var r=Ju(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return st.some(TD.fixed(kc("fixed",st.some(i),c?st.some(u):st.none(),st.none(),c?st.none():st.some(a))))}(u,n,e)},RD=function(n,t){ft(["left","right","top","bottom","position"],function(t){return lu(n.element,t)}),t.onUndocked(n)},VD=function(t,n,e){Cc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},PD=function(i,t,u,a,c){void 0===c&&(c=!1),t.contextual.each(function(r){r.lazyContext(i).each(function(t){var n,e,o=(e=a,(n=t).y<e.bottom&&n.bottom>e.y);o!==u.isVisible()&&(u.setVisible(o),c&&!o?(Ki(i.element,[r.fadeOutClass]),r.onHide(i)):(o?ED:DD)(i,r))})})},HD=function(n,e,t){var o,r,i=n.element;t.setDocked(!1),o=t,r=n.element,AD(r,o).bind(function(t){return FD(r,t,o)}).each(function(t){t.fold(function(){return RD(n,e)},function(t){return VD(n,e,t)},at)}),t.setVisible(!0),e.contextual.each(function(t){Ji(i,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)}),zD(n,e,t)},zD=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&PD(o,r,i,u),ID(o,u,i).each(function(t){i.setDocked(!a),t.fold(function(){return RD(o,r)},function(t){return VD(o,r,t)},function(t){PD(o,r,i,u,!0),VD(o,r,t)})}))},ND=function(t,n,e){e.isDocked()&&HD(t,n,e)},LD=Object.freeze({__proto__:null,refresh:zD,reset:ND,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),jD=Object.freeze({__proto__:null,events:function(o,r){return sr([br(Eo(),function(n,e){o.contextual.each(function(t){qi(n.element,t.transitionClass)&&(Ji(n.element,[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(n)),e.stop()})}),dr(Go(),function(t){zD(t,o,r)}),dr(Xo(),function(t){ND(t,o,r)})])}}),UD=[le("contextual",[Zn("fadeInClass"),Zn("fadeOutClass"),Zn("transitionClass"),ne("lazyContext"),xa("onShow"),xa("onShown"),xa("onHide"),xa("onHidden")]),ve("lazyViewport",Ju),be("modes",["top","bottom"],Gn),xa("onDocked"),xa("onUndocked")],WD=mc({fields:UD,name:"docking",active:jD,apis:LD,state:Object.freeze({__proto__:null,init:function(t){var n=we(!1),e=we(!0),o=we(st.none()),r=we(t.modes);return Bi({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),GD={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},XD="tox-tinymce--toolbar-sticky-on",YD="tox-tinymce--toolbar-sticky-off",qD=function(r){var i=r.element;Fr(i).each(function(t){var n,e,o="padding-"+WD.getModes(r)[0];WD.isDocked(r)?(n=Ru(t),ou(i,"width",n+"px"),ou(t,o,Eu(e=i)+(parseInt(uu(e,"margin-top"),10)||0)+(parseInt(uu(e,"margin-bottom"),10)||0)+"px")):(lu(i,"width"),lu(t,o))})},KD=function(t,n){n?(Yi(t,GD.fadeOutClass),Ki(t,[GD.transitionClass,GD.fadeInClass])):(Yi(t,GD.fadeInClass),Ki(t,[GD.fadeOutClass,GD.transitionClass]))},JD=function(t,n){var e=ke.fromDom(t.getContainer());n?(Gi(e,XD),Yi(e,YD)):(Gi(e,YD),Yi(e,XD))},$D=function(c,t){var n,i=we(st.none()),o=t.getSink,u=function(n){o().each(function(t){return n(t.element)})},e=function(t){c.inline||qD(t),JD(c,WD.isDocked(t)),t.getSystem().broadcastOn([Bl()],{}),o().each(function(t){return t.getSystem().broadcastOn([Bl()],{})})},r=c.inline?[]:[vc.config({channels:((n={})[LT()]={onReceive:qD},n)})];return x([Og.config({}),WD.config({contextual:ct({lazyContext:function(t){var n,e,o=Eu(t.element),r=c.inline?c.getContentAreaContainer():c.getContainer(),i=qu(ke.fromDom(r)),u=i.height-o,a=i.y+(n=t,e="top",N(WD.getModes(n),e)?0:o);return st.some(Yu(i.x,a,i.width,u))},onShow:function(){u(function(t){return KD(t,!0)})},onShown:function(r){u(function(t){return Ji(t,[GD.transitionClass,GD.fadeInClass])}),i.get().each(function(t){var n,e,o;n=r.element,o=Dr(e=t),xc(o).filter(function(t){return!no(e,t)}).filter(function(t){return no(t,ke.fromDom(o.dom.body))||oo(n,t)}).each(function(){return yc(e)}),i.set(st.none())})},onHide:function(t){var n,e;i.set((n=t.element,e=o,wc(n).orThunk(function(){return e().toOptional().bind(function(t){return wc(t.element)})}))),u(function(t){return KD(t,!1)})},onHidden:function(){u(function(t){return Ji(t,[GD.transitionClass])})}},GD),modes:[t.header.getDockingMode()],onDocked:e,onUndocked:e})],r)},QD=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(WD.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(qD)}),t.on("SkinLoaded",function(){e().each(function(t){WD.isDocked(t)?WD.reset(t):WD.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(WD.reset)})),t.on("AfterScrollIntoView",function(y){e().each(function(t){WD.refresh(t);var n,e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b=t.element;cm(b)&&(n=y,i=(r=Dr(e=b)).dom.defaultView.innerHeight,u=Nu(r),a=ke.fromDom(n.elm),c=Ku(a),s=Tu(a),f=(l=c.y)+s,d=Mu(e),m=Tu(e),p=(g=d.top)+m,h=Math.abs(g-u.top)<2,v=Math.abs(p-(u.top+i))<2,h&&l<p?Lu(u.left,l-m,r):v&&g<f&&(o=l-i+s+m,Lu(u.left,o,r)))})}),t.on("PostRender",function(){JD(t,!1)})},isDocked:function(t){return t().map(WD.isDocked).getOr(!1)},getBehaviours:$D}),ZD=Zf({factory:function(n,o){var t={focus:gg.focusIn,setMenus:function(t,n){var e=W(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},e=QT(t).mapError(function(t){return zn(t)}).getOrDie();return XC(e,"tox-mbtn",o.backstage,st.some("menuitem"))});yg.set(t,e)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:fc([yg.config({}),xg("menubar-events",[yr(function(t){n.onSetup(t)}),dr(xo(),function(e,t){na(e.element,".tox-mbtn--active").each(function(n){ea(t.event.target,".tox-mbtn").each(function(t){no(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){hw.expand(t),hw.close(n),Og.focus(t)})})})})}),dr($o(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){
t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(t){hw.isOpen(n)&&(hw.expand(t),hw.close(n))})})})]),gg.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),st.some(!0)}}),Zy.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[$n("dom"),$n("uid"),$n("onEscape"),$n("backstage"),fe("onSetup",at)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),tB="container",nB=[Kl("slotBehaviours",[])],eB=function(t){return"<alloy.field."+t+">"},oB=function(r,t){var e,n=function(){return Uf(r)},o=function(e,o){return function(t,n){return zf(t,r,n).map(function(t){return e(t,n)}).getOr(o)}},i=function(t){return"true"!==ri(t.element,"aria-hidden")},u=o(i,!1),a=o(function(t,n){var e;i(t)&&(e=t.element,ou(e,"display","none"),oi(e,"aria-hidden","true"),rr(t,Qo(),{name:n,visible:!1}))}),c=function(n,t){ft(t,function(t){return e(n,t)})},s=o(function(t,n){var e;i(t)||(e=t.element,lu(e,"display"),ai(e,"aria-hidden"),rr(t,Qo(),{name:n,visible:!0}))}),l={getSlotNames:n,getSlot:function(t,n){return zf(t,r,n)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return c(t,n())},showSlot:s};return{uid:r.uid,dom:r.dom,components:t,behaviours:Jl(r.slotBehaviours),apis:l}},rB=Pt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Ei),iB=ct(ct({},rB),{sketch:function(t){var e,n=(e=[],{slot:function(t,n){return e.push(t),If(tB,eB(t),n)},record:function(){return e}}),o=t(n),r=n.record(),i=W(r,function(t){return Of({name:t,pname:eB(t)})});return Kf(tB,nB,i,oB,o)}}),uB=wn([ce("icon"),ce("tooltip"),ve("onShow",at),ve("onHide",at),ve("onSetup",function(){return at})]),aB=function(t){return{element:function(){return t.element.dom}}},cB=function(e,o){var r=W(It(o),function(t){var n=o[t],e=Pn(Vn("sidebar",uB,n));return{name:t,getApi:aB,onSetup:e.onSetup,onShow:e.onShow,onHide:e.onHide}});return W(r,function(t){var n=we(at);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Kh([tb(t,n),nb(t,n),dr(Qo(),function(n,t){var e=t.event;K(r,function(t){return t.name===e.name}).each(function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))})})])})})},sB=function(t,e){ud.getCurrent(t).each(function(t){return yg.set(t,[(n=e,iB.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:cB(t,n),slotBehaviours:Kh([yr(function(t){return iB.hideAllSlots(t)})])}}))]);var n})},lB=function(t){return ud.getCurrent(t).bind(function(t){return RT.isGrowing(t)||RT.hasGrown(t)?ud.getCurrent(t).bind(function(n){return K(iB.getSlotNames(n),function(t){return iB.isShowing(n,t)})}):st.none()})},fB=mi("FixSizeEvent"),dB=mi("AutoSizeEvent"),mB=function(t){var n,e,o,r=ke.fromHtml(t),i=Vr(r),u=(e=(n=r).dom.attributes!==undefined?n.dom.attributes:[],q(e,function(t,n){var e;return"class"===n.name?t:ct(ct({},t),((e={})[n.name]=n.value,e))},{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:ti(r)};return ct({tag:kr(r),classes:a,attributes:u},c)},gB=function(t,n,e){var o=t.element;!0===n?(yg.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:mB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:fc([gg.config({mode:"special",onTab:function(){return st.some(!0)},onShiftTab:function(){return st.some(!0)}}),Og.config({})])}]),lu(o,"display"),ai(o,"aria-hidden")):(yg.set(t,[]),ou(o,"display","none"),oi(o,"aria-hidden","true"))},pB=bD.optional({factory:ZD,name:"menubar",schema:[$n("backstage")]}),hB=bD.optional({factory:{sketch:function(t){return SD.sketch({uid:t.uid,dom:t.dom,listBehaviours:fc([gg.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return qT({type:t.type,uid:mi("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),st.some(!0)}})},setupItem:function(t,n,e){Q_.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[$n("dom"),$n("onEscape")]}),vB=bD.optional({factory:{sketch:function(t){var n;return((n=t).type===sh.sliding?YT:n.type===sh.floating?XT:qT)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),st.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[$n("dom"),$n("onEscape"),$n("getSink")]}),bB=bD.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?$D:kD;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:fc(e(n,t.sharedBackstage))}}},name:"header",schema:[$n("dom")]}),yB=bD.optional({name:"socket",schema:[$n("dom")]}),xB=bD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:fc([Zy.config({}),Og.config({}),RT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){ud.getCurrent(t).each(iB.hideAllSlots),or(t,dB)},onGrown:function(t){or(t,dB)},onStartGrow:function(t){rr(t,fB,{width:cu(t.element,"width").getOr("")})},onStartShrink:function(t){rr(t,fB,{width:Ru(t.element)+"px"})}}),yg.config({}),ud.config({find:function(t){var n=yg.contents(t);return ot(n)}})])}],behaviours:fc([xk(0),xg("sidebar-sliding-events",[dr(fB,function(t,n){ou(t.element,"width",n.event.width)}),dr(dB,function(t){lu(t.element,"width")})])])}}},name:"sidebar",schema:[$n("dom")]}),wB=bD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:fc([yg.config({})]),components:[]}}},name:"throbber",schema:[$n("dom")]}),SB=td({name:"OuterContainer",factory:function(e,t){var n={getSocket:function(t){return vD.getPart(t,e,"socket")},setSidebar:function(t,n){vD.getPart(t,e,"sidebar").each(function(t){return sB(t,n)})},toggleSidebar:function(t,o){vD.getPart(t,e,"sidebar").each(function(t){return n=t,e=o,void ud.getCurrent(n).each(function(n){ud.getCurrent(n).each(function(t){RT.hasGrown(n)?iB.isShowing(t,e)?RT.shrink(n):(iB.hideAllSlots(t),iB.showSlot(t,e)):(iB.hideAllSlots(t),iB.showSlot(t,e),RT.grow(n))})});var n,e})},whichSidebar:function(t){return vD.getPart(t,e,"sidebar").bind(lB).getOrNull()},getHeader:function(t){return vD.getPart(t,e,"header")},getToolbar:function(t){return vD.getPart(t,e,"toolbar")},setToolbar:function(t,n){vD.getPart(t,e,"toolbar").each(function(t){t.getApis().setGroups(t,n)})},setToolbars:function(t,n){vD.getPart(t,e,"multiple-toolbar").each(function(t){SD.setItems(t,n)})},refreshToolbar:function(t){vD.getPart(t,e,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(t){vD.getPart(t,e,"toolbar").each(function(n){var t,e;e=function(t){return t(n)},(t=n.getApis().toggle)!==undefined&&null!==t?st.some(e(t)):st.none()})},isToolbarDrawerToggled:function(t){return vD.getPart(t,e,"toolbar").bind(function(n){return st.from(n.getApis().isOpen).map(function(t){return t(n)})}).getOr(!1)},getThrobber:function(t){return vD.getPart(t,e,"throbber")},focusToolbar:function(t){vD.getPart(t,e,"toolbar").orThunk(function(){return vD.getPart(t,e,"multiple-toolbar")}).each(function(t){gg.focusIn(t)})},setMenubar:function(t,n){vD.getPart(t,e,"menubar").each(function(t){ZD.setMenus(t,n)})},focusMenubar:function(t){vD.getPart(t,e,"menubar").each(function(t){ZD.focus(t)})}};return{uid:e.uid,dom:e.dom,components:t,apis:n,behaviours:e.behaviours}},configFields:[$n("dom"),$n("behaviours")],partFields:[bB,pB,vB,hB,yB,xB,wB],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=W(e,UT);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=W(e,function(t){return W(t,UT)});t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),kB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},CB=function(t){return"string"==typeof t?t.split(" "):t},OB=function(i,u){var a=ct(ct({},kB),u.menus),n=0<It(u.menus).length,t=u.menubar===undefined||!0===u.menubar?CB("file edit view insert format tools table help"):CB(!1===u.menubar?"":u.menubar),e=X(t,function(t){return n&&u.menus.hasOwnProperty(t)&&u.menus[t].hasOwnProperty("items")||kB.hasOwnProperty(t)}),o=W(e,function(t){var n,e,o,r=a[t];return n={title:r.title,items:CB(r.items)},e=u,o=i.getParam("removed_menuitems","").split(/[ ,]/),{text:n.title,getItems:function(){return $(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||L(o,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return X(o,function(t){return 0<t.getItems().length&&L(t.getItems(),function(t){return"separator"!==t.type})})},_B=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},TB=function(n,e){return function(){return t={message:e},n.fire("SkinLoadError",t);var t}},EB=function(e,o,r){return new Hp(function(t,n){r.load(o,t,n),e.on("remove",function(){return r.unload(o)})})},DB=function(t,n){var e;return e=ke.fromDom(t.getElement()),Ur(e).isSome()?EB(t,n+"/skin.shadowdom.min.css",rv.DOM.styleSheetLoader):Hp.resolve()},BB=function(t,n){var e,o,r,i,u,a=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):xv.baseURL+"/skins/ui/"+o),i);a&&n.contentCSS.push(a+(t?"/content.inline":"/content")+".min.css"),0==(!1===n.getParam("skin"))&&E(a)?Hp.all([EB(u=n,a+"/skin.min.css",u.ui.styleSheetLoader),DB(n,a)]).then(_B(n),TB(n,"Skin could not be loaded")):_B(n)()},AB=b(BB,!1),MB=b(BB,!0),FB=function(e,t,o,r){var n,i=t.outerContainer,u=o.toolbar,a=o.buttons;R(u,E)?(n=u.map(function(t){var n={toolbar:t,buttons:a,allowToolbarGroups:o.allowToolbarGroups};return fD(e,n,{backstage:r},st.none())}),SB.setToolbars(i,n)):SB.setToolbar(i,fD(e,o,{backstage:r},st.none()))},IB=Qe(),RB=IB.os.isiOS()&&IB.os.version.major<=12,VB=function(e,t){var n=e.dom,o=e.getWin(),r=e.getDoc().documentElement,i=we(Bu(o.innerWidth,o.innerHeight)),u=we(Bu(r.offsetWidth,r.offsetHeight)),a=function(){var t=i.get();t.left===o.innerWidth&&t.top===o.innerHeight||(i.set(Bu(o.innerWidth,o.innerHeight)),Nb(e))},c=function(){var t=e.getDoc().documentElement,n=u.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(u.set(Bu(t.offsetWidth,t.offsetHeight)),Nb(e))},s=function(t){return n=t,e.fire("ScrollContent",n);var n};n.bind(o,"resize",a),n.bind(o,"scroll",s);var l=Dy(ke.fromDom(e.getBody()),"load",c),f=t.uiMothership.element;e.on("hide",function(){ou(f,"display","none")}),e.on("show",function(){lu(f,"display")}),e.on("NodeChange",c),e.on("remove",function(){l.unbind(),n.unbind(o,"resize",a),n.unbind(o,"scroll",s),o=null})},PB=Object.freeze({__proto__:null,render:function(e,n,t,o,r){var i=we(0),u=n.outerContainer;AB(e);var a,c,s=ke.fromDom(r.targetNode),l=jr(Lr(s));a=s,c=n.mothership,vl(a,c,Yr),hl(l,n.uiMothership),e.on("PostRender",function(){FB(e,n,t,o),i.set(e.getWin().innerWidth),SB.setMenubar(u,OB(e,t)),SB.setSidebar(u,t.sidebar),VB(e,n)});var f,d,m,g,p,h=SB.getSocket(u).getOrDie("Could not find expected socket element");RB&&(ru(h.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),m=function(){e.fire("ScrollContent")},g=20,p=null,f={cancel:function(){null!==p&&(clearTimeout(p),p=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===p&&(p=setTimeout(function(){m.apply(null,t),p=null},g))}},d=Ey(h.element,"scroll",f.throttle),e.on("remove",d.unbind)),Yv(e,n),e.addCommand("ToggleSidebar",function(t,n){SB.toggleSidebar(u,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return SB.whichSidebar(u)});var v=Fv(e);v!==sh.sliding&&v!==sh.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=e.getWin().innerWidth;t!==i.get()&&(SB.refreshToolbar(n.outerContainer),i.set(t))});var b={enable:function(){Xv(n,!1)},disable:function(){Xv(n,!0)},isDisabled:function(){return yv.isDisabled(u)}};return{iframeContainer:h.element.dom,editorContainer:u.element.dom,api:b}}}),HB=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?st.some(parseInt(""+t,10)):st.none()},zB=function(t){return lt(t)?t+"px":t},NB=function(n,t,e){var o=t.filter(function(t){return n<t}),r=e.filter(function(t){return t<n});return o.or(r).getOr(n)},LB=function(t){var n,e,o,r;return(e=wv(n=t),o=Cv(n),r=_v(n),HB(e).map(function(t){return NB(t,o,r)})).getOr(wv(t))},jB=function(t){var n=Sv(t),e=kv(t),o=Ov(t);return HB(n).map(function(t){return NB(t,e,o)})},UB=function(a,c,t,n,s){var e=t.uiMothership,l=t.outerContainer,o=rv.DOM,f=Nv(a),d=Uv(a),m=Ov(a).or(jB(a)),r=n.shared.header,g=r.isPositionedAtTop,i=Fv(a),p=i===sh.sliding||i===sh.floating,u=we(!1),h=function(){return u.get()&&!a.removed},v=function(t){return p?t.fold(function(){return 0},function(t){return 1<t.components().length?Tu(t.components()[1].element):0}):0},b=function(){e.broadcastOn([Bl()],{})},y=function(t){var n,e,o,r,i,u;void 0===t&&(t=!1),h()&&(f||(n=m.getOrThunk(function(){var t=HB(uu(Zi(),"margin-left")).getOr(0);return Ru(Zi())-Mu(c).left+t}),ou(s.get().element,"max-width",n+"px")),p&&SB.refreshToolbar(l),f||(e=SB.getToolbar(l),o=v(e),r=qu(c),i=g()?Math.max(r.y-Tu(s.get().element)+o,0):r.bottom,ru(l.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(r.x)+"px"})),d&&(u=s.get(),t?WD.reset(u):WD.refresh(u)),b())},x=function(t){var n,e;void 0===t&&(t=!0),!f&&d&&h()&&(n=r.getDockingMode(),(e=function(t){switch(Pv(a)){case Av.auto:var n=SB.getToolbar(l),e=v(n),o=Tu(t.element)-e,r=qu(c);if(r.y>o)return"top";var i=Ar(c),u=Math.max(i.dom.scrollHeight,Tu(i));return r.bottom<u-o||Ju().bottom<r.bottom-o?"bottom":"top";case Av.bottom:return"bottom";case Av.top:default:return"top"}}(s.get()))!==n&&(function(t){var n=s.get();WD.setModes(n,[t]),r.setDockingMode(t);var e=g()?aa.TopToBottom:aa.BottomToTop;oi(n.element,Zc,e)}(e),t&&y(!0)))};return{isVisible:h,isPositionedAtTop:g,show:function(){u.set(!0),ou(l.element,"display","flex"),o.addClass(a.getBody(),"mce-edit-focus"),lu(e.element,"display"),x(!1),y()},hide:function(){u.set(!1),t.outerContainer&&(ou(l.element,"display","none"),o.removeClass(a.getBody(),"mce-edit-focus")),ou(e.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},WB=function(t,n){var e=qu(t);return{pos:n?e.y:e.bottom,bounds:e}},GB=Object.freeze({__proto__:null,render:function(n,e,o,r,t){var i=e.mothership,u=e.uiMothership,a=e.outerContainer,c=we(null),s=ke.fromDom(t.targetNode),l=UB(n,s,e,r,c),f=n.getParam("toolbar_persist",!1,"boolean");MB(n);var d=function(){var t;c.get()?l.show():(c.set(SB.getHeader(a).getOrDie()),t=Lv(n),hl(t,i),hl(t,u),FB(n,e,o,r),SB.setMenubar(a,OB(n,o)),l.show(),function(c,s,l,t){var f=we(WB(s,l.isPositionedAtTop())),n=function(t){var n=WB(s,l.isPositionedAtTop()),e=n.pos,o=n.bounds,r=f.get(),i=r.pos,u=r.bounds,a=o.height!==u.height||o.width!==u.width;f.set({pos:e,bounds:o}),a&&Nb(c,t),l.isVisible()&&(i!==e?l.update(!0):a&&(l.updateMode(),l.repositionPopups()))};t||(c.on("activate",l.show),c.on("deactivate",l.hide)),c.on("SkinLoaded ResizeWindow",function(){return l.update(!0)}),c.on("NodeChange keydown",function(t){xp.requestAnimationFrame(function(){return n(t)})}),c.on("ScrollWindow",function(){return l.updateMode()});var e=tD();e.set(Dy(ke.fromDom(c.getBody()),"load",n)),c.on("remove",function(){e.clear()})}(n,s,l,f),n.nodeChanged())};n.on("show",d),n.on("hide",l.hide),f||(n.on("focus",d),n.on("blur",l.hide)),n.on("init",function(){(n.hasFocus()||f)&&d()}),Yv(n,e);var m={show:function(){l.show()},hide:function(){l.hide()},enable:function(){Xv(e,!1)},disable:function(){Xv(e,!0)},isDisabled:function(){return yv.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),XB=function(t,n){var e,o,r,i,u,a,c,s,l,f,d,m,g,p;r=ME(0,o=n,jE(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=ME(0,u=n,XE(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,l=ct({type:"advanced"},(s=n).styleselect),f=ME(0,s,rD(c,l)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return f.items.validateItems(f.getStyleItems())}}),m=ME(0,n,oD(d=t)),d.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return m.items.validateItems(m.getStyleItems())}}),p=ME(0,n,JE(g=t)),g.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return p.items.validateItems(p.getStyleItems())}})},YB={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},qB=(RE="[eE][+-]?[0-9]+",PE=["Infinity",(IE="[0-9]+")+"\\."+(VE=function(t){return"(?:"+t+")?"})(IE)+VE(RE),"\\."+IE+VE(RE),IE+VE(RE)].join("|"),new RegExp("^([+-]?(?:"+PE+"))(.*)$")),KB=function(t,r){return st.from(qB.exec(t)).bind(function(t){var n,e=Number(t[1]),o=t[2];return n=o,L(r,function(t){return L(YB[t],function(t){return n===t})})?st.some({value:e,unit:o}):st.none()})},JB=function(t){return KB(t,["fixed","relative","empty"]).map(function(t){return t.value+t.unit}).getOr(t)},$B=function(o){var r=o.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),i=new Map,u=ZE(),a=function(){var t=JB(o.queryCommandValue("LineHeight"));st.from(i.get(t)).fold(function(){return u.clear()},function(t){u.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)})};return o.on("nodeChange",a),W(r,function(n,e){return{type:"togglemenuitem",text:n,onSetup:function(t){return i.set(JB(n),t),e+1===r.length&&a(),function(){0===e&&(o.off("nodeChange",a),u.clear())}},onAction:function(){return o.execCommand("LineHeight",!1,n)}}})},QB=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return $B(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t($B(e))}})},ZB=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},tA=function(t){var n,e;!function(n){Ck.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:nD(n,t.name),onAction:ZB(n,t.name)})});for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:nD(n,e),onAction:ZB(n,e)})}}(t),n=t,Ck.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}),e=t,Ck.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:nD(e,t.name)})})},nA=function(t){var n;tA(t),n=t,Ck.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:ZB(n,"code")})},eA=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},oA=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return eA(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return eA(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return eA(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return eA(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},rA=function(t,n){var e,o,r,i;!function(n){Ck.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:nD(n,t.name)})});var t="alignnone",e="No alignment",o="JustifyNone",r="align-none";n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})}(t),nA(t),XB(t,n),oA(t),function(t){Kb(t);var n=we(null),e=we(null);ny(t,"forecolor","forecolor","Text color",n),ny(t,"backcolor","hilitecolor","Background color",e),ey(t,"forecolor","forecolor","Text color"),ey(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),QB(t)},iA=function(t,n){return{anchor:"makeshift",x:t,y:n}},uA=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},aA=function(t,n){var e,o,r,i=rv.DOM.getPos(t);return e=n,o=i.x,r=i.y,iA(e.x+o,e.y+r)},cA=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(uA(t)){var n=t.touches[0];return iA(n.pageX,n.pageY)}return iA(t.pageX,t.pageY)}(n):aA(t.getContentAreaContainer(),function(t){if(uA(t)){var n=t.touches[0];return iA(n.clientX,n.clientY)}return iA(t.clientX,t.clientY)}(n)):sA(t)},sA=function(t){return{anchor:"selection",root:ke.fromDom(t.selection.getNode())}},lA=function(t){return{anchor:"node",node:st.some(ke.fromDom(t.selection.getNode())),root:ke.fromDom(t.getBody())}},fA=function(t,n,e,o,r,i){var u=e(),a=i?lA(t):cA(t,n);WC(u,fh.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),cp.showMenuAt(r,a,{menu:{markers:Ch("normal")},data:t})})},dA={onLtr:function(){return[Ka,Wa,Ga,Xa,Ya,qa,bp,yp,hp,gp,vp,pp]},onRtl:function(){return[Ka,Ga,Wa,Ya,Xa,qa,bp,yp,vp,pp,hp,gp]}},mA={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},gA=function(n,e,t,o,r,i,u){var a,c,s=i?lA(n):(a=n,c=e,ct({bubble:Wc(0,12,mA),layouts:dA,overrides:{maxWidthFunction:q_(),maxHeightFunction:zc()}},cA(a,c)));WC(t,fh.CLOSE_ON_EXECUTE,o,!0).map(function(t){e.preventDefault(),cp.showMenuWithinBounds(r,s,{menu:{markers:Ch("normal"),highlightImmediately:u},data:t,type:"horizontal"},function(){return st.some(kE(n,o.shared))}),n.fire(K_)})},pA=function(n,e,o,r,i,u){var t,a=Qe(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var t=o();gA(n,e,t,r,i,u,!(l||c||s&&f))};!s&&!c||u?(l&&!u&&n.selection.setCursorLocation(e.target,0),d()):(t=function(){!function(t){var n=t.selection.getRng(),e=function(){xp.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(n),d()},function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return Ps(t.getWin(),xs.domRange(r)).exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})}(n,e)?t():(n.once("selectionchange",t),n.once("touchend",function(){return n.off("selectionchange",t)})))},hA=function(t){return"string"==typeof t?t.split(/[ ,]/):t},vA=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},bA=function(t){return e="contextmenu",o="link linkchecker image imagetools table spellchecker configurepermanentpen",r=(n=t).ui.registry.getAll().contextMenus,st.from(n.getParam(e)).map(hA).getOrThunk(function(){return X(hA(o),function(t){return Wt(r,t)})});var n,e,o,r},yA=function(t){return E(t)?"|"===t:"separator"===t.type},xA={type:"separator"},wA=function(n){var t,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(E(n))return n;switch(n.type){case"separator":return xA;case"submenu":return ct(ct({type:"nestedmenuitem"},e(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return E(t)?t:W(t,wA)}});default:return ct(ct({type:"menuitem"},e(n)),{onAction:(t=n.onAction,function(){return t()})})}},SA=function(t,n){if(0===n.length)return t;var e=rt(t).filter(function(t){return!yA(t)}).fold(function(){return[]},function(){return[xA]});return t.concat(e).concat(n).concat([xA])},kA=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},CA=function(t,n){return kA(t,n)?t.selection.getStart(!0):n.target},OA=function(a,t,e){var o=Qe().deviceType.isTouch,r=ku(cp.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return a.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:fc([xg("dismissContextMenu",[dr(Ko(),function(t){El.close(t),a.focus()})])])})),n=function(){return cp.hide(r)},i=function(u){var t,n;vA(a)&&u.preventDefault(),t=a,u.ctrlKey&&!vA(t)||!1===a.getParam("contextmenu")||(n=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(kA(t,n))return!0;if(e){var o=CA(t,n);return Ay(ke.fromDom(o),e)}return!1}(a,u),(o()?pA:fA)(a,u,function(){var n,r,t,e=CA(a,u),o=a.ui.registry.getAll(),i=bA(a);return n=o.contextMenus,r=e,0<(t=q(i,function(o,t){return Ut(n,t.toLowerCase()).map(function(t){var n=t.update(r);if(E(n))return SA(o,n.split(" "));if(0<n.length){var e=W(n,wA);return SA(o,e)}return o}).getOrThunk(function(){return o.concat([t])})},[])).length&&yA(t[t.length-1])&&t.pop(),t},e,r,n))};a.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");a.on(t,n),a.on("longpress contextmenu",i)})},_A=Xt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),TA=function(n){return function(t){return t.translate(-n.left,-n.top)}},EA=function(n){return function(t){return t.translate(n.left,n.top)}},DA=function(e){return function(t,n){return q(e,function(t,n){return n(t)},Bu(t,n))}},BA=function(t,n,e){return t.fold(DA([EA(e),TA(n)]),DA([TA(n)]),DA([]))},AA=function(t,n,e){return t.fold(DA([EA(e)]),DA([]),DA([EA(n)]))},MA=function(t,n,e){return t.fold(DA([]),DA([TA(e)]),DA([EA(n),TA(e)]))},FA=function(t,n,e){var o=t.fold(function(t,n){return{position:st.some("absolute"),left:st.some(t+"px"),top:st.some(n+"px")}},function(t,n){return{position:st.some("absolute"),left:st.some(t-e.left+"px"),top:st.some(n-e.top+"px")}},function(t,n){return{position:st.some("fixed"),left:st.some(t+"px"),top:st.some(n+"px")}});return ct({right:st.none(),bottom:st.none()},o)},IA=function(t,i,u,a){var n=function(o,r){return function(t,n){var e=o(i,u,a);return r(t.getOr(e.left),n.getOr(e.top))}};return t.fold(n(MA,RA),n(AA,VA),n(BA,PA))},RA=_A.offset,VA=_A.absolute,PA=_A.fixed,HA=function(t,n){var e=ri(t,n);return M(e)?NaN:parseInt(e,10)},zA=function(t,n,e,o){return r=n,i=t.element,u=HA(i,r.leftAttr),a=HA(i,r.topAttr),(isNaN(u)||isNaN(a)?st.none():st.some(Bu(u,a))).fold(function(){return e},function(t){return PA(t.left+o.left,t.top+o.top)});var r,i,u,a},NA=function(t,n,e,o,r,i){var u,a,c,s=zA(t,n,e,o),l=(n.mustSnap?UA:WA)(t,n,s,r,i),f=BA(s,r,i);return u=n,a=f,c=t.element,oi(c,u.leftAttr,a.left+"px"),oi(c,u.topAttr,a.top+"px"),l.fold(function(){return{coord:PA(f.left,f.top),extra:st.none()}},function(t){return{coord:t.output,extra:t.extra}})},LA=function(t,n){var e,o;e=n,o=t.element,ai(o,
e.leftAttr),ai(o,e.topAttr)},jA=function(t,l,f,d){return gt(t,function(t){var n,e,o,r,i,u,a,c,s=t.sensor;return n=l,e=s,o=t.range.left,r=t.range.top,a=AA(n,i=f,u=d),c=AA(e,i,u),Math.abs(a.left-c.left)<=o&&Math.abs(a.top-c.top)<=r?st.some({output:IA(t.output,l,f,d),extra:t.extra}):st.none()})},UA=function(t,n,d,m,g){var e=n.getSnapPoints(t);return jA(e,d,m,g).orThunk(function(){return q(e,function(n,e){var t,o,r,i,u,a,c,s,l=e.sensor,f=(t=d,o=l,e.range.left,e.range.top,u=AA(t,r=m,i=g),a=AA(o,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top),Bu(c,s));return n.deltas.fold(function(){return{deltas:st.some(f),snap:st.some(e)}},function(t){return(f.left+f.top)/2<=(t.left+t.top)/2?{deltas:st.some(f),snap:st.some(e)}:n})},{deltas:st.none(),snap:st.none()}).snap.map(function(t){return{output:IA(t.output,d,m,g),extra:t.extra}})})},WA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return jA(i,e,o,r)},GA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f=n.getTarget(t.element);n.repositionTarget&&(r=Dr(t.element),s=Nu(r),l=i=_D(f),u={coord:IA((c=o).output,c.output,s,l),extra:c.extra},a=FA(u.coord,0,i),iu(f,a))}}),XA="data-initial-z-index",YA=function(t,n){var e;t.getSystem().addToGui(n),Fr((e=n).element).filter(Or).each(function(n){cu(n,"z-index").each(function(t){oi(n,XA,t)}),ou(n,"z-index",uu(e.element,"z-index"))})},qA=function(t){Fr(t.element).filter(Or).each(function(n){ii(n,XA).fold(function(){return lu(n,"z-index")},function(t){return ou(n,"z-index",t)}),ai(n,XA)}),t.getSystem().removeFromGui(t)},KA=function(t,n,e){return t.getSystem().build(Xy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},JA=le("snaps",[$n("getSnapPoints"),xa("onSensor"),$n("leftAttr"),$n("topAttr"),fe("lazyViewport",Ju),fe("mustSnap",!1)]),$A=[fe("useFixed",p),$n("blockerClass"),fe("getTarget",ut),fe("onDrag",at),fe("repositionTarget",!0),fe("onDrop",at),ve("getBounds",Ju),JA],QA=function(n){return t=cu(n,"left"),e=cu(n,"top"),o=cu(n,"position"),r=function(t,n,e){return("fixed"===e?PA:RA)(parseInt(t,10),parseInt(n,10))},(t.isSome()&&e.isSome()&&o.isSome()?st.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):st.none()).getOrThunk(function(){var t=Mu(n);return VA(t.left,t.top)});var t,e,o,r},ZA=function(e,t,i,u,a,c,n){var o,r,s,l,f,d,m,g,p;return o=t.fold(function(){var t,e,o,n=(t=i,e=c.left,o=c.top,t.fold(function(t,n){return RA(t+e,n+o)},function(t,n){return VA(t+e,n+o)},function(t,n){return PA(t+e,n+o)})),r=BA(n,u,a);return PA(r.left,r.top)},function(n){var t=NA(e,n,i,c,u,a);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord}),r=u,s=a,f=(l=n).bounds,d=AA(o,r,s),m=Mc(d.left,f.x,f.x+f.width-l.width),g=Mc(d.top,f.y,f.y+f.height-l.height),p=VA(m,g),o.fold(function(){var t=MA(p,r,s);return RA(t.left,t.top)},function(){return p},function(){var t=BA(p,r,s);return PA(t.left,t.top)})},tM=function(t,n){return{bounds:t.getBounds(),height:Eu(n.element),width:Vu(n.element)}},nM=function(d,m,t,n,e){var o=t.update(n,e),g=t.getStartData().getOrThunk(function(){return tM(m,d)});o.each(function(t){var n,e,o,r,i,u,a,c,s,l,f;n=d,o=g,r=t,f=(e=m).getTarget(n.element),e.repositionTarget&&(i=Dr(n.element),u=Nu(i),a=_D(f),c=QA(f),s=ZA(n,e.snaps,c,u,a,r,o),l=FA(s,0,a),iu(f,l)),e.onDrag(n,f,r)})},eM=function(n,t,e,o){t.each(qA),e.snaps.each(function(t){LA(n,t)});var r=e.getTarget(n.element);o.reset(),e.onDrop(n,r)},oM=function(t){return function(n,e){var o=function(t){e.setStartData(tM(n,t))};return sr(x([dr(Go(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o)))}},rM=Object.freeze({__proto__:null,getData:function(t){return st.from(Bu(t.x,t.y))},getDelta:function(t,n){return Bu(n.left-t.left,n.top-t.top)}}),iM=function(a,c,s){return[dr(ho(),function(n,t){var e,o,r,i,u;0===t.event.raw.button&&(t.stop(),r={drop:e=function(){return eM(n,st.some(i),a,c)},delayDrop:(o=My(e,200)).schedule,forceDrop:e,move:function(t){o.cancel(),nM(n,a,c,rM,t)}},i=KA(n,a.blockerClass,(u=r,sr([dr(ho(),u.forceDrop),dr(yo(),u.drop),dr(vo(),function(t,n){u.move(n.event)}),dr(bo(),u.delayDrop)]))),s(n),YA(n,i))})]},uM=x($A,[Ca("dragger",{handlers:oM(iM)})]),aM=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],st.some(Bu(n.clientX,n.clientY))):st.none()},getDelta:function(t,n){return Bu(n.left-t.left,n.top-t.top)}}),cM=function(u,a,c){var s=we(st.none());return[dr(fo(),function(n,t){t.stop();var e,o=function(){eM(n,s.get(),u,a),s.set(st.none())},r={drop:o,delayDrop:at,forceDrop:o,move:function(t){nM(n,u,a,aM,t)}},i=KA(n,u.blockerClass,(e=r,sr([dr(fo(),e.forceDrop),dr(go(),e.drop),dr(po(),e.drop),dr(mo(),function(t,n){e.move(n.event)})])));s.set(st.some(i)),c(n),YA(n,i)}),dr(mo(),function(t,n){n.stop(),nM(t,u,a,aM,n.event)}),dr(go(),function(t,n){n.stop(),eM(t,s.get(),u,a),s.set(st.none())}),dr(po(),function(t){eM(t,s.get(),u,a),s.set(st.none())})]},sM=x($A,[Ca("dragger",{handlers:oM(cM)})]),lM=x($A,[Ca("dragger",{handlers:oM(function(t,n,e){return x(iM(t,n,e),cM(t,n,e))})})]),fM=pc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:uM,touch:sM,mouseOrTouch:lM}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:st.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var i=st.none(),n=st.none(),t=it({});return Bi({readState:t,reset:function(){i=st.none(),n=st.none()},update:function(r,t){return r.getData(t).bind(function(t){return n=r,e=t,o=i.map(function(t){return n.getDelta(t,e)}),i=st.some(e),o;var n,e,o})},getStartData:function(){return n},setStartData:function(t){n=st.some(t)}})}}),apis:GA}),dM=function(t,r,i,u,n,e){return t.fold(function(){return fM.snap({sensor:VA(i-20,u-20),range:Bu(n,e),output:VA(st.some(i),st.some(u)),extra:{td:r}})},function(t){var n=i-20,e=u-20,o=t.element.dom.getBoundingClientRect();return fM.snap({sensor:VA(n,e),range:Bu(40,40),output:VA(st.some(i-o.width/2),st.some(u-o.height/2)),extra:{td:r}})})},mM=function(t,i,u){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,n){var e,o,r=n.td;e=i.get(),o=r,e.exists(function(t){return no(t,o)})||(i.set(st.some(r)),u(r))},mustSnap:!0}},gM=function(t){return Sp(wp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:fc([fM.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),vw.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},pM=function(s,e){var o=we([]),r=we([]),t=we(!1),i=we(st.none()),u=we(st.none()),n=function(t){var n=Ku(t);return dM(f.getOpt(e),t,n.x,n.y,n.width,n.height)},a=function(t){var n=Ku(t);return dM(d.getOpt(e),t,n.right,n.bottom,n.width,n.height)},c=mM(function(){return W(o.get(),n)},i,function(n){u.get().each(function(t){s.fire("TableSelectorChange",{start:n,finish:t})})}),l=mM(function(){return W(r.get(),a)},u,function(n){i.get().each(function(t){s.fire("TableSelectorChange",{start:t,finish:n})})}),f=gM(c),d=gM(l),m=ku(f.asSpec()),g=ku(d.asSpec()),p=function(t,c,n,e){var o=n(c);fM.snapTo(t,o),function(t,n,e,o){var r=c.dom.getBoundingClientRect();lu(t.element,"display");var i=Mr(ke.fromDom(s.getBody())).dom.innerHeight,u=e(r),a=o(r,i);(u||a)&&ou(t.element,"display","none")}(t,0,function(t){return t[e]<0},function(t,n){return t[e]>n})},h=function(t){return p(m,t,n,"top")},v=function(t){return p(g,t,a,"bottom")};Qe().deviceType.isTouch()&&(s.on("TableSelectionChange",function(n){t.get()||(fl(e,m),fl(e,g),t.set(!0)),i.set(st.some(n.start)),u.set(st.some(n.finish)),n.otherCells.each(function(t){o.set(t.upOrLeftCells),r.set(t.downOrRightCells),h(n.start),v(n.finish)})}),s.on("ResizeEditor ResizeWindow ScrollContent",function(){i.get().each(h),u.get().each(v)}),s.on("TableSelectionClear",function(){t.get()&&(gl(m),gl(g),t.set(!1)),i.set(st.none()),u.set(st.none())}))};(zE=HE=HE||{})[zE.None=0]="None",zE[zE.Both=1]="Both",zE[zE.Vertical=2]="Vertical";var hM,vM,bM,yM=function(t,n,e){var o,r,i,u,a,c,s=ke.fromDom(t.getContainer()),l=(o=t,r=n,i=e,u=Tu(s),a=Ru(s),(c={}).height=NB(u+r.top,Cv(o),_v(o)),i===HE.Both&&(c.width=NB(a+r.left,kv(o),Ov(o))),c);Vt(l,function(t,n){return ou(s,n,zB(t)),0}),t.fire("ResizeEditor")},xM=function(i,u,a){return u.delimiter||(u.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:fc([gg.config({mode:"flow",selector:"div[role=button]"}),yv.config({disabled:a.isDisabled}),qv(),Zy.config({}),yg.config({}),xg("elementPathEvents",[yr(function(r){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return gg.focusIn(r)}),i.on("NodeChange",function(t){var n,o,e=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<e.length?yg.set(r,(n=W(e||[],function(t,n){return wp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":n,"tab-index":-1,"aria-level":n+1},innerHtml:t.name},action:function(){i.focus(),i.selection.select(t.element),i.nodeChanged()},buttonBehaviours:fc([Jv(a.isDisabled),qv()])})}),o={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+u.delimiter+" "}},q(n.slice(1),function(t,n){var e=t;return e.push(o),e.push(n),e},[n[0]]))):yg.set(r,[])})})])]),components:[]}},wM=function(o,t){var n,e,r,i,u,a,c,s,l,f,d,m;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(m=[],o.getParam("elementpath",!0,"boolean")&&m.push(xM(o,{},t)),o.hasPlugin("wordcount")&&m.push((c=o,s=t,f=function(t,n,e){return yg.set(t,[xu(s.translate(["{0} "+e,n[e]]))])},wp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:fc([Jv(s.isDisabled),qv(),Zy.config({}),yg.config({}),ql.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),xg("wordcount-events",[Sr(function(t){var n=ql.getValue(t),e="words"===n.mode?"characters":"words";ql.setValue(t,{mode:e,count:n.count}),f(t,n.count,e)}),yr(function(e){c.on("wordCountUpdate",function(t){var n=ql.getValue(e).mode;ql.setValue(e,{mode:n,count:t.wordCount}),f(e,t.wordCount,n)})})])]),eventOrder:((l={})[Vo()]=["disabling","alloy.base.behaviour","wordcount-events"],l)}))),o.getParam("branding",!0,"boolean")&&m.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(d=iv.translate(["Powered by {0}","Tiny"]))+'">'+d+"</a>"}}),u=0<m.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:m}]:[],e=!(n=o).hasPlugin("autoresize"),(a=!1===(r=n.getParam("resize",e))?HE.None:"both"===r?HE.Both:HE.Vertical)!==HE.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:Cp("resize-handle",t.icons)},behaviours:fc([fM.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){yM(o,e,i)},blockerClass:"tox-blocker"})])})),u)}},SM=function(x){var t,n,e,o,r=x.inline,w=r?GB:PB,S=Uv(x)?QD:CD,i=st.none(),u=Qe(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=Hv(x),l=Lv(x),f=iv.isRtl()?{attributes:{dir:"rtl"}}:{},d={attributes:((t={})[Zc]=s?aa.BottomToTop:aa.TopToBottom,t)},k=function(){return i.bind(SB.getHeader)},m=function(){ou(it.element,"width",document.body.clientWidth+"px")},C=ku((n=no(Zi(),l)&&"grid"===uu(l,"display"),e={dom:ct({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},f),behaviours:fc([ul.config({useFixed:function(){return S.isDocked(k)}})])},o={dom:{styles:{width:document.body.clientWidth+"px"}},events:sr([dr(Xo(),m)])},Kt(e,n?o:{}))),O=function(){return vt.value(C)},g=Sp({dom:{tag:"div",classes:["tox-anchorbar"]}}),_=function(){return i.bind(function(t){return SB.getThrobber(t)}).getOrDie("Could not find throbber element")},T=Y_(C,x,function(){return i.bind(function(t){return g.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),p=SB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:T,onEscape:function(){x.focus()}}),E=Fv(x),h=SB.parts.toolbar(ct({dom:{tag:"div",classes:["tox-toolbar"]},getSink:O,providers:T.shared.providers,onEscape:function(){x.focus()},type:E,lazyToolbar:function(){return i.bind(function(t){return SB.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return k().getOrDie("Could not find header element")}},d)),v=SB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:T.shared.providers,onEscape:function(){x.focus()},type:E}),b=SB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),y=SB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),D=SB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:T}),B=x.getParam("statusbar",!0,"boolean")&&!r?st.some(wM(x,T.shared.providers)):st.none(),A={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[b,y]},M=Bv(x),F=Ev(x),I=Tv(x),R=SB.parts.header({dom:ct({tag:"div",classes:["tox-editor-header"]},d),components:dt([I?[p]:[],M?[v]:F?[h]:[],Nv(x)?[]:[g.asSpec()]]),sticky:Uv(x),editor:x,sharedBackstage:T.shared}),V=dt([s?[]:[R],r?[]:[A],s?[R]:[]]),P=dt([[{dom:{tag:"div",classes:["tox-editor-container"]},components:V}],r?[]:B.toArray(),[D]]),H=jv(x),z=ct(ct({role:"application"},iv.isRtl()?{dir:"rtl"}:{}),H?{"aria-hidden":"true"}:{}),N=ku(SB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(r?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:ct({visibility:"hidden"},H?{opacity:"0",border:"0"}:{}),attributes:z},components:P,behaviours:fc([qv(),yv.config({disableClass:"tox-tinymce--disabled"}),gg.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));i=st.some(N);x.shortcuts.add("alt+F9","focus menubar",function(){SB.focusMenubar(N)}),x.shortcuts.add("alt+F10","focus toolbar",function(){SB.focusToolbar(N)}),x.addCommand("ToggleToolbarDrawer",function(){SB.toggleToolbarDrawer(N)}),x.addQueryStateHandler("ToggleToolbarDrawer",function(){return SB.isToolbarDrawerToggled(N)});var L,j,U,W,G,X,Y,q,K,J,$,Q,Z,tt,nt,et,ot,rt=Yy(N),it=Yy(C);L=x,j=rt,U=it,W=function(n,e){ft([j,U],function(t){t.broadcastEvent(n,e)})},G=function(n,e){ft([j,U],function(t){t.broadcastOn([n],e)})},X=function(t){return G(Dl(),{target:t.target})},Y=Ey(ke.fromDom(document),"touchstart",X),q=Ey(ke.fromDom(document),"touchmove",function(t){return W(Uo(),t)}),K=Ey(ke.fromDom(document),"touchend",function(t){return W(Wo(),t)}),J=Ey(ke.fromDom(document),"mousedown",X),$=Ey(ke.fromDom(document),"mouseup",function(t){0===t.raw.button&&G(Al(),{target:t.target})}),Q=function(t){return G(Dl(),{target:ke.fromDom(t.target)})},Z=function(t){0===t.button&&G(Al(),{target:ke.fromDom(t.target)})},tt=function(t){return W(Go(),By(t))},nt=function(t){G(Bl(),{}),W(Xo(),By(t))},et=function(){return G(Bl(),{})},ot=function(t){t.state&&G(Dl(),{target:ke.fromDom(L.getContainer())})},L.on("PostRender",function(){L.on("click",Q),L.on("tap",Q),L.on("mouseup",Z),L.on("ScrollWindow",tt),L.on("ResizeWindow",nt),L.on("ResizeEditor",et),L.on("AfterProgressState",ot)}),L.on("remove",function(){L.off("click",Q),L.off("tap",Q),L.off("mouseup",Z),L.off("ScrollWindow",tt),L.off("ResizeWindow",nt),L.off("ResizeEditor",et),L.off("AfterProgressState",ot),J.unbind(),Y.unbind(),q.unbind(),K.unbind(),$.unbind()}),L.on("detach",function(){bl(j),bl(U),j.destroy(),U.destroy()});var ut=function(){var t,n=zB(LB(x)),e=zB(jB(t=x).getOr(Sv(t)));return x.inline||(su("div","width",e)&&ou(N.element,"width",e),su("div","height",n)?ou(N.element,"height",n):ou(N.element,"height","200px")),n};return{mothership:rt,uiMothership:it,backstage:T,renderUI:function(){var o,r,e,n,i,u,a,c;S.setup(x,T.shared,k),rA(x,T),OA(x,O,T),r=(o=x).ui.registry.getAll().sidebars,ft(It(r),function(n){var t=r[n],e=function(){return st.from(o.queryCommandValue("ToggleSidebar")).is(n)};o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){var n=function(){return t.setActive(e())};return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),e=x,n=_,i=T.shared,u=we(!1),a=we(st.none()),c=function(t){t!==u.get()&&(gB(n(),t,i.providers),u.set(t),e.fire("AfterProgressState",{state:t}))},e.on("ProgressState",function(t){var n;a.get().each(xp.clearTimeout),lt(t.time)?(n=xp.setEditorTimeout(e,function(){return c(t.state)},t.time),a.set(st.some(n))):(c(t.state),a.set(st.none()))}),Pt(x.getParam("toolbar_groups",{},"object"),function(t,n){x.ui.registry.addGroupToolbarButton(n,t)});var t,s=x.ui.registry.getAll(),l=s.buttons,f=s.menuItems,d=s.contextToolbars,m=s.sidebars,g=Dv(x),p={menuItems:f,menus:(t=x.getParam("menu"))?Pt(t,function(t){return ct(ct({},t),{items:t.items})}):{},menubar:x.getParam("menubar"),toolbar:g.getOrThunk(function(){return x.getParam("toolbar",!0)}),allowToolbarGroups:E===sh.floating,buttons:l,sidebar:m};hD(x,d,C,{backstage:T}),pM(x,C);var h=x.getElement(),v=ut(),b={mothership:rt,uiMothership:it,outerContainer:N},y={targetNode:h,height:v};return w.render(x,b,p,T,y)},getUi:function(){return{channels:{broadcastAll:it.broadcast,broadcastOn:it.broadcastOn,register:at}}}}},kM=it([$n("lazySink"),ie("dragBlockClass"),ve("getBounds",Ju),fe("useTabstopAt",S),fe("eventOrder",{}),Kl("modalBehaviours",[gg]),wa("onExecute"),ka("onEscape")]),CM={sketch:ut},OM=it([Tf({name:"draghandle",overrides:function(t,n){return{behaviours:fc([fM.config({mode:"mouse",getTarget:function(t){return ta(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Of({schema:[$n("dom")],name:"title"}),Of({factory:CM,schema:[$n("dom")],name:"close"}),Of({factory:CM,schema:[$n("dom")],name:"body"}),Tf({factory:CM,schema:[$n("dom")],name:"footer"}),_f({factory:{sketch:function(t,n){return ct(ct({},t),{dom:n.dom,components:n.components})}},schema:[fe("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),fe("components",[])],name:"blocker"})]),_M=Object.freeze({__proto__:null,block:function(t,n,e,o){oi(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=fc([gg.config({mode:"special",onTab:function(){return st.some(!0)},onShiftTab:function(){return st.some(!0)}}),Og.config({})]),u=o(r,i),a=r.getSystem().build(u);yg.append(r,Cu(a)),a.hasConfigured(gg)&&gg.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return yg.remove(r,a)})},unblock:function(t,n,e){ai(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),TM=[ve("getRoot",st.none),xa("onBlock"),xa("onUnblock")],EM=mc({fields:TM,name:"blocking",apis:_M,state:Object.freeze({__proto__:null,init:function(){var n=ZE();return Bi({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),DM=td({name:"ModalDialog",configFields:kM(),partFields:OM(),factory:function(a,t,n,r){var e,i=we(st.none()),o=mi("modal-events"),u=ct(ct({},a.eventOrder),((e={})[Yo()]=[o].concat(a.eventOrder["alloy.system.attached"]||[]),e));return{uid:a.uid,dom:a.dom,components:t,apis:{show:function(t){i.set(st.some(t));var n=a.lazySink(t).getOrDie(),e=r.blocker(),o=n.getSystem().build(ct(ct({},e),{components:e.components.concat([Cu(t)]),behaviours:fc([Og.config({}),xg("dialog-blocker-events",[br(wo(),function(){gg.focusIn(t)})])])}));fl(n,o),gg.focusIn(t)},hide:function(n){i.set(st.none()),Fr(n.element).each(function(t){n.getSystem().getByDom(t).each(function(t){gl(t)})})},getBody:function(t){return Nf(t,a,"body")},getFooter:function(t){return Nf(t,a,"footer")},setIdle:function(t){EM.unblock(t)},setBusy:function(t,n){EM.block(t,n)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:$l(a.modalBehaviours,[yg.config({}),gg.config({mode:"cyclic",onEnter:a.onExecute,onEscape:a.onEscape,useTabstopAt:a.useTabstopAt}),EM.config({getRoot:i.get}),xg(o,[yr(function(t){var n,e,o,r,i,u;n=t.element,e=Nf(t,a,"title").element,o=ii(n,"id").fold(function(){var t=mi("dialog-label");return oi(e,"id",t),t},ut),oi(n,"aria-labelledby",o),r=t.element,i=Nf(t,a,"body").element,u=st.from(ri(r,"id")).fold(function(){var t=mi("dialog-describe");return oi(i,"id",t),t},ut),oi(r,"aria-describedby",u)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),BM=wn([Zn("type"),Zn("name")].concat(Nh)),AM=Xn,MM=[En("name","name",en(function(){return mi("button-name")}),Gn),ce("icon"),pe("align","end",["start","end"]),he("primary",!1),he("disabled",!1)],FM=x(MM,[Zn("text")]),IM=x([te("type",["submit","cancel","custom"])],FM),RM=x([te("type",["menu"]),ce("text"),ce("tooltip"),ce("icon"),re("items",BM)],MM),VM=Ln("type",{submit:IM,cancel:IM,custom:IM,menu:RM}),PM=[Zn("type"),Zn("text"),te("level",["info","warn","error","success"]),Zn("icon"),fe("url","")],HM=wn(PM),zM=[Zn("type"),Zn("text"),he("disabled",!1),he("primary",!1),En("name","name",en(function(){return mi("button-name")}),Gn),ce("icon"),he("borderless",!1)],NM=wn(zM),LM=[Zn("type"),Zn("name"),Zn("label"),he("disabled",!1)],jM=wn(LM),UM=Xn,WM=[Zn("type"),Zn("name")],GM=WM.concat([ce("label")]),XM=GM.concat([fe("columns","auto")]),YM=wn(XM),qM=Mn([Zn("value"),Zn("text"),Zn("icon")]),KM=wn(GM),JM=Gn,$M=wn(GM),QM=Gn,ZM=WM.concat([ge("tag","textarea"),Zn("scriptId"),Zn("scriptUrl"),(hM=undefined,de("settings",hM,Kn))]),tF=WM.concat([ge("tag","textarea"),ne("init")]),nF=In(function(t){return Vn("customeditor.old",xn(tF),t).orThunk(function(){return Vn("customeditor.new",xn(ZM),t)})}),eF=Gn,oF=wn(GM),rF=Sn(An),iF=function(t){return[Zn("type"),Qn("columns",Wn),t]},uF=[Zn("type"),Zn("html"),pe("presets","presentation",["presentation","document"])],aF=wn(uF),cF=GM.concat([he("sandboxed",!0)]),sF=wn(cF),lF=Gn,fF=GM.concat([Qn("currentState",wn([$n("blob"),Zn("url")]))]),dF=wn(fF),mF=GM.concat([ce("inputMode"),ce("placeholder"),he("maximized",!1),he("disabled",!1)]),gF=wn(mF),pF=Gn,hF=[Zn("text"),Zn("value")],vF=[Zn("text"),re("items",(vM=function(){return bF},bM=$t(function(){return vM()}),{extract:function(t,n,e){return bM().extract(t,n,e)},toString:function(){return bM().toString()}}))],bF=kn([wn(hF),wn(vF)]),yF=GM.concat([re("items",bF),he("disabled",!1)]),xF=wn(yF),wF=Gn,SF=GM.concat([oe("items",[Zn("text"),Zn("value")]),me("size",1),he("disabled",!1)]),kF=wn(SF),CF=Gn,OF=GM.concat([he("constrain",!0),he("disabled",!1)]),_F=wn(OF),TF=wn([Zn("width"),Zn("height")]),EF=[Zn("type"),re("header",Gn),re("cells",Sn(Gn))],DF=wn(EF),BF=GM.concat([ce("placeholder"),he("maximized",!1),he("disabled",!1)]),AF=wn(BF),MF=Gn,FF=GM.concat([pe("filetype","file",["image","media","file"]),fe("disabled",!1)]),IF=wn(FF),RF=wn([Zn("value"),fe("meta",{})]),VF=function(n){return En("items","items",tn(),Sn(In(function(t){return Vn("Checking item of "+n,PF,t).fold(function(t){return vt.error(zn(t))},function(t){return vt.value(t)})})))},PF=Fn(function(){return Nn("type",{alertbanner:HM,bar:wn((n=VF("bar"),[Zn("type"),n])),button:NM,checkbox:jM,colorinput:KM,colorpicker:$M,dropzone:oF,grid:wn(iF(VF("grid"))),iframe:sF,input:gF,listbox:xF,selectbox:kF,sizeinput:_F,textarea:AF,urlinput:IF,customeditor:nF,htmlpanel:aF,imagetools:dF,collection:YM,label:wn((t=VF("label"),[Zn("type"),Zn("label"),t])),table:DF,panel:zF});var t,n}),HF=[Zn("type"),fe("classes",[]),re("items",PF)],zF=wn(HF),NF=[En("name","name",en(function(){return mi("tab-name")}),Gn),Zn("title"),re("items",PF)],LF=[Zn("type"),oe("tabs",NF)],jF=wn(LF),UF=FM,WF=VM,GF=wn([Zn("title"),Qn("body",Nn("type",{panel:zF,tabpanel:jF})),ge("size","normal"),re("buttons",WF),fe("initialData",{}),ve("onAction",at),ve("onChange",at),ve("onSubmit",at),ve("onClose",at),ve("onCancel",at),fe("onTabChange",at)]),XF=wn(x([te("type",["cancel","custom"])],UF)),YF=wn([Zn("title"),Zn("url"),ae("height"),ae("width"),ue("buttons",Sn(XF)),ve("onAction",at),ve("onCancel",at),ve("onClose",at),ve("onMessage",at)]),qF=function(t){return D(t)?[t].concat($(jt(t),qF)):B(t)?$(t,qF):[]},KF=function(t){return E(t.type)&&E(t.name)},JF={checkbox:UM,colorinput:JM,colorpicker:QM,dropzone:rF,input:pF,iframe:lF,sizeinput:TF,selectbox:CF,listbox:wF,size:TF,textarea:MF,urlinput:RF,customeditor:eF,collection:qM,togglemenuitem:AM},$F=function(t){var n=X(qF(t),KF),e=$(n,function(n){return t=n,st.from(JF[t.type]).fold(function(){return[]},function(t){return[Qn(n.name,t)]});var t});return wn(e)},QF=function(t){return{internalDialog:Pn(Vn("dialog",GF,t)),dataValidator:$F(t),initialData:t.initialData}},ZF={open:function(t,n){var e=QF(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Pn(Vn("dialog",YF,n)))},redial:QF},tI=function(t){var e=[],o={};return Vt(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?vt.error(e):vt.value(o)},nI=Zf({name:"TabButton",configFields:[fe("uid",undefined),$n("value"),En("dom","dom",on(function(){return{attributes:{role:"tab",id:mi("aria"),"aria-selected":"false"}}}),jn()),ie("action"),fe("domModification",{}),Kl("tabButtonBehaviours",[Og,gg,ql]),$n("view")],factory:function(t){return{uid:t.uid,dom:t.dom,components:t.components,events:zg(t.action),behaviours:$l(t.tabButtonBehaviours,[Og.config({}),gg.config({mode:"execution",useSpace:!0,useEnter:!0}),ql.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),eI=it([$n("tabs"),$n("dom"),fe("clickToDismiss",!1),Kl("tabbarBehaviours",[vd,gg]),ba(["tabClass","selectedClass"])]),oI=Ef({factory:nI,name:"tabs",unit:"tab",overrides:function(o){var r=function(t,n){vd.dehighlight(t,n),rr(t,tr(),{tabbar:t,button:n})},i=function(t,n){vd.highlight(t,n),rr(t,Zo(),{tabbar:t,button:n})};return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=vd.isHighlighted(n,t);(e&&o.clickToDismiss?r:e?at:i)(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),rI=it([oI]),iI=td({name:"Tabbar",configFields:eI(),partFields:rI(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:$l(t.tabbarBehaviours,[vd.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){oi(n.element,"aria-selected","true")},onDehighlight:function(t,n){oi(n.element,"aria-selected","false")}}),gg.config({mode:"flow",getInitial:function(t){return vd.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),uI=Zf({name:"Tabview",configFields:[Kl("tabviewBehaviours",[yg])],factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:$l(t.tabviewBehaviours,[yg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),aI=it([fe("selectFirst",!0),xa("onChangeTab"),xa("onDismissTab"),fe("tabs",[]),Kl("tabSectionBehaviours",[])]),cI=Of({factory:iI,schema:[$n("dom"),ee("markers",[$n("tabClass"),$n("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),sI=Of({factory:uI,name:"tabview"}),lI=it([cI,sI]),fI=td({name:"TabSection",configFields:aI(),partFields:lI(),factory:function(i,t){var n=function(t,n){zf(t,i,"tabbar").each(function(t){n(t).each(ir)})};return{uid:i.uid,dom:i.dom,components:t,behaviours:Jl(i.tabSectionBehaviours),events:sr(dt([i.selectFirst?[yr(function(t){n(t,vd.getFirst)})]:[],[dr(Zo(),function(t,n){var o,r,e=n.event.button;o=e,r=ql.getValue(o),zf(o,i,"tabview").each(function(e){K(i.tabs,function(t){return t.value===r}).each(function(t){var n=t.view();ii(o.element,"id").each(function(t){oi(e.element,"aria-labelledby",t)}),yg.set(e,n),i.onChangeTab(e,o,n)})})}),dr(tr(),function(t,n){var e=n.event.button;i.onDismissTab(t,e)})]])),apis:{getViewItems:function(t){return zf(t,i,"tabview").map(function(t){return yg.contents(t)}).getOr([])},showTab:function(t,e){n(t,function(n){var t=vd.getCandidates(n);return K(t,function(t){return ql.getValue(t)===e}).filter(function(t){return!vd.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),dI=function(t,n){ou(t,"height",n+"px"),Qe().browser.isIE()?lu(t,"flex-basis"):ou(t,"flex-basis",n+"px")},mI=function(t,m,n){ta(t,'[role="dialog"]').each(function(d){na(d,'[role="tablist"]').each(function(f){n.get().map(function(t){return ou(m,"height","0"),ou(m,"flex-basis","0"),Math.min(t,(e=m,o=f,r=Ar(n=d).dom,i=ta(n,".tox-dialog-wrap").getOr(n),u="fixed"===uu(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),a=Tu(e),c=e.dom.offsetLeft>=o.dom.offsetLeft+Ru(o)?Math.max(Tu(o),a):a,s=parseInt(uu(n,"margin-top"),10)||0,l=parseInt(uu(n,"margin-bottom"),10)||0,u-(Tu(n)+s+l-c)));var n,e,o,r,i,u,a,c,s,l}).each(function(t){dI(m,t)})})})},gI=function(t){return na(t,'[role="tabpanel"]')},pI=function(a){var c;return{smartTabHeight:(c=we(st.none()),{extraEvents:[yr(function(t){var e=t.element;gI(e).each(function(u){var n;ou(u,"visibility","hidden"),t.getSystem().getByDom(u).toOptional().each(function(t){var o,r,i,n=(r=u,i=t,W(o=a,function(t,n){yg.set(i,o[n].view());var e=r.dom.getBoundingClientRect();return yg.set(i,[]),e.height})),e=ot(nt(n,function(t,n){return n<t?-1:t<n?1:0}));c.set(e)}),mI(e,u,c),lu(u,"visibility"),n=t,ot(a).each(function(t){return fI.showTab(n,t.value)}),xp.requestAnimationFrame(function(){mI(e,u,c)})})}),dr(Xo(),function(t){var n=t.element;gI(n).each(function(t){mI(n,t,c)})}),dr(mx,function(t){var r=t.element;gI(r).each(function(n){var t=xc(Lr(n));ou(n,"visibility","hidden");var e=cu(n,"height").map(function(t){return parseInt(t,10)});lu(n,"height"),lu(n,"flex-basis");var o=n.dom.getBoundingClientRect().height;e.forall(function(t){return t<o})?(c.set(st.from(o)),mI(r,n,c)):e.each(function(t){dI(n,t)}),lu(n,"visibility"),t.each(yc)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},hI="send-data-to-section",vI="send-data-to-view",bI=mi("update-dialog"),yI=mi("update-title"),xI=mi("update-body"),wI=mi("update-footer"),SI=mi("body-send-message"),kI=function(t,n,d,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:ct(ct({},n.map(function(t){return{id:t}}).getOr({})),e?{"aria-live":"polite"}:{})},components:[],behaviours:fc([xk(0),oE.config({channel:xI,updateState:function(t,n){return st.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(r=t.body,i=d,u=we({}),a=function(t){var n=ql.getValue(t),e=tI(n).getOr({}),o=u.get(),r=Kt(o,e);u.set(r)},c=function(t){var n=u.get();ql.setValue(t,n)},s=we(null),l=W(r.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:i.shared.providers.translate(t.title)},view:function(){return[lk.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:W(t.items,function(t){return a_(n,t,i)}),formBehaviours:fc([gg.config({mode:"acyclic",useTabstopAt:w(zk)}),xg("TabView.form.events",[yr(c),xr(a)]),vc.config({channels:cn([{key:hI,value:{onReceive:a}},{key:vI,value:{onReceive:c}}])})])}})]}}}),f=pI(l).smartTabHeight,fI.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n){var e=ql.getValue(n);rr(t,dx,{name:e,oldName:s.get()}),s.set(e)},tabs:l,components:[fI.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[iI.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:fc([Zy.config({})])}),fI.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:f.selectFirst,tabSectionBehaviours:fc([xg("tabpanel",f.extraEvents),gg.config({mode:"acyclic"}),ud.config({find:function(t){return ot(fI.getViewItems(t))}}),ql.config({store:{mode:"manual",
getValue:function(t){return t.getSystem().broadcastOn([hI],{}),u.get()},setValue:function(t,n){u.set(n),t.getSystem().broadcastOn([vI],{})}}})])}))];default:return[(e=t.body,o=d,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(n=Sp(lk.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:W(e.items,function(t){return a_(n,t,o)})}}))).asSpec()]}],behaviours:fc([gg.config({mode:"acyclic",useTabstopAt:w(zk)}),yk(n),Ek(n,{postprocess:function(t){return tI(t).fold(function(t){return console.error(t),{}},function(t){return t})}})])})]}var e,o,n,r,i,u,a,c,s,l,f},initialData:t})])}},CI=ub.deviceType.isTouch(),OI=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},_I=function(t,n){return DM.parts.close(wp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:fc([Zy.config({})])}))},TI=function(){return DM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},EI=function(t,n){return DM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:mB("<p>"+n.translate(t)+"</p>")}]}]})},DI=function(t){return DM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},BI=function(t,n){return[Xy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Xy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},AI=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return DM.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),st.some(!0)},useTabstopAt:function(t){return!zk(t)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:ct({position:"relative"},n.extraStyles)},components:x([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:mB('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:CI?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:fc(x([Og.config({}),xg("dialog-events",n.dialogEvents.concat([br(wo(),function(t){gg.focusIn(t)})])),xg("scroll-lock",[yr(function(){Gi(Zi(),i)}),xr(function(){Yi(Zi(),i)})])],n.extraBehaviours)),eventOrder:ct(((t={})[Vo()]=["dialog-events"],t[Yo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[qo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},MI=function(t){return wp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Cp("close",t.icons)}}],action:function(t){or(t,ax)}})},FI=function(t,n,e){var o=function(t){return[xu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:ct({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:fc([oE.config({channel:yI,renderComponents:o})])}},II=function(){return{dom:mB('<div class="tox-dialog__draghandle"></div>')}},RI=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=DM.parts.title(FI(e,st.none(),o)),i=DM.parts.draghandle(II()),u=DM.parts.close(MI(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),Xy.sketch({dom:mB('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},VI=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:mB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},PI=function(t,o,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){DM.setBusy(t(),function(t,n){return VI(e.message,n,o)})},onUnblock:function(){DM.setIdle(t())}}},HI=function(t,n,e,o){var r;return ku(AI(ct(ct({},t),{lazySink:o.shared.getSink,extraBehaviours:x([oE.config({channel:bI,updateState:function(t,n){return st.some(n)},initialData:n}),Ak({})],t.extraBehaviours),onEscape:function(t){or(t,ax)},dialogEvents:e,eventOrder:((r={})[Ro()]=[oE.name(),vc.name()],r[Yo()]=["scroll-lock",oE.name(),"messages","dialog-events","alloy.base.behaviour"],r[qo()]=["alloy.base.behaviour","dialog-events","messages",oE.name(),"scroll-lock"],r)})))},zI=function(t){return W(t,function(t){return"menu"===t.type?(e=W((n=t).items,function(t){var n=we(!1);return ct(ct({},t),{storage:n})}),ct(ct({},n),{items:e})):t;var n,e})},NI=function(t){return q(t,function(t,n){return"menu"!==n.type?t:q(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})},LI=function(t,e){return[hr(wo(),Hk),t(ux,function(t,n){e.onClose(),n.onClose()}),t(ax,function(t,n,e,o){n.onCancel(t),or(o,ux)}),dr(fx,function(){return e.onUnblock()}),dr(lx,function(t,n){return e.onBlock(n.event)})]},jI=function(r,t){var n=function(t,o){return dr(t,function(n,e){i(n,function(t){o(r(),t,e.event,n)})})},i=function(n,e){oE.getState(n).get().each(function(t){e(t,n)})};return x(LI(n,t),[n(cx,function(t,n,e){n.onAction(t,{name:e.name})})])},UI=function(r,t,c){var n=function(t,o){return dr(t,function(n,e){i(n,function(t){o(r(),t,e.event,n)})})},i=function(n,e){oE.getState(n).get().each(function(t){e(t.internalDialog,n)})};return x(LI(n,t),[n(sx,function(t,n){return n.onSubmit(t)}),n(ix,function(t,n,e){n.onChange(t,{name:e.name})}),n(cx,function(t,n,e,o){var r=function(){return gg.focusIn(o)},i=function(t){return ui(t,"disabled")||ii(t,"aria-disabled").exists(function(t){return"true"===t})},u=Lr(o.element),a=xc(u);n.onAction(t,{name:e.name,value:e.value}),xc(u).fold(r,function(n){i(n)||a.exists(function(t){return oo(n,t)&&i(t)})?r():c().toOptional().filter(function(t){return!oo(t.element,n)}).each(r)})}),n(dx,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),xr(function(t){var n=r();ql.setValue(t,n.getData())})])},WI=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),o=G(e,function(t){return"start"===t.align}),r=function(t,n){return Xy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:W(n,function(t){return t.memento.asSpec()})})};return[r("start",o.pass),r("end",o.fail)]},GI=function(t,i){return{dom:mB('<div class="tox-dialog__footer"></div>'),components:[],behaviours:fc([oE.config({channel:wI,initialData:t,updateState:function(t,n){var r=W(n.buttons,function(t){var n,e,o=Sp((e=i,tO(n=t,n.type,e)));return{name:t.name,align:t.align,memento:o}});return st.some({lookupByName:function(t,n){return e=t,o=n,K(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:WI})])}},XI=GI,YI=function(t,n){return DM.parts.footer(GI(t,n))},qI=function(n,e){if(n.getRoot().getSystem().isConnected()){var o=ud.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return lk.getField(o,e).fold(function(){var t=n.getFooter();return oE.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return st.some(t)})}return st.none()},KI=function(a,o,c){var t=function(t){var n=a.getRoot();n.getSystem().isConnected()&&t(n)},s={getData:function(){var t=a.getRoot(),n=t.getSystem().isConnected()?a.getFormWrapper():t,e=ql.getValue(n),o=Pt(c,function(t){return t.get()});return ct(ct({},e),o)},setData:function(u){t(function(){var n,t,e=s.getData(),o=ct(ct({},e),u),r=(n=o,t=a.getRoot(),oE.getState(t).get().map(function(t){return Pn(Vn("data",t.dataValidator,n))}).getOr(n)),i=a.getFormWrapper();ql.setValue(i,r),Vt(c,function(t,n){Wt(o,n)&&t.set(o[n])})})},disable:function(t){qI(a,t).each(yv.disable)},enable:function(t){qI(a,t).each(yv.enable)},focus:function(t){qI(a,t).each(Og.focus)},block:function(n){if(!E(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){rr(t,lx,{message:n})})},unblock:function(){t(function(t){or(t,fx)})},showTab:function(n){t(function(){var t=a.getBody();oE.getState(t).get().exists(function(t){return t.isTabPanel()})&&ud.getCurrent(t).each(function(t){fI.showTab(t,n)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([bI],n),t.getSystem().broadcastOn([yI],n.internalDialog),t.getSystem().broadcastOn([xI],n.internalDialog),t.getSystem().broadcastOn([wI],n.internalDialog),s.setData(n.initialData)})},close:function(){t(function(t){or(t,ux)})}};return s},JI=function(t,n,e){var o,r,i,u=RI(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=kI(o,st.none(),r,!1),DM.parts.body(i)),c=zI(t.internalDialog.buttons),s=NI(c),l=YI({buttons:c},e),f=UI(function(){return p},PI(function(){return g},e.shared.providers,n),e.shared.getSink),d=function(){switch(t.internalDialog.size){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(),m={header:u,body:a,footer:st.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=HI(m,t,f,e),p=KI({getRoot:function(){return g},getBody:function(){return DM.getBody(g)},getFooter:function(){return DM.getFooter(g)},getFormWrapper:function(){var t=DM.getBody(g);return ud.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:g,instanceApi:p}},$I=function(t,n,o,e){var r,i,u,a,c,s,l,f,d,m=mi("dialog-label"),g=mi("dialog-content"),p=Sp((u={title:t.internalDialog.title,draggable:!0},a=m,c=o.shared.providers,Xy.sketch({dom:mB('<div class="tox-dialog__header"></div>'),components:[FI(u,st.some(a),c),II(),MI(c)],containerBehaviours:fc([fM.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return ea(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=Sp((s={body:t.internalDialog.body},l=g,f=o,d=e,kI(s,st.some(l),f,d))),v=zI(t.internalDialog.buttons),b=NI(v),y=Sp(XI({buttons:v},o)),x=UI(function(){return S},{onBlock:function(e){EM.block(w,function(t,n){return VI(e.message,n,o.shared.providers)})},onUnblock:function(){EM.unblock(w)},onClose:function(){return n.closeWindow()}},o.shared.getSink),w=ku({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[Ro()]=[oE.name(),vc.name()],i[Vo()]=["execute-on-form"],i[Yo()]=["reflecting","execute-on-form"],i),behaviours:fc([gg.config({mode:"cyclic",onEscape:function(t){return or(t,ux),st.some(!0)},useTabstopAt:function(t){return!zk(t)&&("button"!==kr(t)||"disabled"!==ri(t,"disabled"))}}),oE.config({channel:bI,updateState:function(t,n){return st.some(n)},initialData:t}),Og.config({}),xg("execute-on-form",x.concat([br(wo(),function(t){gg.focusIn(t)})])),EM.config({getRoot:function(){return st.some(w)}}),yg.config({}),Ak({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),S=KI({getRoot:function(){return w},getFooter:function(){return y.get(w)},getBody:function(){return h.get(w)},getFormWrapper:function(){var t=h.get(w);return ud.getCurrent(t).getOr(t)}},n.redial,b);return{dialog:w,instanceApi:S}},QI=tinymce.util.Tools.resolve("tinymce.util.URI"),ZI=["insertContent","setContent","execCommand","close","block","unblock"],tR=function(t){return D(t)&&-1!==ZI.indexOf(t.mceAction)},nR=function(o,t,r,n){var e,i,u,a,c=RI(o.title,n),s=(i={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Vk({dom:{tag:"iframe",attributes:{src:o.url}},behaviours:fc([Zy.config({}),Og.config({})])})]}],behaviours:fc([gg.config({mode:"acyclic",useTabstopAt:w(zk)})])},DM.parts.body(i)),l=o.buttons.bind(function(t){return 0===t.length?st.none():st.some(YI({buttons:t},n))}),f=jI(function(){return y},PI(function(){return b},n.shared.providers,t)),d=ct(ct({},o.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),o.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),m=o.width.isNone()&&o.height.isNone()?["tox-dialog--width-lg"]:[],g=new QI(o.url,{base_uri:new QI(window.location.href)}),p=g.protocol+"://"+g.host+(g.port?":"+g.port:""),h=we(st.none()),v=[xg("messages",[yr(function(){var t=Ey(ke.fromDom(window),"message",function(t){var n,e;g.isSameOrigin(new QI(t.raw.origin))&&(n=t.raw.data,tR(n)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!A(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(r,y,n):!tR(e=n)&&D(e)&&Wt(e,"mceAction")&&o.onMessage(y,n))});h.set(st.some(t))}),xr(function(){h.get().each(function(t){return t.unbind()})})]),vc.config({channels:((e={})[SI]={onReceive:function(t,n){na(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,p)})}},e)})],b=HI({header:c,body:s,footer:l,extraClasses:m,extraBehaviours:v,extraStyles:d},o,f,n),y=(a=function(t){u.getSystem().isConnected()&&t(u)},{block:function(n){if(!E(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");a(function(t){rr(t,lx,{message:n})})},unblock:function(){a(function(t){or(t,fx)})},close:function(){a(function(t){or(t,ux)})},sendMessage:function(n){a(function(t){t.getSystem().broadcastOn([SI],n)})}});return{dialog:u=b,instanceApi:y}},eR=function(t){var c,s,l,f,p=t.backstage,h=t.editor,v=Uv(h),e=(s=(c=t).backstage.shared,{open:function(t,n){var e=function(){DM.hide(u),n()},o=Sp(tO({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:st.none()},"cancel",c.backstage)),r=TI(),i=_I(e,s.providers),u=ku(AI({lazySink:function(){return s.getSink()},header:OI(r,i),body:EI(t,s.providers),footer:st.some(DI(BI([],[o.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[dr(ax,e)],eventOrder:{}}));DM.show(u);var a=o.get(u);Og.focus(a)}}),o=(f=(l=t).backstage.shared,{open:function(t,n){var e=function(t){DM.hide(a),n(t)},o=Sp(tO({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:st.none()},"submit",l.backstage)),r=tO({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:st.none()},"cancel",l.backstage),i=TI(),u=_I(function(){return e(!1)},f.providers),a=ku(AI({lazySink:function(){return f.getSink()},header:OI(i,u),body:EI(t,f.providers),footer:st.some(DI(BI([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[dr(ax,function(){return e(!1)}),dr(sx,function(){return e(!0)})],eventOrder:{}}));DM.show(a);var c=o.get(a);Og.focus(c)}}),r=function(t,e){return ZF.openUrl(function(t){var n=nR(t,{closeWindow:function(){DM.hide(n.dialog),e(n.instanceApi)}},h,p);return DM.show(n.dialog),n.instanceApi},t)},i=function(t,i){return ZF.open(function(t,n,e){var o=n,r=JI({dataValidator:e,initialData:o,internalDialog:t},{redial:ZF.redial,closeWindow:function(){DM.hide(r.dialog),i(r.instanceApi)}},p);return DM.show(r.dialog),r.instanceApi.setData(o),r.instanceApi},t)},u=function(t,d,m,g){return ZF.open(function(t,n,e){var o,r,i,u=Pn(Vn("data",e,n)),a=(o=we(st.none()),{clear:function(){return o.set(st.none())},set:function(t){return o.set(st.some(t))},isSet:function(){return o.get().isSome()},on:function(t){return o.get().each(t)}}),c=p.shared.header.isPositionedAtTop(),s=function(){return a.on(function(t){cp.reposition(t),WD.refresh(t)})},l=$I({dataValidator:e,initialData:u,internalDialog:t},{redial:ZF.redial,closeWindow:function(){a.on(cp.hide),h.off("ResizeEditor",s),a.clear(),m(l.instanceApi)}},p,g),f=ku(cp.sketch(ct(ct({lazySink:p.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},c?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:fc(x([xg("window-manager-inline-events",[dr(Ko(),function(){or(l.dialog,ax)})])],(r=h,i=c,v&&i?[]:[WD.config({contextual:{lazyContext:function(){return st.some(qu(ke.fromDom(r.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Ay(e=n,".tox-alert-dialog")||Ay(e,".tox-confirm-dialog");var e}})));return a.set(f),cp.showWithin(f,d,Cu(l.dialog),st.some(Zi())),v&&c||(WD.refresh(f),h.on("ResizeEditor",s)),l.instanceApi.setData(u),gg.focusIn(l.dialog),l.instanceApi},t)};return{open:function(t,n,e){return n!==undefined&&"toolbar"===n.inline?u(t,p.shared.anchors.inlineDialog(),e,n.ariaAttrs):n!==undefined&&"cursor"===n.inline?u(t,p.shared.anchors.cursor(),e,n.ariaAttrs):i(t,e)},openUrl:function(t,n){return r(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){o.open(t,function(t){n(t)})}}};v.add("silver",function(t){var n=SM(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;_y(t,o.shared);var u=eR({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:it(u),getNotificationManagerImpl:function(){return a(0,{backstage:o},e)},ui:i()}})}();