/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.7.1 (2021-03-17)
 */
!function(){"use strict";function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}function t(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function n(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;n>t;t++)for(var a=arguments[t],i=0,c=a.length;c>i;i++,o++)r[o]=a[i];return r}function r(e,t,n,r,o){return e(n,r)?D.some(n):j(o)&&o(n)?D.none():t(n,r,o)}function o(e,t,n){var r=t.backstage;return{open:function(e,o){var a=!e.closeButton&&e.timeout&&(0<e.timeout||e.timeout<0),i=function(){o(),sh.hide(s)},c=xi(zh.sketch({text:e.text,level:$(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:D.from(e.icon),closeButton:!a,onAction:i,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),s=xi(sh.sketch(z({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},r.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return n.add(s),0<e.timeout&&wh.setTimeout(function(){i()},e.timeout),{close:i,moveTo:function(e,t){sh.showAt(s,{anchor:"makeshift",x:e,y:t},Ci(c))},moveRel:function(e,n){var r,o;"banner"!==n?(r=function(e){switch(e){case"bc-bc":return bh;case"tc-tc":return yh;case"tc-bc":return Gc;case"bc-tc":default:return Kc}}(n),o={anchor:"node",root:Qa(),node:D.some(xn.fromDom(e)),layouts:{onRtl:function(){return[r]},onLtr:function(){return[r]}}},sh.showAt(s,o,Ci(c))):sh.showAt(s,t.backstage.shared.anchors.banner(),Ci(c))},text:function(e){zh.updateText(c,e)},settings:e,getEl:function(){return c.element.dom},progressBar:{value:function(e){zh.updateProgress(c,e)}}}},close:function(e){e.close()},reposition:function(e){var t;J(e,function(e){return e.moveTo(0,0)}),0<(t=e).length&&(fe(t).each(function(e){return e.moveRel(null,"banner")}),J(t,function(e,n){n>0&&e.moveRel(t[n-1].getEl(),"bc-tc")}))},getArgs:function(e){return e.settings}}}function a(e){var t=this;null!==this._state?Xw(function(){var n,r=t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(o){return void e.reject(o)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)}):this._deferreds.push(e)}function i(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void Yw(Gw(t,e),Gw(i,this),Gw(c,this))}this._state=!0,this._value=e,s.call(this)}catch(n){c.call(this,n)}}function c(e){this._state=!1,this._value=e,s.call(this)}function s(){for(var e=0,t=this._deferreds;e<t.length;e++){var n=t[e];a.call(this,n)}this._deferreds=[]}function l(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function u(e,t){var n,r,o,a,i=t.document||document,c=i.getElementById(t.handle||e),s=function(e){return kS(e),e.button!==r?l(e):(e.deltaX=e.screenX-o,e.deltaY=e.screenY-a,e.preventDefault(),t.drag(e),void 0)},l=function(e){kS(e),yS(i).off("mousemove touchmove",s).off("mouseup touchend",l),n.remove(),t.stop&&t.stop(e)};return yS(c).on("mousedown touchstart",function(e){var u,f,d,m,g,h,p,v,y,b,w=(u=i,f=Math.max,d=u.documentElement,m=u.body,g=f(d.scrollWidth,m.scrollWidth),h=f(d.clientWidth,m.clientWidth),p=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),y=f(d.clientHeight,m.clientHeight),{width:p>g?h:g,height:v<f(d.offsetHeight,m.offsetHeight)?y:v});kS(e),e.preventDefault(),r=e.button;var k=c;o=e.screenX,a=e.screenY,b=window.getComputedStyle?window.getComputedStyle(k,null).getPropertyValue("cursor"):k.runtimeStyle.cursor,n=yS("<div></div>").css({position:"absolute",top:0,left:0,width:w.width,height:w.height,zIndex:2147483647,opacity:1e-4,cursor:b}).appendTo(i.body),yS(i).on("mousemove touchmove",s).on("mouseup touchend",l),t.start(e)}),{destroy:function(){yS(c).off()}}}var f,d,m,g,h,p,v=function(){},y=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},b=function(e){return function(){return e}},w=function(e){return e},k=function(e){return function(t){return!e(t)}},_=function(e){return function(){throw new Error(e)}},x=b(!1),C=b(!0),S=tinymce.util.Tools.resolve("tinymce.ThemeManager"),z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=function(){return E},E=(f=function(e){return e.isNone()},{fold:function(e){return e()},is:x,isSome:x,isNone:C,getOr:m=function(e){return e},getOrThunk:d=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:m,orThunk:d,map:T,each:v,bind:T,exists:x,forall:C,filter:T,equals:f,equals_:f,toArray:function(){return[]},toString:b("none()")}),O=function(e){var t=b(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:C,isNone:x,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return O(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:E},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(x,function(t){return n(e,t)})}};return o},D={some:O,none:T,from:function(e){return null===e||void 0===e?E:O(e)}},N=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},A=function(e){return function(t){return typeof t===e}},R=N("string"),P=N("object"),B=N("array"),M=A("boolean"),I=(g=void 0,function(e){return g===e}),L=function(e){return!(null===(t=e)||void 0===t);var t},j=A("function"),F=A("number"),H=function(e,t){if(B(e)){for(var n=0,r=e.length;r>n;++n)if(!t(e[n]))return!1;return!0}return!1},V=Array.prototype.slice,q=Array.prototype.indexOf,U=Array.prototype.push,W=function(e,t){return q.call(e,t)},$=function(e,t){return-1<W(e,t)},X=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return!0;return!1},G=function(e,t){for(var n=[],r=0;e>r;r++)n.push(t(r));return n},K=function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=V.call(e,r,r+t);n.push(o)}return n},Y=function(e,t){for(var n=e.length,r=new Array(n),o=0;n>o;o++){var a=e[o];r[o]=t(a,o)}return r},J=function(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)},Z=function(e,t){for(var n=[],r=[],o=0,a=e.length;a>o;o++){var i=e[o];(t(i,o)?n:r).push(i)}return{pass:n,fail:r}},Q=function(e,t){for(var n=[],r=0,o=e.length;o>r;r++){var a=e[r];t(a,r)&&n.push(a)}return n},ee=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n)}(e,function(e){n=t(n,e)}),n},te=function(e,t,n){return J(e,function(e){n=t(n,e)}),n},ne=function(e,t){return function(e,t,n){for(var r=0,o=e.length;o>r;r++){var a=e[r];if(t(a,r))return D.some(a);if(n(a,r))break}return D.none()}(e,t,x)},re=function(e,t){for(var n=0,r=e.length;r>n;n++)if(t(e[n],n))return D.some(n);return D.none()},oe=function(e){for(var t=[],n=0,r=e.length;r>n;++n){if(!B(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);U.apply(t,e[n])}return t},ae=function(e,t){return oe(Y(e,t))},ie=function(e,t){for(var n=0,r=e.length;r>n;++n)if(!0!==t(e[n],n))return!1;return!0},ce=function(e){var t=V.call(e,0);return t.reverse(),t},se=function(e,t){return Q(e,function(e){return!$(t,e)})},le=function(e,t){var n=V.call(e,0);return n.sort(t),n},ue=function(e,t){return t>=0&&t<e.length?D.some(e[t]):D.none()},fe=function(e){return ue(e,0)},de=function(e){return ue(e,e.length-1)},me=j(Array.from)?Array.from:function(e){return V.call(e)},ge=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return D.none()},he=function(e){return{is:function(t){return e===t},isValue:C,isError:x,getOr:b(e),getOrThunk:b(e),getOrDie:b(e),or:function(){return he(e)},orThunk:function(){return he(e)},fold:function(t,n){return n(e)},map:function(t){return he(t(e))},mapError:function(){return he(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return D.some(e)}}},pe=function(e){return{is:x,isValue:x,isError:C,getOr:w,getOrThunk:function(e){return e()},getOrDie:function(){return _(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t){return t(e)},map:function(){return pe(e)},mapError:function(t){return pe(t(e))},each:v,bind:function(){return pe(e)},exists:x,forall:C,toOptional:D.none}},ve={value:he,error:pe,fromOption:function(e,t){return e.fold(function(){return pe(t)},he)}};(p=h=h||{})[p.Error=0]="Error",p[p.Value=1]="Value";var ye,be,we,ke,_e=function(e,t,n){return e.stype===h.Error?t(e.serror):n(e.svalue)},xe=function(e){return{stype:h.Value,svalue:e}},Ce=function(e){return{stype:h.Error,serror:e}},Se=function(e){return e.fold(Ce,xe)},ze=function(e){return _e(e,ve.error,ve.value)},Te=xe,Ee=function(e){var t=[],n=[];return J(e,function(e){_e(e,function(e){return n.push(e)},function(e){return t.push(e)})}),{values:t,errors:n}},Oe=Ce,De=function(e,t){return e.stype===h.Value?t(e.svalue):e},Ne=function(e,t){return e.stype===h.Error?t(e.serror):e},Ae=function(e,t){return e.stype===h.Value?{stype:h.Value,svalue:t(e.svalue)}:e},Re=function(e,t){return e.stype===h.Error?{stype:h.Error,serror:t(e.serror)}:e},Pe=Object.keys,Be=Object.hasOwnProperty,Me=function(e,t){for(var n=Pe(e),r=0,o=n.length;o>r;r++){var a=n[r];t(e[a],a)}},Ie=function(e,t){return Le(e,function(e,n){return{k:n,v:t(e,n)}})},Le=function(e,t){var n={};return Me(e,function(e,r){var o=t(e,r);n[o.k]=o.v}),n},je=function(e,t){var n,r,o,a,i={};return n=t,a=i,r=function(e,t){a[t]=e},o=v,Me(e,function(e,t){(n(e,t)?r:o)(e,t)}),i},Fe=function(e,t){var n=[];return Me(e,function(e,r){n.push(t(e,r))}),n},He=function(e,t){for(var n=Pe(e),r=0,o=n.length;o>r;r++){var a=n[r],i=e[a];if(t(i,a,e))return D.some(i)}return D.none()},Ve=function(e){return Fe(e,function(e){return e})},qe=function(e,t){return Ue(e,t)?D.from(e[t]):D.none()},Ue=function(e,t){return Be.call(e,t)},We=function(e,t){return Ue(e,t)&&void 0!==e[t]&&null!==e[t]},$e=function(e){if(!B(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return J(e,function(r,o){var a=Pe(r);if(1!==a.length)throw new Error("one and only one name per case");var i=a[0],c=r[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!B(c))throw new Error("case arguments must be an array");t.push(i),n[i]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=n.length;if(a!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+a);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:function(e){var r=Pe(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!ie(t,function(e){return $(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:i,params:n})}}}}),n},Xe=Object.prototype.hasOwnProperty,Ge=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var a=t[o];for(var i in a)Xe.call(a,i)&&(r[i]=e(r[i],a[i]))}return r}},Ke=Ge(function(e,t){return P(e)&&P(t)?Ke(e,t):t}),Ye=Ge(function(e,t){return t}),Je=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},Ze=$e([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Qe=function(e){return Ze.defaultedThunk(b(e))},et=Ze.strict,tt=Ze.asOption,nt=Ze.defaultedThunk,rt=(Ze.asDefaultedOptionThunk,Ze.mergeWithThunk),ot=($e([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e,t){var n={};return n[e]=t,n}),at=function(e,t){return n=t,r={},Me(e,function(e,t){$(n,t)||(r[t]=e)}),r;var n,r},it=ot,ct=function(e){return t={},J(e,function(e){t[e.key]=e.value}),t;var t},st=function(e,t){var n,r,o,a,i,c=(n=[],r=[],J(e,function(e){e.fold(function(e){n.push(e)},function(e){r.push(e)})}),{errors:n,values:r});return 0<c.errors.length?(i=c.errors,ve.error(oe(i))):(a=t,0===(o=c.values).length?ve.value(a):ve.value(Ke(a,Ye.apply(void 0,o))))},lt=function(e){return y(Oe,oe)(e)},ut=function(e,t){var n,r,o=Ee(e);return 0<o.errors.length?lt(o.errors):(n=o.values,r=t,Te(0<n.length?Ke(r,Ye.apply(void 0,n)):r))},ft=function(e){var t=Ee(e);return 0<t.errors.length?lt(t.errors):Te(t.values)},dt=function(e){return P(e)&&100<Pe(e).length?" removed due to size":JSON.stringify(e,null,2)},mt=function(e,t){return Oe([{path:e,getErrorInfo:t}])},gt=$e([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),ht=function(e,t,n){return qe(t,n).fold(function(){return r=n,o=t,mt(e,function(){return'Could not find valid *strict* value for "'+r+'" in '+dt(o)});var r,o},Te)},pt=function(e,t,n){var r=qe(e,t).fold(function(){return n(e)},w);return Te(r)},vt=function(e,t,n,r){return n.fold(function(n,o,a,i){var c=function(t){var a=i.extract(e.concat([n]),r,t);return Ae(a,function(e){return ot(o,r(e))})},s=function(t){return t.fold(function(){var e=ot(o,r(D.none()));return Te(e)},function(t){var a=i.extract(e.concat([n]),r,t);return Ae(a,function(e){return ot(o,r(D.some(e)))})})};return a.fold(function(){return De(ht(e,t,n),c)},function(e){return De(pt(t,n,e),c)},function(){return De(Te(qe(t,n)),s)},function(e){return De((o=e,a=qe(r=t,n).map(function(e){return!0===e?o(r):e}),Te(a)),s);var r,o,a},function(e){var r=e(t),o=Ae(pt(t,n,b({})),function(e){return Ke(r,e)});return De(o,c)})},function(e,n){var o=n(t);return Te(ot(e,r(o)))})},yt=function(e){return{extract:function(t,n,r){return Ne(e(r,n),function(e){return n=e,mt(t,function(){return n});var n})},toString:function(){return"val"}}},bt=function(e){var t=wt(e),n=ee(e,function(e,t){return t.fold(function(t){return Ke(e,it(t,!0))},b(e))},{});return{extract:function(e,r,o){var a,i=M(o)?[]:Pe(je(o,function(e){return void 0!==e&&null!==e})),c=Q(i,function(e){return!We(n,e)});return 0===c.length?t.extract(e,r,o):(a=c,mt(e,function(){return"There are unsupported fields: ["+a.join(", ")+"] specified"}))},toString:t.toString}},wt=function(e){return{extract:function(t,n,r){return o=t,a=r,i=n,c=Y(e,function(e){return vt(o,a,e,i)}),ut(c,{});var o,a,i,c},toString:function(){return"obj{\n"+Y(e,function(e){return e.fold(function(e,t,n,r){return e+" -> "+r.toString()},function(e){return"state("+e+")"})}).join("\n")+"}"}}},kt=function(e){return{extract:function(t,n,r){var o=Y(r,function(r,o){return e.extract(t.concat(["["+o+"]"]),n,r)});return ft(o)},toString:function(){return"array("+e.toString()+")"}}},_t=function(e){return{extract:function(t,n,r){for(var o=[],a=0,i=e;a<i.length;a++){var c=i[a].extract(t,n,r);if(c.stype===h.Value)return c;o.push(c)}return ft(o)},toString:function(){return"oneOf("+Y(e,function(e){return e.toString()}).join(", ")+")"}}},xt=function(e,t){return{extract:function(n,r,o){var a,i,c=Pe(o),s=(a=n,i=c,kt(yt(e)).extract(a,w,i));return De(s,function(e){var a=Y(e,function(e){return gt.field(e,e,et(),t)});return wt(a).extract(n,r,o)})},toString:function(){return"setOf("+t.toString()+")"}}},Ct=b(yt(Te)),St=y(kt,wt),zt=gt.state,Tt=gt.field,Et=function(e,t,n,r,o){return qe(r,o).fold(function(){return t=r,n=o,mt(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+dt(t)});var t,n},function(r){return r.extract(e.concat(["branch: "+o]),t,n)})},Ot=function(e,t){return{extract:function(n,r,o){return qe(o,e).fold(function(){return t=e,mt(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(e){return Et(n,r,o,t,e)})},toString:function(){return"chooseOn("+e+"). Possible values: "+Pe(t)}}},Dt=yt(Te),Nt=function(e){return St(e)},At=function(e){return{extract:function(t,n,r){return e().extract(t,n,r)},toString:function(){return e().toString()}}},Rt=function(e){return yt(function(t){return e(t).fold(Oe,Te)})},Pt=function(e,t){return xt(function(t){return Se(e(t))},t)},Bt=function(e,t,n){return ze((r=e,o=w,a=n,i=t.extract([r],o,a),Re(i,function(e){return{input:a,errors:e}})));var r,o,a,i},Mt=function(e){return e.fold(function(e){throw new Error(Lt(e))},w)},It=function(e,t,n){return Mt(Bt(e,t,n))},Lt=function(e){return"Errors: \n"+(t=e.errors,n=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,Y(n,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()}).join("\n"))+"\n\nInput object: "+dt(e.input);var t,n},jt=Ot,Ft=function(e,t){return Ot(e,Ie(t,wt))},Ht=b(Dt),Vt=function(e,t){return yt(function(n){var r=typeof n;return e(n)?Te(n):Oe("Expected type: "+t+" but got: "+r)})},qt=Vt(F,"number"),Ut=Vt(R,"string"),Wt=Vt(M,"boolean"),$t=Vt(j,"function"),Xt=function(e){var t=function(e,t){for(var n=e.next();!n.done;){if(!t(n.value))return!1;n=e.next()}return!0};if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(function(t){return Xt(e[t])});case"Map":return t(e.keys(),Xt)&&t(e.values(),Xt);case"Set":return t(e.keys(),Xt);default:return!1}},Gt=yt(function(e){return Xt(e)?Te(e):Oe("Expected value to be acceptable for sending via postMessage")}),Kt=function(e){return Rt(function(t){return $(e,t)?ve.value(t):ve.error('Unsupported value: "'+t+'", choose one of "'+e.join(", ")+'".')})},Yt=function(e){return Tt(e,e,et(),Ct())},Jt=function(e,t){return Tt(e,e,et(),t)},Zt=function(e){return Jt(e,Ut)},Qt=function(e,t){return Tt(e,e,et(),Kt(t))},en=function(e){return Jt(e,$t)},tn=function(e,t){return Tt(e,e,et(),wt(t))},nn=function(e,t){return Tt(e,e,et(),St(t))},rn=function(e,t){return Tt(e,e,et(),kt(t))},on=function(e){return Tt(e,e,tt(),Ct())},an=function(e,t){return Tt(e,e,tt(),t)},cn=function(e){return an(e,qt)},sn=function(e){return an(e,Ut)},ln=function(e){return an(e,$t)},un=function(e,t){return an(e,wt(t))},fn=function(e,t){return Tt(e,e,Qe(t),Ct())},dn=function(e,t,n){return Tt(e,e,Qe(t),n)},mn=function(e,t){return dn(e,t,qt)},gn=function(e,t){return dn(e,t,Ut)},hn=function(e,t,n){return dn(e,t,Kt(n))},pn=function(e,t){return dn(e,t,Wt)},vn=function(e,t){return dn(e,t,$t)},yn=function(e,t,n){return dn(e,t,kt(n))},bn=function(e,t,n){return dn(e,t,wt(n))},wn=function(e,t){return zt(e,t)},kn=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},_n=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},xn={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return _n(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return _n(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return _n(n)},fromDom:_n,fromPoint:function(e,t,n){return D.from(e.dom.elementFromPoint(t,n)).map(_n)}},Cn=function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return zn(r(1),r(2))},Sn=function(){return zn(0,0)},zn=function(e,t){return{major:e,minor:t}},Tn={nu:zn,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Sn():Cn(e,n)},unknown:Sn},En=function(e,t){var n=String(t).toLowerCase();return ne(e,function(e){return e.search(n)})},On=function(e,t){return En(e,t).map(function(e){var n=Tn.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Dn=function(e,t){return En(e,t).map(function(e){var n=Tn.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Nn=function(e,t){return-1!==e.indexOf(t)},An=function(e,t){return r=t,o=(n=e).length-t.length,""===r||n.length>=r.length&&n.substr(o,o+r.length)===r;var n,r,o},Rn=(ye=/^\s+|\s+$/g,function(e){return e.replace(ye,"")}),Pn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Bn=function(e){return function(t){return Nn(t,e)}},Mn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Nn(e,"edge/")&&Nn(e,"chrome")&&Nn(e,"safari")&&Nn(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Pn],search:function(e){return Nn(e,"chrome")&&!Nn(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Nn(e,"msie")||Nn(e,"trident")}},{name:"Opera",versionRegexes:[Pn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Bn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Bn("firefox")},{name:"Safari",versionRegexes:[Pn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Nn(e,"safari")||Nn(e,"mobile/"))&&Nn(e,"applewebkit")}}],In=[{name:"Windows",search:Bn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Nn(e,"iphone")||Nn(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Bn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Bn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Bn("linux"),versionRegexes:[]},{name:"Solaris",search:Bn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Bn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Bn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ln={browsers:b(Mn),oses:b(In)},jn="Firefox",Fn=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(jn),isSafari:r("Safari")}},Hn={unknown:function(){return Fn({current:void 0,version:Tn.unknown()})},nu:Fn,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b(jn),safari:b("Safari")},Vn="Windows",qn="Android",Un="Solaris",Wn="FreeBSD",$n="ChromeOS",Xn=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(Vn),isiOS:r("iOS"),isAndroid:r(qn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(Un),isFreeBSD:r(Wn),isChromeOS:r($n)}},Gn={unknown:function(){return Xn({current:void 0,version:Tn.unknown()})},nu:Xn,windows:b(Vn),ios:b("iOS"),android:b(qn),linux:b("Linux"),osx:b("OSX"),solaris:b(Un),freebsd:b(Wn),chromeos:b($n)},Kn=function(e,t){var n,r,o,a,i,c,s,l,u,f,d,m,g=Ln.browsers(),h=Ln.oses(),p=On(g,e).fold(Hn.unknown,Hn.nu),v=Dn(h,e).fold(Gn.unknown,Gn.nu);return{browser:p,os:v,deviceType:(r=p,o=e,a=t,i=(n=v).isiOS()&&!0===/ipad/i.test(o),c=n.isiOS()&&!i,s=n.isiOS()||n.isAndroid(),l=s||a("(pointer:coarse)"),u=i||!c&&s&&a("(min-device-width:768px)"),f=c||s&&!u,d=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(o),m=!f&&!u&&!d,{isiPad:b(i),isiPhone:b(c),isTablet:b(u),isPhone:b(f),isTouch:b(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:b(d),isDesktop:b(m)})}},Yn=function(e){return window.matchMedia(e).matches},Jn=Je(function(){return Kn(navigator.userAgent,Yn)}),Zn=function(){return Jn()},Qn=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},er=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},tr=function(e,t){return e.dom===t.dom},nr=function(e,t){return n=e.dom,r=t.dom,o=n,a=r,i=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(a)&i);var n,r,o,a,i},rr=function(e,t){return Zn().browser.isIE()?nr(e,t):(n=t,r=e.dom,o=n.dom,r!==o&&r.contains(o));var n,r,o},or=function(e){return j(e)?e:x},ar=function(e,t,n){for(var r=e.dom,o=or(n);r.parentNode;){r=r.parentNode;var a=xn.fromDom(r),i=t(a);if(i.isSome())return i;if(o(a))break}return D.none()},ir=function(e,t,n){var r=t(e),o=or(n);return r.orThunk(function(){return o(e)?D.none():ar(e,t,o)})},cr=function(e,t){return tr(e.element,t.event.target)},sr=function(e){if(!We(e,"can")&&!We(e,"abort")&&!We(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return It("Extracting event.handler",bt([fn("can",C),fn("abort",x),fn("run",v)]),e)},lr=function(e){var t,n,r,o,a=(n=function(e){return e.can},function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return te(t,function(t,r){return t&&n(r).apply(void 0,e)},!0)}),i=(r=t=e,o=function(e){return e.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return te(r,function(t,n){return t||o(n).apply(void 0,e)},!1)});return sr({can:a,abort:i,run:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];J(e,function(e){e.run.apply(void 0,t)})}})},ur=b,fr=ur("touchstart"),dr=ur("touchmove"),mr=ur("touchend"),gr=ur("touchcancel"),hr=ur("mousedown"),pr=ur("mousemove"),vr=ur("mouseout"),yr=ur("mouseup"),br=ur("mouseover"),wr=ur("focusin"),kr=ur("focusout"),_r=ur("keydown"),xr=ur("keyup"),Cr=ur("input"),Sr=ur("change"),zr=ur("click"),Tr=ur("transitionend"),Er=ur("selectstart"),Or=function(e){return b("alloy."+e)},Dr={tap:Or("tap")},Nr=Or("focus"),Ar=Or("blur.post"),Rr=Or("paste.post"),Pr=Or("receive"),Br=Or("execute"),Mr=Or("focus.item"),Ir=Dr.tap,Lr=Or("longpress"),jr=Or("sandbox.close"),Fr=Or("typeahead.cancel"),Hr=Or("system.init"),Vr=Or("system.touchmove"),qr=Or("system.touchend"),Ur=Or("system.scroll"),Wr=Or("system.resize"),$r=Or("system.attached"),Xr=Or("system.detached"),Gr=Or("system.dismissRequested"),Kr=Or("system.repositionRequested"),Yr=Or("focusmanager.shifted"),Jr=Or("slotcontainer.visibility"),Zr=Or("change.tab"),Qr=Or("dismiss.tab"),eo=Or("highlight"),to=Or("dehighlight"),no=function(e,t){io(e,e.element,t,{})},ro=function(e,t,n){io(e,e.element,t,n)},oo=function(e){no(e,Br())},ao=function(e,t,n){io(e,t,n,{})},io=function(e,t,n,r){var o=z({target:t},r);e.getSystem().triggerEvent(n,t,o)},co=function(e,t,n,r){e.getSystem().triggerEvent(n,t,r.event)},so=ct,lo=function(e,t){return{key:e,value:sr({abort:t})}},uo=function(e){return{key:e,value:sr({run:function(e,t){t.event.prevent()}})}},fo=function(e,t){return{key:e,value:sr({run:t})}},mo=function(e,t,n){return{key:e,value:sr({run:function(e,r){t.apply(void 0,[e,r].concat(n))}})}},go=function(e){return function(t){return{key:e,value:sr({run:function(e,n){cr(e,n)&&t(e,n)}})}}},ho=function(e,t,n){var r,o,a=t.partUids[n];return o=a,fo(r=e,function(e,t){e.getSystem().getByUid(o).each(function(e){co(e,e.element,r,t)})})},po=function(e,t){return fo(e,function(e,n){var r=n.event,o=e.getSystem().getByDom(r.target).fold(function(){return ir(r.target,function(t){return e.getSystem().getByDom(t).toOptional()},x).getOr(e)},function(e){return e});t(e,o,n)})},vo=function(e){return fo(e,function(e,t){t.cut()})},yo=function(e,t){return go(e)(t)},bo=go($r()),wo=go(Xr()),ko=go(Hr()),_o=(be=Br(),function(e){return fo(be,e)}),xo=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),Co=function(e){return function(t){return t.dom.nodeType===e}},So=Co(1),zo=Co(3),To=Co(9),Eo=Co(11),Oo=function(e){return xn.fromDom(e.dom.ownerDocument)},Do=function(e){return To(e)?e:Oo(e)},No=function(e){return xn.fromDom(Do(e).dom.documentElement)},Ao=function(e){return xn.fromDom(Do(e).dom.defaultView)},Ro=function(e){return D.from(e.dom.parentNode).map(xn.fromDom)},Po=Ro,Bo=function(e){return D.from(e.dom.offsetParent).map(xn.fromDom)},Mo=function(e){return Y(e.dom.childNodes,xn.fromDom)},Io=function(e,t){var n=e.dom.childNodes;return D.from(n[t]).map(xn.fromDom)},Lo=function(e){return Eo(e)&&L(e.dom.host)},jo=j(Element.prototype.attachShadow)&&j(Node.prototype.getRootNode),Fo=b(jo),Ho=jo?function(e){return xn.fromDom(e.dom.getRootNode())}:Do,Vo=function(e){return Lo(e)?e:xn.fromDom(Do(e).dom.body)},qo=function(e){var t=Ho(e);return Lo(t)?D.some(t):D.none()},Uo=function(e){return xn.fromDom(e.dom.host)},Wo=function(e){return L(e.dom.shadowRoot)},$o=function(e,t){Ro(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Xo=function(e,t){var n;(n=e,D.from(n.dom.nextSibling).map(xn.fromDom)).fold(function(){Ro(e).each(function(e){Ko(e,t)})},function(e){$o(e,t)})},Go=function(e,t){Io(e,0).fold(function(){Ko(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},Ko=function(e,t){e.dom.appendChild(t.dom)},Yo=function(e,t){J(t,function(t){Ko(e,t)})},Jo=function(e){e.dom.textContent="",J(Mo(e),function(e){Zo(e)})},Zo=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Qo=function(e){var t,n=Mo(e);0<n.length&&(t=e,J(n,function(e){$o(t,e)})),Zo(e)},ea=function(e){return e.dom.innerHTML},ta=function(e,t){var n,r,o=Oo(e).dom,a=xn.fromDom(o.createDocumentFragment()),i=(n=t,(r=(o||document).createElement("div")).innerHTML=n,Mo(xn.fromDom(r)));Yo(a,i),Jo(e),Ko(e,a)},na=function(e,t,n){if(!(R(n)||M(n)||F(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},ra=function(e,t,n){na(e.dom,t,n)},oa=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},aa=function(e,t){return D.from(oa(e,t))},ia=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},ca=function(e,t){e.dom.removeAttribute(t)},sa=function(e){return t=e,n=!1,xn.fromDom(t.dom.cloneNode(n));var t,n},la=function(e){if(Lo(e))return"#shadow-root";var t,n,r,o=sa(e);return t=o,n=xn.fromTag("div"),r=xn.fromDom(t.dom.cloneNode(!0)),Ko(n,r),ea(n)},ua=so([{key:Nr(),value:sr({can:function(e,t){var n,r,o=t.event,a=o.originator,i=o.target;return r=i,!(tr(n=a,e.element)&&!tr(n,r)&&(console.warn(Nr()+" did not get interpreted by the desired target. \nOriginator: "+la(a)+"\nTarget: "+la(i)+"\nCheck the "+Nr()+" event handlers"),1))}})}]),fa=Object.freeze({__proto__:null,events:ua}),da=0,ma=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++da+String(t)},ga=b("alloy-id-"),ha=b("data-alloy-id"),pa=ga(),va=ha(),ya=function(e,t){Object.defineProperty(e.dom,va,{value:t,writable:!0})},ba=function(e){var t=So(e)?e.dom[va]:null;return D.from(t)},wa=ma,ka=w,_a=function(e){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(e?"\n"+la(e().element)+" is not in context.":""))}};return{debugInfo:b("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:x}},xa=_a(),Ca=function(e){return Y(e,function(e){return An(e,"/*")?e.substring(0,e.length-"/*".length):e})},Sa=function(e,t){var n=e.toString(),r=n.indexOf(")")+1,o=n.indexOf("("),a=n.substring(o+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:Ca(a)
}},e},za=ma("alloy-premade"),Ta=function(e){return it(za,e)},Ea=function(e){return t=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return e.apply(void 0,n([t.getApis(),t],r))},r=e.toString(),o=r.indexOf(")")+1,a=r.indexOf("("),i=r.substring(a+1,o-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ca(i.slice(1))}},t;var t,r,o,a,i},Oa={init:function(){return Da({readState:function(){return"No State required"}})}},Da=function(e){return e},Na=function(e,t){var n={};return Me(e,function(e,r){Me(e,function(e,o){var a=qe(n,o).getOr([]);n[o]=a.concat([t(r,e)])})}),n},Aa=function(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}},Ra=function(e){return e.cHandler},Pa=function(e,t){return{name:e,handler:t}},Ba=function(e,t,n){var r,o,a=z(z({},n),(r=e,o={},J(t,function(e){o[e.name()]=e.handlers(r)}),o));return Na(a,Pa)},Ma=function(e){var t,n=j(t=e)?{can:C,abort:x,run:t}:t;return function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var a=[e,t].concat(r);n.abort.apply(void 0,a)?t.stop():n.can.apply(void 0,a)&&n.run.apply(void 0,a)}},Ia=function(e,t,n){var r,o,a=t[n];return a?function(e,t,n,r){try{var o=le(n,function(n,o){var a=n[t],i=o[t],c=r.indexOf(a),s=r.indexOf(i);if(-1===c)throw new Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===s)throw new Error("The ordering for "+e+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));return s>c?-1:c>s?1:0});return ve.value(o)}catch(a){return ve.error([a])}}("Event: "+n,"name",e,a).map(function(e){var t=Y(e,function(e){return e.handler});return lr(t)}):(r=n,o=e,ve.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(Y(o,function(e){return e.name}),null,2)]))},La=function(e,t){var n=Fe(e,function(e,n){return(1===e.length?ve.value(e[0].handler):Ia(e,t,n)).map(function(r){var o=Ma(r),a=1<e.length?Q(t[n],function(t){return X(e,function(e){return e.name===t})}).join(" > "):e[0].name;return it(n,{handler:o,purpose:a})})});return st(n,{})},ja="alloy.base.behaviour",Fa=function(e){var t,n;return Bt("custom.definition",wt([Tt("dom","dom",et(),wt([Yt("tag"),fn("styles",{}),fn("classes",[]),fn("attributes",{}),on("value"),on("innerHtml")])),Yt("components"),Yt("uid"),fn("events",{}),fn("apis",{}),Tt("eventOrder","eventOrder",((t={})[Br()]=["disabling",ja,"toggling","typeaheadevents"],t[Nr()]=[ja,"focusing","keying"],t[Hr()]=[ja,"disabling","toggling","representing"],t[Cr()]=[ja,"representing","streaming","invalidating"],t[Xr()]=[ja,"representing","item-events","tooltipping"],t[hr()]=["focusing",ja,"item-type-events"],t[fr()]=["focusing",ja,"item-type-events"],t[br()]=["item-type-events","tooltipping"],t[Pr()]=["receiving","reflecting","tooltipping"],n=t,Ze.mergeWithThunk(b(n))),Ht()),on("domModification")]),e)},Ha=function(e,t){var n=oa(e,t);return void 0===n||""===n?[]:n.split(" ")},Va=function(e){return void 0!==e.dom.classList},qa=function(e,t){return o=t,a=Ha(n=e,r="class").concat([o]),ra(n,r,a.join(" ")),!0;var n,r,o,a},Ua=function(e,t){return o=t,0<(a=Q(Ha(n=e,r="class"),function(e){return e!==o})).length?ra(n,r,a.join(" ")):ca(n,r),!1;var n,r,o,a},Wa=function(e,t){Va(e)?e.dom.classList.add(t):qa(e,t)},$a=function(e){0===(Va(e)?e.dom.classList:Ha(e,"class")).length&&ca(e,"class")},Xa=function(e,t){Va(e)?e.dom.classList.remove(t):Ua(e,t),$a(e)},Ga=function(e,t){return Va(e)&&e.dom.classList.contains(t)},Ka=function(e,t){J(t,function(t){Wa(e,t)})},Ya=function(e,t){J(t,function(t){Xa(e,t)})},Ja=function(e){return void 0!==e.style&&j(e.style.getPropertyValue)},Za=function(e){var t=zo(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return qo(xn.fromDom(t)).fold(function(){return o.body.contains(t)},(n=Za,r=Uo,function(e){return n(r(e))}))},Qa=function(){return ei(xn.fromDom(document))},ei=function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return xn.fromDom(t)},ti=function(e,t,n){if(!R(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ja(e)&&e.style.setProperty(t,n)},ni=function(e,t){Ja(e)&&e.style.removeProperty(t)},ri=function(e,t,n){var r=e.dom;ti(r,t,n)},oi=function(e,t){var n=e.dom;Me(t,function(e,t){ti(n,t,e)})},ai=function(e,t){var n=e.dom;Me(t,function(e,t){e.fold(function(){ni(n,t)},function(e){ti(n,t,e)})})},ii=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Za(e)?r:ci(n,t)},ci=function(e,t){return Ja(e)?e.style.getPropertyValue(t):""},si=function(e,t){var n=e.dom,r=ci(n,t);return D.from(r).filter(function(e){return 0<e.length})},li=function(e,t,n){var r=xn.fromTag(e);return ri(r,t,n),si(r,t).isSome()},ui=function(e,t){var n=e.dom;ni(n,t),aa(e,"style").map(Rn).is("")&&ca(e,"style")},fi=function(e){return e.dom.offsetWidth},di=function(e){return e.dom.value},mi=function(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},gi=function(e){var t,n,r,o=xn.fromTag(e.tag);t=o,n=e.attributes,r=t.dom,Me(n,function(e,t){na(r,t,e)}),Ka(o,e.classes),oi(o,e.styles),e.innerHtml.each(function(e){return ta(o,e)});var a=e.domChildren;return Yo(o,a),e.value.each(function(e){mi(o,e)}),e.uid,ya(o,e.uid),o},hi=function(e,t){return n=e,o=Y(r=t,function(e){return un(e.name(),[Yt("config"),fn("state",Oa)])}),a=Bt("component.behaviours",wt(o),n.behaviours).fold(function(e){throw new Error(Lt(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(e){return e}),{list:r,data:Ie(a,function(e){var t=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return t}})};var n,r,o,a},pi=function(e){var t,n,r=(t=qe(e,"behaviours").getOr({}),n=Q(Pe(t),function(e){return void 0!==t[e]}),Y(n,function(e){return t[e].me}));return hi(e,r)},vi=function(e,t,n){var r,o,a,i=z(z({},(r=e).dom),{uid:r.uid,domChildren:Y(r.components,function(e){return e.element})}),c=e.domModification.fold(function(){return Aa({})},Aa),s={"alloy.base.modification":c},l=0<t.length?function(e,t,n,r){var o=z({},t);J(n,function(t){o[t.name()]=t.exhibit(e,r)});var a=Na(o,function(e,t){return{name:e,modification:t}}),i=function(e){return ee(e,function(e,t){return z(z({},t.modification),e)},{})},c=ee(a.classes,function(e,t){return t.modification.concat(e)},[]),s=i(a.attributes),l=i(a.styles);return Aa({classes:c,attributes:s,styles:l})}(n,s,t,i):c;return a=l,z(z({},o=i),{attributes:z(z({},o.attributes),a.attributes),styles:z(z({},o.styles),a.styles),classes:o.classes.concat(a.classes)})},yi=function(e,t,n){var r,o,a,i={"alloy.base.behaviour":e.events};return r=n,o=e.eventOrder,a=Ba(r,t,i),La(a,o).getOrDie()},bi=function(e){var n,r,o,a,i,c,s,l,u,f,d,m,g,h=ka(e),p=h.events,v=t(h,["events"]),y=(n=qe(v,"components").getOr([]),Y(n,xi)),b=z(z({},v),{events:z(z({},fa),p),components:y});return ve.value((o=function(){return g},a=kn(xa),i=Mt(Fa(r=b)),c=pi(r),s=c.list,l=c.data,u=vi(i,s,l),f=gi(u),d=yi(i,s,l),m=kn(i.components),g={getSystem:a.get,config:function(e){var t=l;return(j(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(r,null,2))})()},hasConfigured:function(e){return j(l[e.name()])},spec:r,readState:function(e){return l[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return i.apis},connect:function(e){a.set(e)},disconnect:function(){a.set(_a(o))},element:f,syncComponents:function(){var e=Mo(f),t=ae(e,function(e){return a.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});m.set(t)},components:m.get,events:d}))},wi=function(e){var t=xn.fromText(e);return ki({element:t})},ki=function(e){var t=It("external.component",bt([Yt("element"),on("uid")]),e),n=kn(_a());t.uid.each(function(e){ya(t.element,e)});var r={getSystem:n.get,config:D.none,hasConfigured:x,connect:function(e){n.set(e)},disconnect:function(){n.set(_a(function(){return r}))},getApis:function(){return{}},element:t.element,spec:e,readState:b("No state"),syncComponents:v,components:b([]),events:{}};return Ta(r)},_i=wa,xi=function(e){return qe(e,za).fold(function(){var t=e.hasOwnProperty("uid")?e:z({uid:_i("")},e);return bi(t).getOrDie()},function(e){return e})},Ci=Ta,Si=function(e,t){var n=function(n){var r=t(n);if(0>=r||null===r){var o=ii(n,e);return parseFloat(o)||0}return r},r=function(e,t){return te(t,function(t,n){var r=ii(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!F(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Ja(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}},zi=Si("height",function(e){var t=e.dom;return Za(e)?t.getBoundingClientRect().height:t.offsetHeight}),Ti=function(e){return zi.get(e)},Ei=function(e){return zi.getOuter(e)},Oi=function(e,t){return{left:e,top:t,translate:function(n,r){return Oi(e+n,t+r)}}},Di=Oi,Ni=function(e,t){return void 0!==e?e:void 0!==t?t:0},Ai=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Di(n.offsetLeft,n.offsetTop);var a=Ni(null==r?void 0:r.pageYOffset,o.scrollTop),i=Ni(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Ni(o.clientTop,n.clientTop),s=Ni(o.clientLeft,n.clientLeft);return Ri(e).translate(i-s,a-c)},Ri=function(e){var t,n=e.dom,r=n.ownerDocument.body;return r===n?Di(r.offsetLeft,r.offsetTop):Za(e)?(t=n.getBoundingClientRect(),Di(t.left,t.top)):Di(0,0)},Pi=Si("width",function(e){return e.dom.offsetWidth}),Bi=function(e){return Pi.get(e)},Mi=function(e){return Pi.getOuter(e)},Ii=function(e){var t=xn.fromDom(function(e){if(Fo()&&L(e.target)){var t=xn.fromDom(e.target);if(So(t)&&Wo(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return fe(n)}}return D.from(e.target)}(e).getOr(e.target)),n=function(){return e.stopPropagation()},r=function(){return e.preventDefault()},o=y(r,n);return{target:t,x:e.clientX,y:e.clientY,stop:n,prevent:r,kill:o,raw:e}},Li=function(t,n,r,o,a){var i,c,s=(i=r,c=o,function(e){i(e)&&c(Ii(e))});return t.dom.addEventListener(n,s,a),{unbind:e(ji,t,n,s,a)}},ji=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Fi=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Di(n,r)},Hi=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},Vi=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},qi=function(e){var t,n,r=void 0===e?window:e,o=r.document,a=Fi(xn.fromDom(o));return n=void 0===(t=r)?window:t,D.from(n.visualViewport).fold(function(){var e=r.document.documentElement,t=e.clientWidth,n=e.clientHeight;return Vi(a.left,a.top,t,n)},function(e){return Vi(Math.max(e.pageLeft,a.left),Math.max(e.pageTop,a.top),e.width,e.height)})},Ui=function(e,t){return e.view(t).fold(b([]),function(t){var n=e.owner(t),r=Ui(e,n);return[t].concat(r)})},Wi=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?D.none():D.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(xn.fromDom)},owner:Oo}),$i=function(t){var n,r,o,a,i=xn.fromDom(document),c=Fi(i);return(n=t,o=(r=Wi).owner(n),a=Ui(r,o),D.some(a)).fold(e(Ai,t),function(e){var n=Ri(t),r=ee(e,function(e,t){var n=Ri(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return Di(r.left+n.left+c.left,r.top+n.top+c.top)})},Xi=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},Gi=function(e){var t=Ai(e),n=Mi(e),r=Ei(e);return Xi(t.left,t.top,n,r)},Ki=function(e){var t=$i(e),n=Mi(e),r=Ei(e);return Xi(t.left,t.top,n,r)},Yi=function(){return qi(window)},Ji=function(e,t,n){for(var r=e.dom,o=j(n)?n:x;r.parentNode;){r=r.parentNode;var a=xn.fromDom(r);if(t(a))return D.some(a);if(o(a))break}return D.none()},Zi=function(e,t,n){return r(function(e,t){return t(e)},Ji,e,t,n)},Qi=function(e,t,n){return Zi(e,t,n).isSome()},ec=function(e,t,n){return Ji(e,function(e){return Qn(e,t)},n)},tc=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,er(o)?D.none():D.from(o.querySelector(n)).map(xn.fromDom);var n,r,o},nc=function(e,t,n){return r(Qn,ec,e,t,n)},rc=function(){var e=ma("aria-owns");return{id:e,link:function(t){ra(t,"aria-owns",e)},unlink:function(e){ca(e,"aria-owns")}}},oc=function(e,t){return Zi(t,function(e){if(!So(e))return!1;var t=oa(e,"id");return void 0!==t&&-1<t.indexOf("aria-owns")}).bind(function(e){var t=oa(e,"id"),n=Ho(e);return tc(n,'[aria-owns="'+t+'"]')}).exists(function(t){return ac(e,t)})},ac=function(e,t){return Qi(t,function(t){return tr(t,e.element)},x)||oc(e,t)},ic="unknown";(ke=we=we||{})[ke.STOP=0]="STOP",ke[ke.NORMAL=1]="NORMAL",ke[ke.LOGGING=2]="LOGGING";var cc,sc,lc=kn({}),uc=["alloy/data/Fields","alloy/debugging/Debugging"],fc=function(e,t,n){var r,o,a,i;switch(qe(lc.get(),e).orThunk(function(){var t=Pe(lc.get());return ge(t,function(t){return-1<e.indexOf(t)?D.some(lc.get()[t]):D.none()})}).getOr(we.NORMAL)){case we.NORMAL:return n(dc());case we.LOGGING:var c=(r=e,o=t,a=[],i=(new Date).getTime(),{logEventCut:function(e,t,n){a.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){a.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){a.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){a.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){a.push({outcome:"response",purpose:n,target:t})},write:function(){var e=(new Date).getTime();$(["mousemove","mouseover","mouseout",Hr()],r)||console.log(r,{event:r,time:e-i,target:o.dom,sequence:Y(a,function(e){return $(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+la(e.target)+")":e.outcome})})}}),s=n(c);return c.write(),s;case we.STOP:return!0}},dc=b({logEventCut:v,logEventStopped:v,logNoParent:v,logEventNoHandlers:v,logEventResponse:v,write:v}),mc=b([Yt("menu"),Yt("selectedMenu")]),gc=b([Yt("item"),Yt("selectedItem")]),hc=(b(wt(gc().concat(mc()))),b(wt(gc()))),pc=tn("initSize",[Yt("numColumns"),Yt("numRows")]),vc=function(){return tn("markers",[Yt("backgroundMenu")].concat(mc()).concat(gc()))},yc=function(e){return tn("markers",Y(e,Yt))},bc=function(e,t,n){return!function(){var e=new Error;if(void 0!==e.stack){var t=e.stack.split("\n");ne(t,function(e){return 0<e.indexOf("alloy")&&!X(uc,function(t){return-1<e.indexOf(t)})}).getOr(ic)}}(),Tt(t,t,n,Rt(function(e){return ve.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)})}))},wc=function(e){return bc(0,e,Qe(v))},kc=function(e){return bc(0,e,Qe(D.none))},_c=function(e){return bc(0,e,et())},xc=function(e){return bc(0,e,et())},Cc=function(e,t){return wn(e,b(t))},Sc=function(e){return wn(e,w)},zc=b(pc),Tc=function(e,t,n,r,o,a){return{x:e,y:t,bubble:n,direction:r,boundsRestriction:o,label:a}},Ec=$e([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Oc=Ec.southeast,Dc=Ec.southwest,Nc=Ec.northeast,Ac=Ec.northwest,Rc=Ec.south,Pc=Ec.north,Bc=Ec.east,Mc=Ec.west,Ic=function(e,t){return function(e,t){for(var n={},r=0,o=e.length;o>r;r++){var a=e[r];n[String(a)]=t(a,r)}return n}(["left","right","top","bottom"],function(n){return qe(t,n).map(function(t){return function(e,t){switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}}(e,t)})})},Lc=function(e){return e.x},jc=function(e,t){return e.x+e.width/2-t.width/2},Fc=function(e,t){return e.x+e.width-t.width},Hc=function(e,t){return e.y-t.height},Vc=function(e){return e.y+e.height},qc=function(e,t){return e.y+e.height/2-t.height/2},Uc=function(e,t,n){return Tc(Lc(e),Vc(e),n.southeast(),Oc(),Ic(e,{left:1,top:3}),"layout-se")},Wc=function(e,t,n){return Tc(Fc(e,t),Vc(e),n.southwest(),Dc(),Ic(e,{right:0,top:3}),"layout-sw")},$c=function(e,t,n){return Tc(Lc(e),Hc(e,t),n.northeast(),Nc(),Ic(e,{left:1,bottom:2}),"layout-ne")},Xc=function(e,t,n){return Tc(Fc(e,t),Hc(e,t),n.northwest(),Ac(),Ic(e,{right:0,bottom:2}),"layout-nw")},Gc=function(e,t,n){return Tc(jc(e,t),Hc(e,t),n.north(),Pc(),Ic(e,{bottom:2}),"layout-n")},Kc=function(e,t,n){return Tc(jc(e,t),Vc(e),n.south(),Rc(),Ic(e,{top:3}),"layout-s")},Yc=function(e,t,n){return Tc((r=e).x+r.width,qc(e,t),n.east(),Bc(),Ic(e,{left:0}),"layout-e");var r},Jc=function(e,t,n){return Tc((r=t,e.x-r.width),qc(e,t),n.west(),Mc(),Ic(e,{right:1}),"layout-w");var r},Zc=function(){return[Uc,Wc,$c,Xc,Kc,Gc,Yc,Jc]},Qc=function(){return[Wc,Uc,Xc,$c,Kc,Gc,Yc,Jc]},es=function(){return[$c,Xc,Uc,Wc,Gc,Kc]},ts=function(){return[Xc,$c,Wc,Uc,Gc,Kc]},ns=function(){return[Uc,Wc,$c,Xc,Kc,Gc]},rs=function(){return[Wc,Uc,Xc,$c,Kc,Gc]},os=Object.freeze({__proto__:null,events:function(e){return so([fo(Pr(),function(t,n){var r,o,a=e.channels,i=Pe(a),c=n,s=(r=i,(o=c).universal?r:Q(r,function(e){return $(o.channels,e)}));J(s,function(e){var n=a[e],r=n.schema,o=It("channel["+e+"] data\nReceiver: "+la(t.element),r,c.data);n.onReceive(t,o)})})])}}),as=[Jt("channels",Pt(ve.value,bt([_c("onReceive"),fn("schema",Ht())])))],is=function(e,t,n){return ko(function(r){n(r,e,t)})},cs=function(e,t,n,r,o,a){var i=bt(e),c=un(t,[an("config",bt(e))]);return us(i,c,t,n,r,o,a)},ss=function(e,t,n){var r,o,a,i,c,s;return r=function(r){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];var i=[r].concat(o);return r.config({name:b(e)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+n)},function(e){var n=Array.prototype.slice.call(i,1);return t.apply(void 0,[r,e.config,e.state].concat(n))})},o=n,a=t.toString(),i=a.indexOf(")")+1,c=a.indexOf("("),s=a.substring(c+1,i-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:o,parameters:Ca(s.slice(0,1).concat(s.slice(3)))}},r},ls=function(e){return{key:e,value:void 0}},us=function(t,n,r,o,a,i,c){var s=function(e){return We(e,r)?e[r]():D.none()},l=Ie(a,function(e,t){return ss(r,e,t)}),u=Ie(i,Sa),f=z(z(z({},u),l),{revoke:e(ls,r),config:function(e){var n=It(r+"-config",t,e);return{key:r,value:{config:n,me:f,configAsRaw:Je(function(){return It(r+"-config",t,e)}),initialConfig:e,state:c}}},schema:b(n),exhibit:function(e,t){return s(e).bind(function(e){return qe(o,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(Aa({}))},name:b(r),handlers:function(e){return s(e).map(function(e){return qe(o,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return f},fs=ct,ds=bt([Yt("fields"),Yt("name"),fn("active",{}),fn("apis",{}),fn("state",Oa),fn("extra",{})]),ms=function(e){var t=It("Creating behaviour: "+e.name,ds,e);return cs(t.fields,t.name,t.active,t.apis,t.extra,t.state)},gs=bt([Yt("branchKey"),Yt("branches"),Yt("name"),fn("active",{}),fn("apis",{}),fn("state",Oa),fn("extra",{})]),hs=function(e){var t,n,r,o,a,i,c,s,l=It("Creating behaviour: "+e.name,gs,e);return t=Ft(l.branchKey,l.branches),n=l.name,r=l.active,o=l.apis,a=l.extra,i=l.state,s=un(n,[an("config",c=t)]),us(c,s,n,r,o,a,i)},ps=b(void 0),vs=ms({fields:as,name:"receiving",active:os}),ys=Object.freeze({__proto__:null,exhibit:function(e,t){return Aa({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),bs=function(e){return e.dom.focus()},ws=function(e){return void 0===e&&(e=xn.fromDom(document)),D.from(e.dom.activeElement).map(xn.fromDom)},ks=function(e){return ws(Ho(e)).filter(function(t){return e.dom.contains(t.dom)})},_s=function(e,t){var n=Ho(t),r=ws(n).bind(function(e){var n,r,o=function(t){return tr(e,t)};return o(t)?D.some(t):(n=o,(r=function(e){for(var t=0;t<e.childNodes.length;t++){var o=xn.fromDom(e.childNodes[t]);if(n(o))return D.some(o);var a=r(e.childNodes[t]);if(a.isSome())return a}return D.none()})(t.dom))}),o=e(t);return r.each(function(e){ws(n).filter(function(t){return tr(t,e)}).fold(function(){bs(e)},v)}),o},xs=function(e,t,n,r,o){return{position:e,left:t,top:n,right:r,bottom:o}},Cs=function(e,t){var n=function(e){return e+"px"};ai(e,{position:D.some(t.position),left:t.left.map(n),top:t.top.map(n),right:t.right.map(n),bottom:t.bottom.map(n)})},Ss=$e([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),zs=function(e,t,n,r,o,a){var i,c,s,l,u,f,d,m,g,h=t.x-n,p=t.y-r,v=o-(h+t.width),y=a-(p+t.height),b=D.some(h),w=D.some(p),k=D.some(v),_=D.some(y),x=D.none();return i=t.direction,c=function(){return xs(e,b,w,x,x)},s=function(){return xs(e,x,w,k,x)},l=function(){return xs(e,b,x,x,_)},u=function(){return xs(e,x,x,k,_)},f=function(){return xs(e,b,w,x,x)},d=function(){return xs(e,b,x,x,_)},m=function(){return xs(e,b,w,x,x)},g=function(){return xs(e,x,w,k,x)},i.fold(c,s,l,u,f,d,m,g)},Ts=function(t,n){var r=e($i,n),o=t.fold(r,r,function(){var e=Fi();return $i(n).translate(-e.left,-e.top)}),a=Mi(n),i=Ei(n);return Xi(o.left,o.top,a,i)},Es=function(e,t,n){var r=Di(t,n);return e.fold(b(r),b(r),function(){var e=Fi();return r.translate(-e.left,-e.top)})},Os=(Ss.none,Ss.relative),Ds=Ss.fixed,Ns=function(e,t,n,r){var o=e+t;return o>r?n:n>o?r:o},As=function(e,t,n){return Math.min(Math.max(e,t),n)},Rs=$e([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ps=function(e,t,n,r){var o,a,i,c,s,l,u,f,d,m,g,h,p,v,y,k,_,x,C,S,z,T,E,O,N,A,R,P,B,M,I,L,j,F=e.x,H=e.y,V=e.bubble.offset,q=V.left,U=V.top,W=(o=r,a=e.boundsRestriction,i=V,s=(c=function(e,t){var n="top"===e||"bottom"===e?i.top:i.left;return qe(a,e).bind(w).bind(function(n){return"left"===e||"top"===e?n>=t?D.some(n):D.none():t>=n?D.some(n):D.none()}).map(function(e){return e+n}).getOr(t)})("left",o.x),l=c("top",o.y),u=c("right",o.right),f=c("bottom",o.bottom),Xi(s,l,u-s,f-l)),$=W.y,X=W.bottom,G=W.x,K=W.right,Y=H+U,J=(d=F+q,m=Y,g=t,h=n,v=(p=W).x,y=p.y,k=p.width,_=p.height,C=m>=y,S=(x=d>=v)&&C,z=v+k>=d+g&&y+_>=m+h,T=Math.abs(Math.min(g,x?v+k-d:v-(d+g))),E=Math.abs(Math.min(h,C?y+_-m:y-(m+h))),O=Math.max(p.x,p.right-g),N=Math.max(p.y,p.bottom-h),{originInBounds:S,sizeInBounds:z,limitX:As(d,p.x,O),limitY:As(m,p.y,N),deltaW:T,deltaH:E}),Z=J.originInBounds,Q=J.sizeInBounds,ee=J.limitX,te=J.limitY,ne=J.deltaW,re=J.deltaH,oe=b(te+re-$),ae=b(X-te),ie=(A=e.direction,P=R=ae,B=oe,A.fold(R,R,B,B,R,B,P,P)),ce=b(ee+ne-G),se=b(K-ee),le={x:ee,y:te,width:ne,height:re,maxHeight:ie,maxWidth:(M=e.direction,L=I=se,j=ce,M.fold(I,j,I,j,L,L,I,j)),direction:e.direction,classes:{on:e.bubble.classesOn,off:e.bubble.classesOff},label:e.label,candidateYforTest:Y};return Z&&Q?Rs.fit(le):Rs.nofit(le,ne,re)},Bs=function(t,n,r,o){ui(n,"max-height"),ui(n,"max-width");var a,i,c,s,l,u,f,d,m,g={width:Mi(a=n),height:Ei(a)};return i=o.preference,c=t,s=g,l=r,u=o.bounds,f=s.width,d=s.height,m=function(e,t,n,r){var o=e(c,s,l);return Ps(o,f,d,u).fold(Rs.fit,function(e,o,a){return a>r||o>n?Rs.nofit(e,o,a):Rs.nofit(t,n,r)})},te(i,function(t,n){var r=e(m,n);return t.fold(Rs.fit,r)},Rs.nofit({x:c.x,y:c.y,width:s.width,height:s.height,maxHeight:s.height,maxWidth:s.width,direction:Oc(),classes:{on:[],off:[]},label:"none",candidateYforTest:c.y},-1,-1)).fold(w,w)},Ms=function(e,t,n){var r,o;Cs(e,(r=n.origin,o=t,r.fold(function(){return xs("absolute",D.some(o.x),D.some(o.y),D.none(),D.none())},function(e,t,n,r){return zs("absolute",o,e,t,n,r)},function(e,t,n,r){return zs("fixed",o,e,t,n,r)})))},Is=function(e,t){var n,r,o;n=e,r=Math.floor(t),o=zi.max(n,r,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),ri(n,"max-height",o+"px")},Ls=b(function(e,t){Is(e,t),oi(e,{"overflow-x":"hidden","overflow-y":"auto"})}),js=b(function(e,t){Is(e,t)}),Fs=function(e,t,n){return void 0===e[t]?n:e[t]},Hs=function(e,t,n,r,o,a){var i,c=Fs(a,"maxHeightFunction",Ls()),s=Fs(a,"maxWidthFunction",v),l=e.anchorBox,u=e.origin,f={bounds:(i=u,o.fold(function(){return i.fold(Yi,Yi,Xi)},function(e){return i.fold(e,e,function(){var t=e(),n=Es(i,t.x,t.y);return Xi(n.left,n.top,t.width,t.height)})})),origin:u,preference:r,maxHeightFunction:c,maxWidthFunction:s};Vs(l,t,n,f)},Vs=function(e,t,n,r){var o,a,i,c,s,l,u=Bs(e,t,n,r);Ms(t,u,r),o=t,a=u.classes,Ya(o,a.off),Ka(o,a.on),i=t,c=u,(0,r.maxHeightFunction)(i,c.maxHeight),s=t,l=u,(0,r.maxWidthFunction)(s,l.maxWidth)},qs=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Us=function(e,t,n){var r=function(e){return qe(n,e).getOr([])},o=function(e,t,n){var o=se(qs,n);return{offset:Di(e,t),classesOn:ae(n,r),classesOff:ae(o,r)}};return{southeast:function(){return o(-e,t,["top","alignLeft"])},southwest:function(){return o(e,t,["top","alignRight"])},south:function(){return o(-e/2,t,["top","alignCentre"])},northeast:function(){return o(-e,-t,["bottom","alignLeft"])},northwest:function(){return o(e,-t,["bottom","alignRight"])},north:function(){return o(-e/2,-t,["bottom","alignCentre"])},east:function(){return o(e,-t/2,["valignCentre","left"])},west:function(){return o(-e,-t/2,["valignCentre","right"])},innerNorthwest:function(){return o(-e,t,["top","alignRight"])},innerNortheast:function(){return o(e,t,["top","alignLeft"])},innerNorth:function(){return o(-e/2,t,["top","alignCentre"])},innerSouthwest:function(){return o(-e,-t,["bottom","alignRight"])},innerSoutheast:function(){return o(e,-t,["bottom","alignLeft"])},innerSouth:function(){return o(-e/2,-t,["bottom","alignCentre"])},innerWest:function(){return o(e,-t/2,["valignCentre","right"])},innerEast:function(){return o(-e,-t/2,["valignCentre","left"])}}},Ws=function(){return Us(0,0,{})},$s=function(e,t){return function(n){return"rtl"===Xs(n)?t:e}},Xs=function(e){return"rtl"===ii(e,"direction")?"rtl":"ltr"};(sc=cc=cc||{}).TopToBottom="toptobottom",sc.BottomToTop="bottomtotop";var Gs,Ks,Ys,Js,Zs,Qs="data-alloy-vertical-dir",el=function(e){return Qi(e,function(e){return So(e)&&oa(e,"data-alloy-vertical-dir")===cc.BottomToTop})},tl=function(){return un("layouts",[Yt("onLtr"),Yt("onRtl"),on("onBottomLtr"),on("onBottomRtl")])},nl=function(e,t,n,r,o,a,i){var c=i.map(el).getOr(!1),s=t.layouts.map(function(t){return t.onLtr(e)}),l=t.layouts.map(function(t){return t.onRtl(e)}),u=c?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(e)})}).or(s).getOr(o):s.getOr(n),f=c?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(e)})}).or(l).getOr(a):l.getOr(r);return $s(u,f)(e)},rl=[Yt("hotspot"),on("bubble"),fn("overrides",{}),tl(),Cc("placement",function(e,t,n){var r=t.hotspot,o=Ts(n,r.element),a=nl(e.element,t,ns(),rs(),es(),ts(),D.some(t.hotspot.element));return D.some({anchorBox:o,bubble:t.bubble.getOr(Ws()),overrides:t.overrides,layouts:a,placer:D.none()})})],ol=[Yt("x"),Yt("y"),fn("height",0),fn("width",0),fn("bubble",Ws()),fn("overrides",{}),tl(),Cc("placement",function(e,t,n){var r=Es(n,t.x,t.y),o=Xi(r.left,r.top,t.width,t.height),a=nl(e.element,t,Zc(),Qc(),Zc(),Qc(),D.none());return D.some({anchorBox:o,bubble:t.bubble,overrides:t.overrides,layouts:a,placer:D.none()})})],al=$e([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),il=function(e){return e.fold(w,function(e,t,n){return e.translate(-t,-n)})},cl=function(e){return e.fold(w,w)},sl=function(e){return te(e,function(e,t){return e.translate(t.left,t.top)},Di(0,0))},ll=function(e){var t=Y(e,cl);return sl(t)},ul=al.screen,fl=al.absolute,dl=function(e,t,n){var r,o,a=Oo(e.element),i=Fi(a),c=(r=e,o=Ao(n.root).dom,D.from(o.frameElement).map(xn.fromDom).filter(function(e){var t=Oo(e),n=Oo(r.element);return tr(t,n)}).map(Ai).getOr(i));return fl(c,i.left,i.top)},ml=function(e,t,n,r){var o=e,a=t,i=n,c=r;0>e&&(o=0,i=n+e),0>t&&(a=0,c=r+t);var s=ul(Di(o,a));return D.some({point:s,width:i,height:c})},gl=function(e,t,n,r,o){return e.map(function(e){var a,i,c,s=[t,e.point],l=(a=function(){return ll(s)},i=function(){return ll(s)},c=function(){return e=Y(s,il),sl(e);var e},r.fold(a,i,c)),u={x:l.left,y:l.top,width:e.width,height:e.height},f=(n.showAbove?es:ns)(),d=(n.showAbove?ts:rs)(),m=nl(o,n,f,d,f,d,D.none());return{anchorBox:u,bubble:n.bubble.getOr(Ws()),overrides:n.overrides,layouts:m,placer:D.none()}})},hl=[Yt("node"),Yt("root"),on("bubble"),tl(),fn("overrides",{}),fn("showAbove",!1),Cc("placement",function(e,t,n){var r=dl(e,0,t);return t.node.filter(Za).bind(function(o){var a=o.dom.getBoundingClientRect(),i=ml(a.left,a.top,a.width,a.height),c=t.node.getOr(e.element);return gl(i,r,t,n,c)})})],pl=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},vl=$e([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),yl=(vl.before,vl.on,vl.after,function(e){return e.fold(w,w,w)}),bl=$e([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),wl={domRange:bl.domRange,relative:bl.relative,exact:bl.exact,exactFromRange:function(e){return bl.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=e.match({domRange:function(e){return xn.fromDom(e.startContainer)},relative:function(e){return yl(e)},exact:function(e){return e}});return Ao(t)},range:pl},kl=function(e,t,n){var r,o,a=e.document.createRange();return r=a,t.fold(function(e){r.setStartBefore(e.dom)},function(e,t){r.setStart(e.dom,t)},function(e){r.setStartAfter(e.dom)}),o=a,n.fold(function(e){o.setEndBefore(e.dom)},function(e,t){o.setEnd(e.dom,t)},function(e){o.setEndAfter(e.dom)}),a},_l=function(e,t,n,r,o){var a=e.document.createRange();return a.setStart(t.dom,n),a.setEnd(r.dom,o),a},xl=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Cl=$e([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Sl=function(e,t,n){return t(xn.fromDom(n.startContainer),n.startOffset,xn.fromDom(n.endContainer),n.endOffset)},zl=function(e,t){var n,r,o,a=(n=e,t.match({domRange:function(e){return{ltr:b(e),rtl:D.none}},relative:function(e,t){return{ltr:Je(function(){return kl(n,e,t)}),rtl:Je(function(){return D.some(kl(n,t,e))})}},exact:function(e,t,r,o){return{ltr:Je(function(){return _l(n,e,t,r,o)}),rtl:Je(function(){return D.some(_l(n,r,o,e,t))})}}}));return(o=(r=a).ltr()).collapsed?r.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Cl.rtl(xn.fromDom(e.endContainer),e.endOffset,xn.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Sl(0,Cl.ltr,o)}):Sl(0,Cl.ltr,o)},Tl=(Cl.ltr,Cl.rtl,Gs=zo,Ks="text",{get:function(e){if(!Gs(e))throw new Error("Can only get "+Ks+" value of a "+Ks+" node");return Ys(e).getOr("")},getOption:Ys=function(e){return Gs(e)?D.from(e.dom.nodeValue):D.none()},set:function(e,t){if(!Gs(e))throw new Error("Can only set raw "+Ks+" value of a "+Ks+" node");e.dom.nodeValue=t}}),El=function(e){return Tl.getOption(e)},Ol=["img","br"],Dl=function(e){return El(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf("\xa0")}).isSome()||$(Ol,xo(e))},Nl=function(e,t){var n=function(e){for(var r=Mo(e),o=r.length-1;o>=0;o--){var a=r[o];if(t(a))return D.some(a);var i=n(a);if(i.isSome())return i}return D.none()};return n(e)},Al=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,er(o)?[]:Y(o.querySelectorAll(n),xn.fromDom);var n,r,o},Rl=function(e,t,n,r){var o,a,i,c,s,l=(a=t,i=n,c=r,(s=Oo(o=e).dom.createRange()).setStart(o.dom,a),s.setEnd(i.dom,c),s),u=tr(e,n)&&t===r;return l.collapsed&&!u},Pl=function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return D.some(pl(xn.fromDom(t.startContainer),t.startOffset,xn.fromDom(n.endContainer),n.endOffset))}return D.none()},Bl=function(e){if(null===e.anchorNode||null===e.focusNode)return Pl(e);var t=xn.fromDom(e.anchorNode),n=xn.fromDom(e.focusNode);return Rl(t,e.anchorOffset,n,e.focusOffset)?D.some(pl(t,e.anchorOffset,n,e.focusOffset)):Pl(e)},Ml=function(e){return t=e,D.from(t.getSelection()).filter(function(e){return 0<e.rangeCount}).bind(Bl);var t},Il=function(e,t){var n,r,o,a,i=zl(n=e,t).match({ltr:function(e,t,r,o){var a=n.document.createRange();return a.setStart(e.dom,t),a.setEnd(r.dom,o),a},rtl:function(e,t,r,o){var a=n.document.createRange();return a.setStart(r.dom,o),a.setEnd(e.dom,t),a}});return o=(r=i).getClientRects(),0<(a=0<o.length?o[0]:r.getBoundingClientRect()).width||0<a.height?D.some(a).map(xl):D.none()},Ll=function(e,t){return{element:e,offset:t}},jl=function(e,t){var n=Mo(e);if(0===n.length)return Ll(e,t);if(t<n.length)return Ll(n[t],0);var r,o=n[n.length-1],a=zo(o)?(r=o,Tl.get(r).length):Mo(o).length;return Ll(o,a)},Fl=function(e,t){return(zo(e)?Ll:jl)(e,t)},Hl=function(e,t){return t.getSelection.getOrThunk(function(){
return function(){return Ml(e)}})().map(function(e){var t=Fl(e.start,e.soffset),n=Fl(e.finish,e.foffset);return wl.range(t.element,t.offset,n.element,n.offset)})},Vl=[on("getSelection"),Yt("root"),on("bubble"),tl(),fn("overrides",{}),fn("showAbove",!1),Cc("placement",function(e,t,n){var r=Ao(t.root).dom,o=dl(e,0,t),a=Hl(r,t).bind(function(e){return Il(r,wl.exactFromRange(e)).orThunk(function(){var t=xn.fromText("\ufeff");return $o(e.start,t),Il(r,wl.exact(t,0,t,1)).map(function(e){return Zo(t),e})}).bind(function(e){return ml(e.left,e.top,e.width,e.height)})}),i=Hl(r,t).bind(function(e){return So(e.start)?D.some(e.start):Po(e.start)}).getOr(e.element);return gl(a,o,t,n,i)})],ql=function(e){return e.x+e.width},Ul=function(e,t){return e.x-t.width},Wl=function(e,t){return e.y-t.height+e.height},$l=function(e){return e.y},Xl=function(e,t,n){return Tc(ql(e),$l(e),n.southeast(),Oc(),Ic(e,{left:0,top:2}),"link-layout-se")},Gl=function(e,t,n){return Tc(Ul(e,t),$l(e),n.southwest(),Dc(),Ic(e,{right:1,top:2}),"link-layout-sw")},Kl=function(e,t,n){return Tc(ql(e),Wl(e,t),n.northeast(),Nc(),Ic(e,{left:0,bottom:3}),"link-layout-ne")},Yl=function(e,t,n){return Tc(Ul(e,t),Wl(e,t),n.northwest(),Ac(),Ic(e,{right:1,bottom:3}),"link-layout-nw")},Jl=function(){return[Xl,Gl,Kl,Yl]},Zl=function(){return[Gl,Xl,Yl,Kl]},Ql=[Yt("item"),tl(),fn("overrides",{}),Cc("placement",function(e,t,n){var r=Ts(n,t.item.element),o=nl(e.element,t,Jl(),Zl(),Jl(),Zl(),D.none());return D.some({anchorBox:r,bubble:Ws(),overrides:t.overrides,layouts:o,placer:D.none()})})],eu=Ft("anchor",{selection:Vl,node:hl,hotspot:rl,submenu:Ql,makeshift:ol}),tu=function(e,t,n,r,o){var a={anchorBox:n.anchorBox,origin:t};Hs(a,o.element,n.bubble,n.layouts,r,n.overrides)},nu=function(e,t,n,r,o,a){var i=a.map(Gi);return ru(e,t,n,r,o,i)},ru=function(e,t,n,r,o,a){var i=It("positioning anchor.info",eu,r);_s(function(){ri(o.element,"position","fixed");var n=si(o.element,"visibility");ri(o.element,"visibility","hidden");var r,c,s,l,u=t.useFixed()?(l=document.documentElement,Ds(0,0,l.clientWidth,l.clientHeight)):(c=Ai((r=e).element),s=r.element.dom.getBoundingClientRect(),Os(c.left,c.top,s.width,s.height)),f=i.placement,d=a.map(b).or(t.getBounds);f(e,i,u).each(function(t){t.placer.getOr(tu)(e,u,t,d,o)}),n.fold(function(){ui(o.element,"visibility")},function(e){ri(o.element,"visibility",e)}),si(o.element,"left").isNone()&&si(o.element,"top").isNone()&&si(o.element,"right").isNone()&&si(o.element,"bottom").isNone()&&si(o.element,"position").is("fixed")&&ui(o.element,"position")},o.element)},ou=Object.freeze({__proto__:null,position:function(e,t,n,r,o){nu(e,t,n,r,o,D.none())},positionWithin:nu,positionWithinBounds:ru,getMode:function(e,t){return t.useFixed()?"fixed":"absolute"}}),au=[fn("useFixed",x),on("getBounds")],iu=ms({fields:au,name:"positioning",active:ys,apis:ou}),cu=function(e){no(e,Xr());var t=e.components();J(t,cu)},su=function(e){var t=e.components();J(t,su),no(e,$r())},lu=function(e,t){Ko(e.element,t.element)},uu=function(e,t){var n,r=e.components();J((n=e).components(),function(e){return Zo(e.element)}),Jo(n.element),n.syncComponents();var o=se(r,t);J(o,function(t){cu(t),e.getSystem().removeFromWorld(t)}),J(t,function(t){t.getSystem().isConnected()?lu(e,t):(e.getSystem().addToWorld(t),lu(e,t),Za(e.element)&&su(t)),e.syncComponents()})},fu=function(e,t){du(e,t,Ko)},du=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),Za(e.element)&&su(t),e.syncComponents()},mu=function(e){cu(e),Zo(e.element),e.getSystem().removeFromWorld(e)},gu=function(e){var t=Ro(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()});mu(e),t.each(function(e){e.syncComponents()})},hu=function(e){var t=e.components();J(t,mu),Jo(e.element),e.syncComponents()},pu=function(e,t){vu(e,t,Ko)},vu=function(e,t,n){n(e,t.element);var r=Mo(t.element);J(r,function(e){t.getByDom(e).each(su)})},yu=function(e){var t=Mo(e.element);J(t,function(t){e.getByDom(t).each(cu)}),Zo(e.element)},bu=function(e,t,n,r){n.get().each(function(){hu(e)});var o=t.getAttachPoint(e);fu(o,e);var a=e.getSystem().build(r);return fu(e,a),n.set(a),a},wu=function(e,t,n,r){var o=bu(e,t,n,r);return t.onOpen(e,o),o},ku=function(e,t,n){n.get().each(function(r){hu(e),gu(e),t.onClose(e,r),n.clear()})},_u=function(e,t,n){return n.isOpen()},xu=function(e,t){var n,r,o,a,i=t.getAttachPoint(e);ri(e.element,"position",iu.getMode(i)),n=e,r="visibility",o=t.cloakVisibilityAttr,a="hidden",si(n.element,r).fold(function(){ca(n.element,o)},function(e){ra(n.element,o,e)}),ri(n.element,r,a)},Cu=function(e,t){var n,r,o,a;n=e.element,X(["top","left","right","bottom"],function(e){return si(n,e).isSome()})||ui(e.element,"position"),r=e,o="visibility",a=t.cloakVisibilityAttr,aa(r.element,a).fold(function(){return ui(r.element,o)},function(e){return ri(r.element,o,e)})},Su=Object.freeze({__proto__:null,cloak:xu,decloak:Cu,open:wu,openWhileCloaked:function(e,t,n,r,o){xu(e,t),wu(e,t,n,r),o(),Cu(e,t)},close:ku,isOpen:_u,isPartOf:function(e,t,n,r){return _u(0,0,n)&&n.get().exists(function(n){return t.isPartOf(e,n,r)})},getState:function(e,t,n){return n.get()},setContent:function(e,t,n,r){return n.get().map(function(){return bu(e,t,n,r)})}}),zu=Object.freeze({__proto__:null,events:function(e,t){return so([fo(jr(),function(n){ku(n,e,t)})])}}),Tu=[wc("onOpen"),wc("onClose"),Yt("isPartOf"),Yt("getAttachPoint"),fn("cloakVisibilityAttr","data-precloak-visibility")],Eu=ms({fields:Tu,name:"sandboxing",active:zu,apis:Su,state:Object.freeze({__proto__:null,init:function(){var e=kn(D.none()),t=b("not-implemented");return Da({readState:t,isOpen:function(){return e.get().isSome()},clear:function(){e.set(D.none())},set:function(t){e.set(D.some(t))},get:function(){return e.get()}})}})}),Ou=b("dismiss.popups"),Du=b("reposition.popups"),Nu=b("mouse.released"),Au=bt([fn("isExtraPart",x),un("fireEventInstead",[fn("event",Gr())])]),Ru=function(e){var t=It("Dismissal",Au,e),n={};return n[Ou()]={schema:bt([Yt("target")]),onReceive:function(e,n){Eu.isOpen(e)&&(Eu.isPartOf(e,n.target)||t.isExtraPart(e,n.target)||t.fireEventInstead.fold(function(){return Eu.close(e)},function(t){return no(e,t.event)}))}},n},Pu=bt([un("fireEventInstead",[fn("event",Kr())]),en("doReposition")]),Bu=function(e){var t=It("Reposition",Pu,e),n={};return n[Du()]={onReceive:function(e){Eu.isOpen(e)&&t.fireEventInstead.fold(function(){return t.doReposition(e)},function(t){return no(e,t.event)})}},n},Mu=function(e,t,n){t.store.manager.onLoad(e,t,n)},Iu=function(e,t,n){t.store.manager.onUnload(e,t,n)},Lu=Object.freeze({__proto__:null,onLoad:Mu,onUnload:Iu,setValue:function(e,t,n,r){t.store.manager.setValue(e,t,n,r)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),ju=Object.freeze({__proto__:null,events:function(e,t){var n=e.resetOnDom?[bo(function(n){Mu(n,e,t)}),wo(function(n){Iu(n,e,t)})]:[is(e,t,Mu)];return so(n)}}),Fu=function(){var e=kn(null);return Da({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},Hu=function(){var e=kn({}),t=kn({});return Da({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},lookup:function(n){return qe(e.get(),n).orThunk(function(){return qe(t.get(),n)})},update:function(n){var r=e.get(),o=t.get(),a={},i={};J(n,function(e){a[e.value]=e,qe(e,"meta").each(function(t){qe(t,"text").each(function(t){i[t]=e})})}),e.set(z(z({},r),a)),t.set(z(z({},o),i))},clear:function(){e.set({}),t.set({})}})},Vu=Object.freeze({__proto__:null,memory:Fu,dataset:Hu,manual:function(){return Da({readState:v})},init:function(e){return e.store.manager.state(e)}}),qu=function(e,t,n,r){var o=t.store;n.update([r]),o.setValue(e,r),t.onSetValue(e,r)},Uu=[on("initialValue"),Yt("getFallbackEntry"),Yt("getDataKey"),Yt("setValue"),Cc("manager",{setValue:qu,getValue:function(e,t,n){var r=t.store,o=r.getDataKey(e);return n.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(e){return e})},onLoad:function(e,t,n){t.store.initialValue.each(function(r){qu(e,t,n,r)})},onUnload:function(e,t,n){n.clear()},state:Hu})],Wu=[Yt("getValue"),fn("setValue",v),on("initialValue"),Cc("manager",{setValue:function(e,t,n,r){t.store.setValue(e,r),t.onSetValue(e,r)},getValue:function(e,t){return t.store.getValue(e)},onLoad:function(e,t){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:v,state:Oa.init})],$u=[on("initialValue"),Cc("manager",{setValue:function(e,t,n,r){n.set(r),t.onSetValue(e,r)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each(function(e){n.isNotSet()&&n.set(e)})},onUnload:function(e,t,n){n.clear()},state:Fu})],Xu=[dn("store",{mode:"memory"},Ft("mode",{memory:$u,manual:Wu,dataset:Uu})),wc("onSetValue"),fn("resetOnDom",!1)],Gu=ms({fields:Xu,name:"representing",active:ju,apis:Lu,extra:{setValueFrom:function(e,t){var n=Gu.getValue(t);Gu.setValue(e,n)}},state:Vu}),Ku=function(e,t){return bn(e,{},Y(t,function(t){return n=t.name(),r="Cannot configure "+t.name()+" for "+e,Tt(n,n,tt(),yt(function(){return Oe("The field: "+n+" is forbidden. "+r)}));var n,r}).concat([wn("dump",w)]))},Yu=function(e){return e.dump},Ju=function(e,t){return z(z({},e.dump),fs(t))},Zu=Ku,Qu=Ju,ef="placeholder",tf=$e([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),nf=function(e){return Ue(e,"uiType")},rf=function(e,t,n,r){return nf(n)&&n.uiType===ef?(a=n,i=r,(o=e).exists(function(e){return e!==a.owner})?tf.single(!0,b(a)):qe(i,a.name).fold(function(){throw new Error("Unknown placeholder component: "+a.name+"\nKnown: ["+Pe(i)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(a,null,2))},function(e){return e.replace()})):tf.single(!1,b(n));var o,a,i},of=function(e,t,n,r){return rf(e,0,n,r).fold(function(o,a){var i=nf(n)?a(t,n.config,n.validated):a(t),c=qe(i,"components").getOr([]),s=ae(c,function(n){return of(e,t,n,r)});return[z(z({},i),{components:s})]},function(e,r){if(nf(n)){var o=r(t,n.config,n.validated);return n.validated.preprocess.getOr(w)(o)}return r(t)})},af=function(e,t,n,r){var o,a,i,c=Ie(r,function(e,t){return r=e,o=!1,{name:b(n=t),required:function(){return r.fold(function(e){return e},function(e){return e})},used:function(){return o},replace:function(){if(o)throw new Error("Trying to use the same placeholder more than once: "+n);return o=!0,r}};var n,r,o}),s=(o=e,a=t,i=c,ae(n,function(e){return of(o,a,e,i)}));return Me(c,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),s},cf=tf.single,sf=tf.multiple,lf=b(ef),uf=$e([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ff=fn("factory",{sketch:w}),df=fn("schema",[]),mf=Yt("name"),gf=Tt("pname","pname",nt(function(e){return"<alloy."+ma(e.name)+">"}),Ht()),hf=wn("schema",function(){return[on("preprocess")]}),pf=fn("defaults",b({})),vf=fn("overrides",b({})),yf=wt([ff,df,mf,gf,pf,vf]),bf=wt([ff,df,mf,pf,vf]),wf=wt([ff,df,mf,gf,pf,vf]),kf=wt([ff,hf,mf,Yt("unit"),gf,pf,vf]),_f=function(e){return e.fold(D.some,D.none,D.some,D.some)},xf=function(e){var t=function(e){return e.name};return e.fold(t,t,t,t)},Cf=function(e,t){return function(n){var r=It("Converting part type",t,n);return e(r)}},Sf=Cf(uf.required,yf),zf=Cf(uf.external,bf),Tf=Cf(uf.optional,wf),Ef=Cf(uf.group,kf),Of=b("entirety"),Df=Object.freeze({__proto__:null,required:Sf,external:zf,optional:Tf,group:Ef,asNamedPart:_f,name:xf,asCommon:function(e){return e.fold(w,w,w,w)},original:Of}),Nf=function(e,t,n,r){return Ke(t.defaults(e,n,r),n,{uid:e.partUids[t.name]},t.overrides(e,n,r))},Af=function(e,t){var n={};return J(t,function(t){_f(t).each(function(t){var r=Rf(e,t.pname);n[t.name]=function(n){var o=It("Part: "+t.name+" in "+e,wt(t.schema),n);return z(z({},r),{config:n,validated:o})}})}),n},Rf=function(e,t){return{uiType:lf(),owner:e,name:t}},Pf=function(e,t,n){return{uiType:lf(),owner:e,name:t,config:n,validated:{}}},Bf=function(e){return ae(e,function(e){return e.fold(D.none,D.some,D.none,D.none).map(function(e){return tn(e.name,e.schema.concat([Sc(Of())]))}).toArray()})},Mf=function(e){return Y(e,xf)},If=function(e,t,n){return r=t,o={},a={},J(n,function(e){e.fold(function(e){o[e.pname]=cf(!0,function(t,n,r){return e.factory.sketch(Nf(t,e,n,r))})},function(e){var t=r.parts[e.name];a[e.name]=b(e.factory.sketch(Nf(r,e,t[Of()]),t))},function(e){o[e.pname]=cf(!1,function(t,n,r){return e.factory.sketch(Nf(t,e,n,r))})},function(e){o[e.pname]=sf(!0,function(t,n,r){var o=t[e.name];return Y(o,function(n){return e.factory.sketch(Ke(e.defaults(t,n,r),n,e.overrides(t,n)))})})})}),{internals:b(o),externals:b(a)};var r,o,a},Lf=function(e,t,n){return af(D.some(e),t,t.components,n)},jf=function(e,t,n){var r=t.partUids[n];return e.getSystem().getByUid(r).toOptional()},Ff=function(e,t,n){return jf(e,t,n).getOrDie("Could not find part: "+n)},Hf=function(e,t,n){var r={},o=t.partUids,a=e.getSystem();return J(n,function(e){r[e]=b(a.getByUid(o[e]))}),r},Vf=function(e,t){var n=e.getSystem();return Ie(t.partUids,function(e){return b(n.getByUid(e))})},qf=function(e){return Pe(e.partUids)},Uf=function(e,t,n){var r={},o=t.partUids,a=e.getSystem();return J(n,function(e){r[e]=b(a.getByUid(o[e]).getOrDie())}),r},Wf=function(e,t){var n=Mf(t);return ct(Y(n,function(t){return{key:t,value:e+"-"+t}}))},$f=function(e){return Tt("partUids","partUids",rt(function(t){return Wf(t.uid,e)}),Ht())},Xf=Object.freeze({__proto__:null,generate:Af,generateOne:Pf,schemas:Bf,names:Mf,substitutes:If,components:Lf,defaultUids:Wf,defaultUidsSchema:$f,getAllParts:Vf,getAllPartNames:qf,getPart:jf,getPartOrDie:Ff,getParts:Hf,getPartsOrDie:Uf}),Gf=function(e,t,n,r,o){var a,i,c=(i=o,(0<(a=r).length?[tn("parts",a)]:[]).concat([Yt("uid"),fn("dom",{}),fn("components",[]),Sc("originalSpec"),fn("debug.sketcher",{})]).concat(i));return It(e+" [SpecSchema]",bt(c.concat(t)),n)},Kf=function(e,t,n,r,o){var a=Yf(o),i=Bf(n),c=$f(n),s=Gf(e,t,a,i,[c]),l=If(0,s,n);return r(s,Lf(e,s,l.internals()),a,l.externals())},Yf=function(e){return Ue(e,"uid")?e:z(z({},e),{uid:wa("uid")})},Jf=bt([Yt("name"),Yt("factory"),Yt("configFields"),fn("apis",{}),fn("extraApis",{})]),Zf=bt([Yt("name"),Yt("factory"),Yt("configFields"),Yt("partFields"),fn("apis",{}),fn("extraApis",{})]),Qf=function(e){var t=It("Sketcher for "+e.name,Jf,e),n=Ie(t.apis,Ea),r=Ie(t.extraApis,Sa);return z(z({name:t.name,configFields:t.configFields,sketch:function(e){return n=t.name,r=t.configFields,o=t.factory,a=Yf(e),o(Gf(n,r,a,[],[]),a);var n,r,o,a}},n),r)},ed=function(e){var t=It("Sketcher for "+e.name,Zf,e),n=Af(t.name,t.partFields),r=Ie(t.apis,Ea),o=Ie(t.extraApis,Sa);return z(z({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(e){return Kf(t.name,t.configFields,t.partFields,t.factory,e)},parts:n},r),o)},td=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},nd=function(e,t){return e?D.some(t):D.none()},rd=function(e){return"input"===xo(e)&&"radio"!==oa(e,"type")||"textarea"===xo(e)},od=Object.freeze({__proto__:null,getCurrent:function(e,t){return t.find(e)}}),ad=[Yt("find")],id=ms({fields:ad,name:"composing",apis:od}),cd=function(e,t,n,r){var o=Al(e.element,"."+t.highlightClass);J(o,function(n){X(r,function(e){return e.element===n})||(Xa(n,t.highlightClass),e.getSystem().getByDom(n).each(function(n){t.onDehighlight(e,n),no(n,to())}))})},sd=function(e,t,n,r){cd(e,t,0,[r]),ld(e,t,n,r)||(Wa(r.element,t.highlightClass),t.onHighlight(e,r),no(r,eo()))},ld=function(e,t,n,r){return Ga(r.element,t.highlightClass)},ud=function(e,t,n,r){var o=Al(e.element,"."+t.itemClass);return D.from(o[r]).fold(function(){return ve.error(new Error("No element found with index "+r))},e.getSystem().getByDom)},fd=function(e,t){return tc(e.element,"."+t.itemClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},dd=function(e,t){var n=Al(e.element,"."+t.itemClass);return(0<n.length?D.some(n[n.length-1]):D.none()).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},md=function(e,t,n,r){var o=Al(e.element,"."+t.itemClass);return re(o,function(e){return Ga(e,t.highlightClass)}).bind(function(t){var n=Ns(t,r,0,o.length-1);return e.getSystem().getByDom(o[n]).toOptional()})},gd=function(e,t){var n=Al(e.element,"."+t.itemClass);return td(Y(n,function(t){return e.getSystem().getByDom(t).toOptional()}))},hd=Object.freeze({__proto__:null,dehighlightAll:function(e,t){return cd(e,t,0,[])},dehighlight:function(e,t,n,r){ld(e,t,n,r)&&(Xa(r.element,t.highlightClass),t.onDehighlight(e,r),no(r,to()))},highlight:sd,highlightFirst:function(e,t,n){fd(e,t).each(function(r){sd(e,t,n,r)})},highlightLast:function(e,t,n){dd(e,t).each(function(r){sd(e,t,n,r)})},highlightAt:function(e,t,n,r){ud(e,t,n,r).fold(function(e){throw e},function(r){sd(e,t,n,r)})},highlightBy:function(e,t,n,r){var o=gd(e,t);ne(o,r).each(function(r){sd(e,t,n,r)})},isHighlighted:ld,getHighlighted:function(e,t){return tc(e.element,"."+t.highlightClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},getFirst:fd,getLast:dd,getPrevious:function(e,t){return md(e,t,0,-1)},getNext:function(e,t){return md(e,t,0,1)},getCandidates:gd}),pd=[Yt("highlightClass"),Yt("itemClass"),wc("onHighlight"),wc("onDehighlight")],vd=ms({fields:pd,name:"highlighting",apis:hd}),yd=[8],bd=[9],wd=[13],kd=[27],_d=[32],xd=[37],Cd=[38],Sd=[39],zd=[40],Td=function(e,t,n){var r=ce(e.slice(0,t)),o=ce(e.slice(t+1));return ne(r.concat(o),n)},Ed=function(e,t,n){var r=ce(e.slice(0,t));return ne(r,n)},Od=function(e,t,n){var r=e.slice(0,t),o=e.slice(t+1);return ne(o.concat(r),n)},Dd=function(e,t,n){var r=e.slice(t+1);return ne(r,n)},Nd=function(e){return function(t){var n=t.raw;return $(e,n.which)}},Ad=function(e){return function(t){return ie(e,function(e){return e(t)})}},Rd=function(e){return!0===e.raw.shiftKey},Pd=function(e){return!0===e.raw.ctrlKey},Bd=k(Rd),Md=function(e,t){return{matches:e,classification:t}},Id=function(e,t,n){t.exists(function(e){return n.exists(function(t){return tr(t,e)})})||ro(e,Yr(),{prevFocus:t,newFocus:n})},Ld=function(){var e=function(e){return ks(e.element)};return{get:e,set:function(t,n){var r=e(t);t.getSystem().triggerFocus(n,t.element);var o=e(t);Id(t,r,o)}}},jd=function(){var e=function(e){return vd.getHighlighted(e).map(function(e){return e.element})};return{get:e,set:function(t,n){var r=e(t);t.getSystem().getByDom(n).fold(v,function(e){vd.highlight(t,e)});var o=e(t);Id(t,r,o)}}};(Zs=Js=Js||{}).OnFocusMode="onFocus",Zs.OnEnterOrSpaceMode="onEnterOrSpace",Zs.OnApiMode="onApi";var Fd,Hd,Vd,qd=function(e,t,n,r,o){var a=function(e,t,n,r,o){var a,i,c=n(e,t,r,o);return a=c,i=t.event,ne(a,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(n){return n(e,t,r,o)})},i={schema:function(){return e.concat([fn("focusManager",Ld()),dn("focusInside","onFocus",Rt(function(e){return $(["onFocus","onEnterOrSpace","onApi"],e)?ve.value(e):ve.error("Invalid value for focusInside")})),Cc("handler",i),Cc("state",t),Cc("sendFocusIn",o)])},processKey:a,toEvents:function(e,t){var i=e.focusInside!==Js.OnFocusMode?D.none():o(e).map(function(n){return fo(Nr(),function(r,o){n(r,e,t),o.stop()})}),c=[fo(_r(),function(r,i){a(r,i,n,e,t).fold(function(){var n,a,c;n=r,a=i,c=Nd(_d.concat(wd))(a.event),e.focusInside===Js.OnEnterOrSpaceMode&&c&&cr(n,a)&&o(e).each(function(r){r(n,e,t),a.stop()})},function(){i.stop()})}),fo(xr(),function(n,o){a(n,o,r,e,t).each(function(){o.stop()})})];return so(i.toArray().concat(c))}};return i},Ud=function(t){var n=[on("onEscape"),on("onEnter"),fn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),fn("firstTabstop",0),fn("useTabstopAt",C),on("visibilitySelector")].concat([t]),r=function(e,t){var n=e.visibilitySelector.bind(function(e){return nc(t,e)}).getOr(t);return 0<Ti(n)},o=function(e,t){var n,o,a;n=t,o=Al(e.element,n.selector),a=Q(o,function(e){return r(n,e)}),D.from(a[n.firstTabstop]).each(function(n){t.focusManager.set(e,n)})},a=function(e,t,n,o,a){return a(t,n,function(e){return r(t=o,n=e)&&t.useTabstopAt(n);var t,n}).fold(function(){return o.cyclic?D.some(!0):D.none()},function(t){return o.focusManager.set(e,t),D.some(!0)})},i=function(t,n,r,o){var i,c,s=Al(t.element,r.selector);return i=t,(c=r).focusManager.get(i).bind(function(e){return nc(e,c.selector)}).bind(function(n){return re(s,e(tr,n)).bind(function(e){return a(t,s,e,r,o)})})},c=b([Md(Ad([Rd,Nd(bd)]),function(e,t,n){var r=n.cyclic?Td:Ed;return i(e,0,n,r)}),Md(Nd(bd),function(e,t,n){var r=n.cyclic?Od:Dd;return i(e,0,n,r)}),Md(Nd(kd),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),Md(Ad([Bd,Nd(wd)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),s=b([]);return qd(n,Oa.init,c,s,function(){return D.some(o)})},Wd=Ud(wn("cyclic",x)),$d=Ud(wn("cyclic",C)),Xd=function(e,t,n){return rd(n)&&Nd(_d)(t.event)?D.none():(ao(e,n,Br()),D.some(!0))},Gd=function(){return D.some(!0)},Kd=[fn("execute",Xd),fn("useSpace",!1),fn("useEnter",!0),fn("useControlEnter",!1),fn("useDown",!1)],Yd=function(e,t,n){return n.execute(e,t,e.element)},Jd=qd(Kd,Oa.init,function(e,t,n){var r=n.useSpace&&!rd(e.element)?_d:[],o=n.useEnter?wd:[],a=n.useDown?zd:[],i=r.concat(o).concat(a);return[Md(Nd(i),Yd)].concat(n.useControlEnter?[Md(Ad([Pd,Nd(wd)]),Yd)]:[])},function(e,t,n){return n.useSpace&&!rd(e.element)?[Md(Nd(_d),Gd)]:[]},function(){return D.none()}),Zd=function(){var e=kn(D.none());return Da({readState:function(){return e.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(D.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(e){return e.numRows})},getNumColumns:function(){return e.get().map(function(e){return e.numColumns})}})},Qd=Object.freeze({__proto__:null,flatgrid:Zd,init:function(e){return e.state(e)}}),em=function(e){return function(t,n,r,o){var a=e(t.element);return om(a,t,n,r,o)}},tm=function(e,t){var n=$s(e,t);return em(n)},nm=function(e,t){var n=$s(t,e);return em(n)},rm=function(e){return function(t,n,r,o){return om(e,t,n,r,o)}},om=function(e,t,n,r,o){return r.focusManager.get(t).bind(function(n){return e(t.element,n,r,o)}).map(function(e){return r.focusManager.set(t,e),!0})},am=rm,im=rm,cm=rm,sm=function(e){return!((t=e.dom).offsetWidth<=0&&t.offsetHeight<=0);var t},lm=function(e,t,n){var r,o=Al(e,n),a=Q(o,sm);return re(r=a,function(e){return tr(e,t)}).map(function(e){return{index:e,candidates:r}})},um=function(e,t){return re(e,function(e){return tr(t,e)})},fm=function(e,t,n,r){return r(Math.floor(t/n),t%n).bind(function(t){var r=t.row*n+t.column;return r>=0&&r<e.length?D.some(e[r]):D.none()})},dm=function(e,t,n,r,o){return fm(e,t,r,function(t,a){var i=t===n-1?e.length-t*r:r,c=Ns(a,o,0,i-1);return D.some({row:t,column:c})})},mm=function(e,t,n,r,o){return fm(e,t,r,function(t,a){var i=Ns(t,o,0,n-1),c=i===n-1?e.length-i*r:r,s=As(a,0,c-1);return D.some({row:i,column:s})})},gm=[Yt("selector"),fn("execute",Xd),kc("onEscape"),fn("captureTab",!1),zc()],hm=function(e,t){tc(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},pm=function(e){return function(t,n,r,o){return lm(t,n,r.selector).bind(function(t){return e(t.candidates,t.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},vm=function(e,t,n){return n.captureTab?D.some(!0):D.none()},ym=pm(function(e,t,n,r){return dm(e,t,n,r,-1)}),bm=pm(function(e,t,n,r){return dm(e,t,n,r,1)}),wm=pm(function(e,t,n,r){return mm(e,t,n,r,-1)}),km=pm(function(e,t,n,r){return mm(e,t,n,r,1)}),_m=b([Md(Nd(xd),tm(ym,bm)),Md(Nd(Sd),nm(ym,bm)),Md(Nd(Cd),am(wm)),Md(Nd(zd),im(km)),Md(Ad([Rd,Nd(bd)]),vm),Md(Ad([Bd,Nd(bd)]),vm),Md(Nd(kd),function(e,t,n){return n.onEscape(e,t)}),Md(Nd(_d.concat(wd)),function(e,t,n){return r=e,(o=n).focusManager.get(r).bind(function(e){return nc(e,o.selector)}).bind(function(r){return n.execute(e,t,r)});var r,o})]),xm=b([Md(Nd(_d),Gd)]),Cm=qd(gm,Zd,_m,xm,function(){return D.some(hm)}),Sm=function(e,t,n,r){var o=function(e,t,n){var a,i=Ns(t,r,0,n.length-1);return i===e?D.none():(a=n[i],"button"===xo(a)&&"disabled"===oa(a,"disabled")?o(e,i,n):D.from(n[i]))};return lm(e,n,t).bind(function(e){var t=e.index,n=e.candidates;return o(t,t,n)})},zm=[Yt("selector"),fn("getInitial",D.none),fn("execute",Xd),kc("onEscape"),fn("executeOnMove",!1),fn("allowVertical",!0)],Tm=function(e,t,n){return r=e,(o=n).focusManager.get(r).bind(function(e){return nc(e,o.selector)}).bind(function(r){return n.execute(e,t,r)});var r,o},Em=function(e,t){t.getInitial(e).orThunk(function(){return tc(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})},Om=function(e,t,n){return Sm(e,n.selector,t,-1)},Dm=function(e,t,n){return Sm(e,n.selector,t,1)},Nm=function(e){return function(t,n,r,o){return e(t,n,r,o).bind(function(){return r.executeOnMove?Tm(t,n,r):D.some(!0)})}},Am=function(e,t,n){return n.onEscape(e,t)},Rm=b([Md(Nd(_d),Gd)]),Pm=qd(zm,Oa.init,function(e,t,n){var r=xd.concat(n.allowVertical?Cd:[]),o=Sd.concat(n.allowVertical?zd:[]);return[Md(Nd(r),Nm(tm(Om,Dm))),Md(Nd(o),Nm(nm(Om,Dm))),Md(Nd(wd),Tm),Md(Nd(_d),Tm),Md(Nd(kd),Am)]},Rm,function(){return D.some(Em)}),Bm=function(e,t,n){return D.from(e[t]).bind(function(e){return D.from(e[n]).map(function(e){return{rowIndex:t,columnIndex:n,cell:e}})})},Mm=function(e,t,n,r){var o=e[t].length,a=Ns(n,r,0,o-1);return Bm(e,t,a)},Im=function(e,t,n,r){var o=Ns(n,r,0,e.length-1),a=e[o].length,i=As(t,0,a-1);return Bm(e,o,i)},Lm=function(e,t,n,r){var o=e[t].length,a=As(n+r,0,o-1);return Bm(e,t,a)},jm=function(e,t,n,r){var o=As(n+r,0,e.length-1),a=e[o].length,i=As(t,0,a-1);return Bm(e,o,i)},Fm=[tn("selectors",[Yt("row"),Yt("cell")]),fn("cycles",!0),fn("previousSelector",D.none),fn("execute",Xd)],Hm=function(e,t){t.previousSelector(e).orThunk(function(){var n=t.selectors;return tc(e.element,n.cell)}).each(function(n){t.focusManager.set(e,n)})},Vm=function(e,t){return function(n,r,o){var a=o.cycles?e:t;return nc(r,o.selectors.row).bind(function(e){var t=Al(e,o.selectors.cell);return um(t,r).bind(function(t){var r=Al(n,o.selectors.row);return um(r,e).bind(function(e){var n,i=(n=o,Y(r,function(e){return Al(e,n.selectors.cell)}));return a(i,e,t).map(function(e){return e.cell})})})})}},qm=Vm(function(e,t,n){return Mm(e,t,n,-1)},function(e,t,n){return Lm(e,t,n,-1)}),Um=Vm(function(e,t,n){return Mm(e,t,n,1)},function(e,t,n){return Lm(e,t,n,1)}),Wm=Vm(function(e,t,n){return Im(e,n,t,-1)},function(e,t,n){return jm(e,n,t,-1)}),$m=Vm(function(e,t,n){return Im(e,n,t,1)},function(e,t,n){return jm(e,n,t,1)}),Xm=b([Md(Nd(xd),tm(qm,Um)),Md(Nd(Sd),nm(qm,Um)),Md(Nd(Cd),am(Wm)),Md(Nd(zd),im($m)),Md(Nd(_d.concat(wd)),function(e,t,n){return ks(e.element).bind(function(r){return n.execute(e,t,r)})})]),Gm=b([Md(Nd(_d),Gd)]),Km=qd(Fm,Oa.init,Xm,Gm,function(){return D.some(Hm)}),Ym=[Yt("selector"),fn("execute",Xd),fn("moveOnTab",!1)],Jm=function(e,t,n){return n.focusManager.get(e).bind(function(r){return n.execute(e,t,r)})},Zm=function(e,t){tc(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},Qm=function(e,t,n){return Sm(e,n.selector,t,-1)},eg=function(e,t,n){return Sm(e,n.selector,t,1)},tg=b([Md(Nd(Cd),cm(Qm)),Md(Nd(zd),cm(eg)),Md(Ad([Rd,Nd(bd)]),function(e,t,n,r){return n.moveOnTab?cm(Qm)(e,t,n,r):D.none()}),Md(Ad([Bd,Nd(bd)]),function(e,t,n,r){return n.moveOnTab?cm(eg)(e,t,n,r):D.none()}),Md(Nd(wd),Jm),Md(Nd(_d),Jm)]),ng=b([Md(Nd(_d),Gd)]),rg=qd(Ym,Oa.init,tg,ng,function(){return D.some(Zm)}),og=[kc("onSpace"),kc("onEnter"),kc("onShiftEnter"),kc("onLeft"),kc("onRight"),kc("onTab"),kc("onShiftTab"),kc("onUp"),kc("onDown"),kc("onEscape"),fn("stopSpaceKeyup",!1),on("focusIn")],ag=qd(og,Oa.init,function(e,t,n){return[Md(Nd(_d),n.onSpace),Md(Ad([Bd,Nd(wd)]),n.onEnter),Md(Ad([Rd,Nd(wd)]),n.onShiftEnter),Md(Ad([Rd,Nd(bd)]),n.onShiftTab),Md(Ad([Bd,Nd(bd)]),n.onTab),Md(Nd(Cd),n.onUp),Md(Nd(zd),n.onDown),Md(Nd(xd),n.onLeft),Md(Nd(Sd),n.onRight),Md(Nd(_d),n.onSpace),Md(Nd(kd),n.onEscape)]},function(e,t,n){return n.stopSpaceKeyup?[Md(Nd(_d),Gd)]:[]},function(e){return e.focusIn}),ig=Wd.schema(),cg=$d.schema(),sg=Pm.schema(),lg=Cm.schema(),ug=Km.schema(),fg=Jd.schema(),dg=rg.schema(),mg=ag.schema(),gg=hs({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ig,cyclic:cg,flow:sg,flatgrid:lg,matrix:ug,execution:fg,menu:dg,special:mg}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(e,t,n){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(r){r(e,t,n)})},setGridSize:function(e,t,n,r,o){We(n,"setGridSize")?n.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:Qd}),hg=function(e,t,n,r){var o=e.getSystem().build(r);du(e,o,n)},pg=function(e,t,n,r){var o=vg(e);ne(o,function(e){return tr(r.element,e.element)}).each(gu)},vg=function(e){return e.components()},yg=function(e,t,n,r,o){var a=vg(e);return D.from(a[r]).map(function(t){return pg(e,0,0,t),o.each(function(t){hg(e,0,function(e,t){var n,o;o=t,Io(n=e,r).fold(function(){Ko(n,o)},function(e){$o(e,o)})},t)}),t})},bg=ms({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,r){hg(e,0,Ko,r)},prepend:function(e,t,n,r){hg(e,0,Go,r)},remove:pg,replaceAt:yg,replaceBy:function(e,t,n,r,o){var a=vg(e);return re(a,r).bind(function(t){return yg(e,0,0,t,o)})},set:function(e,t,n,r){_s(function(){var t=Y(r,e.getSystem().build);uu(e,t)},e.element)},contents:vg})}),wg=function(e,t){var n,r;return{key:e,value:{config:{},me:(n=e,r=so(t),ms({fields:[Yt("enabled")],name:n,active:{events:b(r)}})),configAsRaw:b({}),initialConfig:{},state:Oa}}},kg=function(e,t){t.ignore||(bs(e.element),t.onFocus(e))},_g=Object.freeze({__proto__:null,focus:kg,blur:function(e,t){t.ignore||e.element.dom.blur()},isFocused:function(e){return t=e.element,n=Ho(t).dom,t.dom===n.activeElement;var t,n}}),xg=Object.freeze({__proto__:null,exhibit:function(e,t){var n=t.ignore?{}:{attributes:{tabindex:"-1"}};return Aa(n)},events:function(e){return so([fo(Nr(),function(t,n){kg(t,e),n.stop()})].concat(e.stopMousedown?[fo(hr(),function(e,t){t.event.prevent()})]:[]))}}),Cg=[wc("onFocus"),fn("stopMousedown",!1),fn("ignore",!1)],Sg=ms({fields:Cg,name:"focusing",active:xg,apis:_g}),zg=function(e,t,n){var r=t.aria;r.update(e,r,n.get())},Tg=function(e,t,n){t.toggleClass.each(function(t){(n.get()?Wa:Xa)(e.element,t)})},Eg=function(e,t,n){Ng(e,t,n,!n.get())},Og=function(e,t,n){n.set(!0),Tg(e,t,n),zg(e,t,n)},Dg=function(e,t,n){n.set(!1),Tg(e,t,n),zg(e,t,n)},Ng=function(e,t,n,r){(r?Og:Dg)(e,t,n)},Ag=function(e,t,n){Ng(e,t,n,t.selected)},Rg=Object.freeze({__proto__:null,onLoad:Ag,toggle:Eg,isOn:function(e,t,n){return n.get()},on:Og,off:Dg,set:Ng}),Pg=Object.freeze({__proto__:null,exhibit:function(){return Aa({})},events:function(e,t){var n,r,o,a=(n=e,r=t,o=Eg,_o(function(e){o(e,n,r)})),i=is(e,t,Ag);return so(oe([e.toggleOnExecute?[a]:[],[i]]))}}),Bg=function(e,t,n){ra(e.element,"aria-expanded",n)},Mg=[fn("selected",!1),on("toggleClass"),fn("toggleOnExecute",!0),dn("aria",{mode:"none"},Ft("mode",{pressed:[fn("syncWithExpanded",!1),Cc("update",function(e,t,n){ra(e.element,"aria-pressed",n),t.syncWithExpanded&&Bg(e,t,n)})],checked:[Cc("update",function(e,t,n){ra(e.element,"aria-checked",n)})],expanded:[Cc("update",Bg)],selected:[Cc("update",function(e,t,n){ra(e.element,"aria-selected",n)})],none:[Cc("update",v)]}))],Ig=ms({fields:Mg,name:"toggling",active:Pg,apis:Rg,state:(Fd=!1,{init:function(){var e=kn(Fd);return{get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(Fd)},readState:function(){return e.get()}}}})}),Lg=function(){var e=function(e,t){t.stop(),oo(e)};return[fo(zr(),e),fo(Ir(),e),vo(fr()),vo(hr())]},jg=function(e){return so(oe([e.map(function(e){return _o(function(t,n){e(t),n.stop()})}).toArray(),Lg()]))},Fg="alloy.item-hover",Hg="alloy.item-focus",Vg=function(e){(ks(e.element).isNone()||Sg.isFocused(e))&&(Sg.isFocused(e)||Sg.focus(e),ro(e,Fg,{item:e}))},qg=function(e){ro(e,Hg,{item:e})},Ug=b(Fg),Wg=b(Hg),$g=[Yt("data"),Yt("components"),Yt("dom"),fn("hasSubmenu",!1),on("toggling"),Zu("itemBehaviours",[Ig,Sg,gg,Gu]),fn("ignoreFocus",!1),fn("domModification",{}),Cc("builder",function(e){return{dom:e.dom,domModification:z(z({},e.domModification),{attributes:z(z(z({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Qu(e.itemBehaviours,[e.toggling.fold(Ig.revoke,function(e){return Ig.config(z({aria:{mode:"checked"
}},e))}),Sg.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){qg(e)}}),gg.config({mode:"execution"}),Gu.config({store:{mode:"memory",initialValue:e.data}}),wg("item-type-events",n(Lg(),[fo(br(),Vg),fo(Mr(),Sg.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),fn("eventOrder",{})],Xg=[Yt("dom"),Yt("components"),Cc("builder",function(e){return{dom:e.dom,components:e.components,events:so([(t=Mr(),fo(t,function(e,t){t.stop()}))])};var t})],Gg=b("item-widget"),Kg=b([Sf({name:"widget",overrides:function(e){return{behaviours:fs([Gu.config({store:{mode:"manual",getValue:function(){return e.data},setValue:v}})])}}})]),Yg=[Yt("uid"),Yt("data"),Yt("components"),Yt("dom"),fn("autofocus",!1),fn("ignoreFocus",!1),Zu("widgetBehaviours",[Gu,Sg,gg]),fn("domModification",{}),$f(Kg()),Cc("builder",function(e){var t=If(Gg(),e,Kg()),n=Lf(Gg(),e,t.internals()),r=function(t){return jf(t,e,"widget").map(function(e){return gg.focusIn(e),e})},o=function(t,n){return rd(n.event.target)||e.autofocus&&n.setSource(t.element),D.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:so([_o(function(e,t){r(e).each(function(){t.stop()})}),fo(br(),Vg),fo(Mr(),function(t){e.autofocus?r(t):Sg.focus(t)})]),behaviours:Qu(e.widgetBehaviours,[Gu.config({store:{mode:"memory",initialValue:e.data}}),Sg.config({ignore:e.ignoreFocus,onFocus:function(e){qg(e)}}),gg.config({mode:"special",focusIn:e.autofocus?function(e){r(e)}:ps(),onLeft:o,onRight:o,onEscape:function(t,n){return Sg.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),D.none()):(Sg.focus(t),D.some(!0))}})])}})],Jg=Ft("type",{widget:Yg,item:$g,separator:Xg}),Zg=b([Ef({factory:{sketch:function(e){var t=It("menu.spec item",Jg,e);return t.builder(t)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:z(z({},t),{uid:wa("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),Qg=b([Yt("value"),Yt("items"),Yt("dom"),Yt("components"),fn("eventOrder",{}),Ku("menuBehaviours",[vd,Gu,id,gg]),dn("movement",{mode:"menu",moveOnTab:!0},Ft("mode",{grid:[zc(),Cc("config",function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}})],matrix:[Cc("config",function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),Yt("rowSelector")],menu:[fn("moveOnTab",!0),Cc("config",function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}})]})),Jt("markers",hc()),fn("fakeFocus",!1),fn("focusManager",Ld()),wc("onHighlight")]),eh=b("alloy.menu-focus"),th=ed({name:"Menu",configFields:Qg(),partFields:Zg(),factory:function(e,t){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Ju(e.menuBehaviours,[vd.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),Gu.config({store:{mode:"memory",initialValue:e.value}}),id.config({find:D.some}),gg.config(e.movement.config(e,e.movement))]),events:so([fo(Wg(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){vd.highlight(e,n),t.stop(),ro(e,eh(),{menu:e,item:n})})}),fo(Ug(),function(e,t){var n=t.event.item;vd.highlight(e,n)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),nh=function(e,t,n,r){return qe(n,r).bind(function(r){return qe(e,r).bind(function(r){var o=nh(e,t,n,r);return D.some([r].concat(o))})}).getOr([])},rh=function(e,t){var n={};Me(e,function(e,t){J(e,function(e){n[e]=t})});var r=t,o=Le(t,function(e,t){return{k:e,v:t}}),a=Ie(o,function(e,t){return[t].concat(nh(n,r,o,t))});return Ie(n,function(e){return qe(a,e).getOr([e])})},oh=function(e){return"prepared"===e.type?D.some(e.menu):D.none()},ah={init:function(){var e=kn({}),t=kn({}),n=kn({}),r=kn(D.none()),o=kn({}),a=function(t,n,r){return i(t).bind(function(o){return a=t,He(e.get(),function(e){return e===a}).bind(function(e){return n(e).map(function(e){return{triggeredMenu:o,triggeringItem:e,triggeringPath:r}})});var a})},i=function(e){return c(e).bind(oh)},c=function(e){return qe(t.get(),e)},s=function(t){return qe(e.get(),t)};return{setMenuBuilt:function(e,n){var r;t.set(z(z({},t.get()),((r={})[e]={type:"prepared",menu:n},r)))},setContents:function(a,i,c,s){r.set(D.some(a)),e.set(c),t.set(i),o.set(s);var l=rh(s,c);n.set(l)},expand:function(t){return qe(e.get(),t).map(function(e){var r=qe(n.get(),t).getOr([]);return[e].concat(r)})},refresh:function(e){return qe(n.get(),e)},collapse:function(e){return qe(n.get(),e).bind(function(e){return 1<e.length?D.some(e.slice(1)):D.none()})},lookupMenu:c,lookupItem:s,otherMenus:function(e){var t=o.get();return se(Pe(t),e)},getPrimary:function(){return r.get().bind(i)},getMenus:function(){return t.get()},clear:function(){e.set({}),t.set({}),n.set({}),r.set(D.none())},isClear:function(){return r.get().isNone()},getTriggeringPath:function(e,t){var o=Q(s(e).toArray(),function(e){return i(e).isSome()});return qe(n.get(),e).bind(function(e){var n=ce(o.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(!r.isSome())return D.none();t.push(r.getOrDie())}return D.some(t)}(ae(n,function(e,o){return a(e,t,n.slice(0,o+1)).fold(function(){return r.get().is(e)?[]:[D.none()]},function(e){return[D.some(e)]})}))})}}},extractPreparedMenu:oh},ih=b("collapse-item"),ch=Qf({name:"TieredMenu",configFields:[xc("onExecute"),xc("onEscape"),_c("onOpenMenu"),_c("onOpenSubmenu"),wc("onRepositionMenu"),wc("onCollapseMenu"),fn("highlightImmediately",!0),tn("data",[Yt("primary"),Yt("menus"),Yt("expansions")]),fn("fakeFocus",!1),wc("onHighlight"),wc("onHover"),vc(),Yt("dom"),fn("navigateOnHover",!0),fn("stayInDom",!1),Ku("tmenuBehaviours",[gg,vd,id,bg]),fn("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(e){var t,n,r=kn(D.none()),o=ah.init(),a=function(t){var n,r,a,i=(n=t,r=e.data.primary,a=e.data.menus,Ie(a,function(t,o){var a=function(){return th.sketch(z(z({},t),{value:o,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:(e.fakeFocus?jd:Ld)()}))};return o===r?{type:"prepared",menu:n.getSystem().build(a())}:{type:"notbuilt",nbMenu:a}})),s=c();return o.setContents(e.data.primary,i,e.data.expansions,s),o.getPrimary()},i=function(e){return Gu.getValue(e).value},c=function(){return Ie(e.data.menus,function(e){return ae(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})})},s=function(e,t){vd.highlight(e,t),vd.getHighlighted(t).orThunk(function(){return vd.getFirst(t)}).each(function(t){ao(e,t.element,Mr())})},l=function(e,t){return td(Y(t,function(t){return e.lookupMenu(t).bind(function(e){return"prepared"===e.type?D.some(e.menu):D.none()})}))},u=function(t,n,r){var o=l(n,n.otherMenus(r));J(o,function(n){Ya(n.element,[e.markers.backgroundMenu]),e.stayInDom||bg.remove(t,n)})},f=function(t,n){var o,a=(o=t,r.get().getOrThunk(function(){var t={},n=Al(o.element,"."+e.markers.item),a=Q(n,function(e){return"true"===oa(e,"aria-haspopup")});return J(a,function(e){o.getSystem().getByDom(e).each(function(e){var n=i(e);t[n]=e})}),r.set(D.some(t)),t}));Me(a,function(e,t){var r=$(n,t);ra(e.element,"aria-expanded",r)})},d=function(t,n,r){return D.from(r[0]).bind(function(o){return n.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return D.none();var a=o.menu,i=l(n,r.slice(1));return J(i,function(t){Wa(t.element,e.markers.backgroundMenu)}),Za(a.element)||bg.append(t,Ci(a)),Ya(a.element,[e.markers.backgroundMenu]),s(t,a),u(t,n,r),D.some(a)})})};(n=t=t||{})[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent";var m=function(n,r,a){void 0===a&&(a=t.HighlightSubmenu);var c=i(r);return o.expand(c).bind(function(i){return f(n,i),D.from(i[0]).bind(function(c){return o.lookupMenu(c).bind(function(s){var l=function(e,t,n){if("notbuilt"!==n.type)return n.menu;var r=e.getSystem().build(n.nbMenu());return o.setMenuBuilt(t,r),r}(n,c,s);return Za(l.element)||bg.append(n,Ci(l)),e.onOpenSubmenu(n,r,l,ce(i)),a===t.HighlightSubmenu?(vd.highlightFirst(l),d(n,o,i)):(vd.dehighlightAll(l),D.some(r))})})})},g=function(t,n){var r=i(n);return o.collapse(r).bind(function(r){return f(t,r),d(t,o,r).map(function(r){return e.onCollapseMenu(t,n,r),r})})},h=function(t){return function(n,r){return nc(r.getSource(),"."+e.markers.item).bind(function(e){return n.getSystem().getByDom(e).toOptional().bind(function(e){return t(n,e).map(C)})})}},p=so([fo(eh(),function(e,t){var n=t.event.item;o.lookupItem(i(n)).each(function(){var n=t.event.menu;vd.highlight(e,n);var r=i(t.event.item);o.refresh(r).each(function(t){return u(e,o,t)})})}),_o(function(n,r){var o=r.event.target;n.getSystem().getByDom(o).each(function(r){0===i(r).indexOf("collapse-item")&&g(n,r),m(n,r,t.HighlightSubmenu).fold(function(){e.onExecute(n,r)},v)})}),bo(function(t){a(t).each(function(n){bg.append(t,Ci(n)),e.onOpenMenu(t,n),e.highlightImmediately&&s(t,n)})})].concat(e.navigateOnHover?[fo(Ug(),function(n,r){var a,c,s=r.event.item;a=n,c=i(s),o.refresh(c).bind(function(e){return f(a,e),d(a,o,e)}),m(n,s,t.HighlightParent),e.onHover(n,s)})]:[])),y=function(e){return vd.getHighlighted(e).bind(vd.getHighlighted)},b={collapseMenu:function(e){y(e).each(function(t){g(e,t)})},highlightPrimary:function(e){o.getPrimary().each(function(t){s(e,t)})},repositionMenus:function(t){o.getPrimary().bind(function(e){return y(t).bind(function(e){var t=i(e),n=Ve(o.getMenus()),r=td(Y(n,ah.extractPreparedMenu));return o.getTriggeringPath(t,function(e){return t=e,ge(r,function(e){if(!e.getSystem().isConnected())return D.none();var n=vd.getCandidates(e);return ne(n,function(e){return i(e)===t})});var t})}).map(function(t){return{primary:e,triggeringPath:t}})}).fold(function(){var n;n=t,D.from(n.components()[0]).filter(function(e){return"menu"===oa(e.element,"role")}).each(function(n){e.onRepositionMenu(t,n,[])})},function(n){var r=n.primary,o=n.triggeringPath;e.onRepositionMenu(t,r,o)})}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Ju(e.tmenuBehaviours,[gg.config({mode:"special",onRight:h(function(e,n){return rd(n.element)?D.none():m(e,n,t.HighlightSubmenu)}),onLeft:h(function(e,t){return rd(t.element)?D.none():g(e,t)}),onEscape:h(function(t,n){return g(t,n).orThunk(function(){return e.onEscape(t,n).map(function(){return t})})}),focusIn:function(e){o.getPrimary().each(function(t){ao(e,t.element,Mr())})}}),vd.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),id.config({find:function(e){return vd.getHighlighted(e)}}),bg.config({})]),eventOrder:e.eventOrder,apis:b,events:p}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:it(e,t),expansions:{}}},collapseItem:function(e){return{value:ma(ih()),meta:{text:e}}}}}),sh=Qf({name:"InlineView",configFields:[Yt("lazySink"),wc("onShow"),wc("onHide"),ln("onEscape"),Ku("inlineBehaviours",[Eu,Gu,vs]),un("fireDismissalEventInstead",[fn("event",Gr())]),un("fireRepositionEventInstead",[fn("event",Kr())]),fn("getRelated",D.none),fn("isExtraPart",x),fn("eventOrder",D.none)],factory:function(e,t){var n=function(e,t,n,o){r(e,t,n,function(){return o.map(Gi)})},r=function(t,n,r,o){var a=e.lazySink(t).getOrDie();Eu.openWhileCloaked(t,r,function(){return iu.positionWithinBounds(a,n,t,o())}),Gu.setValue(t,D.some({mode:"position",anchor:n,getBounds:o}))},o=function(t,n,r,o){var a,i,c,s,l,u,f,d,m=(a=e,i=t,c=n,l=o,u=function(){return a.lazySink(i)},f="horizontal"===(s=r).type?{layouts:{onLtr:ns,onRtl:rs}}:{},d=function(e){return 2===e.length?f:{}},ch.sketch({dom:{tag:"div"},data:s.data,markers:s.menu.markers,highlightImmediately:s.menu.highlightImmediately,onEscape:function(){return Eu.close(i),a.onEscape.map(function(e){return e(i)}),D.some(!0)},onExecute:function(){return D.some(!0)},onOpenMenu:function(e,t){iu.positionWithinBounds(u().getOrDie(),c,t,l())},onOpenSubmenu:function(e,t,n,r){var o=u().getOrDie();iu.position(o,z({anchor:"submenu",item:t},d(r)),n)},onRepositionMenu:function(e,t,n){var r=u().getOrDie();iu.positionWithinBounds(r,c,t,l()),J(n,function(e){var t=d(e.triggeringPath);iu.position(r,z({anchor:"submenu",item:e.triggeringItem},t),e.triggeredMenu)})}}));Eu.open(t,m),Gu.setValue(t,D.some({mode:"menu",menu:m}))},a=function(t){Eu.isOpen(t)&&Gu.getValue(t).each(function(n){switch(n.mode){case"menu":Eu.getState(t).each(function(e){ch.repositionMenus(e)});break;case"position":var r=e.lazySink(t).getOrDie();iu.positionWithinBounds(r,n.anchor,t,n.getBounds())}})},i={setContent:function(e,t){Eu.setContent(e,t)},showAt:function(e,t,r){n(e,t,r,D.none())},showWithin:n,showWithinBounds:r,showMenuAt:function(e,t,n){o(e,t,n,function(){return D.none()})},showMenuWithinBounds:o,hide:function(e){Eu.isOpen(e)&&(Gu.setValue(e,D.none()),Eu.close(e))},getContent:function(e){return Eu.getState(e)},reposition:a,isOpen:Eu.isOpen};return{uid:e.uid,dom:e.dom,behaviours:Ju(e.inlineBehaviours,[Eu.config({isPartOf:function(t,n,r){return ac(n,r)||(o=t,a=r,e.getRelated(o).exists(function(e){return ac(e,a)}));var o,a},getAttachPoint:function(t){return e.lazySink(t).getOrDie()},onOpen:function(t){e.onShow(t)},onClose:function(t){e.onHide(t)}}),Gu.config({store:{mode:"memory",initialValue:D.none()}}),vs.config({channels:z(z({},Ru(z({isExtraPart:t.isExtraPart},e.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),Bu(z(z({},e.fireRepositionEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})),{doReposition:a})))})]),eventOrder:e.eventOrder,apis:i}},apis:{showAt:function(e,t,n,r){e.showAt(t,n,r)},showWithin:function(e,t,n,r,o){e.showWithin(t,n,r,o)},showWithinBounds:function(e,t,n,r,o){e.showWithinBounds(t,n,r,o)},showMenuAt:function(e,t,n,r){e.showMenuAt(t,n,r)},showMenuWithinBounds:function(e,t,n,r,o){e.showMenuWithinBounds(t,n,r,o)},hide:function(e,t){e.hide(t)},isOpen:function(e,t){return e.isOpen(t)},getContent:function(e,t){return e.getContent(t)},setContent:function(e,t,n){e.setContent(t,n)},reposition:function(e,t){e.reposition(t)}}}),lh=function(e){return e.x},uh=function(e,t){return e.x+e.width/2-t.width/2},fh=function(e,t){return e.x+e.width-t.width},dh=function(e){return e.y},mh=function(e,t){return e.y+e.height-t.height},gh=function(e,t,n){return Tc(fh(e,t),mh(e,t),n.innerSoutheast(),Ac(),Ic(e,{right:0,bottom:3}),"layout-inner-se")},hh=function(e,t,n){return Tc(lh(e),mh(e,t),n.innerSouthwest(),Nc(),Ic(e,{left:1,bottom:3}),"layout-inner-sw")},ph=function(e,t,n){return Tc(fh(e,t),dh(e),n.innerNortheast(),Dc(),Ic(e,{right:0,top:2}),"layout-inner-ne")},vh=function(e,t,n){return Tc(lh(e),dh(e),n.innerNorthwest(),Oc(),Ic(e,{left:1,top:2}),"layout-inner-nw")},yh=function(e,t,n){return Tc(uh(e,t),dh(e),n.innerNorth(),Rc(),Ic(e,{top:2}),"layout-inner-n")},bh=function(e,t,n){return Tc(uh(e,t),mh(e,t),n.innerSouth(),Pc(),Ic(e,{bottom:3}),"layout-inner-s")},wh=tinymce.util.Tools.resolve("tinymce.util.Delay"),kh=Qf({name:"Button",factory:function(e){var t=jg(e.action),n=e.dom.tag,r=function(t){return qe(e.dom,"attributes").bind(function(e){return qe(e,t)})};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Qu(e.buttonBehaviours,[Sg.config({}),gg.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==n)return{role:r("role").getOr("button")};var e=r("type").getOr("button"),t=r("role").map(function(e){return{role:e}}).getOr({});return z({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[fn("uid",void 0),Yt("dom"),fn("components",[]),Zu("buttonBehaviours",[Sg,gg]),on("action"),on("role"),fn("eventOrder",{})]}),_h=function(e){var t=void 0!==e.uid&&We(e,"uid")?e.uid:wa("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOptional()},asSpec:function(){return z(z({},e),{uid:t})}}},xh=function(e){return D.from(e()["temporary-placeholder"]).getOr("!not found!")},Ch=function(e,t){return D.from(t()[e.toLowerCase()]).getOrThunk(function(){return xh(t)})},Sh={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},zh=Qf({name:"Notification",factory:function(e){var t,n,r=_h({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:fs([bg.config({})])}),o=function(e){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+e+"%"}}}},a=function(e){return{dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}},i=_h({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},a(0)],behaviours:fs([bg.config({})])}),c={updateProgress:function(e,t){e.getSystem().isConnected()&&i.getOpt(e).each(function(e){bg.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(t)]},a(t)])})},updateText:function(e,t){var n;e.getSystem().isConnected()&&(n=r.get(e),bg.set(n,[wi(t)]))}},s=oe([e.icon.toArray(),e.level.toArray(),e.level.bind(function(e){return D.from(Sh[e])}).toArray()]),l=_h(kh.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Ch("close",e.iconProvider),attributes:{"aria-label":e.translationProvider("Close")}}}],action:function(t){e.onAction(t)}})),u=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(t=s,n=e.iconProvider,ge(t,function(e){return D.from(n()[e.toLowerCase()])}).getOrThunk(function(){return xh(n)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[r.asSpec()],behaviours:fs([bg.config({})])}];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(function(e){return["tox-notification","tox-notification--in","tox-notification--"+e]}).getOr(["tox-notification","tox-notification--in"])},behaviours:fs([Sg.config({}),wg("notification-events",[fo(wr(),function(e){l.getOpt(e).each(Sg.focus)})])]),components:u.concat(e.progress?[i.asSpec()]:[]).concat(e.closeButton?[l.asSpec()]:[]),apis:c}},configFields:[on("level"),Yt("progress"),Yt("icon"),Yt("onAction"),Yt("text"),Yt("iconProvider"),Yt("translationProvider"),pn("closeButton",!0)],apis:{updateProgress:function(e,t,n){e.updateProgress(t,n)},updateText:function(e,t,n){e.updateText(t,n)}}}),Th=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}},Eh=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Oh=function(e,t,n,r,o){var a=Eh(e,function(t){return r=t,(n=e).isBlock(r)||$(["BR","IMG","HR","INPUT"],r.nodeName)||"false"===n.getContentEditable(r);var n,r});return D.from(a.backwards(t,n,r,o))},Dh=function(e,t){return Nh(xn.fromDom(e.selection.getNode())).getOrThunk(function(){var n=xn.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Ko(n,xn.fromDom(t.extractContents())),t.insertNode(n.dom),Ro(n).each(function(e){return e.dom.normalize()}),Nl(n,Dl).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===xo(n=t)?1:El(n).fold(function(){return Mo(n).length},function(e){return e.length}))}),n})},Nh=function(e){return nc(e,"[data-mce-autocompleter]")},Ah=function(e){return e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Rh=function(e){return""!==e&&-1!==" \xa0\f\n\r	\x0B".indexOf(e)},Ph=function(e,t){return e.substring(t.length)},Bh=function(e,t,n,r){if(void 0===r&&(r=0),!(o=t).collapsed||3!==o.startContainer.nodeType)return D.none();var o,a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Oh(e,t.startContainer,t.startOffset,function(e,t,r){return function(e,t,n){for(var r=t-1;r>=0;r--){var o=e.charAt(r);if(Rh(o))return D.none();if(o===n)break}return D.some(r)}(r,t,n).getOr(t)},a).bind(function(e){var o=t.cloneRange();if(o.setStart(e.container,e.offset),o.setEnd(t.endContainer,t.endOffset),o.collapsed)return D.none();var a=Ah(o);return 0!==a.lastIndexOf(n)||Ph(a,n).length<r?D.none():D.some({text:Ph(a,n),range:o,triggerChar:n})})},Mh=function(e,t,n,r){return void 0===r&&(r=0),Nh(xn.fromDom(t.startContainer)).fold(function(){return Bh(e,t,n,r)},function(t){var r=e.createRng();r.selectNode(t.dom);var o=Ah(r);return D.some({range:r,text:Ph(o,n),triggerChar:n})})},Ih=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var n=function(e,t){ro(e,_r(),{raw:t})};t.on("keydown",function(t){var r=function(){return e.getView().bind(vd.getHighlighted)};8===t.which&&e.onKeypress.throttle(t),e.isActive()&&(27===t.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===t.which?(r().each(oo),t.preventDefault()):40===t.which?(r().fold(function(){e.getView().each(vd.highlightFirst)},function(e){n(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||r().each(function(e){n(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==t.which&&38!==t.which&&40!==t.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&Nh(xn.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},Lh=tinymce.util.Tools.resolve("tinymce.util.Promise"),jh=function(e,t){return{container:e,offset:t}},Fh=function(e){if(3===e.nodeType)return jh(e,e.data.length);var t=e.childNodes;return 0<t.length?Fh(t[t.length-1]):jh(e,t.length)},Hh=function(e,t){var n=e.childNodes;return 0<n.length&&t<n.length?Hh(n[t],0):0<n.length&&1===e.nodeType&&n.length===t?Fh(n[n.length-1]):jh(e,t)},Vh=function(e){return function(t){var n,r,o=Hh(t.startContainer,t.startOffset);return!Oh(n=e,(r=o).container,r.offset,function(e,t){return 0===t?-1:t},n.getRoot()).filter(function(e){var t=e.container.data.charAt(e.offset-1);return!Rh(t)}).isSome()}},qh=function(e,t){var n,r,o=t(),a=e.selection.getRng();return n=e.dom,r=a,ge(o.triggerChars,function(e){return Mh(n,r,e)}).bind(function(n){return Uh(e,t,n)})},Uh=function(e,t,n,r){void 0===r&&(r={});var o=t(),a=e.selection.getRng().startContainer.nodeValue,i=Q(o.lookupByChar(n.triggerChar),function(t){return n.text.length>=t.minChars&&t.matches.getOrThunk(function(){return Vh(e.dom)})(n.range,a,n.text)});if(0===i.length)return D.none();var c=Lh.all(Y(i,function(e){return e.fetch(n.text,e.maxResults,r).then(function(t){return{matchText:n.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}})}));return D.some({lookupData:c,context:n})},Wh=wt([Zt("type"),sn("text")]),$h=wt([fn("type","autocompleteitem"),fn("active",!1),fn("disabled",!1),fn("meta",{}),Zt("value"),sn("text"),sn("icon")]),Xh=wt([Zt("type"),Zt("ch"),mn("minChars",1),fn("columns",1),mn("maxResults",10),ln("matches"),en("fetch"),en("onAction"),yn("highlightOn",[],Ut)]),Gh=[pn("disabled",!1),sn("tooltip"),sn("icon"),sn("text"),vn("onSetup",function(){return v})],Kh=wt([Zt("type"),en("onAction")].concat(Gh)),Yh=function(e){return Bt("toolbarbutton",Kh,e)},Jh=[pn("active",!1)].concat(Gh),Zh=wt(Jh.concat([Zt("type"),en("onAction")])),Qh=function(e){return Bt("ToggleButton",Zh,e)},ep=[vn("predicate",x),hn("scope","node",["node","editor"]),hn("position","selection",["node","selection","line"])],tp=Gh.concat([fn("type","contextformbutton"),fn("primary",!1),en("onAction"),wn("original",w)]),np=Jh.concat([fn("type","contextformbutton"),fn("primary",!1),en("onAction"),wn("original",w)]),rp=Gh.concat([fn("type","contextformbutton")]),op=Jh.concat([fn("type","contextformtogglebutton")]),ap=Ft("type",{contextformbutton:tp,contextformtogglebutton:np}),ip=wt([fn("type","contextform"),vn("initValue",function(){return""}),sn("label"),rn("commands",ap),an("launch",Ft("type",{contextformbutton:rp,contextformtogglebutton:op}))].concat(ep)),cp=wt([fn("type","contexttoolbar"),Zt("items")].concat(ep)),sp=function(e){var t,n,r=e.ui.registry.getAll().popups,o=Ie(r,function(e){return Bt("Autocompleter",Xh,e).fold(function(e){throw new Error(Lt(e))},function(e){return e})}),a=(t=Fe(o,function(e){return e.ch}),n={},J(t,function(e){n[e]={}}),Pe(n)),i=Ve(o);return{dataset:o,triggerChars:a,lookupByChar:function(e){return Q(i,function(t){return t.ch===e})}}};(Vd=Hd=Hd||{})[Vd.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Vd[Vd.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var lp,up,fp=Hd,dp="tox-menu-nav__js",mp="tox-collection__item",gp="tox-swatch",hp={normal:dp,color:gp},pp="tox-collection__item--enabled",vp="tox-collection__item-label",yp="tox-collection__item-caret",bp="tox-collection__item--active",wp="tox-collection__item-container",kp="tox-collection__item-container--row",_p=function(e){return qe(hp,e).getOr(dp)},xp=function(e){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===e?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Cp=function(e){var t=xp(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:_p(e)}},Sp=[th.parts.items({})],zp=function(e,t,n){var r=xp(n);return{dom:{tag:"div",classes:oe([[r.tieredMenu]])},markers:Cp(n)}},Tp=function(e,t){return function(n){var r=K(n,t);return Y(r,function(t){return{dom:e,components:t}})}},Ep=function(e,t){var n=[],r=[];return J(e,function(e,o){t(e,o)?(0<r.length&&n.push(r),r=[],Ue(e.dom,"innerHtml")&&r.push(e)):r.push(e)}),0<r.length&&n.push(r),Y(n,function(e){return{dom:{tag:"div",classes:["tox-collection__group"]},components:e}})},Op=function(e,t){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[th.parts.items({preprocess:function(n){return"auto"!==e&&e>1?Tp({tag:"div",classes:["tox-collection__group"]},e)(n):Ep(n,function(e,n){return"separator"===t[n].type})}})]}},Dp=function(e){return X(e,function(e){return"icon"in e&&void 0!==e.icon})},Np=function(e){return console.error(Lt(e)),console.log(e),D.none()},Ap=function(e,t,n){var r,o=(r=n,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[th.parts.items({preprocess:function(e){return Ep(e,function(e,t){return"separator"===r[t].type})}})]});return{value:e,dom:o.dom,components:o.components,items:n}},Rp=function(e,t,n,r,o){var a,i,c,s,l,u;return"color"===o?{value:e,dom:(a=r,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[th.parts.items({preprocess:"auto"!==a?Tp({tag:"div",classes:["tox-swatches__row"]},a):w})]}]}).dom,components:c.components,items:n}:"normal"===o&&"auto"===r?{value:e,dom:(c=Op(r,n)).dom,components:c.components,items:n}:"normal"===o&&1===r?{value:e,dom:(c=Op(1,n)).dom,components:c.components,items:n}:"normal"===o?{value:e,dom:(c=Op(r,n)).dom,components:c.components,items:n}:"listpreview"!==o||"auto"===r?{value:e,dom:(s=t,l=r,u=xp(o),{tag:"div",classes:oe([[u.menu,"tox-menu-"+l+"-column"],s?[u.hasIcons]:[]])}),components:Sp,items:n}:{value:e,dom:(i=r,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[th.parts.items({preprocess:Tp({tag:"div",classes:["tox-collection__group"]},i)})]}).dom,components:c.components,items:n}},Pp=[Zt("type"),Zt("src"),sn("alt"),yn("classes",[],Ut)],Bp=wt(Pp),Mp=[Zt("type"),Zt("text"),sn("name"),yn("classes",["tox-collection__item-label"],Ut)],Ip=wt(Mp),Lp=At(function(){return jt("type",{cardimage:Bp,cardtext:Ip,cardcontainer:jp})}),jp=wt([Zt("type"),gn("direction","horizontal"),gn("align","left"),gn("valign","middle"),rn("items",Lp)]),Fp=[pn("disabled",!1),sn("text"),sn("shortcut"),Tt("value","value",nt(function(){return ma("menuitem-value")}),Ht()),fn("meta",{})],Hp=wt([Zt("type"),sn("label"),rn("items",Lp),vn("onSetup",function(){return v}),vn("onAction",v)].concat(Fp)),Vp=wt([Zt("type"),pn("active",!1),sn("icon")].concat(Fp)),qp=wt([Zt("type"),Qt("fancytype",["inserttable","colorswatch"]),vn("onAction",v)]),Up=wt([Zt("type"),vn("onSetup",function(){return v}),vn("onAction",v),sn("icon")].concat(Fp)),Wp=wt([Zt("type"),en("getSubmenuItems"),vn("onSetup",function(){return v}),sn("icon")].concat(Fp)),$p=wt([Zt("type"),sn("icon"),pn("active",!1),vn("onSetup",function(){return v}),en("onAction")].concat(Fp)),Xp=function(e,t,n){var r=Al(e.element,"."+n);if(0<r.length){var o=re(r,function(e){var n=e.dom.getBoundingClientRect().top,o=r[0].dom.getBoundingClientRect().top;return Math.abs(n-o)>t}).getOr(r.length);return D.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return D.none()},Gp=function(e,t){return fs([wg(e,t)])},Kp=function(e){return Gp(ma("unnamed-events"),e)},Yp=ma("tooltip.exclusive"),Jp=ma("tooltip.show"),Zp=ma("tooltip.hide"),Qp=function(e){e.getSystem().broadcastOn([Yp],{})},ev=Object.freeze({__proto__:null,hideAllExclusive:Qp,setComponents:function(e,t,n,r){n.getTooltip().each(function(e){e.getSystem().isConnected()&&bg.set(e,r)})}}),tv=Object.freeze({__proto__:null,events:function(e,t){var n=function(n){t.getTooltip().each(function(r){gu(r),e.onHide(n,r),t.clearTooltip()}),t.clearTimer()};return so(oe([[fo(Jp,function(n){t.resetTimer(function(){var r,o,a;r=n,t.isShowing()||(Qp(r),o=e.lazySink(r).getOrDie(),a=r.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:so("normal"===e.mode?[fo(br(),function(){no(r,Jp)}),fo(vr(),function(){no(r,Zp)})]:[]),behaviours:fs([bg.config({})])}),t.setTooltip(a),fu(o,a),e.onShow(r,a),iu.position(o,e.anchor(r),a))},e.delay)}),fo(Zp,function(r){t.resetTimer(function(){n(r)},e.delay)}),fo(Pr(),function(e,t){t.universal||$(t.channels,Yp)&&n(e)}),wo(function(e){n(e)})],"normal"===e.mode?[fo(wr(),function(e){no(e,Jp)}),fo(Ar(),function(e){no(e,Zp)}),fo(br(),function(e){no(e,Jp)}),fo(vr(),function(e){no(e,Zp)})]:[fo(eo(),function(e){no(e,Jp)}),fo(to(),function(e){no(e,Zp)})]]))}}),nv=[Yt("lazySink"),Yt("tooltipDom"),fn("exclusive",!0),fn("tooltipComponents",[]),fn("delay",300),hn("mode","normal",["normal","follow-highlight"]),fn("anchor",function(e){return{anchor:"hotspot",hotspot:e,layouts:{onLtr:b([Kc,Gc,Uc,$c,Wc,Xc]),onRtl:b([Kc,Gc,Uc,$c,Wc,Xc])}}}),wc("onHide"),wc("onShow")],rv=ms({fields:nv,name:"tooltipping",active:tv,state:Object.freeze({__proto__:null,init:function(){var e=kn(D.none()),t=kn(D.none()),n=function(){e.get().each(function(e){clearTimeout(e)})},r=b("not-implemented");return Da({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(e){t.set(D.some(e))},clearTooltip:function(){t.set(D.none())},clearTimer:n,resetTimer:function(t,r){n(),e.set(D.some(setTimeout(function(){t()},r)))},readState:r})}}),apis:ev}),ov=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),av=tinymce.util.Tools.resolve("tinymce.util.I18n"),iv=["input","button","textarea","select"],cv=function(e,t){(t.disabled()?mv:gv)(e,t)},sv=function(e,t){return!0===t.useNative&&$(iv,xo(e.element))},lv=function(e){ra(e.element,"disabled","disabled")},uv=function(e){ca(e.element,"disabled")},fv=function(e){ra(e.element,"aria-disabled","true")},dv=function(e){ra(e.element,"aria-disabled","false")},mv=function(e,t){t.disableClass.each(function(t){Wa(e.element,t)}),(sv(e,t)?lv:fv)(e),t.onDisabled(e)},gv=function(e,t){t.disableClass.each(function(t){Xa(e.element,t)}),(sv(e,t)?uv:dv)(e),t.onEnabled(e)},hv=function(e,t){return sv(e,t)?ia(e.element,"disabled"):"true"===oa(e.element,"aria-disabled")},pv=Object.freeze({__proto__:null,enable:gv,disable:mv,isDisabled:hv,onLoad:cv,set:function(e,t,n,r){(r?mv:gv)(e,t)}}),vv=Object.freeze({__proto__:null,exhibit:function(e,t){return Aa({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(e,t){return so([lo(Br(),function(t){return hv(t,e)}),is(e,t,cv)])}}),yv=[vn("disabled",x),fn("useNative",!0),on("disableClass"),wc("onDisabled"),wc("onEnabled")],bv=ms({fields:yv,name:"disabling",active:vv,apis:pv}),wv=tinymce.util.Tools.resolve("tinymce.EditorManager"),kv=function(e){return e.getParam("height",Math.max(e.getElement().offsetHeight,200))},_v=function(e){return e.getParam("width",ov.DOM.getStyle(e.getElement(),"width"))},xv=function(e){return D.from(e.getParam("min_width")).filter(F)},Cv=function(e){return D.from(e.getParam("min_height")).filter(F)},Sv=function(e){return D.from(e.getParam("max_width")).filter(F)},zv=function(e){return D.from(e.getParam("max_height")).filter(F)},Tv=function(e){return!1!==e.getParam("menubar",!0,"boolean")},Ev=function(e){var t=e.getParam("toolbar",!0),n=!0===t,r=R(t),o=B(t)&&0<t.length;
return!Dv(e)&&(o||r||n)},Ov=function(e){var t=G(9,function(t){return e.getParam("toolbar"+(t+1),!1,"string")}),n=Q(t,function(e){return"string"==typeof e});return 0<n.length?D.some(n):D.none()},Dv=function(e){return Ov(e).fold(function(){return 0<e.getParam("toolbar",[],"string[]").length},C)};(up=lp=lp||{})["default"]="wrap",up.floating="floating",up.sliding="sliding",up.scrolling="scrolling";var Nv,Av,Rv=function(e){return e.getParam("toolbar_mode","","string")};(Av=Nv=Nv||{}).auto="auto",Av.top="top",Av.bottom="bottom";var Pv,Bv,Mv,Iv=function(e){return e.getParam("toolbar_location",Nv.auto,"string")},Lv=function(e){return Iv(e)===Nv.bottom},jv=function(e){var t=e.getParam("fixed_toolbar_container","","string");return 0<t.length&&e.inline?tc(Qa(),t):D.none()},Fv=function(e){return e.inline&&jv(e).isSome()},Hv=function(e){return jv(e).getOrThunk(function(){return Vo(Ho(xn.fromDom(e.getElement())))})},Vv=function(e){return e.inline&&!Tv(e)&&!Ev(e)&&!Dv(e)},qv=function(e){return(e.getParam("toolbar_sticky",!1,"boolean")||e.inline)&&!Fv(e)&&!Vv(e)},Uv="silver.readonly",Wv=wt([Jt("readonly",Wt)]),$v=function(e,t){var n=e.outerContainer.element;t&&(e.mothership.broadcastOn([Ou()],{target:n}),e.uiMothership.broadcastOn([Ou()],{target:n})),e.mothership.broadcastOn([Uv],{readonly:t}),e.uiMothership.broadcastOn([Uv],{readonly:t})},Xv=function(e,t){e.on("init",function(){e.mode.isReadOnly()&&$v(t,!0)}),e.on("SwitchMode",function(){return $v(t,e.mode.isReadOnly())}),e.getParam("readonly",!1,"boolean")&&e.setMode("readonly")},Gv=function(){var e;return vs.config({channels:((e={})[Uv]={schema:Wv,onReceive:function(e,t){bv.set(e,t.readonly)}},e)})},Kv=function(e){return bv.config({disabled:e,disableClass:"tox-collection__item--state-disabled"})},Yv=function(e){return bv.config({disabled:e})},Jv=function(e){return bv.config({disabled:e,disableClass:"tox-tbtn--disabled"})},Zv=function(e){return bv.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},Qv=function(e,t){var n=e.getApi(t);return function(e){e(n)}},ey=function(e,t){return bo(function(n){Qv(e,n)(function(n){var r=e.onSetup(n);j(r)&&t.set(r)})})},ty=function(e,t){return wo(function(n){return Qv(e,n)(t.get())})},ny=((Pv={})[Br()]=["disabling","alloy.base.behaviour","toggling","item-events"],Pv),ry=function(e){return ae(e,function(e){return e.toArray()})},oy=function(e,t,n,r){var o,a,i=kn(v);return{type:"item",dom:t.dom,components:ry(t.optComponents),data:e.data,eventOrder:ny,hasSubmenu:e.triggersSubmenu,itemBehaviours:fs([wg("item-events",[(o=e,a=n,_o(function(e,t){Qv(o,e)(o.onAction),o.triggersSubmenu||a!==fp.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&no(e,jr()),t.stop())})),ey(e,i),ty(e,i)]),Kv(function(){return e.disabled||r.isDisabled()}),Gv(),bg.config({})].concat(e.itemBehaviours))}},ay=function(e){return{value:e.value,meta:z({text:e.text.getOr("")},e.meta)}},iy=tinymce.util.Tools.resolve("tinymce.Env"),cy=function(e){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:e}}},sy=function(e){return{dom:{tag:"div",classes:[vp]},components:[wi(av.translate(e))]}},ly=function(e,t){return{dom:{tag:"div",classes:t,innerHtml:e}}},uy=function(e,t){return{dom:{tag:"div",classes:[vp]},components:[{dom:{tag:e.tag,styles:e.styles},components:[wi(av.translate(t))]}]}},fy=function(e){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(t=e,n=iy.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},r=t.split("+"),o=Y(r,function(e){var t=e.toLowerCase().trim();return Ue(n,t)?n[t]:e}),iy.mac?o.join(""):o.join("+"))}};var t,n,r,o},dy=function(e){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Ch("checkmark",e)}}},my=function(e,t){var n=t.map(function(e){return{attributes:{title:av.translate(e)}}}).getOr({});return z({tag:"div",classes:[dp,mp].concat(e?["tox-collection__item-icon-rtl"]:[])},n)},gy=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],hy=["list-bull-circle","list-bull-default","list-bull-square"],py=function(t,r,o,a){void 0===a&&(a=D.none());var i,c,s,l,u,f,d,m,g,h,p,v,y=av.isRtl()&&t.iconContent.exists(function(e){return $(hy,e)}),b=t.iconContent.map(function(e){return av.isRtl()&&$(gy,e)?e+"-rtl":e}).map(function(e){return t=e,n=r.icons,o=a,D.from(n()[t.toLowerCase()]).or(o).getOrThunk(function(){return xh(n)});var t,n,o}),w=D.from(t.meta).fold(function(){return sy},function(t){return Ue(t,"style")?e(uy,t.style):sy});return"color"===t.presets?(m=t.ariaLabel,g=t.value,h=r,{dom:(p=b.getOr(""),v={tag:"div",attributes:m.map(function(e){return{title:h.translate(e)}}).getOr({}),classes:["tox-swatch"]},z(z({},v),"custom"===g?{tag:"button",classes:n(v.classes,["tox-swatches__picker-btn"]),innerHtml:p}:"remove"===g?{classes:n(v.classes,["tox-swatch--remove"]),innerHtml:p}:{attributes:z(z({},v.attributes),{"data-mce-color":g}),styles:{"background-color":g}})),optComponents:[]}):(i=t,c=b,s=w,l=y,u=o?c.or(D.some("")).map(cy):D.none(),f=i.checkMark,d=i.htmlContent.fold(function(){return i.textContent.map(s)},function(e){return D.some(ly(e,[vp]))}),{dom:my(l,i.ariaLabel),optComponents:[u,d,i.shortcutContent.map(fy),f,i.caret]})},vy=function(e,t){return qe(e,"tooltipWorker").map(function(e){return[rv.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(e){return{anchor:"submenu",item:e,overrides:{maxHeightFunction:js}}},mode:"follow-highlight",onShow:function(t){e(function(e){rv.setComponents(t,[ki({element:xn.fromDom(e)})])})}})]}).getOr([])},yy=function(e,t){var n,r=av.translate(e),o=(n=r,ov.DOM.encode(n));if(0<t.length){var a=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(a,function(e){return'<span class="tox-autocompleter-highlight">'+e+"</span>"})}return o},by=function(e,t){return Y(e,function(e){switch(e.type){case"cardcontainer":return c=by((i=e).items,t),s="vertical"===i.direction?"tox-collection__item-container--column":kp,l="left"===i.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[wp,s,l,function(){switch(i.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:c};case"cardimage":return r=e.src,o=e.classes,a=e.alt,{dom:{tag:"img",classes:o,attributes:{src:r,alt:a.getOr("")}}};case"cardtext":var n=e.name.exists(function(e){return $(t.cardText.highlightOn,e)})?D.from(t.cardText.matchText).getOr(""):"";return ly(yy(e.text,n),e.classes)}var r,o,a,i,c,s,l})},wy=Af(Gg(),Kg()),ky=function(e){return{value:e}},_y=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,xy=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Cy=function(e){return _y.test(e)||xy.test(e)},Sy=function(e){var t={value:e.value.replace(_y,function(e,t,n,r){return t+t+n+n+r+r})},n=xy.exec(t.value);return null===n?["FFFFFF","FF","FF","FF"]:n},zy=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},Ty=function(e){var t=zy(e.red)+zy(e.green)+zy(e.blue);return ky(t)},Ey=Math.min,Oy=Math.max,Dy=Math.round,Ny=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Ay=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Ry=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},Py=function(e){var t=parseInt(e,10);return t.toString()===e&&t>=0&&255>=t},By=function(e){var t,n,r,o=(e.hue||0)%360,a=e.saturation/100,i=e.value/100,a=Oy(0,Ey(a,1)),i=Oy(0,Ey(i,1));if(0===a)return t=n=r=Dy(255*i),Ry(t,n,r,1);var c=o/60,s=i*a,l=s*(1-Math.abs(c%2-1)),u=i-s;switch(Math.floor(c)){case 0:t=s,n=l,r=0;break;case 1:t=l,n=s,r=0;break;case 2:t=0,n=s,r=l;break;case 3:t=0,n=l,r=s;break;case 4:t=l,n=0,r=s;break;case 5:t=s,n=0,r=l;break;default:t=n=r=0}return t=Dy(255*(t+u)),n=Dy(255*(n+u)),r=Dy(255*(r+u)),Ry(t,n,r,1)},My=function(e){var t=Sy(e),n=parseInt(t[1],16),r=parseInt(t[2],16),o=parseInt(t[3],16);return Ry(n,r,o,1)},Iy=function(e,t,n,r){var o=parseInt(e,10),a=parseInt(t,10),i=parseInt(n,10),c=parseFloat(r);return Ry(o,a,i,c)},Ly=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},jy=Ry(255,0,0,1),Fy=function(e,t){return e.fire("ResizeContent",t)},Hy=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Vy="tinymce-custom-colors",qy="choiceitem",Uy=[{type:qy,text:"Light Green",value:"#BFEDD2"},{type:qy,text:"Light Yellow",value:"#FBEEB8"},{type:qy,text:"Light Red",value:"#F8CAC6"},{type:qy,text:"Light Purple",value:"#ECCAFA"},{type:qy,text:"Light Blue",value:"#C2E0F4"},{type:qy,text:"Green",value:"#2DC26B"},{type:qy,text:"Yellow",value:"#F1C40F"},{type:qy,text:"Red",value:"#E03E2D"},{type:qy,text:"Purple",value:"#B96AD9"},{type:qy,text:"Blue",value:"#3598DB"},{type:qy,text:"Dark Turquoise",value:"#169179"},{type:qy,text:"Orange",value:"#E67E23"},{type:qy,text:"Dark Red",value:"#BA372A"},{type:qy,text:"Dark Purple",value:"#843FA1"},{type:qy,text:"Dark Blue",value:"#236FA1"},{type:qy,text:"Light Gray",value:"#ECF0F1"},{type:qy,text:"Medium Gray",value:"#CED4D9"},{type:qy,text:"Gray",value:"#95A5A6"},{type:qy,text:"Dark Gray",value:"#7E8C8D"},{type:qy,text:"Navy Blue",value:"#34495E"},{type:qy,text:"Black",value:"#000000"},{type:qy,text:"White",value:"#ffffff"}],Wy=function(e){void 0===e&&(e=10);var t,n=Hy.getItem(Vy),r=R(n)?JSON.parse(n):[],o=e-(t=r).length<0?t.slice(0,e):t,a=function(e){o.splice(e,1)};return{add:function(t){var n;(-1===(n=W(o,t))?D.none():D.some(n)).each(a),o.unshift(t),o.length>e&&o.pop(),Hy.setItem(Vy,JSON.stringify(o))},state:function(){return o.slice(0)}}}(10),$y=function(e){return!1!==e.getParam("custom_colors")},Xy=function(e){var t=e.getParam("color_map");return void 0!==t?function(e){var t=[],n=document.createElement("canvas");n.height=1,n.width=1;for(var r=n.getContext("2d"),o=function(e,t){var n=t/255;return("0"+Math.round(e*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},a=0;a<e.length;a+=2)t.push({text:e[a+1],value:function(e){if(/^[0-9A-Fa-f]{6}$/.test(e))return"#"+e.toUpperCase();r.clearRect(0,0,n.width,n.height),r.fillStyle="#FFFFFF",r.fillStyle=e,r.fillRect(0,0,1,1);var t=r.getImageData(0,0,1,1).data,a=t[0],i=t[1],c=t[2],s=t[3];return"#"+o(a,s)+o(i,s)+o(c,s)}(e[a]),type:"choiceitem"});return t}(t):Uy},Gy=function(e){Wy.add(e)},Ky=function(e){e.addCommand("mceApplyTextcolor",function(t,n){var r,o,a;o=t,a=n,(r=e).undoManager.transact(function(){r.focus(),r.formatter.apply(o,{value:a}),r.nodeChanged()})}),e.addCommand("mceRemoveTextcolor",function(t){var n,r;r=t,(n=e).undoManager.transact(function(){n.focus(),n.formatter.remove(r,{value:null},null,!0),n.nodeChanged()})})},Yy=function(e){var t,n,r=Xy(e),o=(t=r.length,Math.max(5,Math.ceil(Math.sqrt(t))));return n=o,e.getParam("color_cols",n,"number")},Jy=function(e,t,n,r){"custom"===n?rb(e)(function(n){n.each(function(n){Gy(n),e.execCommand("mceApplyTextcolor",t,n),r(n)})},"#000000"):"remove"===n?(r(""),e.execCommand("mceRemoveTextcolor",t)):(r(n),e.execCommand("mceApplyTextcolor",t,n))},Zy=function(e,t){return e.concat(Y(Wy.state(),function(e){return{type:qy,text:e,value:e}}).concat((r={type:n="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},t?[r,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[r])));var n,r},Qy=function(e,t){return function(n){n(Zy(e,t))}},eb=function(e,t,n){var r,o;r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o=n,e.setIconFill(r,o),e.setIconStroke(r,o)},tb=function(e,t,n,r,o){e.ui.registry.addSplitButton(t,{tooltip:r,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var r,o,a;return D.from((o=n,(r=e).dom.getParents(r.selection.getStart(),function(e){var t;(t=e.style["forecolor"===o?"color":"background-color"])&&(a=a||t)}),a)).bind(function(e){return function(e){if("transparent"===e)return D.some(Ry(0,0,0,0));var t=Ny.exec(e);if(null!==t)return D.some(Iy(t[1],t[2],t[3],"1"));var n=Ay.exec(e);return null!==n?D.some(Iy(n[1],n[2],n[3],n[4])):D.none()}(e).map(function(e){var n=Ty(e).value;return Nn(t.toLowerCase(),n)})}).getOr(!1)},columns:Yy(e),fetch:Qy(Xy(e),$y(e)),onAction:function(){null!==o.get()&&Jy(e,n,o.get(),v)},onItemAction:function(r,a){Jy(e,n,a,function(n){var r;o.set(n),r={name:t,color:n},e.fire("TextColorChange",r)})},onSetup:function(n){null!==o.get()&&eb(n,t,o.get());var r=function(e){e.name===t&&eb(n,e.name,e.color)};return e.on("TextColorChange",r),function(){e.off("TextColorChange",r)}}})},nb=function(e,t,n,r){e.ui.registry.addNestedMenuItem(t,{text:r,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){Jy(e,n,t.value,v)}}]}})},rb=function(e){return function(t,n){var r,o={colorpicker:n},a=(r=t,function(e){var t=e.getData();r(D.from(t.colorpicker)),e.close()});e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(e,t){"hex-valid"===t.name&&(t.value?e.enable("ok"):e.disable("ok"))},onSubmit:a,onClose:v,onCancel:function(){t(D.none())}})}},ob=function(e,t,n,r,o,a,i,c){var s=Dp(t),l=ab(t,n,r,"color"!==o?"normal":"color",a,i,c);return Rp(e,s,l,r,o)},ab=function(e,t,n,r,o,a,i){return td(Y(e,function(c){return"choiceitem"===c.type?Bt("choicemenuitem",Vp,c).fold(Np,function(s){return D.some(function(e,t,n,r,o,a,i,c){void 0===c&&(c=!0);var s=py({presets:n,textContent:t?e.text:D.none(),htmlContent:D.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:D.none(),checkMark:t?D.some(dy(i.icons)):D.none(),caret:D.none(),value:e.value},i,c);return Ke(oy({data:ay(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){Ig.set(e,t)},isActive:function(){return Ig.isOn(e)},isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},onAction:function(){return r(e.value)},onSetup:function(e){return e.setActive(o),v},triggersSubmenu:!1,itemBehaviours:[]},s,a,i),{toggling:{toggleClass:pp,toggleOnExecute:!1,selected:e.active}})}(s,1===n,r,t,a(c.value),o,i,Dp(e)))}):D.none()}))},ib=function(e,t){var n=Cp(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}},cb=ma("cell-over"),sb=ma("cell-execute"),lb=function(e,t,n){for(var r=[],o=0;t>o;o++){for(var a=[],i=0;n>i;i++)a.push(function(e,t,n){var r,o=function(n){return ro(n,sb,{row:e,col:t})},a=function(e,t){t.stop(),o(e)};return xi({dom:{tag:"div",attributes:((r={role:"button"})["aria-labelledby"]=n,r)},behaviours:fs([wg("insert-table-picker-cell",[fo(br(),Sg.focus),fo(Br(),o),fo(zr(),a),fo(Ir(),a)]),Ig.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Sg.config({onFocus:function(n){return ro(n,cb,{row:e,col:t})}})])})}(o,i,e));r.push(a)}return r},ub={inserttable:function(e){var t=ma("size-label"),n=lb(t,10,10),r=_h({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[wi("0x0")],behaviours:fs([bg.config({})])});return{type:"widget",data:{value:ma("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[wy.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:ae(n,function(e){return Y(e,Ci)}).concat(r.asSpec()),behaviours:fs([wg("insert-table-picker",[po(cb,function(e,t,o){var a=o.event.row,i=o.event.col;!function(e,t,n,r,o){for(var a=0;r>a;a++)for(var i=0;o>i;i++)Ig.set(e[a][i],t>=a&&n>=i)}(n,a,i,10,10),bg.set(r.get(e),[wi(i+1+"x"+(a+1))])}),po(sb,function(t,n,r){e.onAction({numRows:r.event.row+1,numColumns:r.event.col+1}),no(t,jr())})]),gg.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(e,t){var n=Zy(t.colorinput.getColors(),t.colorinput.hasCustomColors()),r=t.colorinput.getColorCols(),o=ob(ma("menu-value"),n,function(t){e.onAction({value:t})},r,"color",fp.CLOSE_ON_EXECUTE,x,t.shared.providers),a=z(z({},o),{markers:Cp("color"),movement:ib(r,"color")});return{type:"widget",data:{value:ma("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[wy.widget(th.sketch(a))]}}},fb=function(e,t,n,r,o,a,i,c){void 0===c&&(c=!0);var s=py({presets:r,textContent:D.none(),htmlContent:n?e.text.map(function(e){return yy(e,t)}):D.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:D.none(),checkMark:D.none(),caret:D.none(),value:e.value},i.providers,c,e.icon);return oy({data:ay(e),disabled:e.disabled,getApi:b({}),onAction:function(){return o(e.value,e.meta)},onSetup:b(v),triggersSubmenu:!1,itemBehaviours:vy(e.meta,i)},s,a,i.providers)},db=function(e){var t=e.text.fold(function(){return{}},function(e){return{innerHtml:e}});return{type:"separator",dom:z({tag:"div",classes:[mp,"tox-collection__group-heading"]},t),components:[]}},mb=function(e,t,n,r){void 0===r&&(r=!0);var o=py({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,caret:D.none(),checkMark:D.none(),shortcutContent:e.shortcut},n,r);return oy({data:ay(e),getApi:function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},disabled:e.disabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n)},gb=function(e,t,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=!1);var a,i,c=o?(i=n.icons,{dom:{tag:"div",classes:[yp],innerHtml:Ch("chevron-down",i)}}):(a=n.icons,{dom:{tag:"div",classes:[yp],innerHtml:Ch("chevron-right",a)}}),s=py({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,caret:D.some(c),checkMark:D.none(),shortcutContent:e.shortcut},n,r);return oy({data:ay(e),getApi:function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},disabled:e.disabled,onAction:v,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,t,n)},hb=function(e,t,n,r){void 0===r&&(r=!0);var o=py({iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,checkMark:D.some(dy(n.icons)),caret:D.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,r);return Ke(oy({data:ay(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){Ig.set(e,t)},isActive:function(){return Ig.isOn(e)},isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n),{toggling:{toggleClass:pp,toggleOnExecute:!1,selected:e.active}})},pb=function(e,t){return n=ub,r=e.fancytype,(Object.prototype.hasOwnProperty.call(n,r)?D.some(n[r]):D.none()).map(function(n){return n(e,t)});var n,r},vb=function(e,t,n,r){var o={dom:my(!1,e.label),optComponents:[D.some({dom:{tag:"div",classes:[wp,kp]},components:by(e.items,r)})]};return oy({data:ay(z({text:D.none()},e)),disabled:e.disabled,getApi:function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){bv.set(e,t),J(Al(e.element,"*"),function(n){e.getSystem().getByDom(n).each(function(e){e.hasConfigured(bv)&&bv.set(e,t)})})}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:D.from(r.itemBehaviours).getOr([])},o,t,n.providers)};(Mv=Bv=Bv||{})[Mv.ContentFocus=0]="ContentFocus",Mv[Mv.UiFocus=1]="UiFocus";var yb,bb,wb,kb,_b=function(e,t,n,r,o){var a=n.shared.providers,i=function(e){return o?z(z({},e),{shortcut:D.none(),icon:e.text.isSome()?D.none():e.icon}):e};switch(e.type){case"menuitem":return Bt("menuitem",Up,e).fold(Np,function(e){return D.some(mb(i(e),t,a,r))});case"nestedmenuitem":return Bt("nestedmenuitem",Wp,e).fold(Np,function(e){return D.some(gb(i(e),t,a,r,o))});case"togglemenuitem":return Bt("togglemenuitem",$p,e).fold(Np,function(e){return D.some(hb(i(e),t,a,r))});case"separator":return Bt("separatormenuitem",Wh,e).fold(Np,function(e){return D.some(db(e))});case"fancymenuitem":return Bt("fancymenuitem",qp,e).fold(Np,function(e){return pb(i(e),n)});default:return console.error("Unknown item in general menu",e),D.none()}},xb=function(e,t,n,r,o,a,i){var c=1===r,s=!c||Dp(e);return td(Y(e,function(e){switch(e.type){case"separator":return Bt("Autocompleter.Separator",Wh,e).fold(Np,function(e){return D.some(db(e))});case"cardmenuitem":return Bt("cardmenuitem",Hp,e).fold(Np,function(e){return D.some(vb(z(z({},e),{onAction:function(t){e.onAction(t),n(e.value,e.meta)}}),o,a,{itemBehaviours:vy(e.meta,a),cardText:{matchText:t,highlightOn:i}}))});case"autocompleteitem":default:return Bt("Autocompleter.Item",$h,e).fold(Np,function(e){return D.some(fb(e,t,c,"normal",n,o,a,s))})}}))},Cb=function(e,t,n,r,o){var a=Dp(t),i=td(Y(t,function(e){var t=function(e){return _b(e,n,r,(t=e,o?!t.hasOwnProperty("text"):a),o);var t};return t("nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?z(z({},e),{disabled:!0}):e)}));return(o?Ap:Rp)(e,a,i,1,"normal")},Sb=function(e){return ch.singleData(e.value,e)},zb=function(e,t){var n=kn(D.none()),r=kn(!1),o=xi(sh.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:fs([wg("dismissAutocompleter",[fo(Gr(),function(){return c()})])]),lazySink:t.getSink})),a=function(){return n.get().isSome()},i=function(){a()&&sh.hide(o)},c=function(){var t;a()&&(t=n.get().map(function(e){return e.element}),Nh(t.getOr(xn.fromDom(e.selection.getNode()))).each(Qo),i(),n.set(D.none()),r.set(!1))},s=Je(function(){return sp(e)}),l=function(t,n,r,a){t.matchLength=n.text.length;var i,c,s,l,u,f,d,m=ge(r,function(e){return D.from(e.columns)}).getOr(1);sh.showAt(o,{anchor:"node",root:xn.fromDom(e.getBody()),node:D.from(t.element)},th.sketch((i=Rp("autocompleter-value",!0,a,m,"normal"),c=m,s=Bv.ContentFocus,l="normal",u=(s===Bv.ContentFocus?jd:Ld)(),f=ib(c,l),d=Cp(l),{dom:i.dom,components:i.components,items:i.items,value:i.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:s===Bv.ContentFocus,focusManager:u,menuBehaviours:Kp("auto"!==c?[]:[bo(function(e){Xp(e,4,d.item).each(function(t){var n=t.numColumns,r=t.numRows;gg.setGridSize(e,r,n)})})])}))),sh.getContent(o).each(vd.highlightFirst)},u=function(o){var f;f=o,n.get().map(function(t){return Mh(e.dom,e.selection.getRng(),t.triggerChar).bind(function(t){return Uh(e,s,t,f)})}).getOrThunk(function(){return qh(e,s)}).fold(c,function(o){var s,f;s=o.context,a()||(f=Dh(e,s.range),n.set(D.some({triggerChar:s.triggerChar,element:f,matchLength:s.text.length})),r.set(!1)),o.lookupData.then(function(a){n.get().map(function(n){var s,f,d,m,g=o.context;n.triggerChar===g.triggerChar&&(f=g.triggerChar,m=ge(d=a,function(e){return D.from(e.columns)}).getOr(1),0<(s=ae(d,function(n){var o=n.items;return xb(o,n.matchText,function(t,o){var a=e.selection.getRng();Mh(e.dom,a,f).fold(function(){return console.error("Lost context. Cursor probably moved")},function(e){var a=e.range,s={hide:function(){c()},reload:function(e){i(),u(e)}};r.set(!0),n.onAction(s,a,t,o),r.set(!1)})},m,fp.BUBBLE_TO_SANDBOX,t,n.highlightOn)})).length?l(n,g,a,s):(10<=g.text.length-n.matchLength?c:i)())})})})},f={onKeypress:Th(function(e){27!==e.which&&u()},50),cancelIfNecessary:c,isMenuOpen:function(){return sh.isOpen(o)},isActive:a,isProcessingAction:r.get,getView:function(){return sh.getContent(o)}};!1===e.hasPlugin("rtc")&&Ih(f,e)},Tb=C,Eb=function(e,t,n){return Li(e,t,Tb,n,!1)},Ob=function(e,t,n){return Li(e,t,Tb,n,!0)},Db=Ii,Nb=function(e,t,n){return nc(e,t,n).isSome()},Ab=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},schedule:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n=setTimeout(function(){e.apply(null,r),n=null},t)}}},Rb=function(e){var t=e.raw;return void 0===t.touches||1!==t.touches.length?D.none():D.some(t.touches[0])},Pb=function(e){var t=kn(D.none()),n=kn(!1),r=Ab(function(t){e.triggerEvent(Lr(),t),n.set(!0)},400),o=ct([{key:fr(),value:function(e){return Rb(e).each(function(o){r.cancel();var a={x:o.clientX,y:o.clientY,target:e.target};r.schedule(e),n.set(!1),t.set(D.some(a))}),D.none()}},{key:dr(),value:function(e){return r.cancel(),Rb(e).each(function(e){t.get().each(function(n){var r,o,a,i;r=e,o=n,a=Math.abs(r.clientX-o.x),i=Math.abs(r.clientY-o.y),(a>5||i>5)&&t.set(D.none())})}),D.none()}},{key:mr(),value:function(o){return r.cancel(),t.get().filter(function(e){return tr(e.target,o.target)}).map(function(){return n.get()?(o.prevent(),!1):e.triggerEvent(Ir(),o)})}}]);return{fireIfReady:function(e,t){return qe(o,t).bind(function(t){return t(e)})}}},Bb=function(){return Zn().browser.isFirefox()},Mb=bt([en("triggerEvent"),fn("stopBackspace",!0)]),Ib=function(e,t){var n,r,o,a,i=It("Getting GUI events settings",Mb,t),c=Pb(i),s=Y(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Eb(e,t,function(e){c.fireIfReady(e,t).each(function(t){t&&e.kill()}),i.triggerEvent(t,e)&&e.kill()})}),l=kn(D.none()),u=Eb(e,"paste",function(e){c.fireIfReady(e,"paste").each(function(t){t&&e.kill()}),i.triggerEvent("paste",e)&&e.kill(),l.set(D.some(setTimeout(function(){i.triggerEvent(Rr(),e)},0)))}),f=Eb(e,"keydown",function(e){var t;i.triggerEvent("keydown",e)?e.kill():!0!==i.stopBackspace||(t=e).raw.which!==yd[0]||$(["input","textarea"],xo(t.target))||Nb(t.target,'[contenteditable="true"]')||e.prevent()}),d=(n=e,r=function(e){i.triggerEvent("focusin",e)&&e.kill()},Bb()?Ob(n,"focus",r):Eb(n,"focusin",r)),m=kn(D.none()),g=(o=e,a=function(e){i.triggerEvent("focusout",e)&&e.kill(),m.set(D.some(setTimeout(function(){i.triggerEvent(Ar(),e)},0)))},Bb()?Ob(o,"blur",a):Eb(o,"focusout",a));return{unbind:function(){J(s,function(e){e.unbind()}),f.unbind(),d.unbind(),g.unbind(),u.unbind(),l.get().each(clearTimeout),m.get().each(clearTimeout)}}},Lb=function(e,t){var n=qe(e,"target").getOr(t);return kn(n)},jb=$e([{stopped:[]},{resume:["element"]},{complete:[]}]),Fb=function(e,t,n,r,o,a){var i,c,s,l,u=e(t,r),f=(i=n,c=o,s=kn(!1),l=kn(!1),{stop:function(){s.set(!0)},cut:function(){l.set(!0)},isStopped:s.get,isCut:l.get,event:i,setSource:c.set,getSource:c.get});return u.fold(function(){return a.logEventNoHandlers(t,r),jb.complete()},function(e){var n=e.descHandler;return Ra(n)(f),f.isStopped()?(a.logEventStopped(t,e.element,n.purpose),jb.stopped()):f.isCut()?(a.logEventCut(t,e.element,n.purpose),jb.complete()):Ro(e.element).fold(function(){return a.logNoParent(t,e.element,n.purpose),jb.complete()},function(r){return a.logEventResponse(t,e.element,n.purpose),jb.resume(r)})})},Hb=function(e,t,n,r,o,a){return Fb(e,t,n,r,o,a).fold(C,function(r){return Hb(e,t,n,r,o,a)},x)},Vb=function(e,t){var n,r,o=(n=t,r=kn(!1),{stop:function(){r.set(!0)},cut:v,isStopped:r.get,isCut:x,event:n,setSource:_("Cannot set source of a broadcasted event"),getSource:_("Cannot get source of a broadcasted event")});return J(e,function(e){var t=e.descHandler;Ra(t)(o)}),o.isStopped()},qb=function(e,t,n,r,o){var a=Lb(n,r);return Hb(e,t,n,r,a,o)},Ub=function(){var t={};return{registerId:function(n,r,o){Me(o,function(o,a){var i,c,s=void 0!==t[a]?t[a]:{};s[r]=(i=o,c=n,{cHandler:e.apply(void 0,[i.handler].concat(c)),purpose:i.purpose}),t[a]=s})},unregisterId:function(e){Me(t,function(t){t.hasOwnProperty(e)&&delete t[e]})},filterByType:function(e){return qe(t,e).map(function(e){return Fe(e,function(e,t){return{id:t,descHandler:e}})}).getOr([])},find:function(e,n,r){var o=qe(t,n);return ir(r,function(e){return t=o,ba(n=e).fold(function(){return D.none()},function(e){return t.bind(function(t){return qe(t,e)}).map(function(e){return{element:n,descHandler:e}})});var t,n},e)}}},Wb=function(){var e=Ub(),t={},n=function(e){var t=e.element;return ba(t).fold(function(){return t="uid-",n=e.element,r=ma(pa+t),ya(n,r),r;var t,n,r},function(e){return e})},r=function(n){ba(n.element).each(function(n){delete t[n],e.unregisterId(n)})};return{find:function(t,n,r){return e.find(t,n,r)},filter:function(t){return e.filterByType(t)},register:function(o){var a=n(o);We(t,a)&&function(e,n){var o=t[n];if(o!==e)throw new Error('The tagId "'+n+'" is already used by: '+la(o.element)+"\nCannot use it for: "+la(e.element)+"\nThe conflicting element is"+(Za(o.element)?" ":" not ")+"already in the DOM");r(e)}(o,a);var i=[o];e.registerId(i,a,o.events),t[a]=o},unregister:r,getById:function(e){return qe(t,e)}}},$b=Qf({name:"Container",factory:function(e){var n=e.dom,r=n.attributes,o=t(n,["attributes"]);return{uid:e.uid,dom:z({tag:"div",attributes:z({role:"presentation"},r)},o),components:e.components,behaviours:Yu(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[fn("components",[]),Ku("containerBehaviours",[]),fn("events",{}),fn("domModification",{}),fn("eventOrder",{})]}),Xb=function(e){var t=function(t){return Ro(e.element).fold(C,function(e){return tr(t,e)})},n=Wb(),r=function(e,r){return n.find(t,e,r)},o=Ib(e.element,{triggerEvent:function(e,t){return fc(e,t.target,function(n){return a=n,qb(r,e,o=t,o.target,a);var o,a})}}),a={debugInfo:b("real"),triggerEvent:function(e,t,n){fc(e,t,function(o){return qb(r,e,n,t,o)})},triggerFocus:function(e,t){ba(e).fold(function(){bs(e)},function(){fc(Nr(),e,function(n){var o,a,i,c,s,l;return o=r,a=Nr(),s=n,l=Lb(i={originator:t,kill:v,prevent:v,target:e},c=e),Fb(o,a,i,c,l,s),!1})})},triggerEscape:function(e,t){a.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return g(e)},getByDom:function(e){return h(e)},build:xi,addToGui:function(e){s(e)},removeFromGui:function(e){l(e)},addToWorld:function(e){i(e)},removeFromWorld:function(e){c(e)},broadcast:function(e){f(e)},broadcastOn:function(e,t){d(e,t)},broadcastEvent:function(e,t){m(e,t)},isConnected:C},i=function(e){e.connect(a),zo(e.element)||(n.register(e),J(e.components(),i),a.triggerEvent(Hr(),e.element,{target:e.element}))},c=function(e){zo(e.element)||(J(e.components(),c),n.unregister(e)),e.disconnect()},s=function(t){fu(e,t)},l=function(e){gu(e)},u=function(e){var t=n.filter(Pr());J(t,function(t){var n=t.descHandler;Ra(n)(e)})},f=function(e){u({universal:!0,data:e})},d=function(e,t){u({universal:!1,channels:e,data:t})},m=function(e,t){var r=n.filter(e);return Vb(r,t)},g=function(e){return n.getById(e).fold(function(){return ve.error(new Error('Could not find component with uid: "'+e+'" in system.'))},ve.value)},h=function(e){var t=ba(e).getOr("not found");return g(t)};return i(e),{root:e,element:e.element,destroy:function(){o.unbind(),Zo(e.element)},add:s,remove:l,getByUid:g,getByDom:h,addToWorld:i,removeFromWorld:c,broadcast:f,broadcastOn:d,broadcastEvent:m}},Gb=b([fn("prefix","form-field"),Ku("fieldBehaviours",[id,Gu])]),Kb=b([Tf({schema:[Yt("dom")],name:"label"}),Tf({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Yt("text")],name:"aria-descriptor"}),Sf({factory:{sketch:function(e){var t=at(e,["factory"]);return e.factory.sketch(t)}},schema:[Yt("factory")],name:"field"})]),Yb=ed({name:"FormField",configFields:Gb(),partFields:Kb(),factory:function(e,t){var n=Ju(e.fieldBehaviours,[id.config({find:function(t){return jf(t,e,"field")}}),Gu.config({store:{mode:"manual",getValue:function(e){return id.getCurrent(e).bind(Gu.getValue)},setValue:function(e,t){id.getCurrent(e).each(function(e){Gu.setValue(e,t)})}}})]),r=so([bo(function(t){var n=Hf(t,e,["label","field","aria-descriptor"]);n.field().each(function(t){var r=ma(e.prefix);n.label().each(function(e){ra(e.element,"for",r),ra(t.element,"id",r)}),n["aria-descriptor"]().each(function(n){var r=ma(e.prefix);ra(n.element,"id",r),ra(t.element,"aria-describedby",r)})})})]),o={getField:function(t){return jf(t,e,"field")},getLabel:function(t){return jf(t,e,"label")}};return{uid:e.uid,dom:e.dom,components:t,behaviours:n,events:r,apis:o}},apis:{getField:function(e,t){return e.getField(t)},getLabel:function(e,t){return e.getLabel(t)}}}),Jb=Object.freeze({__proto__:null,exhibit:function(e,t){return Aa({attributes:ct([{key:t.tabAttr,value:"true"}])})}}),Zb=[fn("tabAttr","data-alloy-tabstop")],Qb=ms({fields:Zb,name:"tabstopping",active:Jb}),ew=tinymce.util.Tools.resolve("tinymce.html.Entities"),tw=function(e,t,n,r){var o=nw(e,t,n,r);return Yb.sketch(o)},nw=function(e,t,n,r){
return{dom:rw(n),components:e.toArray().concat([t]),fieldBehaviours:fs(r)}},rw=function(e){return{tag:"div",classes:["tox-form__group"].concat(e)}},ow=function(e,t){return Yb.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}})},aw=ma("form-component-change"),iw=ma("form-close"),cw=ma("form-cancel"),sw=ma("form-action"),lw=ma("form-submit"),uw=ma("form-block"),fw=ma("form-unblock"),dw=ma("form-tabchange"),mw=ma("form-resize"),gw=function(e,t){var n,r,o,a=e.label.map(function(e){return ow(e,t)}),i=function(e){return function(t,n){nc(n.event.target,"[data-collection-item-value]").each(function(r){e(t,n,r,oa(r,"data-collection-item-value"))})}},c=i(function(n,r,o,a){r.stop(),t.isDisabled()||ro(n,sw,{name:e.name,value:a})}),s=[fo(br(),i(function(e,t,n){bs(n)})),fo(zr(),c),fo(Ir(),c),fo(wr(),i(function(e,t,n){tc(e.element,"."+bp).each(function(e){Xa(e,bp)}),Wa(n,bp)})),fo(kr(),i(function(e){tc(e.element,"."+bp).each(function(e){Xa(e,bp)})})),_o(i(function(t,n,r,o){ro(t,sw,{name:e.name,value:o})}))],l=function(e,t){return Y(Al(e.element,".tox-collection__item"),t)},u=Yb.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:fs([bv.config({disabled:t.isDisabled,onDisabled:function(e){l(e,function(e){Wa(e,"tox-collection__item--state-disabled"),ra(e,"aria-disabled",!0)})},onEnabled:function(e){l(e,function(e){Xa(e,"tox-collection__item--state-disabled"),ca(e,"aria-disabled")})}}),Gv(),bg.config({}),Gu.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,r){var o,a,i,c;o=n,a=Y(r,function(n){var r=av.translate(n.text),o=1===e.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",a='<div class="tox-collection__item-icon">'+n.icon+"</div>",i={_:" "," - ":" ","-":" "},c=r.replace(/\_| \- |\-/g,function(e){return i[e]});return'<div class="tox-collection__item'+(t.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+ew.encodeAllRaw(n.value)+'" title="'+c+'" aria-label="'+c+'">'+a+o+"</div>"}),i="auto"!==e.columns&&1<e.columns?K(a,e.columns):[a],c=Y(i,function(e){return'<div class="tox-collection__group">'+e.join("")+"</div>"}),ta(o.element,c.join("")),"auto"===e.columns&&Xp(n,5,"tox-collection__item").each(function(e){var t=e.numRows,r=e.numColumns;gg.setGridSize(n,t,r)}),no(n,mw)}}),Qb.config({}),gg.config((r=e.columns,o="normal",1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===o?".tox-swatches__row":".tox-collection__group",cell:"color"===o?"."+gp:"."+mp}})),wg("collection-events",s)]),eventOrder:((n={})[Br()]=["disabling","alloy.base.behaviour","collection-events"],n)});return tw(a,u,["tox-form__group--collection"],[])},hw=b([on("data"),fn("inputAttributes",{}),fn("inputStyles",{}),fn("tag","input"),fn("inputClasses",[]),wc("onSetValue"),fn("styles",{}),fn("eventOrder",{}),Ku("inputBehaviours",[Gu,Sg]),fn("selectOnFocus",!0)]),pw=function(e){return fs([Sg.config({onFocus:e.selectOnFocus?function(e){var t=e.element,n=di(t);t.dom.setSelectionRange(0,n.length)}:v})])},vw=function(e){return{tag:e.tag,attributes:z({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}},yw=Qf({name:"Input",configFields:hw(),factory:function(e){return{uid:e.uid,dom:vw(e),components:[],behaviours:z(z({},pw(t=e)),Ju(t.inputBehaviours,[Gu.config({store:z(z({mode:"manual"},t.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return di(e.element)},setValue:function(e,t){di(e.element)!==t&&mi(e.element,t)}}),onSetValue:t.onSetValue})])),eventOrder:e.eventOrder};var t}}),bw={},ww={exports:bw};yb=void 0,bb=bw,wb=ww,kb=void 0,function(e){"object"==typeof bb&&void 0!==wb?wb.exports=e():"function"==typeof yb&&yb.amd?yb([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function e(t,n,r){function o(i,c){if(!n[i]){if(!t[i]){var s="function"==typeof kb&&kb;if(!c&&s)return s(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){return o(t[i][1][e]||e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof kb&&kb,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function a(){g&&d&&(g=!1,d.length?m=d.concat(m):h=-1,m.length&&i())}function i(){if(!g){var e=o(a);g=!0;for(var t=m.length;t;){for(d=m,m=[];++h<t;)d&&d[h].run();h=-1,t=m.length}d=null,g=!1,function(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}(e)}}function c(e,t){this.fun=e,this.array=t}function s(){}var l,u,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(e){u=r}}();var d,m=[],g=!1,h=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new c(e,t)),1!==m.length||g||o(i)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(){return[]},f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],2:[function(e,t){(function(e){function n(){}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(o){return void i(t.promise,o)}a(t.promise,n)}else(1===e._state?a:i)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void l((a=n,s=t,function(){a.apply(s,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(o){i(e,o)}var a,s}function i(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;n>t;t++)o(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,i(t,e))})}catch(r){if(n)return;n=!0,i(t,r)}}var u,f;u=this,f=setTimeout,r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new s(e,t,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);for(var r=t.length,o=0;o<t.length;o++)!function a(o,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var c=i.then;if("function"==typeof c)return void c.call(i,function(e){a(o,e)},n)}t[o]=i,0==--r&&e(t)}catch(s){n(s)}}(o,t[o])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,o=e.length;o>r;r++)e[r].then(t,n)})},r._immediateFn="function"==typeof e?function(t){e(t)}:function(e){f(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=r:u.Promise||(u.Promise=r)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){function o(e,t){this._id=e,this._clearFn=t}var a=e("process/browser.js").nextTick,i=Function.prototype.apply,c=Array.prototype.slice,s={},l=0;n.setTimeout=function(){return new o(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new o(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=l++,r=!(arguments.length<2)&&c.call(arguments,1);return s[t]=!0,a(function(){s[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t){var n=e("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:r.Promise||n}},{"promise-polyfill":2}]},{},[4])(4)});var kw,_w,xw=ww.exports.boltExport,Cw=function(e){var t=D.none(),n=[],r=function(e){o()?i(e):n.push(e)},o=function(){return t.isSome()},a=function(e){J(e,i)},i=function(e){t.each(function(t){setTimeout(function(){e(t)},0)})};return e(function(e){o()||(t=D.some(e),a(n),n=[])}),{get:r,map:function(e){return Cw(function(t){r(function(n){t(e(n))})})},isReady:o}},Sw={nu:Cw,pure:function(e){return Cw(function(t){t(e)})}},zw=function(e){setTimeout(function(){throw e},0)},Tw=function(e){var t=function(t){e().then(t,zw)};return{map:function(t){return Tw(function(){return e().then(t)})},bind:function(t){return Tw(function(){return e().then(function(e){return t(e).toPromise()})})},anonBind:function(t){return Tw(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return Sw.nu(t)},toCached:function(){var t=null;return Tw(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},Ew=function(e){return Tw(function(){return new xw(e)})},Ow=function(e){return Tw(function(){return xw.resolve(e)})},Dw=["input","textarea"],Nw=function(e){var t=xo(e);return $(Dw,t)},Aw=function(e,t){var n=t.getRoot(e).getOr(e.element);Xa(n,t.invalidClass),t.notify.each(function(t){Nw(e.element)&&ra(e.element,"aria-invalid",!1),t.getContainer(e).each(function(e){ta(e,t.validHtml)}),t.onValid(e)})},Rw=function(e,t,n,r){var o=t.getRoot(e).getOr(e.element);Wa(o,t.invalidClass),t.notify.each(function(t){Nw(e.element)&&ra(e.element,"aria-invalid",!0),t.getContainer(e).each(function(e){ta(e,r)}),t.onInvalid(e,r)})},Pw=function(e,t){return t.validator.fold(function(){return Ow(ve.value(!0))},function(t){return t.validate(e)})},Bw=function(e,t){return t.notify.each(function(t){t.onValidate(e)}),Pw(e,t).map(function(n){return e.getSystem().isConnected()?n.fold(function(n){return Rw(e,t,0,n),ve.error(n)},function(n){return Aw(e,t),ve.value(n)}):ve.error("No longer in system")})},Mw=Object.freeze({__proto__:null,markValid:Aw,markInvalid:Rw,query:Pw,run:Bw,isInvalid:function(e,t){var n=t.getRoot(e).getOr(e.element);return Ga(n,t.invalidClass)}}),Iw=Object.freeze({__proto__:null,events:function(e){return e.validator.map(function(t){return so([fo(t.onEvent,function(t){Bw(t,e).get(w)})].concat(t.validateOnLoad?[bo(function(t){Bw(t,e).get(v)})]:[]))}).getOr({})}}),Lw=[Yt("invalidClass"),fn("getRoot",D.none),un("notify",[fn("aria","alert"),fn("getContainer",D.none),fn("validHtml",""),wc("onValid"),wc("onInvalid"),wc("onValidate")]),un("validator",[Yt("validate"),fn("onEvent","input"),fn("validateOnLoad",!0)])],jw=ms({fields:Lw,name:"invalidating",active:Iw,apis:Mw,extra:{validation:function(e){return function(t){var n=Gu.getValue(t);return Ow(e(n))}}}}),Fw=Object.freeze({__proto__:null,getCoupled:function(e,t,n,r){return n.getOrCreate(e,t,r)}}),Hw=[Jt("others",Pt(ve.value,Ht()))],Vw=ms({fields:Hw,name:"coupling",apis:Fw,state:Object.freeze({__proto__:null,init:function(){var e={},t=b({});return Da({readState:t,getOrCreate:function(t,n,r){var o=Pe(n.others);if(o)return qe(e,r).getOrThunk(function(){var o=qe(n.others,r).getOrDie("No information found for coupled component: "+r)(t),a=t.getSystem().build(o);return e[r]=a});throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(o,null,2))}})}})}),qw=b("sink"),Uw=b(Tf({name:qw(),overrides:b({dom:{tag:"div"},behaviours:fs([iu.config({useFixed:C})]),events:so([vo(_r()),vo(hr()),vo(zr())])})}));(_w=kw=kw||{})[_w.HighlightFirst=0]="HighlightFirst",_w[_w.HighlightNone=1]="HighlightNone";var Ww,$w,Xw,Gw,Kw,Yw,Jw,Zw,Qw,ek,tk,nk,rk,ok=function(e,t){var n=e.getHotspot(t).getOr(t),r=e.getAnchorOverrides();return e.layouts.fold(function(){return{anchor:"hotspot",hotspot:n,overrides:r}},function(e){return{anchor:"hotspot",hotspot:n,overrides:r,layouts:e}})},ak=function(e,t,n,r,o,a,i){var c,s,l,u,f,d,m,g,h,p,v=ok(e,n);return(s=v,u=r,f=o,d=i,m=t,g=l=n,h=(0,(c=e).fetch)(g).map(m),p=lk(l,c),h.map(function(e){return e.bind(function(e){return D.from(ch.sketch(z(z({},f.menu()),{uid:wa(""),data:e,highlightImmediately:d===kw.HighlightFirst,onOpenMenu:function(e,t){var n=p().getOrDie();iu.position(n,s,t),Eu.decloak(u)},onOpenSubmenu:function(e,t,n){var r=p().getOrDie();iu.position(r,{anchor:"submenu",item:t},n),Eu.decloak(u)},onRepositionMenu:function(e,t,n){var r=p().getOrDie();iu.position(r,s,t),J(n,function(e){iu.position(r,{anchor:"submenu",item:e.triggeringItem},e.triggeredMenu)})},onEscape:function(){return Sg.focus(l),Eu.close(u),D.some(!0)}})))})})).map(function(e){return e.fold(function(){Eu.isOpen(r)&&Eu.close(r)},function(e){Eu.cloak(r),Eu.open(r,e),a(r)}),r})},ik=function(e,t,n,r){return Eu.close(r),Ow(r)},ck=function(e,t,n,r,o,a){var i=Vw.getCoupled(n,"sandbox");return(Eu.isOpen(i)?ik:ak)(e,t,n,i,r,o,a)},sk=function(e,t,n){var r,o,a=id.getCurrent(t).getOr(t),i=Bi(e.element);n?ri(a.element,"min-width",i+"px"):(r=a.element,o=i,Pi.set(r,o))},lk=function(e,t){return e.getSystem().getByUid(t.uid+"-"+qw()).map(function(e){return function(){return ve.value(e)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return ve.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(e)}})})},uk=function(e){Eu.getState(e).each(function(e){ch.repositionMenus(e)})},fk=function(e,t,n){var r=rc(),o=lk(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:r.id,role:"listbox"}},behaviours:Qu(e.sandboxBehaviours,[Gu.config({store:{mode:"memory",initialValue:t}}),Eu.config({onOpen:function(o,a){var i=ok(e,t);r.link(t.element),e.matchWidth&&sk(i.hotspot,a,e.useMinWidth),e.onOpen(i,o,a),void 0!==n&&void 0!==n.onOpen&&n.onOpen(o,a)},onClose:function(e,o){r.unlink(t.element),void 0!==n&&void 0!==n.onClose&&n.onClose(e,o)},isPartOf:function(e,n,r){return ac(n,r)||ac(t,r)},getAttachPoint:function(){return o().getOrDie()}}),id.config({find:function(e){return Eu.getState(e).bind(function(e){return id.getCurrent(e)})}}),vs.config({channels:z(z({},Ru({isExtraPart:x})),Bu({doReposition:uk}))})])}},dk=function(e){var t=Vw.getCoupled(e,"sandbox");uk(t)},mk=function(){return[fn("sandboxClasses",[]),Zu("sandboxBehaviours",[id,vs,Eu,Gu])]},gk=b([Yt("dom"),Yt("fetch"),wc("onOpen"),kc("onExecute"),fn("getHotspot",D.some),fn("getAnchorOverrides",b({})),tl(),Ku("dropdownBehaviours",[Ig,Vw,gg,Sg]),Yt("toggleClass"),fn("eventOrder",{}),on("lazySink"),fn("matchWidth",!1),fn("useMinWidth",!1),on("role")].concat(mk())),hk=b([zf({schema:[vc()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),Uw()]),pk=ed({name:"Dropdown",configFields:gk(),partFields:hk(),factory:function(e,t,n,r){var o,a,i=function(e){Eu.getState(e).each(function(e){ch.highlightPrimary(e)})},c={expand:function(t){Ig.isOn(t)||ck(e,function(e){return e},t,r,v,kw.HighlightNone).get(v)},open:function(t){Ig.isOn(t)||ck(e,function(e){return e},t,r,v,kw.HighlightFirst).get(v)},isOpen:Ig.isOn,close:function(t){Ig.isOn(t)&&ck(e,function(e){return e},t,r,v,kw.HighlightFirst).get(v)},repositionMenus:function(e){Ig.isOn(e)&&dk(e)}},s=function(e){return oo(e),D.some(!0)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.dropdownBehaviours,[Ig.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Vw.config({others:{sandbox:function(t){return fk(e,t,{onOpen:function(){return Ig.on(t)},onClose:function(){return Ig.off(t)}})}}}),gg.config({mode:"special",onSpace:s,onEnter:s,onDown:function(e){var t;return pk.isOpen(e)?(t=Vw.getCoupled(e,"sandbox"),i(t)):pk.open(e),D.some(!0)},onEscape:function(e){return pk.isOpen(e)?(pk.close(e),D.some(!0)):D.none()}}),Sg.config({})]),events:jg(D.some(function(t){ck(e,function(e){return e},t,r,i,kw.HighlightFirst).get(v)})),eventOrder:z(z({},e.eventOrder),((o={})[Br()]=["disabling","toggling","alloy.base.behaviour"],o)),apis:c,domModification:{attributes:z(z({"aria-haspopup":"true"},e.role.fold(function(){return{}},function(e){return{role:e}})),"button"===e.dom.tag?{type:(a="type",qe(e.dom,"attributes").bind(function(e){return qe(e,a)}).getOr("button"))}:{})}}},apis:{open:function(e,t){return e.open(t)},expand:function(e,t){return e.expand(t)},close:function(e,t){return e.close(t)},isOpen:function(e,t){return e.isOpen(t)},repositionMenus:function(e,t){return e.repositionMenus(t)}}}),vk=ms({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return so([lo(Er(),C)])},exhibit:function(){return Aa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),yk=ma("color-input-change"),bk=ma("color-swatch-change"),wk=ma("color-picker-cancel"),kk=function(e,t,n){var r,o,a=Yb.parts.field({factory:yw,inputClasses:["tox-textfield"],onSetValue:function(e){return jw.run(e).get(v)},inputBehaviours:fs([bv.config({disabled:t.providers.isDisabled}),Gv(),Qb.config({}),jw.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(e){return Ro(e.element)},notify:{onValid:function(e){var t=Gu.getValue(e);ro(e,yk,{color:t})}},validator:{validateOnLoad:!1,validate:function(e){var t=Gu.getValue(e);if(0===t.length)return Ow(ve.value(!0));var n=xn.fromTag("span");ri(n,"background-color",t);var r=si(n,"background-color").fold(function(){return ve.error("blah")},function(){return ve.value(t)});return Ow(r)}}})]),selectOnFocus:!1}),i=e.label.map(function(e){return ow(e,t.providers)}),c=function(e,t){ro(e,bk,{value:t})},s=_h((r={dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Wc,Uc,Kc]},onLtr:function(){return[Uc,Wc,Kc]}},components:[],fetch:Qy(n.getColors(),n.hasCustomColors()),columns:n.getColorCols(),presets:"color",onItemAction:function(e,t){s.getOpt(e).each(function(e){"custom"===t?n.colorPicker(function(t){t.fold(function(){return no(e,wk)},function(t){c(e,t),Gy(t)})},"#ffffff"):c(e,"remove"===t?"":t)})}},o=t,pk.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:fs([Yv(o.providers.isDisabled),Gv(),vk.config({}),Qb.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:o.getSink,fetch:function(e){return Ew(function(e){return r.fetch(e)}).map(function(t){return D.from(Sb(Ke(ob(ma("menu-value"),t,function(t){r.onItemAction(e,t)},r.columns,r.presets,fp.CLOSE_ON_EXECUTE,x,o.providers),{movement:ib(r.columns,r.presets)})))})},parts:{menu:zp(0,0,r.presets)}})));return Yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:i.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[a,s.asSpec()]}]),fieldBehaviours:fs([wg("form-field-events",[fo(yk,function(t,n){s.getOpt(t).each(function(e){ri(e.element,"background-color",n.event.color)}),ro(t,aw,{name:e.name})}),fo(bk,function(e,t){Yb.getField(e).each(function(n){Gu.setValue(n,t.event.value),id.getCurrent(e).each(Sg.focus)})}),fo(wk,function(e){Yb.getField(e).each(function(){id.getCurrent(e).each(Sg.focus)})})])])})},_k=function(e,t,n){return{hue:e,saturation:t,value:n}},xk=ma("rgb-hex-update"),Ck=ma("slider-update"),Sk=ma("palette-update"),zk=Tf({schema:[Yt("dom")],name:"label"}),Tk=function(e){return Tf({name:e+"-edge",overrides:function(t){return t.model.manager.edgeActions[e].fold(function(){return{}},function(e){return{events:so([mo(fr(),function(t,n,r){return e(t,r)},[t]),mo(hr(),function(t,n,r){return e(t,r)},[t]),mo(pr(),function(t,n,r){r.mouseIsDown.get()&&e(t,r)},[t])])}})}})},Ek=Tk("top-left"),Ok=Tk("top"),Dk=Tk("top-right"),Nk=Tk("right"),Ak=Tk("bottom-right"),Rk=Tk("bottom"),Pk=Tk("bottom-left"),Bk=[zk,Tk("left"),Nk,Ok,Rk,Ek,Dk,Pk,Ak,Sf({name:"thumb",defaults:b({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:so([ho(fr(),e,"spectrum"),ho(dr(),e,"spectrum"),ho(mr(),e,"spectrum"),ho(hr(),e,"spectrum"),ho(pr(),e,"spectrum"),ho(yr(),e,"spectrum")])}}}),Sf({schema:[wn("mouseIsDown",function(){return kn(!1)})],name:"spectrum",overrides:function(e){var t=e.model.manager,n=function(n,r){return t.getValueFromEvent(r).map(function(r){return t.setValueFrom(n,e,r)})};return{behaviours:fs([gg.config({mode:"special",onLeft:function(n){return t.onLeft(n,e)},onRight:function(n){return t.onRight(n,e)},onUp:function(n){return t.onUp(n,e)},onDown:function(n){return t.onDown(n,e)}}),Sg.config({})]),events:so([fo(fr(),n),fo(dr(),n),fo(hr(),n),fo(pr(),function(t,r){e.mouseIsDown.get()&&n(t,r)})])}}})],Mk=b("slider.change.value"),Ik=function(e){var t=e.event.raw;return-1===t.type.indexOf("touch")?void 0!==t.clientX?D.some(t).map(function(e){return Di(e.clientX,e.clientY)}):D.none():void 0!==t.touches&&1===t.touches.length?D.some(t.touches[0]).map(function(e){return Di(e.clientX,e.clientY)}):D.none()},Lk=function(e){return e.model.minX},jk=function(e){return e.model.minY},Fk=function(e){return e.model.minX-1},Hk=function(e){return e.model.minY-1},Vk=function(e){return e.model.maxX},qk=function(e){return e.model.maxY},Uk=function(e){return e.model.maxX+1},Wk=function(e){return e.model.maxY+1},$k=function(e,t,n){return t(e)-n(e)},Xk=function(e){return $k(e,Vk,Lk)},Gk=function(e){return $k(e,qk,jk)},Kk=function(e){return Xk(e)/2},Yk=function(e){return Gk(e)/2},Jk=function(e){return e.stepSize},Zk=function(e){return e.snapToGrid},Qk=function(e){return e.snapStart},e_=function(e){return e.rounded},t_=function(e,t){return void 0!==e[t+"-edge"]},n_=function(e){return t_(e,"left")},r_=function(e){return t_(e,"right")},o_=function(e){return t_(e,"top")},a_=function(e){return t_(e,"bottom")},i_=function(e){return e.model.value.get()},c_=function(e){return{x:e}},s_=function(e){return{y:e}},l_=function(e,t){return{x:e,y:t}},u_=function(e,t){ro(e,Mk(),{value:t})},f_=function(e,t,n,r){return t>e?e:e>n?n:e===t?t-1:Math.max(t,e-r)},d_=function(e,t,n,r){return e>n?e:t>e?t:e===n?n+1:Math.min(n,e+r)},m_=function(e,t,n){return Math.max(t,Math.min(n,e))},g_=function(e){var t=e.min,n=e.max,r=e.range,o=e.value,a=e.step,i=e.snap,c=e.snapStart,s=e.rounded,l=e.hasMinEdge,u=e.hasMaxEdge,f=e.minBound,d=e.maxBound,m=e.screenRange,g=l?t-1:t,h=u?n+1:n;if(f>o)return g;if(o>d)return h;var p,v,y,b,w,k,_,x=(w=o,k=f,_=d,Math.min(_,Math.max(w,k))-k),C=m_(x/m*r+t,g,h);return i&&C>=t&&n>=C?(p=C,v=t,y=n,b=a,c.fold(function(){var e=p-v,t=Math.round(e/b)*b;return m_(v+t,v-1,y+1)},function(e){var t=(p-e)%b,n=Math.round(t/b),r=Math.floor((p-e)/b),o=Math.floor((y-e)/b),a=e+Math.min(o,r+n)*b;return Math.max(e,a)})):s?Math.round(C):C},h_=function(e){var t=e.min,n=e.max,r=e.range,o=e.value,a=e.hasMinEdge,i=e.hasMaxEdge,c=e.maxBound,s=e.maxOffset,l=e.centerMinEdge,u=e.centerMaxEdge;return t>o?a?0:l:o>n?i?c:u:(o-t)/r*s},p_="left",v_=function(e){return e.element.dom.getBoundingClientRect()},y_=function(e,t){return e[t]},b_=function(e){var t=v_(e);return y_(t,p_)},w_=function(e){var t=v_(e);return y_(t,"right")},k_=function(e){var t=v_(e);return y_(t,"top")},__=function(e){var t=v_(e);return y_(t,"bottom")},x_=function(e){var t=v_(e);return y_(t,"width")},C_=function(e){var t=v_(e);return y_(t,"height")},S_=function(e,t,n){return(e+t)/2-n},z_=function(e,t){var n=v_(e),r=v_(t),o=y_(n,p_),a=y_(n,"right"),i=y_(r,p_);return S_(o,a,i)},T_=function(e,t){var n=v_(e),r=v_(t),o=y_(n,"top"),a=y_(n,"bottom"),i=y_(r,"top");return S_(o,a,i)},E_=function(e,t){ro(e,Mk(),{value:t})},O_=function(e){return{x:e}},D_=function(e,t,n){var r={min:Lk(t),max:Vk(t),range:Xk(t),value:n,step:Jk(t),snap:Zk(t),snapStart:Qk(t),rounded:e_(t),hasMinEdge:n_(t),hasMaxEdge:r_(t),minBound:b_(e),maxBound:w_(e),screenRange:x_(e)};return g_(r)},N_=function(e){return function(t,n){return r=t,a=(e>0?d_:f_)(i_(o=n).x,Lk(o),Vk(o),Jk(o)),E_(r,O_(a)),D.some(a).map(C);var r,o,a}},A_=function(e,t,n,r,o,a){var i,c,s,l,u,f,d,m,g,h=(c=a,s=n,l=r,u=o,f=x_(i=t),d=l.bind(function(e){return D.some(z_(e,i))}).getOr(0),m=u.bind(function(e){return D.some(z_(e,i))}).getOr(f),g={min:Lk(c),max:Vk(c),range:Xk(c),value:s,hasMinEdge:n_(c),hasMaxEdge:r_(c),minBound:b_(i),minOffset:0,maxBound:w_(i),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},h_(g));return b_(t)-b_(e)+h},R_=N_(-1),P_=N_(1),B_=D.none,M_=D.none,I_={"top-left":D.none(),top:D.none(),"top-right":D.none(),right:D.some(function(e,t){u_(e,c_(Uk(t)))}),"bottom-right":D.none(),bottom:D.none(),"bottom-left":D.none(),left:D.some(function(e,t){u_(e,c_(Fk(t)))})},L_=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=D_(e,t,n),o=O_(r);return E_(e,o),r},setToMin:function(e,t){var n=Lk(t);E_(e,O_(n))},setToMax:function(e,t){var n=Vk(t);E_(e,O_(n))},findValueOfOffset:D_,getValueFromEvent:function(e){return Ik(e).map(function(e){return e.left})},findPositionOfValue:A_,setPositionFromValue:function(e,t,n,r){var o=i_(n),a=A_(e,r.getSpectrum(e),o.x,r.getLeftEdge(e),r.getRightEdge(e),n),i=Bi(t.element)/2;ri(t.element,"left",a-i+"px")},onLeft:R_,onRight:P_,onUp:B_,onDown:M_,edgeActions:I_}),j_=function(e,t){ro(e,Mk(),{value:t})},F_=function(e){return{y:e}},H_=function(e,t,n){var r={min:jk(t),max:qk(t),range:Gk(t),value:n,step:Jk(t),snap:Zk(t),snapStart:Qk(t),rounded:e_(t),hasMinEdge:o_(t),hasMaxEdge:a_(t),minBound:k_(e),maxBound:__(e),screenRange:C_(e)};return g_(r)},V_=function(e){return function(t,n){return r=t,a=(e>0?d_:f_)(i_(o=n).y,jk(o),qk(o),Jk(o)),j_(r,F_(a)),D.some(a).map(C);var r,o,a}},q_=function(e,t,n,r,o,a){var i,c,s,l,u,f,d,m,g,h=(c=a,s=n,l=r,u=o,f=C_(i=t),d=l.bind(function(e){return D.some(T_(e,i))}).getOr(0),m=u.bind(function(e){return D.some(T_(e,i))}).getOr(f),g={min:jk(c),max:qk(c),range:Gk(c),value:s,hasMinEdge:o_(c),hasMaxEdge:a_(c),minBound:k_(i),minOffset:0,maxBound:__(i),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},h_(g));return k_(t)-k_(e)+h},U_=D.none,W_=D.none,$_=V_(-1),X_=V_(1),G_={"top-left":D.none(),top:D.some(function(e,t){u_(e,s_(Hk(t)))}),"top-right":D.none(),right:D.none(),"bottom-right":D.none(),bottom:D.some(function(e,t){u_(e,s_(Wk(t)))}),"bottom-left":D.none(),left:D.none()},K_=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=H_(e,t,n),o=F_(r);return j_(e,o),r},setToMin:function(e,t){var n=jk(t);j_(e,F_(n))},setToMax:function(e,t){var n=qk(t);j_(e,F_(n))},findValueOfOffset:H_,getValueFromEvent:function(e){return Ik(e).map(function(e){return e.top})},findPositionOfValue:q_,setPositionFromValue:function(e,t,n,r){var o=i_(n),a=q_(e,r.getSpectrum(e),o.y,r.getTopEdge(e),r.getBottomEdge(e),n),i=Ti(t.element)/2;ri(t.element,"top",a-i+"px")},onLeft:U_,onRight:W_,onUp:$_,onDown:X_,edgeActions:G_}),Y_=function(e,t){ro(e,Mk(),{value:t})},J_=function(e,t){return{x:e,y:t}},Z_=function(e,t){return function(n,r){return a=n,i=r,c=e>0?d_:f_,s=(o=t)?i_(i).x:c(i_(i).x,Lk(i),Vk(i),Jk(i)),l=o?c(i_(i).y,jk(i),qk(i),Jk(i)):i_(i).y,Y_(a,J_(s,l)),D.some(s).map(C);var o,a,i,c,s,l}},Q_=Ik,ex=Z_(-1,!1),tx=Z_(1,!1),nx=Z_(-1,!0),rx=Z_(1,!0),ox={"top-left":D.some(function(e,t){u_(e,l_(Fk(t),Hk(t)))}),top:D.some(function(e,t){u_(e,l_(Kk(t),Hk(t)))}),"top-right":D.some(function(e,t){u_(e,l_(Uk(t),Hk(t)))}),right:D.some(function(e,t){u_(e,l_(Uk(t),Yk(t)))}),"bottom-right":D.some(function(e,t){u_(e,l_(Uk(t),Wk(t)))}),bottom:D.some(function(e,t){u_(e,l_(Kk(t),Wk(t)))}),"bottom-left":D.some(function(e,t){u_(e,l_(Fk(t),Wk(t)))}),left:D.some(function(e,t){u_(e,l_(Fk(t),Yk(t)))})},ax=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=D_(e,t,n.left),o=H_(e,t,n.top),a=J_(r,o);return Y_(e,a),a},setToMin:function(e,t){var n=Lk(t),r=jk(t);Y_(e,J_(n,r))},setToMax:function(e,t){var n=Vk(t),r=qk(t);Y_(e,J_(n,r))},getValueFromEvent:Q_,setPositionFromValue:function(e,t,n,r){var o=i_(n),a=A_(e,r.getSpectrum(e),o.x,r.getLeftEdge(e),r.getRightEdge(e),n),i=q_(e,r.getSpectrum(e),o.y,r.getTopEdge(e),r.getBottomEdge(e),n),c=Bi(t.element)/2,s=Ti(t.element)/2;ri(t.element,"left",a-c+"px"),ri(t.element,"top",i-s+"px")},onLeft:ex,onRight:tx,onUp:nx,onDown:rx,edgeActions:ox}),ix=ed({name:"Slider",configFields:[fn("stepSize",1),fn("onChange",v),fn("onChoose",v),fn("onInit",v),fn("onDragStart",v),fn("onDragEnd",v),fn("snapToGrid",!1),fn("rounded",!0),on("snapStart"),Jt("model",Ft("mode",{x:[fn("minX",0),fn("maxX",100),wn("value",function(e){return kn(e.mode.minX)}),Yt("getInitialValue"),Cc("manager",L_)],y:[fn("minY",0),fn("maxY",100),wn("value",function(e){return kn(e.mode.minY)}),Yt("getInitialValue"),Cc("manager",K_)],xy:[fn("minX",0),fn("maxX",100),fn("minY",0),fn("maxY",100),wn("value",function(e){return kn({x:e.mode.minX,y:e.mode.minY})}),Yt("getInitialValue"),Cc("manager",ax)]})),Ku("sliderBehaviours",[gg,Gu]),wn("mouseIsDown",function(){return kn(!1)})],partFields:Bk,factory:function(e,t){var n,r=function(t){return Ff(t,e,"thumb")},o=function(t){return Ff(t,e,"spectrum")},a=function(t){return jf(t,e,"left-edge")},i=function(t){return jf(t,e,"right-edge")},c=function(t){return jf(t,e,"top-edge")},s=function(t){return jf(t,e,"bottom-edge")},l=e.model,u=l.manager,f=function(t,n){u.setPositionFromValue(t,n,e,{getLeftEdge:a,getRightEdge:i,getTopEdge:c,getBottomEdge:s,getSpectrum:o})},d=function(t,n){l.value.set(n);var o=r(t);return f(t,o),e.onChange(t,o,n),D.some(!0)},m=function(t){var n=e.mouseIsDown.get();e.mouseIsDown.set(!1),n&&jf(t,e,"thumb").each(function(n){var r=l.value.get();e.onChoose(t,n,r)})},g=function(t,n){n.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,r(t))},h=function(t,n){n.stop(),e.onDragEnd(t,r(t)),m(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.sliderBehaviours,[gg.config({mode:"special",focusIn:function(t){return jf(t,e,"spectrum").map(gg.focusIn).map(C)}}),Gu.config({store:{mode:"manual",getValue:function(){return l.value.get()}}}),vs.config({channels:((n={})[Nu()]={onReceive:m},n)})]),events:so([fo(Mk(),function(e,t){d(e,t.event.value)}),bo(function(t){var n=l.getInitialValue();l.value.set(n);var a=r(t);f(t,a);var i=o(t);e.onInit(t,a,i,l.value.get())}),fo(fr(),g),fo(mr(),h),fo(hr(),g),fo(yr(),h)]),apis:{resetToMin:function(t){u.setToMin(t,e)},resetToMax:function(t){u.setToMax(t,e)},changeValue:d,refresh:f},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),cx=[Ku("formBehaviours",[Gu])],sx=function(e){return"<alloy.field."+e+">"},lx=function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.formBehaviours,[Gu.config({store:{mode:"manual",getValue:function(t){var n=Vf(t,e);return Ie(n,function(e,t){return e().bind(function(e){var n,r,o=id.getCurrent(e);return n=o,r=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+la(e.element)),n.fold(function(){return ve.error(r)},ve.value)}).map(Gu.getValue)})},setValue:function(t,n){
Me(n,function(n,r){jf(t,e,r).each(function(e){id.getCurrent(e).each(function(e){Gu.setValue(e,n)})})})}}})]),apis:{getField:function(t,n){return jf(t,e,n).bind(id.getCurrent)}}}},ux={getField:Ea(function(e,t,n){return e.getField(t,n)}),sketch:function(e){var t,n=(t=[],{field:function(e,n){return t.push(e),Pf("form",sx(e),n)},record:function(){return t}}),r=e(n),o=n.record(),a=Y(o,function(e){return Sf({name:e,pname:sx(e)})});return Kf("form",cx,a,lx,r)}},fx=ma("valid-input"),dx=ma("invalid-input"),mx=ma("validating-input"),gx="colorcustom.rgb.",hx=function(e,t,n,r){var o=function(n,r,o,a,i){var c,s,l=e(gx+"range"),u=[Yb.parts.label({dom:{tag:"label",innerHtml:o,attributes:{"aria-label":a}}}),Yb.parts.field({data:i,factory:yw,inputAttributes:z({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:fs([(c=r,s=n,jw.config({invalidClass:t("invalid"),notify:{onValidate:function(e){ro(e,mx,{type:c})},onValid:function(e){ro(e,fx,{type:c,value:Gu.getValue(e)})},onInvalid:function(e){ro(e,dx,{type:c,value:Gu.getValue(e)})}},validator:{validate:function(t){var n=Gu.getValue(t),r=s(n)?ve.value(!0):ve.error(e("aria.input.invalid"));return Ow(r)},validateOnLoad:!1}})),Qb.config({})]),onSetValue:function(e){jw.isInvalid(e)&&jw.run(e).get(v)}})],f="hex"!==r?[Yb.parts["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:u.concat(f)}},a=function(e,t){var n=t.red,r=t.green,o=t.blue;Gu.setValue(e,{red:n,green:r,blue:o})},i=_h({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(e,t){i.getOpt(e).each(function(e){ri(e.element,"background-color","#"+t.value)})};return Qf({factory:function(){var s={red:kn(D.some(255)),green:kn(D.some(255)),blue:kn(D.some(255)),hex:kn(D.some("ffffff"))},l=function(e){return s[e].get()},u=function(e,t){s[e].set(t)},f=function(e){var t=e.red,n=e.green,r=e.blue;u("red",D.some(t)),u("green",D.some(n)),u("blue",D.some(r))},d=function(e,t){var n=t.event;"hex"!==n.type?u(n.type,D.none()):r(e)},m=function(e,t,n){var r=parseInt(n,10);u(t,D.some(r)),l("red").bind(function(e){return l("green").bind(function(t){return l("blue").map(function(n){return Ry(e,t,n,1)})})}).each(function(t){var n,r,o=(n=e,r=Ty(t),ux.getField(n,"hex").each(function(e){Sg.isFocused(e)||Gu.setValue(n,{hex:r.value})}),r);c(e,o)})},g=function(e,t){var r=t.event;"hex"===r.type?function(e,t){n(e);var r=ky(t);u("hex",D.some(t));var o=My(r);a(e,o),f(o),ro(e,xk,{hex:r}),c(e,r)}(e,r.value):m(e,r.type,r.value)},h=function(t){return{label:e(gx+t+".label"),description:e(gx+t+".description")}},p=h("red"),v=h("green"),y=h("blue"),b=h("hex");return Ke(ux.sketch(function(n){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[n.field("red",Yb.sketch(o(Py,"red",p.label,p.description,255))),n.field("green",Yb.sketch(o(Py,"green",v.label,v.description,255))),n.field("blue",Yb.sketch(o(Py,"blue",y.label,y.description,255))),n.field("hex",Yb.sketch(o(Cy,"hex",b.label,b.description,"ffffff"))),i.asSpec()],formBehaviours:fs([jw.config({invalidClass:t("form-invalid")}),wg("rgb-form-events",[fo(fx,g),fo(dx,d),fo(mx,d)])])}}),{apis:{updateHex:function(e,t){var n,r;Gu.setValue(e,{hex:t.value}),n=e,r=My(t),a(n,r),f(r),c(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(e,t,n){e.updateHex(t,n)}},extraApis:{}})},px=function(e,t){var n=ix.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=ix.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),o=function(e,t){var n,r,o=e.width,a=e.height,i=e.getContext("2d");null!==i&&(i.fillStyle=t,i.fillRect(0,0,o,a),(n=i.createLinearGradient(0,0,o,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),i.fillStyle=n,i.fillRect(0,0,o,a),(r=i.createLinearGradient(0,0,0,a)).addColorStop(0,"rgba(0,0,0,0)"),r.addColorStop(1,"rgba(0,0,0,1)"),i.fillStyle=r,i.fillRect(0,0,o,a))};return Qf({factory:function(){var e=b({x:0,y:0}),a=fs([id.config({find:D.some}),Sg.config({})]);return ix.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:e},rounded:!1,components:[n,r],onChange:function(e,t,n){ro(e,Sk,{value:n})},onInit:function(e,t,n){o(n.element.dom,Ly(jy))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(e,t,n){var r,a;r=n,a=t.components()[0].element.dom,o(a,Ly(r))}},extraApis:{}})},vx=function(e,t){return Qf({name:"ColourPicker",configFields:[Yt("dom"),fn("onValidHex",v),fn("onInvalidHex",v)],factory:function(n){var r,o,a,i,c,s=hx(e,t,n.onValidHex,n.onInvalidHex),l=px(0,t),u={paletteRgba:kn(jy)},f=_h(l.sketch({})),d=_h(s.sketch({})),m=function(e,t){f.getOpt(e).each(function(e){var n=My(t);u.paletteRgba.set(n),l.setRgba(e,n)})},g=function(e,t){d.getOpt(e).each(function(e){s.updateHex(e,t)})},h=function(e,t,n){J(n,function(n){n(e,t)})};return{uid:n.uid,dom:n.dom,components:[f.asSpec(),(a=t,i=ix.parts.spectrum({dom:{tag:"div",classes:[a("hue-slider-spectrum")],attributes:{role:"presentation"}}}),c=ix.parts.thumb({dom:{tag:"div",classes:[a("hue-slider-thumb")],attributes:{role:"presentation"}}}),ix.sketch({dom:{tag:"div",classes:[a("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:b({y:0})},components:[i,c],sliderBehaviours:fs([Sg.config({})]),onChange:function(e,t,n){ro(e,Ck,{value:n})}})),d.asSpec()],behaviours:fs([wg("colour-picker-events",[fo(Sk,(o=[g],function(e,t){var n,r,a,i,c,s,l,f,d,m=t.event.value,g=u.paletteRgba.get(),p=(i=a=0,c=(n=g).red/255,s=n.green/255,l=n.blue/255,f=Math.min(c,Math.min(s,l)),d=Math.max(c,Math.max(s,l)),f===d?_k(0,0,100*(i=f)):(a=60*((a=c===f?3:l===f?1:5)-(c===f?s-l:l===f?c-s:l-c)/(d-f)),r=(d-f)/d,i=d,_k(Math.round(a),Math.round(100*r),Math.round(100*i)))),v=_k(p.hue,m.x,100-m.y),y=By(v),b=Ty(y);h(e,b,o)})),fo(Ck,(r=[m,g],function(e,t){var n,o,a,i=t.event.value,c=(n=i.y,o=_k((100-n)/100*360,100,100),a=By(o),Ty(a));h(e,c,r)}))]),id.config({find:function(e){return d.getOpt(e)}}),gg.config({mode:"acyclic"})])}}})},yx=function(){return id.config({find:D.some})},bx=function(e){return id.config({find:e.getOpt})},wx=function(e){return id.config({find:function(t){return Io(t.element,e).bind(function(e){return t.getSystem().getByDom(e).toOptional()})}})},kx={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},_x=function(e){return kx[e]},xx=tinymce.util.Tools.resolve("tinymce.Resource"),Cx=tinymce.util.Tools.resolve("tinymce.util.Tools"),Sx=wt([fn("preprocess",w),fn("postprocess",w)]),zx=function(e,t,n){return Gu.config(Ke({store:{mode:"manual",getValue:t,setValue:n}},e.map(function(e){return{store:{initialValue:e}}}).getOr({})))},Tx=function(e,t,n){return zx(e,function(e){return t(e.element)},function(e,t){return n(e.element,t)})},Ex=function(e,t){var n=It("RepresentingConfigs.memento processors",Sx,t);return Gu.config({store:{mode:"manual",getValue:function(t){var r=e.get(t),o=Gu.getValue(r);return n.postprocess(o)},setValue:function(t,r){var o=n.preprocess(r),a=e.get(t);Gu.setValue(a,o)}}})},Ox=zx,Dx=function(e){return Tx(e,ea,ta)},Nx=function(e){return Gu.config({store:{mode:"memory",initialValue:e}})},Ax=function(e,t){var n=function(e,t){t.stop()},r=function(e){return function(t,n){J(e,function(e){e(t,n)})}},o=function(e,t){var n;bv.isDisabled(e)||(n=t.event.raw,i(e,n.dataTransfer.files))},a=function(e,t){var n=t.event.raw.target;i(e,n.files)},i=function(n,r){var o,a,i;Gu.setValue(n,(o=r,a=t,i=Cx.explode(a.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),Q(me(o),function(e){return X(i,function(t){return An(e.name.toLowerCase(),"."+t.toLowerCase())})}))),ro(n,aw,{name:e.name})},c=_h({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:fs([wg("input-file-events",[vo(zr()),vo(Ir())])])}),s=e.label.map(function(e){return ow(e,t)}),l=Yb.parts.field({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:fs([Nx([]),yx(),bv.config({}),Ig.config({toggleClass:"dragenter",toggleOnExecute:!1}),wg("dropzone-events",[fo("dragenter",r([n,Ig.toggle])),fo("dragleave",r([n,Ig.toggle])),fo("dragover",n),fo("drop",r([n,o])),fo(Sr(),a)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},kh.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(e){c.get(e).element.dom.click()},buttonBehaviours:fs([Qb.config({}),Yv(t.isDisabled),Gv()])})]}]}}}});return tw(s,l,["tox-form__group--stretched"],[])},Rx=ma("alloy-fake-before-tabstop"),Px=ma("alloy-fake-after-tabstop"),Bx=function(e){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:fs([Sg.config({ignore:!0}),Qb.config({})])}},Mx=function(e){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Bx([Rx]),e,Bx([Px])],behaviours:fs([wx(1)])}},Ix=function(e,t){ro(e,_r(),{raw:{which:9,shiftKey:t}})},Lx=function(e,t){var n=t.element;Ga(n,Rx)?Ix(e,!0):Ga(n,Px)&&Ix(e,!1)},jx=function(e){return Nb(e,["."+Rx,"."+Px].join(","),x)},Fx=!(Zn().browser.isIE()||Zn().browser.isEdge()),Hx=function(e,t){var n,r,o=Fx&&e.sandboxed,a=z(z({},e.label.map(function(e){return{title:e}}).getOr({})),o?{sandbox:"allow-scripts allow-same-origin"}:{}),i=(n=o,r=kn(""),{getValue:function(){return r.get()},setValue:function(e,t){var o;n?ra(e.element,"srcdoc",t):(ra(e.element,"src","javascript:''"),(o=e.element.dom.contentWindow.document).open(),o.write(t),o.close()),r.set(t)}}),c=e.label.map(function(e){return ow(e,t)}),s=Yb.parts.field({factory:{sketch:function(e){return Mx({uid:e.uid,dom:{tag:"iframe",attributes:a},behaviours:fs([Qb.config({}),Sg.config({}),Ox(D.none(),i.getValue,i.setValue)])})}}});return tw(c,s,["tox-form__group--stretched"],[])},Vx=function(e,t){return Wx(document.createElement("canvas"),e,t)},qx=function(e){var t=Vx(e.width,e.height);return Ux(t).drawImage(e,0,0),t},Ux=function(e){return e.getContext("2d")},Wx=function(e,t,n){return e.width=t,e.height=n,e},$x=function(e){return e.naturalWidth||e.width},Xx=function(e){return e.naturalHeight||e.height},Gx=window.Promise?window.Promise:(Ww=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Yw(e,Gw(i,this),Gw(c,this))},$w=window,Xw=Ww.immediateFn||"function"==typeof $w.setImmediate&&$w.setImmediate||function(e){return setTimeout(e,1)},Gw=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(t,n)}},Kw=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Yw=function(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(o){if(r)return;r=!0,n(o)}},Ww.prototype["catch"]=function(e){return this.then(null,e)},Ww.prototype.then=function(e,t){var n=this;return new Ww(function(r,o){a.call(n,new l(e,t,r,o))})},Ww.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Array.prototype.slice.call(1===e.length&&Kw(e[0])?e[0]:e);return new Ww(function(e,t){if(0===n.length)return e([]);for(var r=n.length,o=function(a,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var c=i.then;if("function"==typeof c)return void c.call(i,function(e){o(a,e)},t)}n[a]=i,0==--r&&e(n)}catch(s){t(s)}},a=0;a<n.length;a++)o(a,n[a])})},Ww.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Ww?e:new Ww(function(t){t(e)})},Ww.reject=function(e){return new Ww(function(t,n){n(e)})},Ww.race=function(e){return new Ww(function(t,n){for(var r=0,o=e;r<o.length;r++)o[r].then(t,n)})},Ww),Kx=function(e){return new Gx(function(t,n){(function(e){var t=e.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return D.none();for(var r=n[1],o=t[1],a=atob(o),i=a.length,c=Math.ceil(i/1024),s=new Array(c),l=0;c>l;++l){for(var u=1024*l,f=Math.min(1024+u,i),d=new Array(f-u),m=u,g=0;f>m;++g,++m)d[g]=a[m].charCodeAt(0);s[l]=new Uint8Array(d)}return D.some(new Blob(s,{type:r}))})(e).fold(function(){n("uri is not base64: "+e)},t)})},Yx=function(e,t,n){return t=t||"image/png",j(HTMLCanvasElement.prototype.toBlob)?new Gx(function(r,o){e.toBlob(function(e){e?r(e):o()},t,n)}):Kx(e.toDataURL(t,n))},Jx=function(e){return t=e,new Gx(function(e,n){var r=URL.createObjectURL(t),o=new Image,a=function(){o.removeEventListener("load",i),o.removeEventListener("error",c)},i=function(){a(),e(o)},c=function(){a(),n("Unable to load data of type "+t.type+": "+r)};o.addEventListener("load",i),o.addEventListener("error",c),o.src=r,o.complete&&setTimeout(i,0)}).then(function(e){Zx(e);var t=Vx($x(e),Xx(e));return Ux(t).drawImage(e,0,0),t});var t},Zx=function(e){URL.revokeObjectURL(e.src)},Qx=function(e,t,n){var r=t.type,o=b(r),a=b(n),i=function(t,n){return e.then(function(e){return o=n,r=(r=t)||"image/png",e.toDataURL(r,o);var r,o})};return{getType:o,toBlob:function(){return Gx.resolve(t)},toDataURL:a,toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(t,n){return e.then(function(e){return Yx(e,t,n)})},toAdjustedDataURL:i,toAdjustedBase64:function(e,t){return i(e,t).then(function(e){return e.split(",")[1]})},toCanvas:function(){return e.then(qx)}}},eC=function(e,t){return Yx(e,t).then(function(t){return Qx(Gx.resolve(e),t,e.toDataURL())})},tC=function(e){return t=e,new Gx(function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t)}).then(function(t){return Qx(Jx(e),e,t)});var t},nC=function(e,t,n){var r="string"==typeof e?parseFloat(e):e;return r>n?r=n:t>r&&(r=t),r},rC=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},oC=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],aC=function(e,t){for(var n,r=[],o=new Array(25),a=0;5>a;a++){for(var i=0;5>i;i++)r[i]=t[i+5*a];for(i=0;5>i;i++){for(var c=n=0;5>c;c++)n+=e[i+5*c]*r[c];o[i+5*a]=n}}return o},iC=function(e,t){return e.toCanvas().then(function(n){return cC(n,e.getType(),t)})},cC=function(e,t,n){var r=Ux(e),o=function(e,t){for(var n,r,o,a,i=e.data,c=t[0],s=t[1],l=t[2],u=t[3],f=t[4],d=t[5],m=t[6],g=t[7],h=t[8],p=t[9],v=t[10],y=t[11],b=t[12],w=t[13],k=t[14],_=t[15],x=t[16],C=t[17],S=t[18],z=t[19],T=0;T<i.length;T+=4)n=i[T],r=i[T+1],o=i[T+2],a=i[T+3],i[T]=n*c+r*s+o*l+a*u+f,i[T+1]=n*d+r*m+o*g+a*h+p,i[T+2]=n*v+r*y+o*b+a*w+k,i[T+3]=n*_+r*x+o*C+a*S+z;return e}(r.getImageData(0,0,e.width,e.height),n);return r.putImageData(o,0,0),eC(e,t)},sC=function(e,t,n){var r=Ux(e),o=function(e,t,n){for(var r=function(e,t,n){return e>n?e=n:t>e&&(e=t),e},o=Math.round(Math.sqrt(n.length)),a=Math.floor(o/2),i=e.data,c=t.data,s=e.width,l=e.height,u=0;l>u;u++)for(var f=0;s>f;f++){for(var d=0,m=0,g=0,h=0;o>h;h++)for(var p=0;o>p;p++){var v=r(f+p-a,0,s-1),y=4*(r(u+h-a,0,l-1)*s+v),b=n[h*o+p];d+=i[y]*b,m+=i[1+y]*b,g+=i[2+y]*b}var w=4*(u*s+f);c[w]=r(d,0,255),c[1+w]=r(m,0,255),c[2+w]=r(g,0,255)}return t}(r.getImageData(0,0,e.width,e.height),o=r.getImageData(0,0,e.width,e.height),n);return r.putImageData(o,0,0),eC(e,t)},lC=function(e){return function(t,n){return iC(t,e(rC(),n))}},uC=(Jw=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(e){return iC(e,Jw)}),fC=lC(function(e,t){return t=nC(255*t,-255,255),aC(e,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}),dC=lC(function(e,t){var n;return t=nC(t,-1,1),n=(t*=100)<0?127+t/100*127:127*(n=0===(n=t%1)?oC[t]:oC[Math.floor(t)]*(1-n)+oC[Math.floor(t)+1]*n)+127,aC(e,[n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}),mC=(Zw=[0,-1,0,-1,5,-1,0,-1,0],function(e){return n=Zw,(t=e).toCanvas().then(function(e){return sC(e,t.getType(),n)});var t,n}),gC=(Qw=function(e,t){return 255*Math.pow(e/255,1-t)},function(e,t){return e.toCanvas().then(function(n){return function(e,t,n){for(var r=Ux(e),o=new Array(256),a=0;a<o.length;a++)o[a]=Qw(a,n);var i=function(e,t){for(var n=e.data,r=0;r<n.length;r+=4)n[r]=t[n[r]],n[r+1]=t[n[r+1]],n[r+2]=t[n[r+2]];return e}(r.getImageData(0,0,e.width,e.height),o);return r.putImageData(i,0,0),eC(e,t)}(n,e.getType(),t)})}),hC=function(e,t,n){var r=$x(e),o=Xx(e),a=t/r,i=n/o,c=!1;(.5>a||a>2)&&(a=.5>a?.5:2,c=!0),(.5>i||i>2)&&(i=.5>i?.5:2,c=!0);var s=pC(e,a,i);return c?s.then(function(e){return hC(e,t,n)}):s},pC=function(e,t,n){return new Gx(function(r){var o=$x(e),a=Xx(e),i=Math.floor(o*t),c=Math.floor(a*n),s=Vx(i,c);Ux(s).drawImage(e,0,0,o,a,0,0,i,c),r(s)})},vC=function(e,t,n){var r=Vx(e.width,e.height),o=Ux(r),a=0,i=0;return 90!==(n=0>n?360+n:n)&&270!==n||Wx(r,r.height,r.width),90!==n&&180!==n||(a=r.width),270!==n&&180!==n||(i=r.height),o.translate(a,i),o.rotate(n*Math.PI/180),o.drawImage(e,0,0),eC(r,t)},yC=function(e,t,n){var r=Vx(e.width,e.height),o=Ux(r);return"v"===n?(o.scale(1,-1),o.drawImage(e,0,-r.height)):(o.scale(-1,1),o.drawImage(e,-r.width,0)),eC(r,t)},bC=function(e,t,n,r,o,a){var i=Vx(o,a);return Ux(i).drawImage(e,-n,-r),eC(i,t)},wC=function(e){return uC(e)},kC=function(e){return mC(e)},_C=function(e,t){return gC(e,t)},xC=function(e,t,n,r){return iC(e,(o=rC(),i=n,c=r,a=nC(a=t,0,2),i=nC(i,0,2),c=nC(c,0,2),aC(o,[a,0,0,0,0,0,i,0,0,0,0,0,c,0,0,0,0,0,1,0,0,0,0,0,1])));var o,a,i,c},CC=function(e,t){return fC(e,t)},SC=function(e,t){return dC(e,t)},zC=function(e,t){return r=t,(n=e).toCanvas().then(function(e){return yC(e,n.getType(),r)});var n,r},TC=function(e,t,n,r,o){return i=t,c=n,s=r,l=o,(a=e).toCanvas().then(function(e){return bC(e,a.getType(),i,c,s,l)});var a,i,c,s,l},EC=function(e,t,n){return o=t,a=n,(r=e).toCanvas().then(function(e){return hC(e,o,a).then(function(e){return eC(e,r.getType())})});var r,o,a},OC=function(e,t){return r=t,(n=e).toCanvas().then(function(e){return vC(e,n.getType(),r)});var n,r},DC=function(e,t){return z({dom:{tag:"span",innerHtml:e,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},NC=function(e,t){return DC(Ch(e,t),{})},AC=function(e,t){return DC(Ch(e,t),{behaviours:fs([bg.config({})])})},RC=function(e,t,n){return{dom:{tag:"span",innerHtml:n.translate(e),classes:[t+"__select-label"]},behaviours:fs([bg.config({})])}},PC=ma("toolbar.button.execute"),BC=((ek={})[Br()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],ek),MC=ma("update-menu-text"),IC=ma("update-menu-icon"),LC=function(t,r,o){var a=kn(v),i=t.text.map(function(e){return _h(RC(e,r,o.providers))}),c=t.icon.map(function(e){return _h(AC(e,o.providers.icons))}),s=function(e,t){var n=Gu.getValue(e);return Sg.focus(n),ro(n,"keydown",{raw:t.event.raw}),pk.close(n),D.some(!0)},l=t.role.fold(function(){return{}},function(e){return{role:e}}),u=t.tooltip.fold(function(){return{}},function(e){var t=o.providers.translate(e);return{title:t,"aria-label":t}});return _h(pk.sketch(z(z(z({},t.uid?{uid:t.uid}:{}),l),{dom:{tag:"button",classes:[r,r+"--select"].concat(Y(t.classes,function(e){return r+"--"+e})),attributes:z({},u)},components:ry([c.map(function(e){return e.asSpec()}),i.map(function(e){return e.asSpec()}),D.some({dom:{tag:"div",classes:[r+"__select-chevron"],innerHtml:Ch("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:fs(n(t.dropdownBehaviours,[Yv(function(){return t.disabled||o.providers.isDisabled()}),Gv(),vk.config({}),bg.config({}),wg("dropdown-events",[ey(t,a),ty(t,a)]),wg("menubutton-update-display-text",[fo(MC,function(e,t){i.bind(function(t){return t.getOpt(e)}).each(function(e){bg.set(e,[wi(o.providers.translate(t.event.text))])})}),fo(IC,function(e,t){c.bind(function(t){return t.getOpt(e)}).each(function(e){bg.set(e,[AC(t.event.icon,o.providers.icons)])})})])])),eventOrder:Ke(BC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:fs([gg.config({mode:"special",onLeft:s,onRight:s})]),lazySink:o.getSink,toggleClass:r+"--active",parts:{menu:zp(0,t.columns,t.presets)},fetch:function(n){return Ew(e(t.fetch,n))}}))).asSpec()},jC=function(e){return"separator"===e.type},FC={type:"separator"},HC=function(e,t){var n=te(e,function(e,n){return R(n)?""===n?e:"|"===n?0<e.length&&!jC(e[e.length-1])?e.concat([FC]):e:Ue(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n])},[]);return 0<n.length&&jC(n[n.length-1])&&n.pop(),n},VC=function(e,t){return Ue(e,"getSubmenuItems")?(r=t,o=(n=e).getSubmenuItems(),a=qC(o,r),{item:n,menus:Ke(a.menus,it(n.value,a.items)),expansions:Ke(a.expansions,it(n.value,n.value))}):{item:e,menus:{},expansions:{}};var n,r,o,a},qC=function(e,t){var n=HC(R(e)?e.split(" "):e,t);return ee(n,function(e,n){var r=function(e){if(jC(e))return e;var t=qe(e,"value").getOrThunk(function(){return ma("generated-menu-item")});return Ke({value:t},e)}(n),o=VC(r,t);return{menus:Ke(e.menus,o.menus),items:[o.item].concat(e.items),expansions:Ke(e.expansions,o.expansions)}},{menus:{},expansions:{},items:[]})},UC=function(e,t,n,r){var o=ma("primary-menu"),a=qC(e,n.shared.providers.menuItems());if(0===a.items.length)return D.none();var i=Cb(o,a.items,t,n,r),c=Ie(a.menus,function(e,r){return Cb(r,e,t,n,!1)}),s=Ke(c,it(o,i));return D.from(ch.tieredData(o,s,a.expansions))},WC=function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)},setActive:function(t){var n=e.element;t?(Wa(n,"tox-tbtn--enabled"),ra(n,"aria-pressed",!0)):(Xa(n,"tox-tbtn--enabled"),ca(n,"aria-pressed"))},isActive:function(){return Ga(e.element,"tox-tbtn--enabled")}}},$C=function(e,t,n,r){return LC({text:e.text,icon:e.icon,tooltip:e.tooltip,role:r,fetch:function(t,r){e.fetch(function(e){r(UC(e,fp.CLOSE_ON_EXECUTE,n,!1))})},onSetup:e.onSetup,getApi:WC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Qb.config({})]},t,n.shared)},XC=function(e,t,n){return function(r){r(Y(e,function(e){var r,o,a=e.text.fold(function(){return{}},function(e){return{text:e}});return z(z({type:e.type,active:!1},a),{onAction:function(e){var r=!e.isActive();e.setActive(r),o.storage.set(r),n.shared.getSink().each(function(e){t().getOpt(e).each(function(e){bs(e.element),ro(e,sw,{name:o.name,value:o.storage.get()})})})},onSetup:(r=o=e,function(e){e.setActive(r.storage.get())})})}))}},GC=function(e,t,n,r,o,a){void 0===n&&(n=[]);var i=t.fold(function(){return{}},function(e){return{action:e}}),c=z({buttonBehaviours:fs([Yv(function(){return e.disabled||a.isDisabled()}),Gv(),Qb.config({}),wg("button press",[uo("click"),uo("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),s=Ke(c,{dom:r});return Ke(s,{components:o})},KC=function(e,t,n,r){void 0===r&&(r=[]);var o={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(function(e){return{"aria-label":n.translate(e),title:n.translate(e)}}).getOr({})},a=e.icon.map(function(e){return NC(e,n.icons)}),i=ry([a]);return GC(e,t,r,o,i,n)},YC=function(e,t,n,r){void 0===r&&(r=[]);var o=KC(e,D.some(t),n,r);return kh.sketch(o)},JC=function(e,t,r,o,a){void 0===o&&(o=[]),void 0===a&&(a=[]);var i=r.translate(e.text),c=e.icon?e.icon.map(function(e){return NC(e,r.icons)}):D.none(),s=c.isSome()?ry([c]):[],l=c.isSome()?{}:{innerHtml:i},u=n(e.primary||e.borderless?["tox-button"]:["tox-button","tox-button--secondary"],c.isSome()?["tox-button--icon"]:[],e.borderless?["tox-button--naked"]:[],a),f=z(z({tag:"button",classes:u},l),{attributes:{title:i}});return GC(e,t,o,f,s,r)},ZC=function(e,t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var a=JC(e,D.some(t),n,r,o);return kh.sketch(a)},QC=function(e,t){return function(n){"custom"===t?ro(n,sw,{name:e,value:{}}):"submit"===t?no(n,lw):"cancel"===t?no(n,cw):console.error("Unknown button type: ",t)}},eS=function(e,t,n){if("menu"===t){var r=e,o=z(z({},e),{onSetup:function(t){return t.setDisabled(e.disabled),v},fetch:XC(r.items,function(){return a},n)}),a=_h($C(o,"tox-tbtn",n,D.none()));return a.asSpec()}if("custom"===(s=t)||"cancel"===s||"submit"===s){var i=QC(e.name,t),c=z(z({},e),{borderless:!1});return ZC(c,i,n.shared.providers,[])}var s;console.error("Unknown footer button type: ",t)},tS=function(e,t){var n,r,o=QC(e.name,"custom");return n=D.none(),r=Yb.parts.field(z({factory:kh},JC(e,D.some(o),t,[Nx(""),yx()]))),tw(n,r,[],[])},nS=b([fn("field1Name","field1"),fn("field2Name","field2"),_c("onLockedChange"),yc(["lockClass"]),fn("locked",!1),Zu("coupledFieldBehaviours",[id,Gu])]),rS=function(e,t){return Sf({factory:Yb,name:e,overrides:function(e){return{fieldBehaviours:fs([wg("coupled-input-behaviour",[fo(Cr(),function(n){jf(n,e,t).bind(id.getCurrent).each(function(t){jf(n,e,"lock").each(function(r){Ig.isOn(r)&&e.onLockedChange(n,t,r)})})})])])}}})},oS=b([rS("field1","field2"),rS("field2","field1"),Sf({factory:kh,schema:[Yt("dom")],name:"lock",overrides:function(e){return{buttonBehaviours:fs([Ig.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])}}})]),aS=ed({name:"FormCoupledInputs",configFields:nS(),partFields:oS(),factory:function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Qu(e.coupledFieldBehaviours,[id.config({find:D.some}),Gu.config({store:{mode:"manual",getValue:function(t){var n=Uf(t,e,["field1","field2"]),r={};return r[e.field1Name]=Gu.getValue(n.field1()),r[e.field2Name]=Gu.getValue(n.field2()),r},setValue:function(t,n){var r=Uf(t,e,["field1","field2"]);We(n,e.field1Name)&&Gu.setValue(r.field1(),n[e.field1Name]),We(n,e.field2Name)&&Gu.setValue(r.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return jf(t,e,"field1")},getField2:function(t){return jf(t,e,"field2")},getLock:function(t){return jf(t,e,"lock")}}}},apis:{getField1:function(e,t){return e.getField1(t)},getField2:function(e,t){return e.getField2(t)},getLock:function(e,t){return e.getLock(t)}}}),iS=function(e){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return ve.error(e);var n=parseFloat(t[1]),r=t[2];return ve.value({value:n,unit:r})},cS=function(e,t){var n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},r=function(e){return Object.prototype.hasOwnProperty.call(n,e)};return e.unit===t?D.some(e.value):r(e.unit)&&r(t)?n[e.unit]===n[t]?D.some(e.value):D.some(e.value/n[e.unit]*n[t]):D.none()},sS=function(){return D.none()},lS=function(e,t){var n,r,o,a=iS(e).toOptional(),i=iS(t).toOptional();return r=i,o=function(e,t){return cS(e,t.unit).map(function(e){return t.value/e}).map(function(e){return n=e,r=t.unit,function(e){return cS(e,r).map(function(e){return{value:e*n,unit:r}})};var n,r}).getOr(sS)},((n=a).isSome()&&r.isSome()?D.some(o(n.getOrDie(),r.getOrDie())):D.none()).getOr(sS)},uS=function(e,t){var n=sS,r=ma("ratio-event"),o=aS.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Ch("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Ch("unlock",t.icons)}}],buttonBehaviours:fs([bv.config({disabled:function(){return e.disabled||t.isDisabled()}}),Gv(),Qb.config({})])}),a=function(e){return{dom:{tag:"div",classes:["tox-form__group"]},components:e}},i=function(n){return Yb.parts.field({factory:yw,inputClasses:["tox-textfield"],inputBehaviours:fs([bv.config({disabled:function(){return e.disabled||t.isDisabled()}}),Gv(),Qb.config({}),wg("size-input-events",[fo(wr(),function(e){ro(e,r,{isField1:n})}),fo(Sr(),function(t){ro(t,aw,{name:e.name})})])]),selectOnFocus:!1})},c=function(e){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}},s=aS.parts.field1(a([Yb.parts.label(c("Width")),i(!0)])),l=aS.parts.field2(a([Yb.parts.label(c("Height")),i(!1)]));return aS.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,l,a([c("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(e,t){iS(Gu.getValue(e)).each(function(e){n(e).each(function(e){var n,r,o,a;Gu.setValue(t,(o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},-1!==(a=(n=e).value.toFixed((r=n.unit)in o?o[r]:1)).indexOf(".")&&(a=a.replace(/\.?0*$/,"")),a+n.unit))})})},coupledFieldBehaviours:fs([bv.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){aS.getField1(e).bind(Yb.getField).each(bv.disable),aS.getField2(e).bind(Yb.getField).each(bv.disable),aS.getLock(e).each(bv.disable)},onEnabled:function(e){aS.getField1(e).bind(Yb.getField).each(bv.enable),aS.getField2(e).bind(Yb.getField).each(bv.enable),aS.getLock(e).each(bv.enable)}}),Gv(),wg("size-input-events2",[fo(r,function(e,t){var r=t.event.isField1,o=r?aS.getField1(e):aS.getField2(e),a=r?aS.getField2(e):aS.getField1(e),i=o.map(Gu.getValue).getOr(""),c=a.map(Gu.getValue).getOr("");n=lS(i,c)})])])})},fS={undo:b(ma("undo")),redo:b(ma("redo")),zoom:b(ma("zoom")),back:b(ma("back")),apply:b(ma("apply")),swap:b(ma("swap")),transform:b(ma("transform")),tempTransform:b(ma("temp-transform")),transformApply:b(ma("transform-apply"))},dS=b("save-state"),mS=b("disable"),gS=b("enable"),hS={formActionEvent:sw,saveState:dS,disable:mS,enable:gS},pS=function(e,t){var n=function(e,n,r,o){return _h(ZC({name:e,text:e,disabled:r,primary:o,icon:D.none(),borderless:!1},n,t))},r=function(e,n,r,o){return _h(YC({name:e,icon:D.some(e),tooltip:D.some(n),disabled:o,primary:!1,borderless:!1},r,t))},o=function(e,t){e.map(function(e){var n=e.get(t);n.hasConfigured(bv)&&bv.disable(n)})},a=function(e,t){e.map(function(e){var n=e.get(t);n.hasConfigured(bv)&&bv.enable(n)})},i={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},c=v,s=function(e,t,n){ro(e,t,n)},l=function(e){return no(e,hS.disable())},u=function(e){return no(e,hS.enable())},f=function(e,t){l(e),s(e,fS.transform(),{transform:t}),u(e)},d=function(e){return function(){Q.getOpt(e).each(function(e){bg.set(e,[J])})}},m=function(e,t){l(e),s(e,fS.transformApply(),{transform:t,swap:d(e)}),u(e)},g=function(){return n("Back",function(e){return s(e,fS.back(),{swap:d(e)})},!1,!1)},h=function(){return _h({dom:{tag:"div",classes:["tox-spacer"]},behaviours:fs([bv.config({})])})},p=function(){return n("Apply",function(e){return s(e,fS.apply(),{swap:d(e)})},!0,!0)},y=[g(),h(),n("Apply",function(t){m(t,function(t){var n=e.getRect();return TC(t,n.x,n.y,n.w,n.h)}),e.hideCrop()},!1,!0)],w=$b.sketch({dom:i,components:y.map(function(e){return e.asSpec()}),containerBehaviours:fs([wg("image-tools-crop-buttons-events",[fo(hS.disable(),function(e){o(y,e)}),fo(hS.enable(),function(e){a(y,e)})])])}),k=_h(uS({name:"size",label:D.none(),constrain:!0,disabled:!1},t)),_=[g(),h(),k,h(),n("Apply",function(e){k.getOpt(e).each(function(t){var n,r,o=Gu.getValue(t),a=parseInt(o.width,10),i=parseInt(o.height,10),c=(n=a,r=i,function(e){return EC(e,n,r)});m(e,c)})},!1,!0)],x=$b.sketch({dom:i,components:_.map(function(e){return e.asSpec()}),containerBehaviours:fs([wg("image-tools-resize-buttons-events",[fo(hS.disable(),function(e){o(_,e)}),fo(hS.enable(),function(e){a(_,e)})])])}),C=function(e,t){return function(n){return e(n,t)}},S=C(zC,"h"),z=C(zC,"v"),T=C(OC,-90),E=C(OC,90),O=function(e,t){
var n,r;r=t,l(n=e),s(n,fS.tempTransform(),{transform:r}),u(n)},N=[g(),h(),r("flip-horizontally","Flip horizontally",function(e){O(e,S)},!1),r("flip-vertically","Flip vertically",function(e){O(e,z)},!1),r("rotate-left","Rotate counterclockwise",function(e){O(e,T)},!1),r("rotate-right","Rotate clockwise",function(e){O(e,E)},!1),h(),p()],A=$b.sketch({dom:i,components:N.map(function(e){return e.asSpec()}),containerBehaviours:fs([wg("image-tools-fliprotate-buttons-events",[fo(hS.disable(),function(e){o(N,e)}),fo(hS.enable(),function(e){a(N,e)})])])}),R=function(e,n,r,o,a){var i=ix.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}),c=ix.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=ix.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return _h(ix.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:a,getInitialValue:b({x:o})},components:[i,c,s],sliderBehaviours:fs([Sg.config({})]),onChoose:n}))},P=function(e,t,n,r,o){return[g(),(a=t,R(e,function(e,t,n){var r=C(a,n.x/100);f(e,r)},n,r,o)),p()];var a},B=function(e,t,n,r,c){var s=P(e,t,n,r,c);return $b.sketch({dom:i,components:s.map(function(e){return e.asSpec()}),containerBehaviours:fs([wg("image-tools-filter-panel-buttons-events",[fo(hS.disable(),function(e){o(s,e)}),fo(hS.enable(),function(e){a(s,e)})])])})},M=[g(),h(),p()],I=$b.sketch({dom:i,components:M.map(function(e){return e.asSpec()})}),L=B("Brightness",CC,-100,0,100),j=B("Contrast",SC,-100,0,100),F=B("Gamma",_C,-100,0,100),H=function(e){return R(e,function(e){var t=V.getOpt(e),n=U.getOpt(e),r=q.getOpt(e);t.each(function(t){n.each(function(n){r.each(function(r){var o,a,i,c=Gu.getValue(t).x/100,s=Gu.getValue(r).x/100,l=Gu.getValue(n).x/100,u=(o=c,a=s,i=l,function(e){return xC(e,o,a,i)});f(e,u)})})})},0,100,200)},V=H("R"),q=H("G"),U=H("B"),W=[g(),V,q,U,p()],$=$b.sketch({dom:i,components:W.map(function(e){return e.asSpec()})}),X=function(e,t,n){return function(r){s(r,fS.swap(),{transform:t,swap:function(){Q.getOpt(r).each(function(t){bg.set(t,[e]),n(t)})}})}},G=D.some(kC),K=D.some(wC),Y=[r("crop","Crop",X(w,D.none(),function(){e.showCrop()}),!1),r("resize","Resize",X(x,D.none(),function(t){k.getOpt(t).each(function(t){var n=e.getMeasurements(),r=n.width,o=n.height;Gu.setValue(t,{width:r,height:o})})}),!1),r("orientation","Orientation",X(A,D.none(),c),!1),r("brightness","Brightness",X(L,D.none(),c),!1),r("sharpen","Sharpen",X(I,G,c),!1),r("contrast","Contrast",X(j,D.none(),c),!1),r("color-levels","Color levels",X($,D.none(),c),!1),r("gamma","Gamma",X(F,D.none(),c),!1),r("invert","Invert",X(I,K,c),!1)],J=$b.sketch({dom:i,components:Y.map(function(e){return e.asSpec()})}),Z=$b.sketch({dom:{tag:"div"},components:[J],containerBehaviours:fs([bg.config({})])}),Q=_h(Z);return{memContainer:Q,getApplyButton:function(e){return Q.getOpt(e).map(function(e){var t=e.components()[0];return t.components()[t.components().length-1]})}}},vS=tinymce.util.Tools.resolve("tinymce.geom.Rect"),yS=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),bS=tinymce.util.Tools.resolve("tinymce.util.Observable"),wS=tinymce.util.Tools.resolve("tinymce.util.VK"),kS=function(e){var t,n;if(e.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]},_S=0,xS=function(e,t,n,r,o){var a,i="tox-",c="tox-crid-"+_S++,s=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],l=["top","right","bottom","left"],f=function(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}},d=function(t,r,o,a){var i,c=r.x,s=r.y,l=r.w,u=r.h;c+=o*t.deltaX,s+=a*t.deltaY,(l+=o*t.deltaW)<20&&(l=20),(u+=a*t.deltaH)<20&&(u=20),i=e=vS.clamp({x:c,y:s,w:l,h:u},n,"move"===t.name),i=f(n,i),p.fire("updateRect",{rect:i}),h(i)},m=function(e){var n=function(e,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),yS("#"+c+"-"+e,r).css({left:t.x,top:t.y,width:t.w,height:t.h})};Cx.each(s,function(t){yS("#"+c+"-"+t.name,r).css({left:e.w*t.xMul+e.x,top:e.h*t.yMul+e.y})}),n("top",{x:t.x,y:t.y,w:t.w,h:e.y-t.y}),n("right",{x:e.x+e.w,y:e.y,w:t.w-e.x-e.w+t.x,h:e.h}),n("bottom",{x:t.x,y:e.y+e.h,w:t.w,h:t.h-e.y-e.h+t.y}),n("left",{x:t.x,y:e.y,w:e.x-t.x,h:e.h}),n("move",e)},g=function(t){m(e=t)},h=function(e){var t,r;g((t=n,{x:(r=e).x+t.x,y:r.y+t.y,w:r.w,h:r.h}))};yS('<div id="'+c+'" class="'+i+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),Cx.each(l,function(e){yS("#"+c,r).append('<div id="'+c+"-"+e+'"class="'+i+'croprect-block" style="display: none" data-mce-bogus="all">')}),Cx.each(s,function(e){yS("#"+c,r).append('<div id="'+c+"-"+e.name+'" class="'+i+"croprect-handle "+i+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false" title="'+e.label+'">')}),a=Cx.map(s,function(t){var n;return u(c,{document:r.ownerDocument,handle:c+"-"+t.name,start:function(){n=e},drag:function(e){d(t,n,e.deltaX,e.deltaY)}})}),m(e),yS(r).on("focusin focusout",function(e){yS(e.target).attr("aria-grabbed","focus"===e.type?"true":"false")}),yS(r).on("keydown",function(t){var n;Cx.each(s,function(e){return t.target.id===c+"-"+e.name?(n=e,!1):void 0});var r=function(e,t,r,o,a){e.stopPropagation(),e.preventDefault(),d(n,r,o,a)};switch(t.keyCode){case wS.LEFT:r(t,0,e,-10,0);break;case wS.RIGHT:r(t,0,e,10,0);break;case wS.UP:r(t,0,e,0,-10);break;case wS.DOWN:r(t,0,e,0,10);break;case wS.ENTER:case wS.SPACEBAR:t.preventDefault(),o()}});var p=Cx.extend({toggleVisibility:function(e){var t=Cx.map(s,function(e){return"#"+c+"-"+e.name}).concat(Cx.map(l,function(e){return"#"+c+"-"+e})).join(",");e?yS(t,r).show():yS(t,r).hide()},setClampRect:function(t){n=t,m(e)},setRect:g,getInnerRect:function(){return f(n,e)},setInnerRect:h,setViewPortRect:function(n){t=n,m(e)},destroy:function(){Cx.each(a,function(e){e.destroy()}),a=[]}},bS);return p},CS=function(e){var t=_h({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),n=kn(1),r=kn(D.none()),o=kn({x:0,y:0,w:1,h:1}),a=kn({x:0,y:0,w:1,h:1}),i=function(e,a){l.getOpt(e).each(function(e){var i=n.get(),c=Bi(e.element),s=Ti(e.element),l=a.dom.naturalWidth*i,u=a.dom.naturalHeight*i,f=Math.max(0,c/2-l/2),d=Math.max(0,s/2-u/2),m={left:f.toString()+"px",top:d.toString()+"px",width:l.toString()+"px",height:u.toString()+"px",position:"absolute"};oi(a,m),t.getOpt(e).each(function(e){oi(e.element,m)}),r.get().each(function(e){var t=o.get();e.setRect({x:t.x*i+f,y:t.y*i+d,w:t.w*i,h:t.h*i}),e.setClampRect({x:f,y:d,w:l,h:u}),e.setViewPortRect({x:0,y:0,w:c,h:s})})})},c=function(e,t){var r,c=xn.fromTag("img");return ra(c,"src",t),r=c.dom,new Lh(function(e){var t=function(){r.removeEventListener("load",t),e(r)};r.complete?e(r):r.addEventListener("load",t)}).then(function(){return l.getOpt(e).map(function(e){var t=ki({element:c});bg.replaceAt(e,1,D.some(t));var r=a.get(),s={x:0,y:0,w:c.dom.naturalWidth,h:c.dom.naturalHeight};a.set(s);var u,f,d=vS.inflate(s,-20,-20);return o.set(d),r.w===s.w&&r.h===s.h||(u=e,f=c,l.getOpt(u).each(function(e){var t=Bi(e.element),r=Ti(e.element),o=f.dom.naturalWidth,a=f.dom.naturalHeight,i=Math.min(t/o,r/a);i>=1?n.set(1):n.set(i)})),i(e,c),c})})},s=$b.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:e}}},{dom:{tag:"div"},behaviours:fs([wg("image-panel-crop-events",[bo(function(e){l.getOpt(e).each(function(e){var t=e.element.dom,a=xS({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,v);a.toggleVisibility(!1),a.on("updateRect",function(e){var t=e.rect,r=n.get(),a={x:Math.round(t.x/r),y:Math.round(t.y/r),w:Math.round(t.w/r),h:Math.round(t.h/r)};o.set(a)}),r.set(D.some(a))})})])])}],containerBehaviours:fs([bg.config({}),wg("image-panel-events",[bo(function(t){c(t,e)})])])}),l=_h(s);return{memContainer:l,updateSrc:c,zoom:function(e,t){var r=n.get(),o=t>0?Math.min(2,r+.1):Math.max(.1,r-.1);n.set(o),l.getOpt(e).each(function(e){var t=e.components()[1].element;i(e,t)})},showCrop:function(){r.get().each(function(e){e.toggleVisibility(!0)})},hideCrop:function(){r.get().each(function(e){e.toggleVisibility(!1)})},getRect:function(){return o.get()},getMeasurements:function(){var e=a.get();return{width:e.w,height:e.h}}}},SS=function(e,t,n,r,o){return YC({name:e,icon:D.some(t),disabled:n,tooltip:D.some(e),primary:!1,borderless:!1},r,o)},zS=function(e,t){t?bv.enable(e):bv.disable(e)},TS=function(e){var t,n,r,o,a=kn(e),i=kn(D.none()),c=(n=-1,{data:t=[],add:function(e){var r=t.splice(++n);return t.push(e),{state:e,removed:r}},undo:function(){return r()?t[--n]:void 0},redo:function(){return o()?t[++n]:void 0},canUndo:r=function(){return n>0},canRedo:o=function(){return-1!==n&&n<t.length-1}});c.add(e);var s=function(e){a.set(e)},l=function(e){return{blob:e,url:URL.createObjectURL(e)}},u=function(e){URL.revokeObjectURL(e.url)},f=function(){i.get().each(u),i.set(D.none())},d=function(e){var t=l(e);s(t);var n,r=c.add(t).removed;return n=r,Cx.each(n,u),t.url};return{getBlobState:function(){return a.get()},setBlobState:s,addBlobState:d,getTempState:function(){return i.get().fold(function(){return a.get()},function(e){return e})},updateTempState:function(e){var t=l(e);return f(),i.set(D.some(t)),t.url},addTempState:function(e){var t=l(e);return i.set(D.some(t)),t.url},applyTempState:function(e){return i.get().fold(v,function(t){d(t.blob),e()})},destroyTempState:f,undo:function(){var e=c.undo();return s(e),e.url},redo:function(){var e=c.redo();return s(e),e.url},getHistoryStates:function(){return{undoEnabled:c.canUndo(),redoEnabled:c.canRedo()}}}},ES=function(e,t){var n,r,o,a=TS(e.currentState),i=function(e){var t=a.getHistoryStates();h.updateButtonUndoStates(e,t.undoEnabled,t.redoEnabled),ro(e,hS.formActionEvent,{name:hS.saveState(),value:t.undoEnabled})},c=function(e){return e.toBlob()},s=function(e){ro(e,hS.formActionEvent,{name:hS.disable(),value:{}})},l=function(e){p.getApplyButton(e).each(function(e){bv.enable(e)}),ro(e,hS.formActionEvent,{name:hS.enable(),value:{}})},u=function(e,t){return s(e),g.updateSrc(e,t)},f=function(e,t,n,r,o){return s(e),tC(t).then(n).then(c).then(r).then(function(t){return u(e,t).then(function(t){return i(e),o(),l(e),t})})["catch"](function(t){return console.log(t),l(e),t})},d=function(e,t,n){var r=a.getBlobState().blob;f(e,r,t,function(e){return a.updateTempState(e)},n)},m=function(e){var t=a.getBlobState().url;return a.destroyTempState(),i(e),t},g=CS(e.currentState.url),h=(r=_h(SS("Undo","undo",!0,function(e){ro(e,fS.undo(),{direction:1})},n=t)),o=_h(SS("Redo","redo",!0,function(e){ro(e,fS.redo(),{direction:1})},n)),{container:$b.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[r.asSpec(),o.asSpec(),SS("Zoom in","zoom-in",!1,function(e){ro(e,fS.zoom(),{direction:1})},n),SS("Zoom out","zoom-out",!1,function(e){ro(e,fS.zoom(),{direction:-1})},n)]}),updateButtonUndoStates:function(e,t,n){r.getOpt(e).each(function(e){zS(e,t)}),o.getOpt(e).each(function(e){zS(e,n)})}}),p=pS(g,t);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[p.memContainer.asSpec(),g.memContainer.asSpec(),h.container],behaviours:fs([Gu.config({store:{mode:"manual",getValue:function(){return a.getBlobState()}}}),wg("image-tools-events",[fo(fS.undo(),function(e){var t=a.undo();u(e,t).then(function(){l(e),i(e)})}),fo(fS.redo(),function(e){var t=a.redo();u(e,t).then(function(){l(e),i(e)})}),fo(fS.zoom(),function(e,t){var n=t.event.direction;g.zoom(e,n)}),fo(fS.back(),function(e,t){var n,r;r=m(n=e),u(n,r).then(function(){l(n)}),(0,t.event.swap)(),g.hideCrop()}),fo(fS.apply(),function(e,t){a.applyTempState(function(){m(e),(0,t.event.swap)()})}),fo(fS.transform(),function(e,t){return d(e,t.event.transform,v)}),fo(fS.tempTransform(),function(e,t){return n=e,r=t.event.transform,o=a.getTempState().blob,void f(n,o,r,function(e){return a.addTempState(e)},v);var n,r,o}),fo(fS.transformApply(),function(e,t){return n=e,r=t.event.transform,o=t.event.swap,i=a.getBlobState().blob,void f(n,i,r,function(e){var t=a.addBlobState(e);return m(n),t},o);var n,r,o,i}),fo(fS.swap(),function(e,t){var n;n=e,h.updateButtonUndoStates(n,!1,!1);var r=t.event.transform,o=t.event.swap;r.fold(function(){o()},function(t){d(e,t,o)})})]),yx()])}},OS=function(e){return!Ue(e,"items")},DS="data-value",NS=function(e,t,n,r){return Y(n,function(n){return OS(n)?{type:"togglemenuitem",text:n.text,value:n.value,active:n.value===r,onAction:function(){Gu.setValue(e,n.value),ro(e,aw,{name:t}),Sg.focus(e)}}:{type:"nestedmenuitem",text:n.text,getSubmenuItems:function(){return NS(e,t,n.items,r)}}})},AS=function(e,t){return ge(e,function(e){return OS(e)?nd(e.value===t,e):AS(e.items,t)})},RS=Qf({name:"HtmlSelect",configFields:[Yt("options"),Ku("selectBehaviours",[Sg,Gu]),fn("selectClasses",[]),fn("selectAttributes",{}),on("data")],factory:function(e){var t=Y(e.options,function(e){return{dom:{tag:"option",value:e.value,innerHtml:e.text}}}),n=e.data.map(function(e){return it("initialValue",e)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:t,behaviours:Ju(e.selectBehaviours,[Sg.config({}),Gu.config({store:z({mode:"manual",getValue:function(e){return di(e.element)},setValue:function(t,n){ne(e.options,function(e){return e.value===n}).isSome()&&mi(t.element,n)}},n)})])}}}),PS=function(e,t){var n=e.label.map(function(e){return ow(e,t)}),r=[bv.config({disabled:function(){return e.disabled||t.isDisabled()}}),Gv(),gg.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(e){return no(e,lw),D.some(!0)}}),wg("textfield-change",[fo(Cr(),function(t){ro(t,aw,{name:e.name})}),fo(Rr(),function(t){ro(t,aw,{name:e.name})})]),Qb.config({})],o=e.validation.map(function(e){return jw.config({getRoot:function(e){return Ro(e.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=Gu.getValue(t),r=e.validator(n);return Ow(!0===r?ve.value(n):ve.error(r))},validateOnLoad:e.validateOnLoad}})}).toArray(),a=e.placeholder.fold(b({}),function(e){return{placeholder:t.translate(e)}}),i=e.inputMode.fold(b({}),function(e){return{inputmode:e}}),c=z(z({},a),i),s=Yb.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:c,inputClasses:[e.classname],inputBehaviours:fs(oe([r,o])),selectOnFocus:!1,factory:yw}),l=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),u=[bv.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){Yb.getField(e).each(bv.disable)},onEnabled:function(e){Yb.getField(e).each(bv.enable)}}),Gv()];return tw(n,s,l,u)},BS=Object.freeze({__proto__:null,events:function(e,t){var n=e.stream.streams.setup(e,t);return so([fo(e.event,n),wo(function(){return t.cancel()})].concat(e.cancelEvent.map(function(e){return[fo(e,function(){return t.cancel()})]}).getOr([])))}}),MS=function(){var e=kn(null);return Da({readState:function(){return{timer:null!==e.get()?"set":"unset"}},setTimer:function(t){e.set(t)},cancel:function(){var t=e.get();null!==t&&t.cancel()}})},IS=Object.freeze({__proto__:null,throttle:MS,init:function(e){return e.stream.streams.state(e)}}),LS=[Jt("stream",Ft("mode",{throttle:[Yt("delay"),fn("stopEvent",!0),Cc("streams",{setup:function(e,t){var n=e.stream,r=Th(e.onStream,n.delay);return t.setTimer(r),function(e,t){r.throttle(e,t),n.stopEvent&&t.stop()}},state:MS})]})),fn("event","input"),on("cancelEvent"),_c("onStream")],jS=ms({fields:LS,name:"streaming",active:BS,state:IS}),FS=function(e,t,n){var r=Gu.getValue(n);Gu.setValue(t,r),VS(t)},HS=function(e,t){var n=e.element,r=di(n),o=n.dom;"number"!==oa(n,"type")&&t(o,r)},VS=function(e){HS(e,function(e,t){return e.setSelectionRange(t.length,t.length)})},qS=function(e,t,n){if(e.selectsOver){var r=Gu.getValue(t),o=e.getDisplayText(r),a=Gu.getValue(n);return 0===e.getDisplayText(a).indexOf(o)?D.some(function(){var e,r;FS(0,t,n),e=t,r=o.length,HS(e,function(e,t){return e.setSelectionRange(r,t.length)})}):D.none()}return D.none()},US=b("alloy.typeahead.itemexecute"),WS=b([on("lazySink"),Yt("fetch"),fn("minChars",5),fn("responseTime",1e3),wc("onOpen"),fn("getHotspot",D.some),fn("getAnchorOverrides",b({})),fn("layouts",D.none()),fn("eventOrder",{}),bn("model",{},[fn("getDisplayText",function(e){return void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value}),fn("selectsOver",!0),fn("populateFromBrowse",!0)]),wc("onSetValue"),kc("onExecute"),wc("onItemExecute"),fn("inputClasses",[]),fn("inputAttributes",{}),fn("inputStyles",{}),fn("matchWidth",!0),fn("useMinWidth",!1),fn("dismissOnBlur",!0),yc(["openClass"]),on("initialData"),Ku("typeaheadBehaviours",[Sg,Gu,jS,gg,Ig,Vw]),wn("previewing",function(){return kn(!0)})].concat(hw()).concat(mk())),$S=b([zf({schema:[vc()],name:"menu",overrides:function(e){return{fakeFocus:!0,onHighlight:function(t,n){e.previewing.get()?t.getSystem().getByUid(e.uid).each(function(r){qS(e.model,r,n).fold(function(){return vd.dehighlight(t,n)},function(e){return e()})}):t.getSystem().getByUid(e.uid).each(function(t){e.model.populateFromBrowse&&FS(e.model,t,n)}),e.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(e.uid).toOptional().map(function(e){return ro(e,US(),{item:n}),!0})},onHover:function(t,n){e.previewing.set(!1),t.getSystem().getByUid(e.uid).each(function(t){e.model.populateFromBrowse&&FS(e.model,t,n)})}}}})]),XS=ed({name:"Typeahead",configFields:WS(),partFields:$S(),factory:function(e,t,n,r){var o=function(t,n,o){e.previewing.set(!1);var a=Vw.getCoupled(t,"sandbox");Eu.isOpen(a)?id.getCurrent(a).each(function(e){vd.getHighlighted(e).fold(function(){o(e)},function(){co(a,e.element,"keydown",n)})}):ak(e,i(t),t,a,r,function(e){id.getCurrent(e).each(o)},kw.HighlightFirst).get(v)},a=pw(e),i=function(e){return function(t){return t.map(function(t){var n=Ve(t.menus),r=ae(n,function(e){return Q(e.items,function(e){return"item"===e.type})});return Gu.getState(e).update(Y(r,function(e){return e.data})),t})}},c=[Sg.config({}),Gu.config({onSetValue:e.onSetValue,store:z({mode:"dataset",getDataKey:function(e){return di(e.element)},getFallbackEntry:function(e){return{value:e,meta:{}}},setValue:function(t,n){mi(t.element,e.model.getDisplayText(n))}},e.initialData.map(function(e){return it("initialValue",e)}).getOr({}))}),jS.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:function(t){var n,o=Vw.getCoupled(t,"sandbox");Sg.isFocused(t)&&di(t.element).length>=e.minChars&&(n=id.getCurrent(o).bind(function(e){return vd.getHighlighted(e).map(Gu.getValue)}),e.previewing.set(!0),ak(e,i(t),t,o,r,function(){id.getCurrent(o).each(function(t){n.fold(function(){e.model.selectsOver&&vd.highlightFirst(t)},function(e){vd.highlightBy(t,function(t){return Gu.getValue(t).value===e.value}),vd.getHighlighted(t).orThunk(function(){return vd.highlightFirst(t),D.none()})})})},kw.HighlightFirst).get(v))},cancelEvent:Fr()}),gg.config({mode:"special",onDown:function(e,t){return o(e,t,vd.highlightFirst),D.some(!0)},onEscape:function(e){var t=Vw.getCoupled(e,"sandbox");return Eu.isOpen(t)?(Eu.close(t),D.some(!0)):D.none()},onUp:function(e,t){return o(e,t,vd.highlightLast),D.some(!0)},onEnter:function(t){var n=Vw.getCoupled(t,"sandbox"),r=Eu.isOpen(n);if(r&&!e.previewing.get())return id.getCurrent(n).bind(function(e){return vd.getHighlighted(e)}).map(function(e){return ro(t,US(),{item:e}),!0});var o=Gu.getValue(t);return no(t,Fr()),e.onExecute(n,t,o),r&&Eu.close(n),D.some(!0)}}),Ig.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),Vw.config({others:{sandbox:function(t){return fk(e,t,{onOpen:function(){return Ig.on(t)},onClose:function(){return Ig.off(t)}})}}}),wg("typeaheadevents",[_o(function(t){var n=v;ck(e,i(t),t,r,n,kw.HighlightFirst).get(v)}),fo(US(),function(t,n){var r=Vw.getCoupled(t,"sandbox");FS(e.model,t,n.event.item),no(t,Fr()),e.onItemExecute(t,r,n.event.item,Gu.getValue(t)),Eu.close(r),VS(t)})].concat(e.dismissOnBlur?[fo(Ar(),function(e){var t=Vw.getCoupled(e,"sandbox");ks(t.element).isNone()&&Eu.close(t)})]:[]))];return{uid:e.uid,dom:vw(Ke(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:z(z({},a),Ju(e.typeaheadBehaviours,c)),eventOrder:e.eventOrder}}}),GS=function(e){return z(z({},e),{toCached:function(){return GS(e.toCached())},bindFuture:function(t){return GS(e.bind(function(e){return e.fold(function(e){return Ow(ve.error(e))},function(e){return t(e)})}))},bindResult:function(t){return GS(e.map(function(e){return e.bind(t)}))},mapResult:function(t){return GS(e.map(function(e){return e.map(t)}))},mapError:function(t){return GS(e.map(function(e){return e.mapError(t)}))},foldResult:function(t,n){return e.map(function(e){return e.fold(t,n)})},withTimeout:function(t,n){return GS(Ew(function(r){var o=!1,a=setTimeout(function(){o=!0,r(ve.error(n()))},t);e.get(function(e){o||(clearTimeout(a),r(e))})}))}})},KS=function(e){return GS(Ew(e))},YS=KS,JS={type:"separator"},ZS=function(e){return{type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:v}},QS=function(e,t){return{type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:v}},ez=function(e,t){return r=e,n=Q(t,function(e){return e.type===r}),Y(n,ZS);var n,r},tz=function(e,t){var n=e.toLowerCase();return Q(t,function(e){var t=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text;return Nn(t.toLowerCase(),n)||Nn(e.value.toLowerCase(),n)})},nz=function(e,t,n){var r=Gu.getValue(t),o=void 0!==r.meta.text?r.meta.text:r.value;return n.getLinkInformation().fold(function(){return[]},function(t){var r,a,i,c,s=tz(o,(r=n.getHistory(e),Y(r,function(e){return QS(e,e)})));return"file"===e?(a=[s,tz(o,ez("header",t.targets)),tz(o,oe([(c=t,D.from(c.anchorTop).map(function(e){return QS("<top>",e)}).toArray()),ez("anchor",t.targets),(i=t,D.from(i.anchorBottom).map(function(e){return QS("<bottom>",e)}).toArray())]))],te(a,function(e,t){return 0===e.length||0===t.length?e.concat(t):e.concat(JS,t)},[])):s})},rz=ma("aria-invalid"),oz=function(e,t,n){var r,o,a,i,c,s=t.shared.providers,l=function(t){var r=Gu.getValue(t);n.addToHistory(r.value,e.filetype)},u=Yb.parts.field({factory:XS,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":rz,type:"url"},minChars:0,responseTime:0,fetch:function(r){var o=nz(e.filetype,r,n),a=UC(o,fp.BUBBLE_TO_SANDBOX,t,!1);return Ow(a)},getHotspot:function(e){return p.getOpt(e)},onSetValue:function(e){e.hasConfigured(jw)&&jw.run(e).get(v)},typeaheadBehaviours:fs(oe([n.getValidationHandler().map(function(t){return jw.config({getRoot:function(e){return Ro(e.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(e,t){d.getOpt(e).each(function(e){ra(e.element,"title",s.translate(t))})}},validator:{validate:function(n){var r=Gu.getValue(n);return YS(function(n){t({type:e.filetype,url:r.value},function(e){var t,r;"invalid"===e.status?(t=ve.error(e.message),n(t)):(r=ve.value(e.message),n(r))})})},validateOnLoad:!1}})}).toArray(),[bv.config({disabled:function(){return e.disabled||s.isDisabled()}}),Qb.config({}),wg("urlinput-events",oe(["file"===e.filetype?[fo(Cr(),function(t){ro(t,aw,{name:e.name})})]:[],[fo(Sr(),function(t){ro(t,aw,{name:e.name}),l(t)}),fo(Rr(),function(t){ro(t,aw,{name:e.name}),l(t)})]]))]])),eventOrder:((r={})[Cr()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(e){return e.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:zp(0,0,"normal")},onExecute:function(e,t){ro(t,lw,{})},onItemExecute:function(t){l(t),ro(t,aw,{name:e.name})}}),f=e.label.map(function(e){return ow(e,s)}),d=_h((o="invalid",a=D.some(rz),void 0===(i="warning")&&(i=o),void 0===c&&(c=o),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+o],innerHtml:Ch(i,s.icons),attributes:z({title:s.translate(c),"aria-live":"polite"},a.fold(function(){return{}},function(e){return{id:e}}))}})),m=_h({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[d.asSpec()]}),g=n.getUrlPicker(e.filetype),h=ma("browser.url.event"),p=_h({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,m.asSpec()],behaviours:fs([bv.config({disabled:function(){return e.disabled||s.isDisabled()}})])}),y=_h(ZC({name:e.name,icon:D.some("browse"),text:e.label.getOr(""),disabled:e.disabled,primary:!1,borderless:!0},function(e){return no(e,h)},s,[],["tox-browse-url"]));return Yb.sketch({dom:rw([]),components:f.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:oe([[p.asSpec()],g.map(function(){return y.asSpec()}).toArray()])}]),fieldBehaviours:fs([bv.config({disabled:function(){return e.disabled||s.isDisabled()},onDisabled:function(e){Yb.getField(e).each(bv.disable),y.getOpt(e).each(bv.disable)},onEnabled:function(e){Yb.getField(e).each(bv.enable),y.getOpt(e).each(bv.enable)}}),Gv(),wg("url-input-events",[fo(h,function(t){id.getCurrent(t).each(function(n){var r=Gu.getValue(n),o=z({fieldname:e.name},r);g.each(function(r){r(o).get(function(r){Gu.setValue(n,r),ro(t,aw,{name:e.name})})})})})])])})},az=function(e){return function(t,n,r){return qe(n,"name").fold(function(){return e(n,r)},function(o){return t.field(o,e(n,r))})}},iz={bar:az(function(e,t){return n=e,r=t.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:Y(n.items,r.interpreter)};var n,r}),collection:az(function(e,t){return gw(e,t.shared.providers)}),alertbanner:az(function(e,t){return n=e,r=t.shared.providers,$b.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[kh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Ch(n.icon,r.icons),attributes:{title:r.translate(n.iconTooltip)}},action:function(e){ro(e,sw,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:r.translate(n.text)}}]});var n,r}),input:az(function(e,t){return n=e,r=t.shared.providers,PS({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:D.none(),maximized:n.maximized},r);var n,r}),textarea:az(function(e,t){return n=e,r=t.shared.providers,PS({name:n.name,multiline:!0,label:n.label,inputMode:D.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:D.none(),maximized:n.maximized},r);var n,r}),label:az(function(e,t){return n=e,r=t.shared,o={dom:{tag:"label",innerHtml:r.providers.translate(n.label),classes:["tox-label"]}},a=Y(n.items,r.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[o].concat(a),behaviours:fs([yx(),bg.config({}),Dx(D.none()),gg.config({mode:"acyclic"})])};var n,r,o,a}),iframe:(tk=function(e,t){return Hx(e,t.shared.providers)},function(e,t,n){var r=Ke(t,{source:"dynamic"});return az(tk)(e,r,n)}),button:az(function(e,t){return tS(e,t.shared.providers)}),checkbox:az(function(e,t){return n=e,r=t.shared.providers,o=Gu.config({store:{mode:"manual",getValue:function(e){return e.element.dom.checked},setValue:function(e,t){e.element.dom.checked=t}}}),a=function(e){return e.element.dom.click(),D.some(!0)},i=Yb.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:fs([yx(),bv.config({disabled:function(){return n.disabled||r.isDisabled()}}),Qb.config({}),Sg.config({}),o,gg.config({mode:"special",onEnter:a,onSpace:a,stopSpaceKeyup:!0}),wg("checkbox-events",[fo(Sr(),function(e){ro(e,aw,{name:n.name})})])])}),c=Yb.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:r.translate(n.label)},behaviours:fs([vk.config({})])}),l=_h({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(e){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e],innerHtml:Ch("checked"===e?"selected":"unselected",r.icons)}}})("checked"),s("unchecked")]}),Yb.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[i,l.asSpec(),c],fieldBehaviours:fs([bv.config({disabled:function(){return n.disabled||r.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(e){Yb.getField(e).each(bv.disable)},onEnabled:function(e){Yb.getField(e).each(bv.enable)}}),Gv()])});var n,r,o,a,i,c,s,l}),colorinput:az(function(e,t){return kk(e,t.shared,t.colorinput)}),colorpicker:az(function(){var e=function(e){return"tox-"+e},t=vx(_x,e),n=_h(t.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(e){ro(e,sw,{name:"hex-valid",value:!0})},onInvalidHex:function(e){ro(e,sw,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[n.asSpec()],behaviours:fs([Gu.config({store:{mode:"manual",getValue:function(e){var t=n.get(e);return id.getCurrent(t).bind(function(e){return Gu.getValue(e).hex}).map(function(e){return"#"+e}).getOr("")},setValue:function(e,t){var r=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),o=n.get(e);id.getCurrent(o).fold(function(){console.log("Can not find form")},function(e){Gu.setValue(e,{hex:D.from(r[1]).getOr("")}),ux.getField(e,"hex").each(function(e){no(e,Cr())})})}}}),yx()])}}),dropzone:az(function(e,t){return Ax(e,t.shared.providers)}),grid:az(function(e,t){return n=e,r=t.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:Y(n.items,r.interpreter)};var n,r}),listbox:az(function(e,t){return n=e,o=(r=t).shared.providers,a=fe(n.items).filter(OS),i=n.label.map(function(e){return ow(e,o)}),c={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Yb.parts.field({dom:{},factory:{sketch:function(e){return LC({uid:e.uid,text:a.map(function(e){return e.text}),icon:D.none(),tooltip:n.label,role:D.none(),fetch:function(e,t){var o=NS(e,n.name,n.items,Gu.getValue(e));t(UC(o,fp.CLOSE_ON_EXECUTE,r,!1))},onSetup:b(v),getApi:b({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Qb.config({}),Gu.config({store:{mode:"manual",initialValue:a.map(function(e){return e.value}).getOr(""),getValue:function(e){return oa(e.element,DS)},setValue:function(e,t){AS(n.items,t).each(function(t){ra(e.element,DS,t.value),ro(e,MC,{text:t.text})})}}})]},"tox-listbox",r.shared)}}})]},Yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:oe([i.toArray(),[c]]),fieldBehaviours:fs([bv.config({disabled:b(n.disabled),onDisabled:function(e){Yb.getField(e).each(bv.disable)},onEnabled:function(e){Yb.getField(e).each(bv.enable)}})])});var n,r,o,a,i,c}),selectbox:az(function(e,t){return n=e,r=t.shared.providers,o=Y(n.items,function(e){return{text:r.translate(e.text),value:e.value}}),a=n.label.map(function(e){return ow(e,r)}),i=Yb.parts.field({dom:{},selectAttributes:{size:n.size},options:o,factory:RS,selectBehaviours:fs([bv.config({disabled:function(){return n.disabled||r.isDisabled()}}),Qb.config({}),wg("selectbox-change",[fo(Sr(),function(e){ro(e,aw,{name:n.name})})])])}),c=1<n.size?D.none():D.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Ch("chevron-down",r.icons)}}),s={dom:{tag:"div",classes:["tox-selectfield"]},components:oe([[i],c.toArray()])},Yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:oe([a.toArray(),[s]]),fieldBehaviours:fs([bv.config({disabled:function(){return n.disabled||r.isDisabled()},onDisabled:function(e){Yb.getField(e).each(bv.disable)},onEnabled:function(e){Yb.getField(e).each(bv.enable)}}),Gv()])});var n,r,o,a,i,c,s}),sizeinput:az(function(e,t){return uS(e,t.shared.providers)}),urlinput:az(function(e,t){return oz(e,t,t.urlinput)}),customeditor:az(function(e){var t=kn(D.none()),n=_h({dom:{tag:e.tag}}),r=kn(D.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:fs([wg("custom-editor-events",[bo(function(o){n.getOpt(o).each(function(n){var o;o=e,(Object.prototype.hasOwnProperty.call(o,"init")?e.init(n.element.dom):xx.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(e){r.get().each(function(t){e.setValue(t)}),r.set(D.none()),t.set(D.some(e))})})})]),Gu.config({
store:{mode:"manual",getValue:function(){return t.get().fold(function(){return r.get().getOr("")},function(e){return e.getValue()})},setValue:function(e,n){t.get().fold(function(){r.set(D.some(n))},function(e){return e.setValue(n)})}}}),yx()]),components:[n.asSpec()]}}),htmlpanel:az(function(e){return"presentation"===e.presets?$b.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):$b.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:fs([Qb.config({}),Sg.config({})])})}),imagetools:az(function(e,t){return ES(e,t.shared.providers)}),table:az(function(e,t){return n=e,r=t.shared.providers,i=function(e){return{dom:{tag:"th",innerHtml:r.translate(e)}}},c=function(e){return{dom:{tag:"td",innerHtml:r.translate(e)}}},s=function(e){return{dom:{tag:"tr"},components:Y(e,c)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(a=n.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:Y(a,i)}]}),(o=n.cells,{dom:{tag:"tbody"},components:Y(o,s)})],behaviours:fs([Qb.config({}),Sg.config({})])};var n,r,o,a,i,c,s}),panel:az(function(e,t){return r=t,{dom:{tag:"div",classes:(n=e).classes},components:Y(n.items,r.shared.interpreter)};var n,r})},cz={field:function(e,t){return t}},sz=function(e,t,n){var r=Ke(n,{shared:{interpreter:function(t){return lz(e,t,r)}}});return lz(e,t,r)},lz=function(e,t,n){return qe(iz,t.type).fold(function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t},function(r){return r(e,t,n)})},uz={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},fz=function(e,t,n){var r=Us(-12,12,uz),o={maxHeightFunction:js()};return function(){return n()?{anchor:"node",root:Vo(e()),node:D.from(e()),bubble:r,layouts:{onRtl:function(){return[vh]},onLtr:function(){return[ph]}},overrides:o}:{anchor:"hotspot",hotspot:t(),bubble:r,layouts:{onRtl:function(){return[Uc]},onLtr:function(){return[Wc]}},overrides:o}}},dz=function(e,t,n){return function(){return n()?{anchor:"node",root:Vo(e()),node:D.from(e()),layouts:{onRtl:function(){return[yh]},onLtr:function(){return[yh]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[Kc]},onLtr:function(){return[Kc]}}}}},mz=function(e,t,n){var r,o,a,i=Fv(e),c=function(){return xn.fromDom(e.getBody())},s=function(){return xn.fromDom(e.getContentAreaContainer())},l=function(){return i||!n()};return{inlineDialog:fz(s,t,l),banner:dz(s,t,l),cursor:(o=e,function(){return{anchor:"selection",root:a(),getSelection:function(){var e=o.selection.getRng();return D.some(wl.range(xn.fromDom(e.startContainer),e.startOffset,xn.fromDom(e.endContainer),e.endOffset))}}}),node:(r=a=c,function(e){return{anchor:"node",root:r(),node:e}})}},gz=function(e){return{colorPicker:function(e,t){rb(o)(e,t)},hasCustomColors:function(){return $y(r)},getColors:function(){return Xy(n)},getColorCols:(t=n=r=o=e,function(){return Yy(t)})};var t,n,r,o},hz=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],pz=function(e){return te(e,function(e,t){if(Ue(t,"items")){var n=pz(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(Ue(t,"inline")||Ue(t,"block")||Ue(t,"selector")){var r="custom-"+(R(t.name)?t.name:t.title.toLowerCase());return{customFormats:e.customFormats.concat([{name:r,format:t}]),formats:e.formats.concat([{title:t.title,format:r,icon:t.icon}])}}return z(z({},e),{formats:e.formats.concat(t)})},{customFormats:[],formats:[]})},vz=function(e){return t=e,D.from(t.getParam("style_formats")).filter(B).map(function(t){var n,r,o,a=(n=e,r=pz(t),o=function(e){J(e,function(e){n.formatter.has(e.name)||n.formatter.register(e.name,e.format)})},n.formatter?o(r.customFormats):n.on("init",function(){o(r.customFormats)}),r.formats);return e.getParam("style_formats_merge",!1,"boolean")?hz.concat(a):a}).getOr(hz);var t},yz=function(e,t,n){var r={type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)};return Ke(e,r)},bz=function(e,t,n,r){var o=function(t){return Y(t,function(t){var a,i,c,s,l,u=Pe(t);if(We(t,"items")){var f=o(t.items);return Ke(Ke(t,{type:"submenu"}),{getStyleItems:function(){return f}})}return We(t,"format")?yz(t,n,r):1===u.length&&$(u,"title")?Ke(t,{type:"separator"}):(i=R((a=t).name)?a.name:ma(a.title),s={type:"formatter",format:c="custom-"+i,isSelected:n(c),getStylePreview:r(c)},l=Ke(a,s),e.formatter.register(i,l),l)})};return o(t)},wz=Cx.trim,kz=function(e){return function(t){if(L(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}},_z=kz("true"),xz=kz("false"),Cz=function(e,t,n,r,o){return{type:e,title:t,url:n,level:r,attach:o}},Sz=function(e){return e.innerText||e.textContent},zz=function(e){return(t=e)&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&Ez(e);var t},Tz=function(e){return e&&/^(H[1-6])$/.test(e.nodeName)},Ez=function(e){return function(e){for(;e=e.parentNode;){var t=e.contentEditable;if(t&&"inherit"!==t)return _z(e)}return!1}(e)&&!xz(e)},Oz=function(e){return Tz(e)&&Ez(e)},Dz=function(e){var t,n,r=(t=e).id?t.id:ma("h");return Cz("header",Sz(e),"#"+r,Tz(n=e)?parseInt(n.nodeName.substr(1),10):0,function(){e.id=r})},Nz=function(e){var t=e.id||e.name,n=Sz(e);return Cz("anchor",n||"#"+t,"#"+t,0,v)},Az=function(e){var t,n;return t="h1,h2,h3,h4,h5,h6,a:not([href])",n=e,Y(Al(xn.fromDom(n),t),function(e){return e.dom})},Rz=function(e){return 0<wz(e.title).length},Pz=function(e){var t=Az(e);return Q(Y(Q(t,Oz),Dz).concat(Y(Q(t,zz),Nz)),Rz)},Bz="tinymce-url-history",Mz=function(e){return R(e)&&/^https?/.test(e)},Iz=function(e){return P(e)&&He(e,function(e){return!(B(t=e)&&t.length<=5&&ie(t,Mz));var t}).isNone()},Lz=function(){var e,t=Hy.getItem(Bz);if(null===t)return{};try{e=JSON.parse(t)}catch(n){if(n instanceof SyntaxError)return console.log("Local storage "+Bz+" was not valid JSON",n),{};throw n}return Iz(e)?e:(console.log("Local storage "+Bz+" was not valid format",e),{})},jz=function(e){var t=Lz();return Object.prototype.hasOwnProperty.call(t,e)?t[e]:[]},Fz=function(e,t){var n,r,o;Mz(e)&&(n=Lz(),r=Object.prototype.hasOwnProperty.call(n,t)?n[t]:[],o=Q(r,function(t){return t!==e}),n[t]=[e].concat(o).slice(0,5),function(e){if(!Iz(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));Hy.setItem(Bz,JSON.stringify(e))}(n))},Hz=function(e){return!!e},Vz=function(e){return Ie(Cx.makeMap(e,/[, ]/),Hz)},qz=function(e){return D.from(e.getParam("file_picker_callback")).filter(j)},Uz=function(e,t){var n,r,o,a,i=(n=e,r=D.some(n.getParam("file_picker_types")).filter(Hz),o=D.some(n.getParam("file_browser_callback_types")).filter(Hz),a=r.or(o).map(Vz),qz(n).fold(x,function(){return a.fold(C,function(e){return 0<Pe(e).length&&e})}));return M(i)?i?qz(e):D.none():i[t]?qz(e):D.none()},Wz=function(e){return D.from(e).filter(R).getOrUndefined()},$z=function(e){return D.from(void 0===(n=(t=e).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):n);var t,n},Xz=function(e){return{getHistory:jz,addToHistory:Fz,getLinkInformation:function(){return!1===(t=e).getParam("typeahead_urls")?D.none():D.some({targets:Pz(t.getBody()),anchorTop:Wz(t.getParam("anchor_top","#top")),anchorBottom:Wz(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return $z(e)},getUrlPicker:function(t){return Uz(n=e,r=t).map(function(e){return function(t){return Ew(function(o){var a=z({filetype:r,fieldname:t.fieldname},D.from(t.meta).getOr({}));e.call(n,function(e,t){if(!R(e))throw new Error("Expected value to be string");if(void 0!==t&&!P(t))throw new Error("Expected meta to be a object");o({value:e,meta:t})},t.value,a)})}});var n,r}}},Gz=function(e,t,n){var r,o,a=kn(!1),i={isPositionedAtTop:function(){return"top"===r.get()},getDockingMode:(r=kn(Lv(t)?"bottom":"top")).get,setDockingMode:r.set},c={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:av.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(e){return lz(cz,e,c)},anchors:mz(t,n,i.isPositionedAtTop),header:i,getSink:function(){return ve.value(e)}},urlinput:Xz(t),styleselect:function(e){var t=function(t){return function(){return e.formatter.match(t)}},n=function(t){return function(){var n=e.formatter.get(t);return void 0!==n?D.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):D.none()}},r=function(e){var t=e.items;return void 0!==t&&0<t.length?ae(t,r):[e.format]},o=kn([]),a=kn([]),i=kn([]),c=kn([]),s=kn(!1);return e.on("PreInit",function(){var i=vz(e),c=bz(e,i,t,n);o.set(c),a.set(ae(c,r))}),e.on("addStyleModifications",function(o){var a=bz(e,o.items,t,n);i.set(a),s.set(o.replace),c.set(ae(a,r))}),{getData:function(){var e=s.get()?[]:o.get(),t=i.get();return e.concat(t)},getFlattenedKeys:function(){var e=s.get()?[]:a.get(),t=c.get();return e.concat(t)}}}(t),colorinput:gz(t),dialog:{isDraggableModal:(o=t,function(){return o.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return a.get()},setContextMenuState:function(e){return a.set(e)}};return c},Kz=b(function(e,t){var n,r,o;n=e,r=Math.floor(t),o=Pi.max(n,r,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),ri(n,"max-width",o+"px")}),Yz="contexttoolbar-hide",Jz=b([Yt("dom"),fn("shell",!0),Ku("toolbarBehaviours",[bg])]),Zz=b([Tf({name:"groups",overrides:function(){return{behaviours:fs([bg.config({})])}}})]),Qz=ed({name:"Toolbar",configFields:Jz(),partFields:Zz(),factory:function(e,t){var n=function(t){return e.shell?D.some(t):jf(t,e,"groups")},r=e.shell?{behaviours:[bg.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:r.components,behaviours:Ju(e.toolbarBehaviours,r.behaviours),apis:{setGroups:function(e,t){n(e).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(e){bg.set(e,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),eT=function(e,t,n){return{within:e,extra:t,withinWidth:n}},tT=function(e,t,n){var r,o=(r=function(e,t){var r=n(e);return D.some({element:e,start:t,finish:t+r,width:r})},te(e,function(e,t){return r(t,e.len).fold(b(e),function(t){return{len:t.finish,list:e.list.concat([t])}})},{len:0,list:[]}).list),a=Q(o,function(e){return e.finish<=t}),i=ee(a,function(e,t){return e+t.width},0);return{within:a,extra:o.slice(a.length),withinWidth:i}},nT=function(e){return Y(e,function(e){return e.element})},rT=function(e,t,n,r){var o,a,i,c,s,l,u,f,d,m=(0===(o=tT(t,e,n)).extra.length?D.some(o):D.none()).getOrThunk(function(){return tT(t,e-n(r),n)}),g=m.within,h=m.extra,p=m.withinWidth;return 1===h.length&&h[0].width<=n(r)?(u=h,f=p,d=nT(g.concat(u)),eT(d,[],f)):1<=h.length?(i=h,c=r,s=p,l=nT(g).concat([c]),eT(l,nT(i),s)):(a=p,eT(nT(g),[],a))},oT=function(e,t){var n=Y(t,function(e){return Ci(e)});Qz.setGroups(e,n)},aT=function(e,t,n){var r=Ff(e,t,"primary"),o=Vw.getCoupled(e,"overflowGroup");ri(r.element,"visibility","hidden");var a=t.builtGroups.get().concat([o]),i=ge(a,function(e){return ks(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()})});n([]),oT(r,a);var c=Bi(r.element),s=rT(c,t.builtGroups.get(),function(e){return Bi(e.element)},o);0===s.extra.length?(bg.remove(r,o),n([])):(oT(r,s.within),n(s.extra)),ui(r.element,"visibility"),fi(r.element),i.each(Sg.focus)},iT=b([Ku("splitToolbarBehaviours",[Vw]),wn("builtGroups",function(){return kn([])})]),cT=b([yc(["overflowToggledClass"]),ln("getOverflowBounds"),Yt("lazySink"),wn("overflowGroups",function(){return kn([])})].concat(iT())),sT=b([Sf({factory:Qz,schema:Jz(),name:"primary"}),zf({schema:Jz(),name:"overflow"}),zf({name:"overflow-button"}),zf({name:"overflow-group"})]),lT=b([yc(["toggledClass"]),Yt("lazySink"),en("fetch"),ln("getBounds"),un("fireDismissalEventInstead",[fn("event",Gr())]),tl()]),uT=b([zf({name:"button",overrides:function(e){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:fs([Ig.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),zf({factory:Qz,schema:Jz(),name:"toolbar",overrides:function(e){return{toolbarBehaviours:fs([gg.config({mode:"cyclic",onEscape:function(t){return jf(t,e,"button").each(Sg.focus),D.none()}})])}}})]),fT=function(e,t){var n=Vw.getCoupled(e,"toolbarSandbox");Eu.isOpen(n)?Eu.close(n):Eu.open(n,t.toolbar())},dT=function(e,t,n,r){var o=n.getBounds.map(function(e){return e()}),a=n.lazySink(e).getOrDie();iu.positionWithinBounds(a,{anchor:"hotspot",hotspot:e,layouts:r,overrides:{maxWidthFunction:Kz()}},t,o)},mT=function(e,t,n,r,o){Qz.setGroups(t,o),dT(e,t,n,r),Ig.on(e)},gT=ed({name:"FloatingToolbarButton",factory:function(e,t,n,r){return z(z({},kh.sketch(z(z({},r.button()),{action:function(e){fT(e,r)},buttonBehaviours:Qu({dump:r.button().buttonBehaviours},[Vw.config({others:{toolbarSandbox:function(t){return r=t,o=n,a=e,{dom:{tag:"div",attributes:{id:(i=rc()).id}},behaviours:fs([gg.config({mode:"special",onEscape:function(e){return Eu.close(e),D.some(!0)}}),Eu.config({onOpen:function(e,t){a.fetch().get(function(e){mT(r,t,a,o.layouts,e),i.link(r.element),gg.focusIn(t)})},onClose:function(){Ig.off(r),Sg.focus(r),i.unlink(r.element)},isPartOf:function(e,t,n){return ac(t,n)||ac(r,n)},getAttachPoint:function(){return a.lazySink(r).getOrDie()}}),vs.config({channels:z(z({},Ru(z({isExtraPart:x},a.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),Bu({doReposition:function(){Eu.getState(Vw.getCoupled(r,"toolbarSandbox")).each(function(e){dT(r,e,a,o.layouts)})}}))})])};var r,o,a,i}}})])}))),{apis:{setGroups:function(t,r){Eu.getState(Vw.getCoupled(t,"toolbarSandbox")).each(function(o){mT(t,o,e,n.layouts,r)})},reposition:function(t){Eu.getState(Vw.getCoupled(t,"toolbarSandbox")).each(function(r){dT(t,r,e,n.layouts)})},toggle:function(e){fT(e,r)},getToolbar:function(e){return Eu.getState(Vw.getCoupled(e,"toolbarSandbox"))},isOpen:function(e){return Eu.isOpen(Vw.getCoupled(e,"toolbarSandbox"))}}})},configFields:lT(),partFields:uT(),apis:{setGroups:function(e,t,n){e.setGroups(t,n)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getToolbar:function(e,t){return e.getToolbar(t)},isOpen:function(e,t){return e.isOpen(t)}}}),hT=b([Yt("items"),yc(["itemSelector"]),Ku("tgroupBehaviours",[gg])]),pT=b([Ef({name:"items",unit:"item"})]),vT=ed({name:"ToolbarGroup",configFields:hT(),partFields:pT(),factory:function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.tgroupBehaviours,[gg.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),yT=function(e){return Y(e,function(e){return Ci(e)})},bT=function(e,t,n){aT(e,n,function(r){n.overflowGroups.set(r),t.getOpt(e).each(function(e){gT.setGroups(e,yT(r))})})},wT=ed({name:"SplitFloatingToolbar",configFields:cT(),partFields:sT(),factory:function(e,t,n,r){var o=_h(gT.sketch({fetch:function(){return Ew(function(t){t(yT(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[Wc,Uc]},onRtl:function(){return[Uc,Wc]},onBottomLtr:function(){return[Xc,$c]},onBottomRtl:function(){return[$c,Xc]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:r["overflow-button"](),toolbar:r.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.splitToolbarBehaviours,[Vw.config({others:{overflowGroup:function(){return vT.sketch(z(z({},r["overflow-group"]()),{items:[o.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(Y(n,t.getSystem().build)),bT(t,o,e)},refresh:function(t){return bT(t,o,e)},toggle:function(e){o.getOpt(e).each(function(e){gT.toggle(e)})},isOpen:function(e){return o.getOpt(e).map(gT.isOpen).getOr(!1)},reposition:function(e){o.getOpt(e).each(function(e){gT.reposition(e)})},getOverflow:function(e){return o.getOpt(e).bind(gT.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)},getOverflow:function(e,t){return e.getOverflow(t)}}}),kT=function(e,t){return t.getAnimationRoot.fold(function(){return e.element},function(t){return t(e)})},_T=function(e){return e.dimension.property},xT=function(e,t){return e.dimension.getDimension(t)},CT=function(e,t){var n=kT(e,t);Ya(n,[t.shrinkingClass,t.growingClass])},ST=function(e,t){Xa(e.element,t.openClass),Wa(e.element,t.closedClass),ri(e.element,_T(t),"0px"),fi(e.element)},zT=function(e,t){Xa(e.element,t.closedClass),Wa(e.element,t.openClass),ui(e.element,_T(t))},TT=function(e,t,n){n.setCollapsed(),ri(e.element,_T(t),xT(t,e.element)),fi(e.element),CT(e,t),ST(e,t),t.onStartShrink(e),t.onShrunk(e)},ET=function(e,t,n,r){var o=r.getOrThunk(function(){return xT(t,e.element)});n.setCollapsed(),ri(e.element,_T(t),o),fi(e.element);var a=kT(e,t);Xa(a,t.growingClass),Wa(a,t.shrinkingClass),ST(e,t),t.onStartShrink(e)},OT=function(e,t,n){var r=xT(t,e.element);("0px"===r?TT:ET)(e,t,n,D.some(r))},DT=function(e,t,n){var r=kT(e,t),o=Ga(r,t.shrinkingClass),a=xT(t,e.element);zT(e,t);var i=xT(t,e.element);(o?function(){ri(e.element,_T(t),a),fi(e.element)}:function(){ST(e,t)})(),Xa(r,t.shrinkingClass),Wa(r,t.growingClass),zT(e,t),ri(e.element,_T(t),i),n.setExpanded(),t.onStartGrow(e)},NT=function(e,t){var n=kT(e,t);return!0===Ga(n,t.growingClass)},AT=function(e,t){var n=kT(e,t);return!0===Ga(n,t.shrinkingClass)},RT=Object.freeze({__proto__:null,refresh:function(e,t,n){var r;n.isExpanded()&&(ui(e.element,_T(t)),r=xT(t,e.element),ri(e.element,_T(t),r))},grow:function(e,t,n){n.isExpanded()||DT(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&OT(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&TT(e,t,n,D.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:NT,isShrinking:AT,isTransitioning:function(e,t){return NT(e,t)||AT(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?OT:DT)(e,t,n)},disableTransitions:CT}),PT=Object.freeze({__proto__:null,exhibit:function(e,t){var n=t.expanded;return Aa(n?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:it(t.dimension.property,"0px")})},events:function(e,t){return so([yo(Tr(),function(n,r){r.event.raw.propertyName===e.dimension.property&&(CT(n,e),t.isExpanded()&&ui(n.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))})])}}),BT=[Yt("closedClass"),Yt("openClass"),Yt("shrinkingClass"),Yt("growingClass"),on("getAnimationRoot"),wc("onShrunk"),wc("onStartShrink"),wc("onGrown"),wc("onStartGrow"),fn("expanded",!1),Jt("dimension",Ft("property",{width:[Cc("property","width"),Cc("getDimension",function(e){return Bi(e)+"px"})],height:[Cc("property","height"),Cc("getDimension",function(e){return Ti(e)+"px"})]}))],MT=ms({fields:BT,name:"sliding",active:PT,apis:RT,state:Object.freeze({__proto__:null,init:function(t){var n=kn(t.expanded);return Da({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:e(n.set,!1),setExpanded:e(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),IT=b([yc(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),wc("onOpened"),wc("onClosed")].concat(iT())),LT=b([Sf({factory:Qz,schema:Jz(),name:"primary"}),Sf({factory:Qz,schema:Jz(),name:"overflow",overrides:function(e){return{toolbarBehaviours:fs([MT.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:function(t){jf(t,e,"overflow-button").each(function(e){Ig.off(e),Sg.focus(e)}),e.onClosed(t)},onGrown:function(t){gg.focusIn(t),e.onOpened(t)},onStartGrow:function(t){jf(t,e,"overflow-button").each(Ig.on)}}),gg.config({mode:"acyclic",onEscape:function(t){return jf(t,e,"overflow-button").each(Sg.focus),D.some(!0)}})])}}}),zf({name:"overflow-button",overrides:function(e){return{buttonBehaviours:fs([Ig.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),zf({name:"overflow-group"})]),jT=function(e,t){jf(e,t,"overflow-button").bind(function(){return jf(e,t,"overflow")}).each(function(n){FT(e,t),MT.toggleGrow(n)})},FT=function(e,t){jf(e,t,"overflow").each(function(n){aT(e,t,function(e){var t=Y(e,function(e){return Ci(e)});Qz.setGroups(n,t)}),jf(e,t,"overflow-button").each(function(e){MT.hasGrown(n)&&Ig.on(e)}),MT.refresh(n)})},HT=ed({name:"SplitSlidingToolbar",configFields:IT(),partFields:LT(),factory:function(e,t,n,r){var o="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:Ju(e.splitToolbarBehaviours,[Vw.config({others:{overflowGroup:function(e){return vT.sketch(z(z({},r["overflow-group"]()),{items:[kh.sketch(z(z({},r["overflow-button"]()),{action:function(){no(e,o)}}))]}))}}}),wg("toolbar-toggle-events",[fo(o,function(t){jT(t,e)})])]),apis:{setGroups:function(t,n){var r;r=Y(n,t.getSystem().build),e.builtGroups.set(r),FT(t,e)},refresh:function(t){return FT(t,e)},toggle:function(t){return jT(t,e)},isOpen:function(t){return jf(t,e,"overflow").map(MT.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)}}}),VT=b(ma("toolbar-height-change")),qT=function(e){var t=e.title.fold(function(){return{}},function(e){return{attributes:{title:e}}});return{dom:z({tag:"div",classes:["tox-toolbar__group"]},t),components:[vT.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:fs([Qb.config({}),Sg.config({})])}},UT=function(e){return vT.sketch(qT(e))},WT=function(e,t){var n=bo(function(t){var n=Y(e.initGroups,UT);Qz.setGroups(t,n)});return fs([Zv(e.providers.isDisabled),Gv(),gg.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),wg("toolbar-events",[n])])},$T=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":qT({title:D.none(),items:[]}),"overflow-button":KC({name:"more",icon:D.some("more-drawer"),disabled:!1,tooltip:D.some("More..."),primary:!1,borderless:!1},D.none(),e.providers)},splitToolbarBehaviours:WT(e,t)}},XT=function(e){var t=$T(e),n=wT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return wT.sketch(z(z({},t),{lazySink:e.getSink,getOverflowBounds:function(){var t=e.moreDrawerData.lazyHeader().element,n=Ki(t),r=No(t),o=Ki(r),a=Math.max(r.dom.scrollHeight,o.height);return Xi(n.x+4,o.y,n.width-8,a)},parts:z(z({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},GT=function(e){var t=HT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=HT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=$T(e);return HT.sketch(z(z({},r),{components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(e){e.getSystem().broadcastOn([VT()],{type:"opened"})},onClosed:function(e){e.getSystem().broadcastOn([VT()],{type:"closed"})}}))},KT=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return Qz.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===lp.scrolling?["tox-toolbar--scrolling"]:[])},components:[Qz.parts.groups({})],toolbarBehaviours:WT(e,t)})},YT=wt([Zt("type"),Jt("items",_t([Nt([Zt("name"),rn("items",Ut)]),Ut]))].concat(Gh)),JT=[sn("text"),sn("tooltip"),sn("icon"),en("fetch"),vn("onSetup",function(){return v})],ZT=wt(n([Zt("type")],JT)),QT=function(e){return Bt("menubutton",ZT,e)},eE=wt([Zt("type"),sn("tooltip"),sn("icon"),sn("text"),ln("select"),en("fetch"),vn("onSetup",function(){return v}),hn("presets","normal",["normal","color","listpreview"]),fn("columns",1),en("onAction"),en("onItemAction")]),tE=Object.freeze({__proto__:null,events:function(e,t){var n=function(n,r){e.updateState.each(function(e){var o=e(n,r);t.set(o)}),e.renderComponents.each(function(e){var o=e(r,t.get()),a=Y(o,n.getSystem().build);uu(n,a)})};return so([fo(Pr(),function(t,r){var o,a=r;a.universal||(o=e.channel,$(a.channels,o)&&n(t,a.data))}),bo(function(t){e.initialData.each(function(e){n(t,e)})})])}}),nE=Object.freeze({__proto__:null,getState:function(e,t,n){return n}}),rE=[Yt("channel"),on("renderComponents"),on("updateState"),on("initialData")],oE=ms({fields:rE,name:"reflecting",active:tE,apis:nE,state:Object.freeze({__proto__:null,init:function(){var e=kn(D.none());return{readState:function(){return e.get().fold(function(){return"none"},function(e){return e})},get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(D.none())}}}})}),aE=b([Yt("toggleClass"),Yt("fetch"),_c("onExecute"),fn("getHotspot",D.some),fn("getAnchorOverrides",b({})),tl(),_c("onItemExecute"),on("lazySink"),Yt("dom"),wc("onOpen"),Ku("splitDropdownBehaviours",[Vw,gg,Sg]),fn("matchWidth",!1),fn("useMinWidth",!1),fn("eventOrder",{}),on("role")].concat(mk())),iE=Sf({factory:kh,schema:[Yt("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:fs([Sg.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(oo)},buttonBehaviours:fs([Ig.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])}}}),cE=Sf({factory:kh,schema:[Yt("dom")],name:"button",defaults:function(){return{buttonBehaviours:fs([Sg.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(function(n){e.onExecute(n,t)})}}}}),sE=b([iE,cE,Tf({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Yt("text")],name:"aria-descriptor"}),zf({schema:[vc()],name:"menu",defaults:function(e){return{onExecute:function(t,n){t.getSystem().getByUid(e.uid).each(function(r){e.onItemExecute(r,t,n)})}}}}),Uw()]),lE=ed({name:"SplitDropdown",configFields:aE(),partFields:sE(),factory:function(e,t,n,r){var o,a=function(e){id.getCurrent(e).each(function(e){vd.highlightFirst(e),gg.focusIn(e)})},i=function(t){ck(e,function(e){return e},t,r,a,kw.HighlightFirst).get(v)},c=function(t){var n=Ff(t,e,"button");return oo(n),D.some(!0)},s=z(z({},so([bo(function(t){jf(t,e,"aria-descriptor").each(function(e){var n=ma("aria");ra(e.element,"id",n),ra(t.element,"aria-describedby",n)})})])),jg(D.some(i))),l={repositionMenus:function(e){Ig.isOn(e)&&dk(e)}};return{uid:e.uid,dom:e.dom,components:t,apis:l,eventOrder:z(z({},e.eventOrder),((o={})[Br()]=["disabling","toggling","alloy.base.behaviour"],o)),events:s,behaviours:Ju(e.splitDropdownBehaviours,[Vw.config({others:{sandbox:function(t){var n=Ff(t,e,"arrow");return fk(e,t,{onOpen:function(){Ig.on(n),Ig.on(t)},onClose:function(){Ig.off(n),Ig.off(t)}})}}}),gg.config({mode:"special",onSpace:c,onEnter:c,onDown:function(e){return i(e),D.some(!0)}}),Sg.config({}),Ig.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(e,t){return e.repositionMenus(t)}}}),uE=function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},fE=function(e){return{setActive:function(t){Ig.set(e,t)},isActive:function(){return Ig.isOn(e)},isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)}}},dE=function(e,t){return e.map(function(e){return{"aria-label":t.translate(e),title:t.translate(e)}}).getOr({})},mE=ma("focus-button"),gE=["checklist","ordered-list"],hE=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],pE=function(e,t,n,r,o,a){var i,c=function(e){return av.isRtl()&&$(gE,e)?e+"-rtl":e},s=av.isRtl()&&e.exists(function(e){return $(hE,e)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(s?["tox-tbtn__icon-rtl"]:[]),attributes:dE(n,a)},components:ry([e.map(function(e){return NC(c(e),a.icons)}),t.map(function(e){return RC(e,"tox-tbtn",a)})]),eventOrder:((i={})[hr()]=["focusing","alloy.base.behaviour","common-button-display-events"],i),buttonBehaviours:fs([Zv(a.isDisabled),Gv(),wg("common-button-display-events",[fo(hr(),function(e,t){t.event.prevent(),no(e,mE)})])].concat(r.map(function(n){return oE.config({channel:n,initialData:{icon:e,text:t},renderComponents:function(e){return ry([e.icon.map(function(e){return NC(c(e),a.icons)}),e.text.map(function(e){return RC(e,"tox-tbtn",a)})])}})}).toArray()).concat(o.getOr([])))}},vE=function(e,t,n){var r,o=kn(v),a=pE(e.icon,e.text,e.tooltip,D.none(),D.none(),n);return kh.sketch({dom:a.dom,components:a.components,eventOrder:BC,buttonBehaviours:fs([wg("toolbar-button-events",[(r={onAction:e.onAction,getApi:t.getApi},_o(function(e){Qv(r,e)(function(t){ro(e,PC,{buttonApi:t}),r.onAction(t)})})),ey(t,o),ty(t,o)]),Zv(function(){return e.disabled||n.isDisabled()}),Gv()].concat(t.toolbarButtonBehaviours))})},yE=function(e,t,n){return vE(e,{toolbarButtonBehaviours:[].concat(0<n.length?[wg("toolbarButtonWith",n)]:[]),getApi:uE,onSetup:e.onSetup},t)},bE=function(e,t,n){return Ke(vE(e,{toolbarButtonBehaviours:[bg.config({}),Ig.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<n.length?[wg("toolbarToggleButtonWith",n)]:[]),getApi:fE,onSetup:e.onSetup},t))},wE=function(e,t){var n,r,o,a,i=ma("channel-update-split-dropdown-display"),c=function(e){return{isDisabled:function(){return bv.isDisabled(e)},setDisabled:function(t){return bv.set(e,t)},setIconFill:function(t,n){tc(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(e){ra(e,"fill",n)})},setIconStroke:function(t,n){tc(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(e){ra(e,"stroke",n)})},setActive:function(t){ra(e.element,"aria-pressed",t),tc(e.element,"span").each(function(n){e.getSystem().getByDom(n).each(function(e){return Ig.set(e,t)})})},isActive:function(){return tc(e.element,"span").exists(function(t){return e.getSystem().getByDom(t).exists(Ig.isOn)})}}},s=kn(v),l={getApi:c,onSetup:e.onSetup};return lE.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:z({"aria-pressed":!1},dE(e.tooltip,t.providers))},onExecute:function(t){e.onAction(c(t))},onItemExecute:function(){},splitDropdownBehaviours:fs([Jv(t.providers.isDisabled),Gv(),wg("split-dropdown-events",[fo(mE,Sg.focus),ey(l,s),ty(l,s)]),vk.config({})]),eventOrder:((n={})[$r()]=["alloy.base.behaviour","split-dropdown-events"],n),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(r=c,o=e,a=t.providers,function(e){return Ew(function(e){return o.fetch(e)}).map(function(t){return D.from(Sb(Ke(ob(ma("menu-value"),t,function(t){o.onItemAction(r(e),t)},o.columns,o.presets,fp.CLOSE_ON_EXECUTE,o.select.getOr(x),a),{movement:ib(o.columns,o.presets),menuBehaviours:Kp("auto"!==o.columns?[]:[bo(function(e){Xp(e,4,_p(o.presets)).each(function(t){var n=t.numRows,r=t.numColumns;
gg.setGridSize(e,n,r)})})])})))})}),parts:{menu:zp(0,e.columns,e.presets)},components:[lE.parts.button(pE(e.icon,e.text,D.none(),D.some(i),D.some([Ig.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),lE.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Ch("chevron-down",t.providers.icons)},buttonBehaviours:fs([Jv(t.providers.isDisabled),Gv()])}),lE.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},kE=function(e,t){return fo(PC,function(n,r){var o,a=e.get(n),i=(o=a,{hide:function(){return no(o,jr())},getValue:function(){return Gu.getValue(o)}});t.onAction(i,r.event.buttonApi)})},_E=function(e,n,r){var o,a,i,c,s,l,u,f,d,m,g,h,p={backstage:{shared:{providers:r}}};return"contextformtogglebutton"===n.type?(u=e,d=p,(m=(f=n).original).primary,g=t(m,["primary"]),h=Mt(Qh(z(z({},g),{type:"togglebutton",onAction:v}))),bE(h,d.backstage.shared.providers,[kE(u,f)])):(o=e,i=p,(c=(a=n).original).primary,s=t(c,["primary"]),l=Mt(Yh(z(z({},s),{type:"button",onAction:v}))),yE(l,i.backstage.shared.providers,[kE(o,a)]))},xE=function(e,t){var n,r,o,a,i=e.label.fold(function(){return{}},function(e){return{"aria-label":e}}),c=_h(yw.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:i,selectOnFocus:!0,inputBehaviours:fs([gg.config({mode:"special",onEnter:function(e){return s.findPrimary(e).map(function(e){return oo(e),!0})},onLeft:function(e,t){return t.cut(),D.none()},onRight:function(e,t){return t.cut(),D.none()}})])})),s=(n=c,r=e.commands,o=t,a=Y(r,function(e){return _h(_E(n,e,o))}),{asSpecs:function(){return Y(a,function(e){return e.asSpec()})},findPrimary:function(e){return ge(r,function(t,n){return t.primary?D.from(a[n]).bind(function(t){return t.getOpt(e)}).filter(k(bv.isDisabled)):D.none()})}});return[{title:D.none(),items:[c.asSpec()]},{title:D.none(),items:s.asSpecs()}]},CE=xE,SE=function(e,t){var n,r,o,a,i,c=qi(window),s=Gi(xn.fromDom(e.getContentAreaContainer())),l=Tv(e)||Ev(e)||Dv(e),u=(n=s,r=c,o=Math.max(r.x,n.x),a=n.right-o,i=r.width-(o-r.x),{x:o,width:Math.min(a,i)}),f=u.x,d=u.width;if(e.inline&&!l)return Xi(f,c.y,d,c.height);var m=function(e,t,n,r){var o=xn.fromDom(e.getContainer()),a=tc(o,".tox-editor-header").getOr(o),i=Gi(a),c=i.y>=t.bottom,s=r&&!c;if(e.inline&&s)return{y:Math.max(i.bottom,n.y),bottom:n.bottom};if(e.inline&&!s)return{y:n.y,bottom:Math.min(i.y,n.bottom)};var l=Gi(o);return s?{y:Math.max(i.bottom,n.y),bottom:Math.min(l.bottom,n.bottom)}:{y:Math.max(l.y,n.y),bottom:Math.min(i.y,n.bottom)}}(e,s,c,t.header.isPositionedAtTop()),g=m.y,h=m.bottom;return Xi(f,g,d,h-g)},zE=function(e,t){var n=Q(t,function(t){return t.predicate(e.dom)}),r=Z(n,function(e){return"contexttoolbar"===e.type});return{contextToolbars:r.pass,contextForms:r.fail}},TE=function(e,t,n){var r=zE(e,t);if(0<r.contextForms.length)return D.some({elem:e,toolbars:[r.contextForms[0]]});var o=zE(e,n);if(0<o.contextForms.length)return D.some({elem:e,toolbars:[o.contextForms[0]]});if(0<r.contextToolbars.length||0<o.contextToolbars.length){var a=function(e){if(e.length<=1)return e;var t=function(t){return X(e,function(e){return e.position===t})},n=function(t){return Q(e,function(e){return e.position===t})},r=t("selection"),o=t("node");if(r||o){if(o&&r){var a=n("node"),i=Y(n("selection"),function(e){return z(z({},e),{position:"node"})});return a.concat(i)}return n(r?"selection":"node")}return n("line")}(r.contextToolbars.concat(o.contextToolbars));return D.some({elem:e,toolbars:a})}return D.none()},EE=function(e,t,n){return e(t)?D.none():ar(t,function(e){var t=zE(e,n.inNodeScope),r=t.contextToolbars,o=t.contextForms,a=0<o.length?o:function(e){if(e.length<=1)return e;var t=function(t){return ne(e,function(e){return e.position===t})};return t("selection").orThunk(function(){return t("node")}).orThunk(function(){return t("line")}).map(function(e){return e.position}).fold(function(){return[]},function(t){return Q(e,function(e){return e.position===t})})}(r);return 0<a.length?D.some({elem:e,toolbars:a}):D.none()},e)},OE=function(e,t){var n={},r=[],o=[],a={},i={},c=function(e,c){var s=Mt(Bt("ContextForm",ip,c));(n[e]=s).launch.map(function(n){a["form:"+e]=z(z({},c.launch),{type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:function(){t(s)}})}),"editor"===s.scope?o.push(s):r.push(s),i[e]=s},s=function(e,t){Bt("ContextToolbar",cp,t).each(function(n){"editor"===t.scope?o.push(n):r.push(n),i[e]=n})},l=Pe(e);return J(l,function(t){var n=e[t];"contextform"===n.type?c(t,n):"contexttoolbar"===n.type&&s(t,n)}),{forms:n,inNodeScope:r,inEditorScope:o,lookupTable:i,formNavigators:a}},DE=ma("forward-slide"),NE=ma("backward-slide"),AE=ma("change-slide-event"),RE="tox-pop--resizing",PE=function(e,t,n){var r,o,a,i,c,s=n.dataset,l="basic"===s.type?function(){return Y(s.data,function(e){return yz(e,n.isSelectedFor,n.getPreviewFor)})}:s.getData;return{items:(r=t,o=n,a=function(e,t,n,a){var c=r.shared.providers.translate(e.title);if("separator"===e.type)return D.some({type:"separator",text:c});if("submenu"!==e.type)return D.some(z({type:"togglemenuitem",text:c,icon:e.icon,active:e.isSelected(a),disabled:n,onAction:o.onAction(e)},e.getStylePreview().fold(function(){return{}},function(e){return{meta:{style:e}}})));var s=ae(e.getStyleItems(),function(e){return i(e,t,a)});return 0===t&&s.length<=0?D.none():D.some({type:"nestedmenuitem",text:c,disabled:s.length<=0,getSubmenuItems:function(){return ae(e.getStyleItems(),function(e){return i(e,t,a)})}})},i=function(e,t,n){var r="formatter"===e.type&&o.isInvalid(e);return 0===t?r?[]:a(e,t,!1,n).toArray():a(e,t,r,n).toArray()},{validateItems:c=function(e){var t=o.getCurrentValue(),n=o.shouldHide?0:1;return ae(e,function(e){return i(e,n,t)})},getFetch:function(e,t){return function(n,r){var o=t(),a=c(o);r(UC(a,fp.CLOSE_ON_EXECUTE,e,!1))}}}),getStyleItems:l}},BE=function(e,t,n){var r=PE(0,t,n),o=r.items,a=r.getStyleItems;return LC({text:n.icon.isSome()?D.none():D.some(""),icon:n.icon,tooltip:D.from(n.tooltip),role:D.none(),fetch:o.getFetch(t,a),onSetup:function(t){return n.setInitialValue.each(function(e){return e(t.getComponent())}),n.nodeChangeHandler.map(function(n){var r=n(t.getComponent());return e.on("NodeChange",r),function(){e.off("NodeChange",r)}}).getOr(v)},getApi:function(e){return{getComponent:function(){return e}}},columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)};(rk=nk=nk||{})[rk.SemiColon=0]="SemiColon",rk[rk.Space=1]="Space";var ME,IE,LE,jE,FE,HE,VE=function(e,t,n,r){var o,a,i=e.getParam(t,n,"string");return{type:"basic",data:(a=i,o=r===nk.SemiColon?a.replace(/;$/,"").split(";"):a.split(" "),Y(o,function(e){var t=e,n=e,r=e.split("=");return 1<r.length&&(t=r[0],n=r[1]),{title:t,format:n}}))}},qE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],UE=function(e){var t=function(t){var n=ne(qE,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(e){return e.title.toLowerCase()});ro(t,IC,{icon:"align-"+n})},n=D.some(function(e){return function(){return t(e)}}),r=D.some(t),o={type:"basic",data:qE};return{tooltip:"Align",icon:D.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:D.none,getPreviewFor:function(){return function(){return D.none()}},onAction:function(t){return function(){return ne(qE,function(e){return e.format===t.format}).each(function(t){return e.execCommand(t.command)})}},setInitialValue:r,nodeChangeHandler:n,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},WE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],$E=function(e){var t=e.split(/\s*,\s*/);return Y(t,function(e){return e.replace(/^['"]+|['"]+$/g,"")})},XE=function(e){var t;return 0===e.indexOf("-apple-system")&&(t=$E(e.toLowerCase()),ie(WE,function(e){return-1<t.indexOf(e.toLowerCase())}))},GE=function(e){var t=function(){var t=function(e){return e?$E(e)[0]:""},n=e.queryCommandValue("FontName"),r=a.data,o=n?n.toLowerCase():"";return{matchOpt:ne(r,function(e){var n=e.format;return n.toLowerCase()===o||t(n).toLowerCase()===t(o).toLowerCase()}).orThunk(function(){return XE(o)?D.from({title:"System Font",format:o}):D.none()}),font:n}},n=function(e){var n=t(),r=n.matchOpt,o=n.font,a=r.fold(function(){return o},function(e){return e.title});ro(e,MC,{text:a})},r=D.some(function(e){return function(){return n(e)}}),o=D.some(n),a=VE(e,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",nk.SemiColon);return{tooltip:"Fonts",icon:D.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(e){return function(){return D.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}})}},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontName",!1,t.format)})}},setInitialValue:o,nodeChangeHandler:r,dataset:a,shouldHide:!1,isInvalid:x}},KE={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},YE={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},JE=function(e,t){return/[0-9.]+px$/.test(e)?(n=72*parseInt(e,10)/96,r=t||0,o=Math.pow(10,r),Math.round(n*o)/o+"pt"):qe(YE,e).getOr(e);var n,r,o},ZE=function(e){var t=function(){var t=D.none(),n=i.data,r=e.queryCommandValue("FontSize");if(r)for(var o=function(e){var o=JE(r,e),a=qe(KE,o).getOr("");t=ne(n,function(e){return e.format===r||e.format===o||e.format===a})},a=3;t.isNone()&&a>=0;a--)o(a);return{matchOpt:t,size:r}},n=b(D.none),r=function(e){var n=t(),r=n.matchOpt,o=n.size,a=r.fold(function(){return o},function(e){return e.title});ro(e,MC,{text:a})},o=D.some(function(e){return function(){return r(e)}}),a=D.some(r),i=VE(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",nk.Space);return{tooltip:"Font sizes",icon:D.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getPreviewFor:n,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},setInitialValue:a,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:x}},QE=function(e,t){var n=t(),r=Y(n,function(e){return e.format});return D.from(e.formatter.closest(r)).bind(function(e){return ne(n,function(t){return t.format===e})}).orThunk(function(){return nd(e.formatter.match("p"),{title:"Paragraph",format:"p"})})},eO=function(e){var t=kn(D.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(D.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(D.some(e))}}},tO=function(){return eO(function(e){return e.destroy()})},nO=function(){return eO(function(e){return e.unbind()})},rO=function(e,t){return function(n){var r=nO(),o=function(){n.setActive(e.formatter.match(t));var o=e.formatter.formatChanged(t,n.setActive);r.set(o)};return e.initialized?o():e.on("init",o),r.clear}},oO=function(e){return function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})}}},aO=function(e){var t=function(t){var n=QE(e,function(){return o.data}).fold(function(){return"Paragraph"},function(e){return e.title});ro(t,MC,{text:n})},n=D.some(function(e){return function(){return t(e)}}),r=D.some(t),o=VE(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",nk.SemiColon);return{tooltip:"Blocks",icon:D.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:D.none,getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return D.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))})}},onAction:oO(e),setInitialValue:r,nodeChangeHandler:n,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},iO=function(e,t){var n=function(t){var n=function(e){var t=e.items;return void 0!==t&&0<t.length?ae(t,n):[{title:e.title,format:e.format}]},r=ae(vz(e),n),o=QE(e,function(){return r}).fold(function(){return"Paragraph"},function(e){return e.title});ro(t,MC,{text:o})},r=D.some(function(e){return function(){return n(e)}}),o=D.some(n);return{tooltip:"Formats",icon:D.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:D.none,getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return void 0!==n?D.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):D.none()}},onAction:oO(e),setInitialValue:o,nodeChangeHandler:r,shouldHide:e.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!e.formatter.canApply(t.format)},dataset:t}},cO=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],sO=function(e,t){return function(n,r,o){var a=e(n).mapError(function(e){return Lt(e)}).getOrDie();return t(a,r,o)}},lO={button:sO(Yh,function(e,t){return n=e,r=t.backstage.shared.providers,yE(n,r,[]);var n,r}),togglebutton:sO(Qh,function(e,t){return n=e,r=t.backstage.shared.providers,bE(n,r,[]);var n,r}),menubutton:sO(QT,function(e,t){return $C(e,"tox-tbtn",t.backstage,D.none())}),splitbutton:sO(function(e){return Bt("SplitButton",eE,e)},function(e,t){return wE(e,t.backstage.shared)}),grouptoolbarbutton:sO(function(e){return Bt("GroupToolbarButton",YT,e)},function(e,t,n){var r,o,a,i,c,s,l=n.ui.registry.getAll().buttons,u=((r={})[Qs]=t.backstage.shared.header.isPositionedAtTop()?cc.TopToBottom:cc.BottomToTop,r);switch(Rv(n)){case lp.floating:return o=e,a=t.backstage,i=function(e){return mO(n,{buttons:l,toolbar:e,allowToolbarGroups:!1},t,D.none())},c=u,s=a.shared,gT.sketch({lazySink:s.getSink,fetch:function(){return Ew(function(e){e(Y(i(o.items),UT))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:pE(o.icon,o.text,o.tooltip,D.none(),D.none(),s.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:c}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(e,t){return n=e,r=t.backstage,o=z({type:"advanced"},r.styleselect),BE(n,r,iO(n,o));var n,r,o},fontsizeSelectButton:function(e,t){return n=e,r=t.backstage,BE(n,r,ZE(n));var n,r},fontSelectButton:function(e,t){return n=e,r=t.backstage,BE(n,r,GE(n));var n,r},formatButton:function(e,t){return n=e,r=t.backstage,BE(n,r,aO(n));var n,r},alignMenuButton:function(e,t){return n=e,r=t.backstage,BE(n,r,UE(n));var n,r}},uO={styleselect:lO.styleSelectButton,fontsizeselect:lO.fontsizeSelectButton,fontselect:lO.fontSelectButton,formatselect:lO.formatButton,align:lO.alignMenuButton},fO=function(e){var t,n,r,o=e.toolbar,a=e.buttons;return!1===o?[]:void 0===o||!0===o?(n=a,r=Y(cO,function(e){var t=Q(e.items,function(e){return Ue(n,e)||Ue(uO,e)});return{name:e.name,items:t}}),Q(r,function(e){return 0<e.items.length})):R(o)?(t=o.split("|"),Y(t,function(e){return{items:e.trim().split(" ")}})):H(o,function(e){return Ue(e,"name")&&Ue(e,"items")})?o:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},dO=function(e,t,n,r,o,a){return qe(t,n.toLowerCase()).orThunk(function(){return a.bind(function(e){return ge(e,function(e){return qe(t,e+n.toLowerCase())})})}).fold(function(){return qe(uO,n.toLowerCase()).map(function(t){return t(e,o)}).orThunk(function(){return D.none()})},function(t){return"grouptoolbarbutton"!==t.type||r?(i=o,c=e,qe(lO,(a=t).type).fold(function(){return console.error("skipping button defined by",a),D.none()},function(e){return D.some(e(a,i,c))})):(console.warn("Ignoring the '"+n+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),D.none());var a,i,c})},mO=function(e,t,n,r){var o=fO(t),a=Y(o,function(o){var a=ae(o.items,function(o){return 0===o.trim().length?[]:dO(e,t.buttons,o,t.allowToolbarGroups,n,r).toArray()});return{title:D.from(e.translate(o.name)),items:a}});return Q(a,function(e){return 0<e.items.length})},gO={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},hO={maxHeightFunction:js(),maxWidthFunction:Kz()},pO={onLtr:function(){return[Gc,Kc,$c,Uc,Xc,Wc,yh,bh,ph,gh,vh,hh]},onRtl:function(){return[Gc,Kc,Xc,Wc,$c,Uc,yh,bh,vh,hh,ph,gh]}},vO={onLtr:function(){return[Kc,Uc,Wc,$c,Xc,Gc,yh,bh,ph,gh,vh,hh]},onRtl:function(){return[Kc,Wc,Uc,Xc,$c,Gc,yh,bh,vh,hh,ph,gh]}},yO=function(e,t,n,r){var o,a,i=Zn().deviceType.isTouch,c=xi((o={sink:n,onEscape:function(){return e.focus(),D.some(!0)}},a=kn([]),sh.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(e){a.set([]),sh.getContent(e).each(function(e){ui(e.element,"visibility")}),Xa(e.element,RE),ui(e.element,"width")},inlineBehaviours:fs([wg("context-toolbar-events",[yo(Tr(),function(e){Xa(e.element,RE),ui(e.element,"width")}),fo(AE,function(e,t){var n=e.element;ui(n,"width");var r=Bi(n);sh.setContent(e,t.event.contents),Wa(n,RE);var o=Bi(n);ri(n,"width",r+"px"),sh.getContent(e).each(function(e){t.event.focus.bind(function(e){return bs(e),ks(n)}).orThunk(function(){return gg.focusIn(e),ws(Ho(n))})}),wh.setTimeout(function(){ri(e.element,"width",o+"px")},0)}),fo(DE,function(e,t){sh.getContent(e).each(function(t){a.set(a.get().concat([{bar:t,focus:ws(Ho(e.element))}]))}),ro(e,AE,{contents:t.event.forwardContents,focus:D.none()})}),fo(NE,function(e){de(a.get()).each(function(t){a.set(a.get().slice(0,a.get().length-1)),ro(e,AE,{contents:Ci(t.bar),focus:t.focus})})})]),gg.config({mode:"special",onEscape:function(e){return de(a.get()).fold(function(){return o.onEscape()},function(){return no(e,NE),D.some(!0)})}})]),lazySink:function(){return ve.value(o.sink)}}))),s=function(){return SE(e,r.backstage.shared)},l=function(){if(i()&&r.backstage.isContextMenuOpen())return!0;var t,n,o,a,c,l,u=(t=g.get().filter(function(e){return Za(xn.fromDom(e))}).map(function(e){return e.getBoundingClientRect()}).getOrThunk(function(){return e.selection.getRng().getBoundingClientRect()}),n=e.inline?Fi().top:Ki(xn.fromDom(e.getBody())).y,{y:t.top+n,bottom:t.bottom+n}),f=s();return o=u.y,a=u.bottom,c=f.y,l=f.bottom,!(Math.max(o,c)<=Math.min(a,l))},u=function(){m.set(D.none()),sh.hide(c)},f=function(){sh.hide(c)},d=function(){m.get().each(function(e){var t=c.element;ui(t,"display"),l()?ri(t,"display","none"):iu.positionWithinBounds(n,e,c,D.some(s()))})},m=kn(D.none()),g=kn(D.none()),h=kn(null),p=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:fs([gg.config({mode:"acyclic"}),wg("pop-dialog-wrap-events",[bo(function(t){e.shortcuts.add("ctrl+F9","focus statusbar",function(){return gg.focusIn(t)})}),wo(function(){e.shortcuts.remove("ctrl+F9")})])])}},y=Je(function(){return OE(t,function(e){var t=b([e]);ro(c,DE,{forwardContents:p(t)})})}),b=function(t){var n=e.ui.registry.getAll().buttons,o=y(),a=z(z({},n),o.formNavigators),i=Rv(e)===lp.scrolling?lp.scrolling:lp["default"],c=oe(Y(t,function(t){return"contexttoolbar"===t.type?mO(e,{buttons:a,toolbar:t.items,allowToolbarGroups:!1},r,D.some(["form:"])):(n=t,o=r.backstage.shared.providers,CE(n,o));var n,o}));return KT({type:i,uid:ma("context-toolbar"),initGroups:c,onEscape:D.none,cyclicKeying:!0,providers:r.backstage.shared.providers})};e.on("contexttoolbar-show",function(t){var n=y();qe(n.lookupTable,t.toolbarKey).each(function(n){k([n],t.target===e?D.none():D.some(t)),sh.getContent(c).each(gg.focusIn)})});var w=function(e,t){var n,o,a="node"===e?r.backstage.shared.anchors.node(t):r.backstage.shared.anchors.cursor();return Ke(a,(n=e,o=i(),"line"===n?{bubble:Us(12,0,gO),layouts:{onLtr:function(){return[Yc]},onRtl:function(){return[Jc]}},overrides:hO}:{bubble:Us(0,12,gO),layouts:o?vO:pO,overrides:hO}))},k=function(e,t){var n,o,a,u;x(),i()&&r.backstage.isContextMenuOpen()||(n=b(e),o=t.map(xn.fromDom),a=w(e[0].position,o),m.set(D.some(a)),g.set(t),u=c.element,ui(u,"display"),sh.showWithinBounds(c,a,p(n),function(){return D.some(s())}),l()&&ri(u,"display","none"))},_=function(){var t,n,r,o,a,i,c;e.hasFocus()&&(t=y(),n=t,r=e,a=xn.fromDom(r.getBody()),i=function(e){return tr(e,a)},c=xn.fromDom(r.selection.getNode()),(i(o=c)||rr(a,o)?TE(c,n.inNodeScope,n.inEditorScope).orThunk(function(){return EE(i,c,n)}):D.none()).fold(u,function(e){k(e.toolbars,D.some(e.elem.dom))}))},x=function(){var e=h.get();null!==e&&(wh.clearTimeout(e),h.set(null))},C=function(){x(),h.set(wh.setEditorTimeout(e,_,0))};e.on("init",function(){e.on(Yz,f),e.on("ScrollContent ScrollWindow longpress",d),e.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){C()}),e.on("focusout",function(){wh.setEditorTimeout(e,function(){ks(n.element).isNone()&&ks(c.element).isNone()&&u()},0)}),e.on("SwitchMode",function(){e.mode.isReadOnly()&&u()}),e.on("AfterProgressState",function(t){t.state?u():e.hasFocus()&&C()}),e.on("NodeChange",function(){ks(c.element).fold(C,v)})})},bO=Xf,wO=Df,kO=b([fn("shell",!1),Yt("makeItem"),fn("setupItem",v),Zu("listBehaviours",[bg])]),_O=Tf({name:"items",overrides:function(){return{behaviours:fs([bg.config({})])}}}),xO=b([_O]),CO=ed({name:b("CustomList")(),configFields:kO(),partFields:xO(),factory:function(e,t){var n=e.shell?{behaviours:[bg.config({})],components:[]}:{behaviours:[],components:t},r=function(t){return e.shell?D.some(t):jf(t,e,"items")};return{uid:e.uid,dom:e.dom,components:n.components,behaviours:Ju(e.listBehaviours,n.behaviours),apis:{setItems:function(t,n){r(t).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(r){var o=bg.contents(r),a=n.length,i=a-o.length,c=i>0?G(i,function(){return e.makeItem()}):[],s=o.slice(a);J(s,function(e){return bg.remove(r,e)}),J(c,function(e){return bg.append(r,e)});var l=bg.contents(r);J(l,function(r,o){e.setupItem(t,r,n[o],o)})})}}}},apis:{setItems:function(e,t,n){e.setItems(t,n)}}}),SO=b([]),zO=Object.freeze({__proto__:null,setup:v,isDocked:x,getBehaviours:SO}),TO=function(e){return(si(e,"position").is("fixed")?D.none():Bo(e)).orThunk(function(){var t=xn.fromTag("span");return Ro(e).bind(function(e){Ko(e,t);var n=Bo(t);return Zo(t),n})})},EO=function(e){return TO(e).map(Ai).getOrThunk(function(){return Di(0,0)})},OO=$e([{"static":[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),DO=function(e,t){var n=e.element;Wa(n,t.transitionClass),Xa(n,t.fadeOutClass),Wa(n,t.fadeInClass),t.onShow(e)},NO=function(e,t){var n=e.element;Wa(n,t.transitionClass),Xa(n,t.fadeInClass),Wa(n,t.fadeOutClass),t.onHide(e)},AO=function(e,t,n){return ie(e,function(e){switch(e){case"bottom":return o=n,t.bottom<=o.bottom;case"top":return r=n,t.y>=r.y}var r,o})},RO=function(e,t){return t.getInitialPosition().map(function(t){return Xi(t.bounds.x,t.bounds.y,Bi(e),Ti(e))})},PO=function(e,t,n){n.setInitialPosition(D.some({style:function(e){var t={},n=e.dom;if(Ja(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t}(e),position:ii(e,"position")||"static",bounds:t}))},BO=function(e,t,n){return n.getInitialPosition().bind(function(r){switch(n.setInitialPosition(D.none()),r.position){case"static":return D.some(OO["static"]());case"absolute":var o=TO(e).map(Gi).getOrThunk(function(){return Gi(Qa())});return D.some(OO.absolute(xs("absolute",qe(r.style,"left").map(function(){return t.x-o.x}),qe(r.style,"top").map(function(){return t.y-o.y}),qe(r.style,"right").map(function(){return o.right-t.right}),qe(r.style,"bottom").map(function(){return o.bottom-t.bottom}))));default:return D.none()}})},MO=function(e,t,n){var r,o,a,i=e.element;return si(i,"position").is("fixed")?(o=t,RO(r=i,a=n).filter(function(e){return AO(a.getModes(),e,o)}).bind(function(e){return BO(r,e,a)})):function(e,t,n){var r=Gi(e);if(AO(n.getModes(),r,t))return D.none();PO(e,r,n);var o=Yi(),a=r.x-o.x,i=t.y-o.y,c=o.bottom-t.bottom,s=r.y<=t.y;return D.some(OO.fixed(xs("fixed",D.some(a),s?D.some(i):D.none(),D.none(),s?D.none():D.some(c))))}(i,t,n)},IO=function(e,t){J(["left","right","top","bottom","position"],function(t){return ui(e.element,t)}),t.onUndocked(e)},LO=function(e,t,n){Cs(e.element,n),("fixed"===n.position?t.onDocked:t.onUndocked)(e)},jO=function(e,t,n,r,o){void 0===o&&(o=!1),t.contextual.each(function(t){t.lazyContext(e).each(function(a){var i,c,s=(c=r,(i=a).y<c.bottom&&i.bottom>c.y);s!==n.isVisible()&&(n.setVisible(s),o&&!s?(Ka(e.element,[t.fadeOutClass]),t.onHide(e)):(s?DO:NO)(e,t))})})},FO=function(e,t,n){var r,o,a=e.element;n.setDocked(!1),r=n,o=e.element,RO(o,r).bind(function(e){return BO(o,e,r)}).each(function(n){n.fold(function(){return IO(e,t)},function(n){return LO(e,t,n)},v)}),n.setVisible(!0),t.contextual.each(function(t){Ya(a,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)}),HO(e,t,n)},HO=function(e,t,n){var r,o,a,i,c;e.getSystem().isConnected()&&(r=e,a=n,i=(o=t).lazyViewport(r),(c=a.isDocked())&&jO(r,o,a,i),MO(r,i,a).each(function(e){a.setDocked(!c),e.fold(function(){return IO(r,o)},function(e){return LO(r,o,e)},function(e){jO(r,o,a,i,!0),LO(r,o,e)})}))},VO=function(e,t,n){n.isDocked()&&FO(e,t,n)},qO=Object.freeze({__proto__:null,refresh:HO,reset:VO,isDocked:function(e,t,n){return n.isDocked()},getModes:function(e,t,n){return n.getModes()},setModes:function(e,t,n,r){return n.setModes(r)}}),UO=Object.freeze({__proto__:null,events:function(e,t){return so([yo(Tr(),function(n,r){e.contextual.each(function(e){Ga(n.element,e.transitionClass)&&(Ya(n.element,[e.transitionClass,e.fadeInClass]),(t.isVisible()?e.onShown:e.onHidden)(n)),r.stop()})}),fo(Ur(),function(n){HO(n,e,t)}),fo(Wr(),function(n){VO(n,e,t)})])}}),WO=[un("contextual",[Zt("fadeInClass"),Zt("fadeOutClass"),Zt("transitionClass"),en("lazyContext"),wc("onShow"),wc("onShown"),wc("onHide"),wc("onHidden")]),vn("lazyViewport",Yi),yn("modes",["top","bottom"],Ut),wc("onDocked"),wc("onUndocked")],$O=ms({fields:WO,name:"docking",active:UO,apis:qO,state:Object.freeze({__proto__:null,init:function(e){var t=kn(!1),n=kn(!0),r=kn(D.none()),o=kn(e.modes);return Da({isDocked:t.get,setDocked:t.set,getInitialPosition:r.get,setInitialPosition:r.set,isVisible:n.get,setVisible:n.set,getModes:o.get,setModes:o.set,readState:function(){return"docked:  "+t.get()+", visible: "+n.get()+", modes: "+o.get().join(",")}})}})}),XO={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},GO="tox-tinymce--toolbar-sticky-on",KO="tox-tinymce--toolbar-sticky-off",YO=function(e){var t=e.element;Ro(t).each(function(n){var r,o,a="padding-"+$O.getModes(e)[0];$O.isDocked(e)?(r=Bi(n),ri(t,"width",r+"px"),ri(n,a,Ei(o=t)+(parseInt(ii(o,"margin-top"),10)||0)+(parseInt(ii(o,"margin-bottom"),10)||0)+"px")):(ui(t,"width"),ui(n,a))})},JO=function(e,t){t?(Xa(e,XO.fadeOutClass),Ka(e,[XO.transitionClass,XO.fadeInClass])):(Xa(e,XO.fadeInClass),Ka(e,[XO.fadeOutClass,XO.transitionClass]))},ZO=function(e,t){var n=xn.fromDom(e.getContainer());t?(Wa(n,GO),Xa(n,KO)):(Wa(n,KO),Xa(n,GO))},QO=function(e,t){var r,o=kn(D.none()),a=t.getSink,i=function(e){a().each(function(t){return e(t.element)})},c=function(t){e.inline||YO(t),ZO(e,$O.isDocked(t)),t.getSystem().broadcastOn([Du()],{}),a().each(function(e){return e.getSystem().broadcastOn([Du()],{})})},s=e.inline?[]:[vs.config({channels:((r={})[VT()]={onReceive:YO},r)})];return n([Sg.config({}),$O.config({contextual:z({lazyContext:function(t){var n,r,o=Ei(t.element),a=e.inline?e.getContentAreaContainer():e.getContainer(),i=Gi(xn.fromDom(a)),c=i.height-o,s=i.y+(n=t,r="top",$($O.getModes(n),r)?0:o);return D.some(Xi(i.x,s,i.width,c))},onShow:function(){i(function(e){return JO(e,!0)})},onShown:function(e){i(function(e){return Ya(e,[XO.transitionClass,XO.fadeInClass])}),o.get().each(function(t){var n,r,a;n=e.element,a=Oo(r=t),ws(a).filter(function(e){return!tr(r,e)}).filter(function(e){return tr(e,xn.fromDom(a.dom.body))||rr(n,e)}).each(function(){return bs(r)}),o.set(D.none())})},onHide:function(e){var t,n;o.set((t=e.element,n=a,ks(t).orThunk(function(){return n().toOptional().bind(function(e){return ks(e.element)})}))),i(function(e){return JO(e,!1)})},onHidden:function(){i(function(e){return Ya(e,[XO.transitionClass])})}},XO),modes:[t.header.getDockingMode()],onDocked:c,onUndocked:c})],s)},eD=Object.freeze({__proto__:null,setup:function(e,t,n){e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",function(){n().each($O.reset)}),e.on("ResizeWindow ResizeEditor",function(){n().each(YO)}),e.on("SkinLoaded",function(){n().each(function(e){$O.isDocked(e)?$O.reset(e):$O.refresh(e)})}),e.on("FullscreenStateChanged",function(){n().each($O.reset)})),e.on("AfterScrollIntoView",function(e){n().each(function(t){$O.refresh(t);var n,r,o,a,i,c,s,l,u,f,d,m,g,h,p,v,y,b=t.element;sm(b)&&(n=e,a=Oo(r=b),i=a.dom.defaultView.innerHeight,c=Fi(a),s=xn.fromDom(n.elm),l=Ki(s),u=Ti(s),f=l.y,d=f+u,m=Ai(r),g=Ti(r),h=m.top,p=h+g,v=Math.abs(h-c.top)<2,y=Math.abs(p-(c.top+i))<2,v&&p>f?Hi(c.left,f-g,a):y&&d>h&&(o=f-i+u+g,Hi(c.left,o,a)))})}),e.on("PostRender",function(){ZO(e,!1)})},isDocked:function(e){return e().map($O.isDocked).getOr(!1)},getBehaviours:QO}),tD=Qf({factory:function(e,t){var n={focus:gg.focusIn,setMenus:function(e,n){var r=Y(n,function(e){var n={type:"menubutton",text:e.text,fetch:function(t){t(e.getItems())}},r=QT(n).mapError(function(e){return Lt(e)}).getOrDie();return $C(r,"tox-mbtn",t.backstage,D.some("menuitem"))});bg.set(e,r)}};return{uid:e.uid,dom:e.dom,components:[],behaviours:fs([bg.config({}),wg("menubar-events",[bo(function(t){e.onSetup(t)}),fo(br(),function(e,t){tc(e.element,".tox-mbtn--active").each(function(n){nc(t.event.target,".tox-mbtn").each(function(t){tr(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(e){pk.expand(e),pk.close(n),Sg.focus(e)})})})})}),fo(Yr(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(e){pk.isOpen(n)&&(pk.expand(e),pk.close(n))})})})]),gg.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return e.onEscape(t),D.some(!0)}}),Qb.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Yt("dom"),Yt("uid"),Yt("onEscape"),Yt("backstage"),fn("onSetup",v)],apis:{focus:function(e,t){e.focus(t)},setMenus:function(e,t,n){e.setMenus(t,n)}}}),nD="container",rD=[Ku("slotBehaviours",[])],oD=function(e){return"<alloy.field."+e+">"},aD=function(e,t){var n,r=function(){return qf(e)},o=function(t,n){return function(r,o){return jf(r,e,o).map(function(e){return t(e,o)}).getOr(n)}},a=function(e){return"true"!==oa(e.element,"aria-hidden")},i=o(a,!1),c=o(function(e,t){var n;a(e)&&(n=e.element,ri(n,"display","none"),ra(n,"aria-hidden","true"),ro(e,Jr(),{name:t,visible:!1}))}),s=function(e,t){J(t,function(t){return n(e,t)})},l=o(function(e,t){var n;a(e)||(n=e.element,ui(n,"display"),ca(n,"aria-hidden"),ro(e,Jr(),{name:t,visible:!0}))}),u={getSlotNames:r,getSlot:function(t,n){return jf(t,e,n)},isShowing:i,hideSlot:n=c,hideAllSlots:function(e){return s(e,r())},showSlot:l};return{uid:e.uid,dom:e.dom,components:t,
behaviours:Yu(e.slotBehaviours),apis:u}},iD=Ie({getSlotNames:function(e,t){return e.getSlotNames(t)},getSlot:function(e,t,n){return e.getSlot(t,n)},isShowing:function(e,t,n){return e.isShowing(t,n)},hideSlot:function(e,t,n){return e.hideSlot(t,n)},hideAllSlots:function(e,t){return e.hideAllSlots(t)},showSlot:function(e,t,n){return e.showSlot(t,n)}},Ea),cD=z(z({},iD),{sketch:function(e){var t,n=(t=[],{slot:function(e,n){return t.push(e),Pf(nD,oD(e),n)},record:function(){return t}}),r=e(n),o=n.record(),a=Y(o,function(e){return Sf({name:e,pname:oD(e)})});return Kf(nD,rD,a,aD,r)}}),sD=wt([sn("icon"),sn("tooltip"),vn("onShow",v),vn("onHide",v),vn("onSetup",function(){return v})]),lD=function(e){return{element:function(){return e.element.dom}}},uD=function(e,t){var n=Y(Pe(t),function(e){var n=t[e],r=Mt(Bt("sidebar",sD,n));return{name:e,getApi:lD,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}});return Y(n,function(t){var r=kn(v);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Kp([ey(t,r),ty(t,r),fo(Jr(),function(e,t){var r=t.event;ne(n,function(e){return e.name===r.name}).each(function(t){(r.visible?t.onShow:t.onHide)(t.getApi(e))})})])})})},fD=function(e,t){id.getCurrent(e).each(function(e){return bg.set(e,[(n=t,cD.sketch(function(e){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:uD(e,n),slotBehaviours:Kp([bo(function(e){return cD.hideAllSlots(e)})])}}))]);var n})},dD=function(e){return id.getCurrent(e).bind(function(e){return MT.isGrowing(e)||MT.hasGrown(e)?id.getCurrent(e).bind(function(e){return ne(cD.getSlotNames(e),function(t){return cD.isShowing(e,t)})}):D.none()})},mD=ma("FixSizeEvent"),gD=ma("AutoSizeEvent"),hD=function(e){var t,n,r,o=xn.fromHtml(e),a=Mo(o),i=(n=void 0!==(t=o).dom.attributes?t.dom.attributes:[],te(n,function(e,t){var n;return"class"===t.name?e:z(z({},e),((n={})[t.name]=t.value,n))},{})),c=(r=o,Array.prototype.slice.call(r.dom.classList,0)),s=0===a.length?{}:{innerHtml:ea(o)};return z({tag:xo(o),classes:c,attributes:i},s)},pD=function(e,t,n){var r=e.element;!0===t?(bg.set(e,[{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:hD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:fs([gg.config({mode:"special",onTab:function(){return D.some(!0)},onShiftTab:function(){return D.some(!0)}}),Sg.config({})])}]),ui(r,"display"),ca(r,"aria-hidden")):(bg.set(e,[]),ri(r,"display","none"),ra(r,"aria-hidden","true"))},vD=wO.optional({factory:tD,name:"menubar",schema:[Yt("backstage")]}),yD=wO.optional({factory:{sketch:function(e){return CO.sketch({uid:e.uid,dom:e.dom,listBehaviours:fs([gg.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return KT({type:e.type,uid:ma("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:function(){return e.onEscape(),D.some(!0)}})},setupItem:function(e,t,n){Qz.setGroups(t,n)},shell:!0})}},name:"multiple-toolbar",schema:[Yt("dom"),Yt("onEscape")]}),bD=wO.optional({factory:{sketch:function(e){var t;return((t=e).type===lp.sliding?GT:t.type===lp.floating?XT:KT)({type:e.type,uid:e.uid,onEscape:function(){return e.onEscape(),D.some(!0)},cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes})}},name:"toolbar",schema:[Yt("dom"),Yt("onEscape"),Yt("getSink")]}),wD=wO.optional({factory:{sketch:function(e){var t=e.editor,n=e.sticky?QO:SO;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:fs(n(t,e.sharedBackstage))}}},name:"header",schema:[Yt("dom")]}),kD=wO.optional({name:"socket",schema:[Yt("dom")]}),_D=wO.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:fs([Qb.config({}),Sg.config({}),MT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(e){id.getCurrent(e).each(cD.hideAllSlots),no(e,gD)},onGrown:function(e){no(e,gD)},onStartGrow:function(e){ro(e,mD,{width:si(e.element,"width").getOr("")})},onStartShrink:function(e){ro(e,mD,{width:Bi(e.element)+"px"})}}),bg.config({}),id.config({find:function(e){var t=bg.contents(e);return fe(t)}})])}],behaviours:fs([wx(0),wg("sidebar-sliding-events",[fo(mD,function(e,t){ri(e.element,"width",t.event.width)}),fo(gD,function(e){ui(e.element,"width")})])])}}},name:"sidebar",schema:[Yt("dom")]}),xD=wO.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:fs([bg.config({})]),components:[]}}},name:"throbber",schema:[Yt("dom")]}),CD=ed({name:"OuterContainer",factory:function(e,t){var n={getSocket:function(t){return bO.getPart(t,e,"socket")},setSidebar:function(t,n){bO.getPart(t,e,"sidebar").each(function(e){return fD(e,n)})},toggleSidebar:function(t,n){bO.getPart(t,e,"sidebar").each(function(e){return t=e,r=n,void id.getCurrent(t).each(function(e){id.getCurrent(e).each(function(t){MT.hasGrown(e)?cD.isShowing(t,r)?MT.shrink(e):(cD.hideAllSlots(t),cD.showSlot(t,r)):(cD.hideAllSlots(t),cD.showSlot(t,r),MT.grow(e))})});var t,r})},whichSidebar:function(t){return bO.getPart(t,e,"sidebar").bind(dD).getOrNull()},getHeader:function(t){return bO.getPart(t,e,"header")},getToolbar:function(t){return bO.getPart(t,e,"toolbar")},setToolbar:function(t,n){bO.getPart(t,e,"toolbar").each(function(e){e.getApis().setGroups(e,n)})},setToolbars:function(t,n){bO.getPart(t,e,"multiple-toolbar").each(function(e){CO.setItems(e,n)})},refreshToolbar:function(t){bO.getPart(t,e,"toolbar").each(function(e){return e.getApis().refresh(e)})},toggleToolbarDrawer:function(t){bO.getPart(t,e,"toolbar").each(function(e){var t,n;t=e.getApis().toggle,n=function(t){return t(e)},void 0!==t&&null!==t?D.some(n(t)):D.none()})},isToolbarDrawerToggled:function(t){return bO.getPart(t,e,"toolbar").bind(function(e){return D.from(e.getApis().isOpen).map(function(t){return t(e)})}).getOr(!1)},getThrobber:function(t){return bO.getPart(t,e,"throbber")},focusToolbar:function(t){bO.getPart(t,e,"toolbar").orThunk(function(){return bO.getPart(t,e,"multiple-toolbar")}).each(function(e){gg.focusIn(e)})},setMenubar:function(t,n){bO.getPart(t,e,"menubar").each(function(e){tD.setMenus(e,n)})},focusMenubar:function(t){bO.getPart(t,e,"menubar").each(function(e){tD.focus(e)})}};return{uid:e.uid,dom:e.dom,components:t,apis:n,behaviours:e.behaviours}},configFields:[Yt("dom"),Yt("behaviours")],partFields:[wD,vD,bD,yD,kD,_D,xD],apis:{getSocket:function(e,t){return e.getSocket(t)},setSidebar:function(e,t,n){e.setSidebar(t,n)},toggleSidebar:function(e,t,n){e.toggleSidebar(t,n)},whichSidebar:function(e,t){return e.whichSidebar(t)},getHeader:function(e,t){return e.getHeader(t)},getToolbar:function(e,t){return e.getToolbar(t)},setToolbar:function(e,t,n){var r=Y(n,UT);e.setToolbar(t,r)},setToolbars:function(e,t,n){var r=Y(n,function(e){return Y(e,UT)});e.setToolbars(t,r)},refreshToolbar:function(e,t){return e.refreshToolbar(t)},toggleToolbarDrawer:function(e,t){e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(e,t){return e.isToolbarDrawerToggled(t)},getThrobber:function(e,t){return e.getThrobber(t)},setMenubar:function(e,t,n){e.setMenubar(t,n)},focusMenubar:function(e,t){e.focusMenubar(t)},focusToolbar:function(e,t){e.focusToolbar(t)}}}),SD={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},zD=function(e){return"string"==typeof e?e.split(" "):e},TD=function(e,t){var n=z(z({},SD),t.menus),r=0<Pe(t.menus).length,o=zD(void 0===t.menubar||!0===t.menubar?"file edit view insert format tools table help":!1===t.menubar?"":t.menubar),a=Q(o,function(e){return r&&t.menus.hasOwnProperty(e)&&t.menus[e].hasOwnProperty("items")||SD.hasOwnProperty(e)}),i=Y(a,function(r){var o,a,i,c=n[r];return o={title:c.title,items:zD(c.items)},a=t,i=e.getParam("removed_menuitems","").split(/[ ,]/),{text:o.title,getItems:function(){return ae(o.items,function(e){var t=e.toLowerCase();return 0===t.trim().length||X(i,function(e){return e===t})?[]:"separator"===t||"|"===t?[{type:"separator"}]:a.menuItems[t]?[a.menuItems[t]]:[]})}}});return Q(i,function(e){return 0<e.getItems().length&&X(e.getItems(),function(e){return"separator"!==e.type})})},ED=function(e){var t=function(){e._skinLoaded=!0,e.fire("SkinLoaded")};return function(){e.initialized?t():e.on("init",t)}},OD=function(e,t){return function(){return n={message:t},e.fire("SkinLoadError",n);var n}},DD=function(e,t,n){return new Lh(function(r,o){n.load(t,r,o),e.on("remove",function(){return n.unload(t)})})},ND=function(e,t){var n;return n=xn.fromDom(e.getElement()),qo(n).isSome()?DD(e,t+"/skin.shadowdom.min.css",ov.DOM.styleSheetLoader):Lh.resolve()},AD=function(e,t){var n,r,o,a,i,c=(o=(n=t).getParam("skin"),a=n.getParam("skin_url"),!1!==o&&(r=o||"oxide",a=a?n.documentBaseURI.toAbsolute(a):wv.baseURL+"/skins/ui/"+r),a);c&&t.contentCSS.push(c+(e?"/content.inline":"/content")+".min.css"),0==(!1===t.getParam("skin"))&&R(c)?Lh.all([DD(i=t,c+"/skin.min.css",i.ui.styleSheetLoader),ND(t,c)]).then(ED(t),OD(t,"Skin could not be loaded")):ED(t)()},RD=e(AD,!1),PD=e(AD,!0),BD=function(e,t,n,r){var o,a=t.outerContainer,i=n.toolbar,c=n.buttons;H(i,R)?(o=i.map(function(t){var o={toolbar:t,buttons:c,allowToolbarGroups:n.allowToolbarGroups};return mO(e,o,{backstage:r},D.none())}),CD.setToolbars(a,o)):CD.setToolbar(a,mO(e,n,{backstage:r},D.none()))},MD=Zn(),ID=MD.os.isiOS()&&MD.os.version.major<=12,LD=function(e,t){var n=e.dom,r=e.getWin(),o=e.getDoc().documentElement,a=kn(Di(r.innerWidth,r.innerHeight)),i=kn(Di(o.offsetWidth,o.offsetHeight)),c=function(){var t=a.get();t.left===r.innerWidth&&t.top===r.innerHeight||(a.set(Di(r.innerWidth,r.innerHeight)),Fy(e))},s=function(){var t=e.getDoc().documentElement,n=i.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(i.set(Di(t.offsetWidth,t.offsetHeight)),Fy(e))},l=function(t){return n=t,e.fire("ScrollContent",n);var n};n.bind(r,"resize",c),n.bind(r,"scroll",l);var u=Ob(xn.fromDom(e.getBody()),"load",s),f=t.uiMothership.element;e.on("hide",function(){ri(f,"display","none")}),e.on("show",function(){ui(f,"display")}),e.on("NodeChange",s),e.on("remove",function(){u.unbind(),n.unbind(r,"resize",c),n.unbind(r,"scroll",l),r=null})},jD=Object.freeze({__proto__:null,render:function(e,t,n,r,o){var a=kn(0),i=t.outerContainer;RD(e);var c,s,l=xn.fromDom(o.targetNode),u=Vo(Ho(l));c=l,s=t.mothership,vu(c,s,Xo),pu(u,t.uiMothership),e.on("PostRender",function(){BD(e,t,n,r),a.set(e.getWin().innerWidth),CD.setMenubar(i,TD(e,n)),CD.setSidebar(i,n.sidebar),LD(e,t)});var f,d,m,g,h,p=CD.getSocket(i).getOrDie("Could not find expected socket element");ID&&(oi(p.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),m=function(){e.fire("ScrollContent")},g=20,h=null,f={cancel:function(){null!==h&&(clearTimeout(h),h=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===h&&(h=setTimeout(function(){m.apply(null,e),h=null},g))}},d=Eb(p.element,"scroll",f.throttle),e.on("remove",d.unbind)),Xv(e,t),e.addCommand("ToggleSidebar",function(t,n){CD.toggleSidebar(i,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return CD.whichSidebar(i)});var v=Rv(e);v!==lp.sliding&&v!==lp.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var n=e.getWin().innerWidth;n!==a.get()&&(CD.refreshToolbar(t.outerContainer),a.set(n))});var y={enable:function(){$v(t,!1)},disable:function(){$v(t,!0)},isDisabled:function(){return bv.isDisabled(i)}};return{iframeContainer:p.element.dom,editorContainer:i.element.dom,api:y}}}),FD=function(e){return/^[0-9\.]+(|px)$/i.test(""+e)?D.some(parseInt(""+e,10)):D.none()},HD=function(e){return F(e)?e+"px":e},VD=function(e,t,n){var r=t.filter(function(t){return t>e}),o=n.filter(function(t){return e>t});return r.or(o).getOr(e)},qD=function(e){var t,n,r,o;return(n=kv(t=e),r=Cv(t),o=zv(t),FD(n).map(function(e){return VD(e,r,o)})).getOr(kv(e))},UD=function(e){var t=_v(e),n=xv(e),r=Sv(e);return FD(t).map(function(e){return VD(e,n,r)})},WD=function(e,t,n,r,o){var a=n.uiMothership,i=n.outerContainer,c=ov.DOM,s=Fv(e),l=qv(e),u=Sv(e).or(UD(e)),f=r.shared.header,d=f.isPositionedAtTop,m=Rv(e),g=m===lp.sliding||m===lp.floating,h=kn(!1),p=function(){return h.get()&&!e.removed},v=function(e){return g?e.fold(function(){return 0},function(e){return 1<e.components().length?Ti(e.components()[1].element):0}):0},y=function(){a.broadcastOn([Du()],{})},b=function(e){var n,r,a,c,f,m;void 0===e&&(e=!1),p()&&(s||(n=u.getOrThunk(function(){var e=FD(ii(Qa(),"margin-left")).getOr(0);return Bi(Qa())-Ai(t).left+e}),ri(o.get().element,"max-width",n+"px")),g&&CD.refreshToolbar(i),s||(r=CD.getToolbar(i),a=v(r),c=Gi(t),f=d()?Math.max(c.y-Ti(o.get().element)+a,0):c.bottom,oi(i.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(c.x)+"px"})),l&&(m=o.get(),e?$O.reset(m):$O.refresh(m)),y())},w=function(n){var r,a;void 0===n&&(n=!0),!s&&l&&p()&&(r=f.getDockingMode(),(a=function(n){switch(Iv(e)){case Nv.auto:var r=CD.getToolbar(i),o=v(r),a=Ti(n.element)-o,c=Gi(t);if(c.y>a)return"top";var s=No(t),l=Math.max(s.dom.scrollHeight,Ti(s));return c.bottom<l-a||Yi().bottom<c.bottom-a?"bottom":"top";case Nv.bottom:return"bottom";case Nv.top:default:return"top"}}(o.get()))!==r&&(function(e){var t=o.get();$O.setModes(t,[e]),f.setDockingMode(e);var n=d()?cc.TopToBottom:cc.BottomToTop;ra(t.element,Qs,n)}(a),n&&b(!0)))};return{isVisible:p,isPositionedAtTop:d,show:function(){h.set(!0),ri(i.element,"display","flex"),c.addClass(e.getBody(),"mce-edit-focus"),ui(a.element,"display"),w(!1),b()},hide:function(){h.set(!1),n.outerContainer&&(ri(i.element,"display","none"),c.removeClass(e.getBody(),"mce-edit-focus")),ri(a.element,"display","none")},update:b,updateMode:w,repositionPopups:y}},$D=function(e,t){var n=Gi(e);return{pos:t?n.y:n.bottom,bounds:n}},XD=Object.freeze({__proto__:null,render:function(e,t,n,r,o){var a=t.mothership,i=t.uiMothership,c=t.outerContainer,s=kn(null),l=xn.fromDom(o.targetNode),u=WD(e,l,t,r,s),f=e.getParam("toolbar_persist",!1,"boolean");PD(e);var d=function(){var o;s.get()?u.show():(s.set(CD.getHeader(c).getOrDie()),o=Hv(e),pu(o,a),pu(o,i),BD(e,t,n,r),CD.setMenubar(c,TD(e,n)),u.show(),function(e,t,n,r){var o=kn($D(t,n.isPositionedAtTop())),a=function(r){var a=$D(t,n.isPositionedAtTop()),i=a.pos,c=a.bounds,s=o.get(),l=s.pos,u=s.bounds,f=c.height!==u.height||c.width!==u.width;o.set({pos:i,bounds:c}),f&&Fy(e,r),n.isVisible()&&(l!==i?n.update(!0):f&&(n.updateMode(),n.repositionPopups()))};r||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",function(){return n.update(!0)}),e.on("NodeChange keydown",function(e){wh.requestAnimationFrame(function(){return a(e)})}),e.on("ScrollWindow",function(){return n.updateMode()});var i=nO();i.set(Ob(xn.fromDom(e.getBody()),"load",a)),e.on("remove",function(){i.clear()})}(e,l,u,f),e.nodeChanged())};e.on("show",d),e.on("hide",u.hide),f||(e.on("focus",d),e.on("blur",u.hide)),e.on("init",function(){(e.hasFocus()||f)&&d()}),Xv(e,t);var m={show:function(){u.show()},hide:function(){u.hide()},enable:function(){$v(t,!1)},disable:function(){$v(t,!0)},isDisabled:function(){return bv.isDisabled(c)}};return{editorContainer:c.element.dom,api:m}}}),GD=function(e,t){var n,r,o,a,i,c,s,l,u,f,d,m,g,h;o=PE(0,r=t,UE(n=e)),n.ui.registry.addNestedMenuItem("align",{text:r.shared.providers.translate("Align"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),c=PE(0,i=t,GE(a=e)),a.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),s=e,u=z({type:"advanced"},(l=t).styleselect),f=PE(0,l,iO(s,u)),s.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return f.items.validateItems(f.getStyleItems())}}),m=PE(0,t,aO(d=e)),d.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return m.items.validateItems(m.getStyleItems())}}),h=PE(0,t,ZE(g=e)),g.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})},KD={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},YD=(IE="[eE][+-]?[0-9]+",jE=["Infinity",(ME="[0-9]+")+"\\."+(LE=function(e){return"(?:"+e+")?"})(ME)+LE(IE),"\\."+ME+LE(IE),ME+LE(IE)].join("|"),new RegExp("^([+-]?(?:"+jE+"))(.*)$")),JD=function(e,t){return D.from(YD.exec(e)).bind(function(e){var n,r=Number(e[1]),o=e[2];return n=o,X(t,function(e){return X(KD[e],function(e){return n===e})})?D.some({value:r,unit:o}):D.none()})},ZD=function(e){return JD(e,["fixed","relative","empty"]).map(function(e){return e.value+e.unit}).getOr(e)},QD=function(e){var t=e.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),n=new Map,r=tO(),o=function(){var t=ZD(e.queryCommandValue("LineHeight"));D.from(n.get(t)).fold(function(){return r.clear()},function(e){r.set({destroy:function(){e.setActive(!1)}}),e.setActive(!0)})};return e.on("nodeChange",o),Y(t,function(a,i){return{type:"togglemenuitem",text:a,onSetup:function(c){return n.set(ZD(a),c),i+1===t.length&&o(),function(){0===i&&(e.off("nodeChange",o),r.clear())}},onAction:function(){return e.execCommand("LineHeight",!1,a)}}})},eN=function(e){var t,n;(t=e).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return QD(t)}}),(n=e).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(e){return e(QD(n))}})},tN=function(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}},nN=function(e){var t,n;!function(e){Cx.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:rO(e,t.name),onAction:tN(e,t.name)})});for(var t=1;6>=t;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:rO(e,n),onAction:tN(e,n)})}}(e),t=e,Cx.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(e){t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)}})}),n=e,Cx.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(e){n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return n.execCommand(e.action)},onSetup:rO(n,e.name)})})},rN=function(e){var t;nN(e),t=e,Cx.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(e){t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:function(){return t.execCommand(e.action)}})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:tN(t,"code")})},oN=function(e,t,n){var r=function(){return!!t.undoManager&&t.undoManager[n]()},o=function(){e.setDisabled(t.mode.isReadOnly()||!r())};return e.setDisabled(!r()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},aN=function(e){var t,n;(t=e).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(e){return oN(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(e){return oN(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}}),(n=e).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(e){return oN(e,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(e){return oN(e,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},iN=function(e,t){var n,r,o,a;!function(e){Cx.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return e.execCommand(t.cmd)},icon:t.icon,onSetup:rO(e,t.name)})});var t="alignnone",n="No alignment",r="JustifyNone",o="align-none";e.ui.registry.addButton(t,{tooltip:n,onAction:function(){return e.execCommand(r)},icon:o})}(e),rN(e),GD(e,t),aN(e),function(e){Ky(e);var t=kn(null),n=kn(null);tb(e,"forecolor","forecolor","Text color",t),tb(e,"backcolor","hilitecolor","Background color",n),nb(e,"forecolor","forecolor","Text color"),nb(e,"backcolor","hilitecolor","Background color")}(e),(r=n=e).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return r.execCommand("mceToggleVisualAid")}}),(o=n).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(e){return function(e,t){e.setActive(t.hasVisual);var n=function(t){e.setActive(t.hasVisual)};return t.on("VisualAid",n),function(){return t.off("VisualAid",n)}}(e,o)},onAction:function(){o.execCommand("mceToggleVisualAid")}}),(a=e).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(e){return function(e,t){e.setDisabled(!t.queryCommandState("outdent"));var n=function(){e.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}(e,a)},onAction:function(){return a.execCommand("outdent")}}),a.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return a.execCommand("indent")}}),eN(e)},cN=function(e,t){return{anchor:"makeshift",x:e,y:t}},sN=function(e){return"longpress"===e.type||0===e.type.indexOf("touch")},lN=function(e,t){var n,r,o,a=ov.DOM.getPos(e);return n=t,r=a.x,o=a.y,cN(n.x+r,n.y+o)},uN=function(e,t){return"contextmenu"===t.type||"longpress"===t.type?e.inline?function(e){if(sN(e)){var t=e.touches[0];return cN(t.pageX,t.pageY)}return cN(e.pageX,e.pageY)}(t):lN(e.getContentAreaContainer(),function(e){if(sN(e)){var t=e.touches[0];return cN(t.clientX,t.clientY)}return cN(e.clientX,e.clientY)}(t)):fN(e)},fN=function(e){return{anchor:"selection",root:xn.fromDom(e.selection.getNode())}},dN=function(e){return{anchor:"node",node:D.some(xn.fromDom(e.selection.getNode())),root:xn.fromDom(e.getBody())}},mN=function(e,t,n,r,o,a){var i=n(),c=a?dN(e):uN(e,t);UC(i,fp.CLOSE_ON_EXECUTE,r,!1).map(function(e){t.preventDefault(),sh.showMenuAt(o,c,{menu:{markers:Cp("normal")},data:e})})},gN={onLtr:function(){return[Kc,Uc,Wc,$c,Xc,Gc,yh,bh,ph,gh,vh,hh]},onRtl:function(){return[Kc,Wc,Uc,Xc,$c,Gc,yh,bh,vh,hh,ph,gh]}},hN={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},pN=function(e,t,n,r,o,a,i){var c,s,l=a?dN(e):(c=e,s=t,z({bubble:Us(0,12,hN),layouts:gN,overrides:{maxWidthFunction:Kz(),maxHeightFunction:js()}},uN(c,s)));UC(n,fp.CLOSE_ON_EXECUTE,r,!0).map(function(n){t.preventDefault(),sh.showMenuWithinBounds(o,l,{menu:{markers:Cp("normal"),highlightImmediately:i},data:n,type:"horizontal"},function(){return D.some(SE(e,r.shared))}),e.fire(Yz)})},vN=function(e,t,n,r,o,a){var i,c=Zn(),s=c.os.isiOS(),l=c.os.isOSX(),u=c.os.isAndroid(),f=c.deviceType.isTouch(),d=function(){var i=n();pN(e,t,i,r,o,a,!(u||s||l&&f))};!l&&!s||a?(u&&!a&&e.selection.setCursorLocation(t.target,0),d()):(i=function(){!function(e){var t=e.selection.getRng(),n=function(){wh.setEditorTimeout(e,function(){e.selection.setRng(t)},10),a()};e.once("touchend",n);var r=function(e){e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",r,!0);var o=function(){return a()};e.once("longpresscancel",o);var a=function(){e.off("touchend",n),e.off("longpresscancel",o),e.off("mousedown",r)}}(e),d()},function(e,t){var n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;var r=t.touches[0],o=n.getRng();return Il(e.getWin(),wl.domRange(o)).exists(function(e){return e.left<=r.clientX&&e.right>=r.clientX&&e.top<=r.clientY&&e.bottom>=r.clientY})}(e,t)?i():(e.once("selectionchange",i),e.once("touchend",function(){return e.off("selectionchange",i)})))},yN=function(e){return"string"==typeof e?e.split(/[ ,]/):e},bN=function(e){return e.getParam("contextmenu_never_use_native",!1,"boolean")},wN=function(e){return n="contextmenu",r="link linkchecker image imagetools table spellchecker configurepermanentpen",o=(t=e).ui.registry.getAll().contextMenus,D.from(t.getParam(n)).map(yN).getOrThunk(function(){return Q(yN(r),function(e){return Ue(o,e)})});var t,n,r,o},kN=function(e){return R(e)?"|"===e:"separator"===e.type},_N={type:"separator"},xN=function(e){var t,n=function(e){return{text:e.text,icon:e.icon,disabled:e.disabled,shortcut:e.shortcut}};if(R(e))return e;switch(e.type){case"separator":return _N;case"submenu":return z(z({type:"nestedmenuitem"},n(e)),{getSubmenuItems:function(){var t=e.getSubmenuItems();return R(t)?t:Y(t,xN)}});default:return z(z({type:"menuitem"},n(e)),{onAction:(t=e.onAction,function(){return t()})})}},CN=function(e,t){if(0===t.length)return e;var n=de(e).filter(function(e){return!kN(e)}).fold(function(){return[]},function(){return[_N]});return e.concat(n).concat(t).concat([_N])},SN=function(e,t){return"longpress"!==t.type&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType)},zN=function(e,t){return SN(e,t)?e.selection.getStart(!0):t.target},TN=function(e,t,n){var r=Zn().deviceType.isTouch,o=xi(sh.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return e.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:fs([wg("dismissContextMenu",[fo(Gr(),function(t){Eu.close(t),e.focus()})])])})),a=function(){return sh.hide(o)},i=function(t){var a,i;bN(e)&&t.preventDefault(),a=e,t.ctrlKey&&!bN(a)||!1===e.getParam("contextmenu")||(i=function(e,t){var n=e.getParam("contextmenu_avoid_overlap","","string");if(SN(e,t))return!0;if(n){var r=zN(e,t);return Nb(xn.fromDom(r),n)}return!1}(e,t),(r()?vN:mN)(e,t,function(){var n,r,o,a=zN(e,t),i=e.ui.registry.getAll(),c=wN(e);return n=i.contextMenus,r=a,0<(o=te(c,function(e,t){return qe(n,t.toLowerCase()).map(function(t){var n=t.update(r);if(R(n))return CN(e,n.split(" "));if(0<n.length){var o=Y(n,xN);return CN(e,o)}return e}).getOrThunk(function(){return e.concat([t])})},[])).length&&kN(o[o.length-1])&&o.pop(),o},n,o,i))};e.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");e.on(t,a),e.on("longpress contextmenu",i)})},EN=$e([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),ON=function(e){return function(t){return t.translate(-e.left,-e.top)}},DN=function(e){return function(t){return t.translate(e.left,e.top)}},NN=function(e){return function(t,n){return te(e,function(e,t){return t(e)},Di(t,n))}},AN=function(e,t,n){return e.fold(NN([DN(n),ON(t)]),NN([ON(t)]),NN([]))},RN=function(e,t,n){return e.fold(NN([DN(n)]),NN([]),NN([DN(t)]))},PN=function(e,t,n){return e.fold(NN([]),NN([ON(n)]),NN([DN(t),ON(n)]))},BN=function(e,t,n){var r=e.fold(function(e,t){return{position:D.some("absolute"),left:D.some(e+"px"),top:D.some(t+"px")}},function(e,t){return{position:D.some("absolute"),left:D.some(e-n.left+"px"),top:D.some(t-n.top+"px")}},function(e,t){return{position:D.some("fixed"),left:D.some(e+"px"),top:D.some(t+"px")}});return z({right:D.none(),bottom:D.none()},r)},MN=function(e,t,n,r){var o=function(e,o){return function(a,i){var c=e(t,n,r);return o(a.getOr(c.left),i.getOr(c.top))}};return e.fold(o(PN,IN),o(RN,LN),o(AN,jN))},IN=EN.offset,LN=EN.absolute,jN=EN.fixed,FN=function(e,t){var n=oa(e,t);return I(n)?NaN:parseInt(n,10)},HN=function(e,t,n,r){return o=t,a=e.element,i=FN(a,o.leftAttr),c=FN(a,o.topAttr),(isNaN(i)||isNaN(c)?D.none():D.some(Di(i,c))).fold(function(){return n},function(e){return jN(e.left+r.left,e.top+r.top)});var o,a,i,c},VN=function(e,t,n,r,o,a){var i,c,s,l=HN(e,t,n,r),u=(t.mustSnap?WN:$N)(e,t,l,o,a),f=AN(l,o,a);return i=t,c=f,s=e.element,ra(s,i.leftAttr,c.left+"px"),ra(s,i.topAttr,c.top+"px"),u.fold(function(){return{coord:jN(f.left,f.top),extra:D.none()}},function(e){return{coord:e.output,extra:e.extra}})},qN=function(e,t){var n,r;n=t,r=e.element,ca(r,n.leftAttr),ca(r,n.topAttr)},UN=function(e,t,n,r){return ge(e,function(e){var o,a,i,c,s,l,u,f,d=e.sensor;return o=t,a=d,i=e.range.left,c=e.range.top,u=RN(o,s=n,l=r),f=RN(a,s,l),Math.abs(u.left-f.left)<=i&&Math.abs(u.top-f.top)<=c?D.some({output:MN(e.output,t,n,r),extra:e.extra}):D.none()})},WN=function(e,t,n,r,o){var a=t.getSnapPoints(e);return UN(a,n,r,o).orThunk(function(){return te(a,function(e,t){var a,i,c,s,l,u,f,d,m=t.sensor,g=(a=n,i=m,t.range.left,t.range.top,l=RN(a,c=r,s=o),u=RN(i,c,s),f=Math.abs(l.left-u.left),d=Math.abs(l.top-u.top),Di(f,d));return e.deltas.fold(function(){return{deltas:D.some(g),snap:D.some(t)}},function(n){return(g.left+g.top)/2<=(n.left+n.top)/2?{deltas:D.some(g),snap:D.some(t)}:e})},{deltas:D.none(),snap:D.none()}).snap.map(function(e){return{output:MN(e.output,n,r,o),extra:e.extra}})})},$N=function(e,t,n,r,o){var a=t.getSnapPoints(e);return UN(a,n,r,o)},XN=Object.freeze({__proto__:null,snapTo:function(e,t,n,r){var o,a,i,c,s,l,u,f,d=t.getTarget(e.element);t.repositionTarget&&(o=Oo(e.element),a=Fi(o),i=EO(d),u=a,f=i,c={coord:MN((l=r).output,l.output,u,f),extra:l.extra},s=BN(c.coord,0,i),ai(d,s))}}),GN="data-initial-z-index",KN=function(e,t){var n;e.getSystem().addToGui(t),Ro((n=t).element).filter(So).each(function(e){si(e,"z-index").each(function(t){ra(e,GN,t)}),ri(e,"z-index",ii(n.element,"z-index"));
})},YN=function(e){Ro(e.element).filter(So).each(function(e){aa(e,GN).fold(function(){return ui(e,"z-index")},function(t){return ri(e,"z-index",t)}),ca(e,GN)}),e.getSystem().removeFromGui(e)},JN=function(e,t,n){return e.getSystem().build($b.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}))},ZN=un("snaps",[Yt("getSnapPoints"),wc("onSensor"),Yt("leftAttr"),Yt("topAttr"),fn("lazyViewport",Yi),fn("mustSnap",!1)]),QN=[fn("useFixed",x),Yt("blockerClass"),fn("getTarget",w),fn("onDrag",v),fn("repositionTarget",!0),fn("onDrop",v),vn("getBounds",Yi),ZN],eA=function(e){return t=si(e,"left"),n=si(e,"top"),r=si(e,"position"),o=function(e,t,n){return("fixed"===n?jN:IN)(parseInt(e,10),parseInt(t,10))},(t.isSome()&&n.isSome()&&r.isSome()?D.some(o(t.getOrDie(),n.getOrDie(),r.getOrDie())):D.none()).getOrThunk(function(){var t=Ai(e);return LN(t.left,t.top)});var t,n,r,o},tA=function(e,t,n,r,o,a,i){var c,s,l,u,f,d,m,g,h,p=t.fold(function(){var e,t,i,c=(e=n,t=a.left,i=a.top,e.fold(function(e,n){return IN(e+t,n+i)},function(e,n){return LN(e+t,n+i)},function(e,n){return jN(e+t,n+i)})),s=AN(c,r,o);return jN(s.left,s.top)},function(t){var i=VN(e,t,n,a,r,o);return i.extra.each(function(n){t.onSensor(e,n)}),i.coord});return c=p,s=r,l=o,f=(u=i).bounds,d=RN(c,s,l),m=As(d.left,f.x,f.x+f.width-u.width),g=As(d.top,f.y,f.y+f.height-u.height),h=LN(m,g),c.fold(function(){var e=PN(h,s,l);return IN(e.left,e.top)},function(){return h},function(){var e=AN(h,s,l);return jN(e.left,e.top)})},nA=function(e,t){return{bounds:e.getBounds(),height:Ei(t.element),width:Mi(t.element)}},rA=function(e,t,n,r,o){var a=n.update(r,o),i=n.getStartData().getOrThunk(function(){return nA(t,e)});a.each(function(n){var r,o,a,c,s,l,u,f,d,m,g;r=e,a=i,c=n,g=(o=t).getTarget(r.element),o.repositionTarget&&(s=Oo(r.element),l=Fi(s),u=EO(g),f=eA(g),d=tA(r,o.snaps,f,l,u,c,a),m=BN(d,0,u),ai(g,m)),o.onDrag(r,g,c)})},oA=function(e,t,n,r){t.each(YN),n.snaps.each(function(t){qN(e,t)});var o=n.getTarget(e.element);r.reset(),n.onDrop(e,o)},aA=function(e){return function(t,r){var o=function(e){r.setStartData(nA(t,e))};return so(n([fo(Ur(),function(e){r.getStartData().each(function(){return o(e)})})],e(t,r,o)))}},iA=Object.freeze({__proto__:null,getData:function(e){return D.from(Di(e.x,e.y))},getDelta:function(e,t){return Di(t.left-e.left,t.top-e.top)}}),cA=function(e,t,n){return[fo(hr(),function(r,o){var a,i,c,s,l;0===o.event.raw.button&&(o.stop(),c={drop:a=function(){return oA(r,D.some(s),e,t)},delayDrop:(i=Ab(a,200)).schedule,forceDrop:a,move:function(n){i.cancel(),rA(r,e,t,iA,n)}},s=JN(r,e.blockerClass,(l=c,so([fo(hr(),l.forceDrop),fo(yr(),l.drop),fo(pr(),function(e,t){l.move(t.event)}),fo(vr(),l.delayDrop)]))),n(r),KN(r,s))})]},sA=n(QN,[Cc("dragger",{handlers:aA(cA)})]),lA=Object.freeze({__proto__:null,getData:function(e){var t,n=e.raw.touches;return 1===n.length?(t=n[0],D.some(Di(t.clientX,t.clientY))):D.none()},getDelta:function(e,t){return Di(t.left-e.left,t.top-e.top)}}),uA=function(e,t,n){var r=kn(D.none());return[fo(fr(),function(o,a){a.stop();var i,c=function(){oA(o,r.get(),e,t),r.set(D.none())},s={drop:c,delayDrop:v,forceDrop:c,move:function(n){rA(o,e,t,lA,n)}},l=JN(o,e.blockerClass,(i=s,so([fo(fr(),i.forceDrop),fo(mr(),i.drop),fo(gr(),i.drop),fo(dr(),function(e,t){i.move(t.event)})])));r.set(D.some(l)),n(o),KN(o,l)}),fo(dr(),function(n,r){r.stop(),rA(n,e,t,lA,r.event)}),fo(mr(),function(n,o){o.stop(),oA(n,r.get(),e,t),r.set(D.none())}),fo(gr(),function(n){oA(n,r.get(),e,t),r.set(D.none())})]},fA=n(QN,[Cc("dragger",{handlers:aA(uA)})]),dA=n(QN,[Cc("dragger",{handlers:aA(function(e,t,r){return n(cA(e,t,r),uA(e,t,r))})})]),mA=hs({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:sA,touch:fA,mouseOrTouch:dA}),name:"dragging",active:{events:function(e,t){return e.dragger.handlers(e,t)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:D.from(e.extra)}}},state:Object.freeze({__proto__:null,init:function(){var e=D.none(),t=D.none(),n=b({});return Da({readState:n,reset:function(){e=D.none(),t=D.none()},update:function(t,n){return t.getData(n).bind(function(n){return r=t,o=n,a=e.map(function(e){return r.getDelta(e,o)}),e=D.some(o),a;var r,o,a})},getStartData:function(){return t},setStartData:function(e){t=D.some(e)}})}}),apis:XN}),gA=function(e,t,n,r,o,a){return e.fold(function(){return mA.snap({sensor:LN(n-20,r-20),range:Di(o,a),output:LN(D.some(n),D.some(r)),extra:{td:t}})},function(e){var o=n-20,a=r-20,i=e.element.dom.getBoundingClientRect();return mA.snap({sensor:LN(o,a),range:Di(40,40),output:LN(D.some(n-i.width/2),D.some(r-i.height/2)),extra:{td:t}})})},hA=function(e,t,n){return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(e,r){var o,a,i=r.td;o=t.get(),a=i,o.exists(function(e){return tr(e,a)})||(t.set(D.some(i)),n(i))},mustSnap:!0}},pA=function(e){return _h(kh.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:fs([mA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),vk.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},vA=function(e,t){var n=kn([]),r=kn([]),o=kn(!1),a=kn(D.none()),i=kn(D.none()),c=function(e){var n=Ki(e);return gA(f.getOpt(t),e,n.x,n.y,n.width,n.height)},s=function(e){var n=Ki(e);return gA(d.getOpt(t),e,n.right,n.bottom,n.width,n.height)},l=hA(function(){return Y(n.get(),c)},a,function(t){i.get().each(function(n){e.fire("TableSelectorChange",{start:t,finish:n})})}),u=hA(function(){return Y(r.get(),s)},i,function(t){a.get().each(function(n){e.fire("TableSelectorChange",{start:n,finish:t})})}),f=pA(l),d=pA(u),m=xi(f.asSpec()),g=xi(d.asSpec()),h=function(t,n,r,o){var a=r(n);mA.snapTo(t,a),!function(t,n,r,o){var a=n.dom.getBoundingClientRect();ui(t.element,"display");var i=Ao(xn.fromDom(e.getBody())).dom.innerHeight,c=r(a),s=o(a,i);(c||s)&&ri(t.element,"display","none")}(t,n,function(e){return e[o]<0},function(e,t){return e[o]>t})},p=function(e){return h(m,e,c,"top")},v=function(e){return h(g,e,s,"bottom")};Zn().deviceType.isTouch()&&(e.on("TableSelectionChange",function(e){o.get()||(fu(t,m),fu(t,g),o.set(!0)),a.set(D.some(e.start)),i.set(D.some(e.finish)),e.otherCells.each(function(t){n.set(t.upOrLeftCells),r.set(t.downOrRightCells),p(e.start),v(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",function(){a.get().each(p),i.get().each(v)}),e.on("TableSelectionClear",function(){o.get()&&(gu(m),gu(g),o.set(!1)),a.set(D.none()),i.set(D.none())}))};(HE=FE=FE||{})[HE.None=0]="None",HE[HE.Both=1]="Both",HE[HE.Vertical=2]="Vertical";var yA,bA,wA,kA=function(e,t,n){var r,o,a,i,c,s,l=xn.fromDom(e.getContainer()),u=(r=e,o=t,a=n,i=Ti(l),c=Bi(l),(s={}).height=VD(i+o.top,Cv(r),zv(r)),a===FE.Both&&(s.width=VD(c+o.left,xv(r),Sv(r))),s);Me(u,function(e,t){return ri(l,t,HD(e)),0}),e.fire("ResizeEditor")},_A=function(e,t,n){return t.delimiter||(t.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:fs([gg.config({mode:"flow",selector:"div[role=button]"}),bv.config({disabled:n.isDisabled}),Gv(),Qb.config({}),bg.config({}),wg("elementPathEvents",[bo(function(r){e.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return gg.focusIn(r)}),e.on("NodeChange",function(o){var a,i,c=function(t){for(var n=[],r=t.length;0<r--;){var o=t[r];if(1===o.nodeType&&!function(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1}(o)){var a=e.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(a.isDefaultPrevented()||n.push({name:a.name,element:o}),a.isPropagationStopped())break}}return n}(o.parents);0<c.length?bg.set(r,(a=Y(c||[],function(t,r){return kh.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":r,"tab-index":-1,"aria-level":r+1},innerHtml:t.name},action:function(){e.focus(),e.selection.select(t.element),e.nodeChanged()},buttonBehaviours:fs([Yv(n.isDisabled),Gv()])})}),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},te(a.slice(1),function(e,t){var n=e;return n.push(i),n.push(t),n},[a[0]]))):bg.set(r,[])})})])]),components:[]}},xA=function(e,t){var n,r,o,a,i,c;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(i=function(){var n,r,o,a,i,c=[];return e.getParam("elementpath",!0,"boolean")&&c.push(_A(e,{},t)),e.hasPlugin("wordcount")&&c.push((n=e,r=t,a=function(e,t,n){return bg.set(e,[wi(r.translate(["{0} "+n,t[n]]))])},kh.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:fs([Yv(r.isDisabled),Gv(),Qb.config({}),bg.config({}),Gu.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),wg("wordcount-events",[_o(function(e){var t=Gu.getValue(e),n="words"===t.mode?"characters":"words";Gu.setValue(e,{mode:n,count:t.count}),a(e,t.count,n)}),bo(function(e){n.on("wordCountUpdate",function(t){var n=Gu.getValue(e).mode;Gu.setValue(e,{mode:n,count:t.wordCount}),a(e,t.wordCount,n)})})])]),eventOrder:((o={})[Br()]=["disabling","alloy.base.behaviour","wordcount-events"],o)}))),e.getParam("branding",!0,"boolean")&&c.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(i=av.translate(["Powered by {0}","Tiny"]))+'">'+i+"</a>"}}),0<c.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:c}]:[]}(),r=!(n=e).hasPlugin("autoresize"),(c=!1===(o=n.getParam("resize",r))?FE.None:"both"===o?FE.Both:FE.Vertical)!==FE.None&&i.push((a=c,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:Ch("resize-handle",t.icons)},behaviours:fs([mA.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,r){kA(e,r,a)},blockerClass:"tox-blocker"})])})),i)}},CA=function(e){var t,n,r,o,a=e.inline,i=a?XD:jD,c=qv(e)?eD:zO,s=D.none(),l=Zn(),u=l.browser.isIE()?["tox-platform-ie"]:[],f=l.deviceType.isTouch()?["tox-platform-touch"]:[],d=Lv(e),m=Hv(e),g=av.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:((t={})[Qs]=d?cc.BottomToTop:cc.TopToBottom,t)},p=function(){return s.bind(CD.getHeader)},y=function(){ri(fe.element,"width",document.body.clientWidth+"px")},b=xi((n=tr(Qa(),m)&&"grid"===ii(m,"display"),r={dom:z({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(u).concat(f)},g),behaviours:fs([iu.config({useFixed:function(){return c.isDocked(p)}})])},o={dom:{styles:{width:document.body.clientWidth+"px"}},events:so([fo(Wr(),y)])},Ke(r,n?o:{}))),w=function(){return ve.value(b)},k=_h({dom:{tag:"div",classes:["tox-anchorbar"]}}),_=function(){return s.bind(function(e){return CD.getThrobber(e)}).getOrDie("Could not find throbber element")},x=Gz(b,e,function(){return s.bind(function(e){return k.getOpt(e)}).getOrDie("Could not find a anchor bar element")}),C=CD.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:x,onEscape:function(){e.focus()}}),S=Rv(e),T=CD.parts.toolbar(z({dom:{tag:"div",classes:["tox-toolbar"]},getSink:w,providers:x.shared.providers,onEscape:function(){e.focus()},type:S,lazyToolbar:function(){return s.bind(function(e){return CD.getToolbar(e)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return p().getOrDie("Could not find header element")}},h)),E=CD.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:x.shared.providers,onEscape:function(){e.focus()},type:S}),O=CD.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),N=CD.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),A=CD.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:x}),R=e.getParam("statusbar",!0,"boolean")&&!a?D.some(xA(e,x.shared.providers)):D.none(),P={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[O,N]},B=Dv(e),M=Ev(e),I=Tv(e),L=CD.parts.header({dom:z({tag:"div",classes:["tox-editor-header"]},h),components:oe([I?[C]:[],B?[E]:M?[T]:[],Fv(e)?[]:[k.asSpec()]]),sticky:qv(e),editor:e,sharedBackstage:x.shared}),j=oe([d?[]:[L],a?[]:[P],d?[L]:[]]),H=oe([[{dom:{tag:"div",classes:["tox-editor-container"]},components:j}],a?[]:R.toArray(),[A]]),V=Vv(e),q=z(z({role:"application"},av.isRtl()?{dir:"rtl"}:{}),V?{"aria-hidden":"true"}:{}),U=xi(CD.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(a?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(f).concat(u),styles:z({visibility:"hidden"},V?{opacity:"0",border:"0"}:{}),attributes:q},components:H,behaviours:fs([Gv(),bv.config({disableClass:"tox-tinymce--disabled"}),gg.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])})),s=D.some(U);e.shortcuts.add("alt+F9","focus menubar",function(){CD.focusMenubar(U)}),e.shortcuts.add("alt+F10","focus toolbar",function(){CD.focusToolbar(U)}),e.addCommand("ToggleToolbarDrawer",function(){CD.toggleToolbarDrawer(U)}),e.addQueryStateHandler("ToggleToolbarDrawer",function(){return CD.isToolbarDrawerToggled(U)});var W,$,X,G,K,Y,Z,Q,ee,te,ne,re,ae,ie,ce,se,le,ue=Xb(U),fe=Xb(b);W=e,$=ue,X=fe,G=function(e,t){J([$,X],function(n){n.broadcastEvent(e,t)})},K=function(e,t){J([$,X],function(n){n.broadcastOn([e],t)})},Y=function(e){return K(Ou(),{target:e.target})},Z=Eb(xn.fromDom(document),"touchstart",Y),Q=Eb(xn.fromDom(document),"touchmove",function(e){return G(Vr(),e)}),ee=Eb(xn.fromDom(document),"touchend",function(e){return G(qr(),e)}),te=Eb(xn.fromDom(document),"mousedown",Y),ne=Eb(xn.fromDom(document),"mouseup",function(e){0===e.raw.button&&K(Nu(),{target:e.target})}),re=function(e){return K(Ou(),{target:xn.fromDom(e.target)})},ae=function(e){0===e.button&&K(Nu(),{target:xn.fromDom(e.target)})},ie=function(e){return G(Ur(),Db(e))},ce=function(e){K(Du(),{}),G(Wr(),Db(e))},se=function(){return K(Du(),{})},le=function(e){e.state&&K(Ou(),{target:xn.fromDom(W.getContainer())})},W.on("PostRender",function(){W.on("click",re),W.on("tap",re),W.on("mouseup",ae),W.on("ScrollWindow",ie),W.on("ResizeWindow",ce),W.on("ResizeEditor",se),W.on("AfterProgressState",le)}),W.on("remove",function(){W.off("click",re),W.off("tap",re),W.off("mouseup",ae),W.off("ScrollWindow",ie),W.off("ResizeWindow",ce),W.off("ResizeEditor",se),W.off("AfterProgressState",le),te.unbind(),Z.unbind(),Q.unbind(),ee.unbind(),ne.unbind()}),W.on("detach",function(){yu($),yu(X),$.destroy(),X.destroy()});var de=function(){var t,n=HD(qD(e)),r=HD(UD(t=e).getOr(_v(t)));return e.inline||(li("div","width",r)&&ri(U.element,"width",r),li("div","height",n)?ri(U.element,"height",n):ri(U.element,"height","200px")),n};return{mothership:ue,uiMothership:fe,backstage:x,renderUI:function(){var t,n,r,o,a,s,l,u;c.setup(e,x.shared,p),iN(e,x),TN(e,w,x),n=(t=e).ui.registry.getAll().sidebars,J(Pe(n),function(e){var r=n[e],o=function(){return D.from(t.queryCommandValue("ToggleSidebar")).is(e)};t.ui.registry.addToggleButton(e,{icon:r.icon,tooltip:r.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(o())},onSetup:function(e){var n=function(){return e.setActive(o())};return t.on("ToggleSidebar",n),function(){t.off("ToggleSidebar",n)}}})}),r=e,o=_,a=x.shared,s=kn(!1),l=kn(D.none()),u=function(e){e!==s.get()&&(pD(o(),e,a.providers),s.set(e),r.fire("AfterProgressState",{state:e}))},r.on("ProgressState",function(e){var t;l.get().each(wh.clearTimeout),F(e.time)?(t=wh.setEditorTimeout(r,function(){return u(e.state)},e.time),l.set(D.some(t))):(u(e.state),l.set(D.none()))}),Ie(e.getParam("toolbar_groups",{},"object"),function(t,n){e.ui.registry.addGroupToolbarButton(n,t)});var f,d=e.ui.registry.getAll(),m=d.buttons,g=d.menuItems,h=d.contextToolbars,v=d.sidebars,y=Ov(e),k={menuItems:g,menus:(f=e.getParam("menu"))?Ie(f,function(e){return z(z({},e),{items:e.items})}):{},menubar:e.getParam("menubar"),toolbar:y.getOrThunk(function(){return e.getParam("toolbar",!0)}),allowToolbarGroups:S===lp.floating,buttons:m,sidebar:v};yO(e,h,b,{backstage:x}),vA(e,b);var C=e.getElement(),T=de(),E={mothership:ue,uiMothership:fe,outerContainer:U},O={targetNode:C,height:T};return i.render(e,E,k,x,O)},getUi:function(){return{channels:{broadcastAll:fe.broadcast,broadcastOn:fe.broadcastOn,register:v}}}}},SA=b([Yt("lazySink"),on("dragBlockClass"),vn("getBounds",Yi),fn("useTabstopAt",C),fn("eventOrder",{}),Ku("modalBehaviours",[gg]),kc("onExecute"),xc("onEscape")]),zA={sketch:w},TA=b([Tf({name:"draghandle",overrides:function(e,t){return{behaviours:fs([mA.config({mode:"mouse",getTarget:function(e){return ec(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])}}}),Sf({schema:[Yt("dom")],name:"title"}),Sf({factory:zA,schema:[Yt("dom")],name:"close"}),Sf({factory:zA,schema:[Yt("dom")],name:"body"}),Tf({factory:zA,schema:[Yt("dom")],name:"footer"}),zf({factory:{sketch:function(e,t){return z(z({},e),{dom:t.dom,components:t.components})}},schema:[fn("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),fn("components",[])],name:"blocker"})]),EA=Object.freeze({__proto__:null,block:function(e,t,n,r){ra(e.element,"aria-busy",!0);var o=t.getRoot(e).getOr(e),a=fs([gg.config({mode:"special",onTab:function(){return D.some(!0)},onShiftTab:function(){return D.some(!0)}}),Sg.config({})]),i=r(o,a),c=o.getSystem().build(i);bg.append(o,Ci(c)),c.hasConfigured(gg)&&gg.focusIn(c),n.isBlocked()||t.onBlock(e),n.blockWith(function(){return bg.remove(o,c)})},unblock:function(e,t,n){ca(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()}}),OA=[vn("getRoot",D.none),wc("onBlock"),wc("onUnblock")],DA=ms({fields:OA,name:"blocking",apis:EA,state:Object.freeze({__proto__:null,init:function(){var e=tO();return Da({readState:e.isSet,blockWith:function(t){e.set({destroy:t})},clear:e.clear,isBlocked:e.isSet})}})}),NA=ed({name:"ModalDialog",configFields:SA(),partFields:TA(),factory:function(e,t,n,r){var o,a=kn(D.none()),i=ma("modal-events"),c=z(z({},e.eventOrder),((o={})[$r()]=[i].concat(e.eventOrder["alloy.system.attached"]||[]),o));return{uid:e.uid,dom:e.dom,components:t,apis:{show:function(t){a.set(D.some(t));var n=e.lazySink(t).getOrDie(),o=r.blocker(),i=n.getSystem().build(z(z({},o),{components:o.components.concat([Ci(t)]),behaviours:fs([Sg.config({}),wg("dialog-blocker-events",[yo(wr(),function(){gg.focusIn(t)})])])}));fu(n,i),gg.focusIn(t)},hide:function(e){a.set(D.none()),Ro(e.element).each(function(t){e.getSystem().getByDom(t).each(function(e){gu(e)})})},getBody:function(t){return Ff(t,e,"body")},getFooter:function(t){return Ff(t,e,"footer")},setIdle:function(e){DA.unblock(e)},setBusy:function(e,t){DA.block(e,t)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Ju(e.modalBehaviours,[bg.config({}),gg.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),DA.config({getRoot:a.get}),wg(i,[bo(function(t){var n,r,o,a,i,c;n=t.element,r=Ff(t,e,"title").element,o=aa(n,"id").fold(function(){var e=ma("dialog-label");return ra(r,"id",e),e},w),ra(n,"aria-labelledby",o),a=t.element,i=Ff(t,e,"body").element,c=D.from(oa(a,"id")).fold(function(){var e=ma("dialog-describe");return ra(i,"id",e),e},w),ra(a,"aria-describedby",c)})])])}},apis:{show:function(e,t){e.show(t)},hide:function(e,t){e.hide(t)},getBody:function(e,t){return e.getBody(t)},getFooter:function(e,t){return e.getFooter(t)},setBusy:function(e,t,n){e.setBusy(t,n)},setIdle:function(e,t){e.setIdle(t)}}}),AA=wt([Zt("type"),Zt("name")].concat(Fp)),RA=Wt,PA=[Tt("name","name",nt(function(){return ma("button-name")}),Ut),sn("icon"),hn("align","end",["start","end"]),pn("primary",!1),pn("disabled",!1)],BA=n(PA,[Zt("text")]),MA=n([Qt("type",["submit","cancel","custom"])],BA),IA=n([Qt("type",["menu"]),sn("text"),sn("tooltip"),sn("icon"),rn("items",AA)],PA),LA=Ft("type",{submit:MA,cancel:MA,custom:MA,menu:IA}),jA=[Zt("type"),Zt("text"),Qt("level",["info","warn","error","success"]),Zt("icon"),fn("url","")],FA=wt(jA),HA=[Zt("type"),Zt("text"),pn("disabled",!1),pn("primary",!1),Tt("name","name",nt(function(){return ma("button-name")}),Ut),sn("icon"),pn("borderless",!1)],VA=wt(HA),qA=[Zt("type"),Zt("name"),Zt("label"),pn("disabled",!1)],UA=wt(qA),WA=Wt,$A=[Zt("type"),Zt("name")],XA=$A.concat([sn("label")]),GA=XA.concat([fn("columns","auto")]),KA=wt(GA),YA=Nt([Zt("value"),Zt("text"),Zt("icon")]),JA=wt(XA),ZA=Ut,QA=wt(XA),eR=Ut,tR=$A.concat([gn("tag","textarea"),Zt("scriptId"),Zt("scriptUrl"),(yA=void 0,dn("settings",yA,Gt))]),nR=$A.concat([gn("tag","textarea"),en("init")]),rR=Rt(function(e){return Bt("customeditor.old",bt(nR),e).orThunk(function(){return Bt("customeditor.new",bt(tR),e)})}),oR=Ut,aR=wt(XA),iR=kt(Dt),cR=function(e){return[Zt("type"),Jt("columns",qt),e]},sR=[Zt("type"),Zt("html"),hn("presets","presentation",["presentation","document"])],lR=wt(sR),uR=XA.concat([pn("sandboxed",!0)]),fR=wt(uR),dR=Ut,mR=XA.concat([Jt("currentState",wt([Yt("blob"),Zt("url")]))]),gR=wt(mR),hR=XA.concat([sn("inputMode"),sn("placeholder"),pn("maximized",!1),pn("disabled",!1)]),pR=wt(hR),vR=Ut,yR=[Zt("text"),Zt("value")],bR=[Zt("text"),rn("items",(bA=function(){return wR},wA=Je(function(){return bA()}),{extract:function(e,t,n){return wA().extract(e,t,n)},toString:function(){return wA().toString()}}))],wR=_t([wt(yR),wt(bR)]),kR=XA.concat([rn("items",wR),pn("disabled",!1)]),_R=wt(kR),xR=Ut,CR=XA.concat([nn("items",[Zt("text"),Zt("value")]),mn("size",1),pn("disabled",!1)]),SR=wt(CR),zR=Ut,TR=XA.concat([pn("constrain",!0),pn("disabled",!1)]),ER=wt(TR),OR=wt([Zt("width"),Zt("height")]),DR=[Zt("type"),rn("header",Ut),rn("cells",kt(Ut))],NR=wt(DR),AR=XA.concat([sn("placeholder"),pn("maximized",!1),pn("disabled",!1)]),RR=wt(AR),PR=Ut,BR=XA.concat([hn("filetype","file",["image","media","file"]),fn("disabled",!1)]),MR=wt(BR),IR=wt([Zt("value"),fn("meta",{})]),LR=function(e){return Tt("items","items",et(),kt(Rt(function(t){return Bt("Checking item of "+e,jR,t).fold(function(e){return ve.error(Lt(e))},function(e){return ve.value(e)})})))},jR=At(function(){return jt("type",{alertbanner:FA,bar:wt((t=LR("bar"),[Zt("type"),t])),button:VA,checkbox:UA,colorinput:JA,colorpicker:QA,dropzone:aR,grid:wt(cR(LR("grid"))),iframe:fR,input:pR,listbox:_R,selectbox:SR,sizeinput:ER,textarea:RR,urlinput:MR,customeditor:rR,htmlpanel:lR,imagetools:gR,collection:KA,label:wt((e=LR("label"),[Zt("type"),Zt("label"),e])),table:NR,panel:HR});var e,t}),FR=[Zt("type"),fn("classes",[]),rn("items",jR)],HR=wt(FR),VR=[Tt("name","name",nt(function(){return ma("tab-name")}),Ut),Zt("title"),rn("items",jR)],qR=[Zt("type"),nn("tabs",VR)],UR=wt(qR),WR=BA,$R=LA,XR=wt([Zt("title"),Jt("body",jt("type",{panel:HR,tabpanel:UR})),gn("size","normal"),rn("buttons",$R),fn("initialData",{}),vn("onAction",v),vn("onChange",v),vn("onSubmit",v),vn("onClose",v),vn("onCancel",v),fn("onTabChange",v)]),GR=wt(n([Qt("type",["cancel","custom"])],WR)),KR=wt([Zt("title"),Zt("url"),cn("height"),cn("width"),an("buttons",kt(GR)),vn("onAction",v),vn("onCancel",v),vn("onClose",v),vn("onMessage",v)]),YR=function(e){return P(e)?[e].concat(ae(Ve(e),YR)):B(e)?ae(e,YR):[]},JR=function(e){return R(e.type)&&R(e.name)},ZR={checkbox:WA,colorinput:ZA,colorpicker:eR,dropzone:iR,input:vR,iframe:dR,sizeinput:OR,selectbox:zR,listbox:xR,size:OR,textarea:PR,urlinput:IR,customeditor:oR,collection:YA,togglemenuitem:RA},QR=function(e){var t=Q(YR(e),JR),n=ae(t,function(e){return t=e,D.from(ZR[t.type]).fold(function(){return[]},function(t){return[Jt(e.name,t)]});var t});return wt(n)},eP=function(e){return{internalDialog:Mt(Bt("dialog",XR,e)),dataValidator:QR(e),initialData:e.initialData}},tP={open:function(e,t){var n=eP(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(e,t){return e(Mt(Bt("dialog",KR,t)))},redial:eP},nP=function(e){var t=[],n={};return Me(e,function(e,r){e.fold(function(){t.push(r)},function(e){n[r]=e})}),0<t.length?ve.error(t):ve.value(n)},rP=Qf({name:"TabButton",configFields:[fn("uid",void 0),Yt("value"),Tt("dom","dom",rt(function(){return{attributes:{role:"tab",id:ma("aria"),"aria-selected":"false"}}}),Ht()),on("action"),fn("domModification",{}),Ku("tabButtonBehaviours",[Sg,gg,Gu]),Yt("view")],factory:function(e){return{uid:e.uid,dom:e.dom,components:e.components,events:jg(e.action),behaviours:Ju(e.tabButtonBehaviours,[Sg.config({}),gg.config({mode:"execution",useSpace:!0,useEnter:!0}),Gu.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}}}),oP=b([Yt("tabs"),Yt("dom"),fn("clickToDismiss",!1),Ku("tabbarBehaviours",[vd,gg]),yc(["tabClass","selectedClass"])]),aP=Ef({factory:rP,name:"tabs",unit:"tab",overrides:function(e){var t=function(e,t){vd.dehighlight(e,t),ro(e,Qr(),{tabbar:e,button:t})},n=function(e,t){vd.highlight(e,t),ro(e,Zr(),{tabbar:e,button:t})};return{action:function(r){var o=r.getSystem().getByUid(e.uid).getOrDie(),a=vd.isHighlighted(o,r);(a&&e.clickToDismiss?t:a?v:n)(o,r)},domModification:{classes:[e.markers.tabClass]}}}}),iP=b([aP]),cP=ed({name:"Tabbar",configFields:oP(),partFields:iP(),factory:function(e,t){return{uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Ju(e.tabbarBehaviours,[vd.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:function(e,t){ra(t.element,"aria-selected","true")},onDehighlight:function(e,t){ra(t.element,"aria-selected","false")}}),gg.config({mode:"flow",getInitial:function(e){return vd.getHighlighted(e).map(function(e){return e.element})},selector:"."+e.markers.tabClass,executeOnMove:!0})])}}}),sP=Qf({name:"Tabview",configFields:[Ku("tabviewBehaviours",[bg])],factory:function(e){return{uid:e.uid,dom:e.dom,behaviours:Ju(e.tabviewBehaviours,[bg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),lP=b([fn("selectFirst",!0),wc("onChangeTab"),wc("onDismissTab"),fn("tabs",[]),Ku("tabSectionBehaviours",[])]),uP=Sf({factory:cP,schema:[Yt("dom"),tn("markers",[Yt("tabClass"),Yt("selectedClass")])],name:"tabbar",defaults:function(e){return{tabs:e.tabs}}}),fP=Sf({factory:sP,name:"tabview"}),dP=b([uP,fP]),mP=ed({name:"TabSection",configFields:lP(),partFields:dP(),factory:function(e,t){var n=function(t,n){jf(t,e,"tabbar").each(function(e){n(e).each(oo)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:Yu(e.tabSectionBehaviours),events:so(oe([e.selectFirst?[bo(function(e){n(e,vd.getFirst)})]:[],[fo(Zr(),function(t,n){var r,o,a=n.event.button;r=a,o=Gu.getValue(r),jf(r,e,"tabview").each(function(t){ne(e.tabs,function(e){return e.value===o}).each(function(n){var o=n.view();aa(r.element,"id").each(function(e){ra(t.element,"aria-labelledby",e)}),bg.set(t,o),e.onChangeTab(t,r,o)})})}),fo(Qr(),function(t,n){var r=n.event.button;e.onDismissTab(t,r)})]])),apis:{getViewItems:function(t){return jf(t,e,"tabview").map(function(e){return bg.contents(e)}).getOr([])},showTab:function(e,t){n(e,function(e){var n=vd.getCandidates(e);return ne(n,function(e){return Gu.getValue(e)===t}).filter(function(t){return!vd.isHighlighted(e,t)})})}}}},apis:{getViewItems:function(e,t){return e.getViewItems(t)},showTab:function(e,t,n){e.showTab(t,n)}}}),gP=function(e,t){ri(e,"height",t+"px"),Zn().browser.isIE()?ui(e,"flex-basis"):ri(e,"flex-basis",t+"px")},hP=function(e,t,n){ec(e,'[role="dialog"]').each(function(e){tc(e,'[role="tablist"]').each(function(r){n.get().map(function(n){return ri(t,"height","0"),ri(t,"flex-basis","0"),Math.min(n,(a=t,i=r,c=No(o=e).dom,s=ec(o,".tox-dialog-wrap").getOr(o),l="fixed"===ii(s,"position")?Math.max(c.clientHeight,window.innerHeight):Math.max(c.offsetHeight,c.scrollHeight),u=Ti(a),f=a.dom.offsetLeft>=i.dom.offsetLeft+Bi(i)?Math.max(Ti(i),u):u,d=parseInt(ii(o,"margin-top"),10)||0,m=parseInt(ii(o,"margin-bottom"),10)||0,l-(Ti(o)+d+m-f)));var o,a,i,c,s,l,u,f,d,m}).each(function(e){gP(t,e)})})})},pP=function(e){return tc(e,'[role="tabpanel"]')},vP=function(e){var t;return{smartTabHeight:(t=kn(D.none()),{extraEvents:[bo(function(n){var r=n.element;pP(r).each(function(o){var a;ri(o,"visibility","hidden"),n.getSystem().getByDom(o).toOptional().each(function(n){var r,a,i,c=(a=o,i=n,Y(r=e,function(e,t){bg.set(i,r[t].view());var n=a.dom.getBoundingClientRect();return bg.set(i,[]),n.height})),s=fe(le(c,function(e,t){return e>t?-1:t>e?1:0}));t.set(s)}),hP(r,o,t),ui(o,"visibility"),a=n,fe(e).each(function(e){return mP.showTab(a,e.value)}),wh.requestAnimationFrame(function(){hP(r,o,t)})})}),fo(Wr(),function(e){var n=e.element;pP(n).each(function(e){hP(n,e,t)})}),fo(mw,function(e){var n=e.element;pP(n).each(function(e){var r=ws(Ho(e));ri(e,"visibility","hidden");var o=si(e,"height").map(function(e){return parseInt(e,10)});ui(e,"height"),ui(e,"flex-basis");var a=e.dom.getBoundingClientRect().height;o.forall(function(e){return a>e})?(t.set(D.from(a)),hP(n,e,t)):o.each(function(t){gP(e,t)}),ui(e,"visibility"),r.each(bs)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},yP="send-data-to-section",bP="send-data-to-view",wP=ma("update-dialog"),kP=ma("update-title"),_P=ma("update-body"),xP=ma("update-footer"),CP=ma("body-send-message"),SP=function(e,t,n,r){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:z(z({},t.map(function(e){return{id:e}}).getOr({})),r?{"aria-live":"polite"}:{})},components:[],behaviours:fs([wx(0),oE.config({channel:_P,updateState:function(e,t){return D.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(e){switch(e.body.type){case"tabpanel":return[(a=e.body,i=n,c=kn({}),s=function(e){var t=Gu.getValue(e),n=nP(t).getOr({}),r=c.get(),o=Ke(r,n);c.set(o)},l=function(e){var t=c.get();Gu.setValue(e,t)},u=kn(null),f=Y(a.tabs,function(e){return{value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:i.shared.providers.translate(e.title)},view:function(){return[ux.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"]},components:Y(e.items,function(e){return sz(t,e,i)}),formBehaviours:fs([gg.config({mode:"acyclic",useTabstopAt:k(jx)}),wg("TabView.form.events",[bo(l),wo(s)]),vs.config({channels:ct([{key:yP,value:{onReceive:s}},{key:bP,value:{onReceive:l}}])})])}})]}}}),d=vP(f).smartTabHeight,mP.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(e,t){var n=Gu.getValue(t);ro(e,dw,{name:n,oldName:u.get()}),u.set(n)},tabs:f,components:[mP.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[cP.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:fs([Qb.config({})])}),mP.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:d.selectFirst,tabSectionBehaviours:fs([wg("tabpanel",d.extraEvents),gg.config({mode:"acyclic"}),id.config({find:function(e){return fe(mP.getViewItems(e))}}),Gu.config({store:{mode:"manual",getValue:function(e){return e.getSystem().broadcastOn([yP],{}),c.get()},setValue:function(e,t){c.set(t),e.getSystem().broadcastOn([bP],{})}}})])}))];default:return[(t=e.body,r=n,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(o=_h(ux.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:Y(t.items,function(t){return sz(e,t,r)})}}))).asSpec()]}],behaviours:fs([gg.config({mode:"acyclic",useTabstopAt:k(jx)}),bx(o),Ex(o,{postprocess:function(e){return nP(e).fold(function(e){return console.error(e),{}},function(e){return e})}})])})]}var t,r,o,a,i,c,s,l,u,f,d},initialData:e})])}},zP=iy.deviceType.isTouch(),TP=function(e,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}},EP=function(e,t){return NA.parts.close(kh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:fs([Qb.config({})])}))},OP=function(){return NA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},DP=function(e,t){return NA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:hD("<p>"+t.translate(e)+"</p>")}]}]})},NP=function(e){
return NA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e})},AP=function(e,t){return[$b.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),$b.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},RP=function(e){var t,r="tox-dialog",o=r+"-wrap",a=o+"__backdrop",i=r+"__disable-scroll";return NA.sketch({lazySink:e.lazySink,onEscape:function(t){return e.onEscape(t),D.some(!0)},useTabstopAt:function(e){return!jx(e)},dom:{tag:"div",classes:[r].concat(e.extraClasses),styles:z({position:"relative"},e.extraStyles)},components:n([e.header,e.body],e.footer.toArray()),parts:{blocker:{dom:hD('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:zP?[a,a+"--opaque"]:[a]}}]}},dragBlockClass:o,modalBehaviours:fs(n([Sg.config({}),wg("dialog-events",e.dialogEvents.concat([yo(wr(),function(e){gg.focusIn(e)})])),wg("scroll-lock",[bo(function(){Wa(Qa(),i)}),wo(function(){Xa(Qa(),i)})])],e.extraBehaviours)),eventOrder:z(((t={})[Br()]=["dialog-events"],t[$r()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Xr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),e.eventOrder)})},PP=function(e){return kh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Ch("close",e.icons)}}],action:function(e){no(e,cw)}})},BP=function(e,t,n){var r=function(e){return[wi(n.translate(e.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:z({},t.map(function(e){return{id:e}}).getOr({}))},components:r(e),behaviours:fs([oE.config({channel:kP,renderComponents:r})])}},MP=function(){return{dom:hD('<div class="tox-dialog__draghandle"></div>')}},IP=function(e,t){return n={title:t.shared.providers.translate(e),draggable:t.dialog.isDraggableModal()},r=t.shared.providers,o=NA.parts.title(BP(n,D.none(),r)),a=NA.parts.draghandle(MP()),i=NA.parts.close(PP(r)),c=[o].concat(n.draggable?[a]:[]).concat([i]),$b.sketch({dom:hD('<div class="tox-dialog__header"></div>'),components:c});var n,r,o,a,i,c},LP=function(e,t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:hD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},jP=function(e,t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){NA.setBusy(e(),function(e,r){return LP(n.message,r,t)})},onUnblock:function(){NA.setIdle(e())}}},FP=function(e,t,r,o){var a;return xi(RP(z(z({},e),{lazySink:o.shared.getSink,extraBehaviours:n([oE.config({channel:wP,updateState:function(e,t){return D.some(t)},initialData:t}),Nx({})],e.extraBehaviours),onEscape:function(e){no(e,cw)},dialogEvents:r,eventOrder:((a={})[Pr()]=[oE.name(),vs.name()],a[$r()]=["scroll-lock",oE.name(),"messages","dialog-events","alloy.base.behaviour"],a[Xr()]=["alloy.base.behaviour","dialog-events","messages",oE.name(),"scroll-lock"],a)})))},HP=function(e){return Y(e,function(e){return"menu"===e.type?(n=Y((t=e).items,function(e){var t=kn(!1);return z(z({},e),{storage:t})}),z(z({},t),{items:n})):e;var t,n})},VP=function(e){return te(e,function(e,t){return"menu"!==t.type?e:te(t.items,function(e,t){return e[t.name]=t.storage,e},e)},{})},qP=function(e,t){return[po(wr(),Lx),e(iw,function(e,n){t.onClose(),n.onClose()}),e(cw,function(e,t,n,r){t.onCancel(e),no(r,iw)}),fo(fw,function(){return t.onUnblock()}),fo(uw,function(e,n){return t.onBlock(n.event)})]},UP=function(e,t){var r=function(t,n){return fo(t,function(t,r){o(t,function(o){n(e(),o,r.event,t)})})},o=function(e,t){oE.getState(e).get().each(function(n){t(n,e)})};return n(qP(r,t),[r(sw,function(e,t,n){t.onAction(e,{name:n.name})})])},WP=function(e,t,r){var o=function(t,n){return fo(t,function(t,r){a(t,function(o){n(e(),o,r.event,t)})})},a=function(e,t){oE.getState(e).get().each(function(n){t(n.internalDialog,e)})};return n(qP(o,t),[o(lw,function(e,t){return t.onSubmit(e)}),o(aw,function(e,t,n){t.onChange(e,{name:n.name})}),o(sw,function(e,t,n,o){var a=function(){return gg.focusIn(o)},i=function(e){return ia(e,"disabled")||aa(e,"aria-disabled").exists(function(e){return"true"===e})},c=Ho(o.element),s=ws(c);t.onAction(e,{name:n.name,value:n.value}),ws(c).fold(a,function(e){i(e)||s.exists(function(t){return rr(e,t)&&i(t)})?a():r().toOptional().filter(function(t){return!rr(t.element,e)}).each(a)})}),o(dw,function(e,t,n){t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})}),wo(function(t){var n=e();Gu.setValue(t,n.getData())})])},$P=function(e,t){var n=t.map(function(e){return e.footerButtons}).getOr([]),r=Z(n,function(e){return"start"===e.align}),o=function(e,t){return $b.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:Y(t,function(e){return e.memento.asSpec()})})};return[o("start",r.pass),o("end",r.fail)]},XP=function(e,t){return{dom:hD('<div class="tox-dialog__footer"></div>'),components:[],behaviours:fs([oE.config({channel:xP,initialData:e,updateState:function(e,n){var r=Y(n.buttons,function(e){var n,r,o=_h((r=t,eS(n=e,n.type,r)));return{name:e.name,align:e.align,memento:o}});return D.some({lookupByName:function(e,t){return n=e,o=t,ne(r,function(e){return e.name===o}).bind(function(e){return e.memento.getOpt(n)});var n,o},footerButtons:r})},renderComponents:$P})])}},GP=XP,KP=function(e,t){return NA.parts.footer(XP(e,t))},YP=function(e,t){if(e.getRoot().getSystem().isConnected()){var n=id.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return ux.getField(n,t).fold(function(){var r=e.getFooter();return oE.getState(r).get().bind(function(e){return e.lookupByName(n,t)})},function(e){return D.some(e)})}return D.none()},JP=function(e,t,n){var r=function(t){var n=e.getRoot();n.getSystem().isConnected()&&t(n)},o={getData:function(){var t=e.getRoot(),r=t.getSystem().isConnected()?e.getFormWrapper():t,o=Gu.getValue(r),a=Ie(n,function(e){return e.get()});return z(z({},o),a)},setData:function(t){r(function(){var r,a,i=o.getData(),c=z(z({},i),t),s=(r=c,a=e.getRoot(),oE.getState(a).get().map(function(e){return Mt(Bt("data",e.dataValidator,r))}).getOr(r)),l=e.getFormWrapper();Gu.setValue(l,s),Me(n,function(e,t){Ue(c,t)&&e.set(c[t])})})},disable:function(t){YP(e,t).each(bv.disable)},enable:function(t){YP(e,t).each(bv.enable)},focus:function(t){YP(e,t).each(Sg.focus)},block:function(e){if(!R(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r(function(t){ro(t,uw,{message:e})})},unblock:function(){r(function(e){no(e,fw)})},showTab:function(t){r(function(){var n=e.getBody();oE.getState(n).get().exists(function(e){return e.isTabPanel()})&&id.getCurrent(n).each(function(e){mP.showTab(e,t)})})},redial:function(e){r(function(n){var r=t(e);n.getSystem().broadcastOn([wP],r),n.getSystem().broadcastOn([kP],r.internalDialog),n.getSystem().broadcastOn([_P],r.internalDialog),n.getSystem().broadcastOn([xP],r.internalDialog),o.setData(r.initialData)})},close:function(){r(function(e){no(e,iw)})}};return o},ZP=function(e,t,n){var r,o,a,i=IP(e.internalDialog.title,n),c=(r={body:e.internalDialog.body},o=n,a=SP(r,D.none(),o,!1),NA.parts.body(a)),s=HP(e.internalDialog.buttons),l=VP(s),u=KP({buttons:s},n),f=WP(function(){return h},jP(function(){return g},n.shared.providers,t),n.shared.getSink),d=function(e){switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(e.internalDialog.size),m={header:i,body:c,footer:D.some(u),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=FP(m,e,f,n),h=JP({getRoot:function(){return g},getBody:function(){return NA.getBody(g)},getFooter:function(){return NA.getFooter(g)},getFormWrapper:function(){var e=NA.getBody(g);return id.getCurrent(e).getOr(e)}},t.redial,l);return{dialog:g,instanceApi:h}},QP=function(e,t,n,r){var o,a,i,c,s,l,u,f,d,m=ma("dialog-label"),g=ma("dialog-content"),h=_h((i={title:e.internalDialog.title,draggable:!0},c=m,s=n.shared.providers,$b.sketch({dom:hD('<div class="tox-dialog__header"></div>'),components:[BP(i,D.some(c),s),MP(),PP(s)],containerBehaviours:fs([mA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(e){return nc(e,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),p=_h((l={body:e.internalDialog.body},u=g,f=n,d=r,SP(l,D.some(u),f,d))),v=HP(e.internalDialog.buttons),y=VP(v),b=_h(GP({buttons:v},n)),w=WP(function(){return _},{onBlock:function(e){DA.block(k,function(t,r){return LP(e.message,r,n.shared.providers)})},onUnblock:function(){DA.unblock(k)},onClose:function(){return t.closeWindow()}},n.shared.getSink),k=xi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((o={role:"dialog"})["aria-labelledby"]=m,o["aria-describedby"]=""+g,o)},eventOrder:((a={})[Pr()]=[oE.name(),vs.name()],a[Br()]=["execute-on-form"],a[$r()]=["reflecting","execute-on-form"],a),behaviours:fs([gg.config({mode:"cyclic",onEscape:function(e){return no(e,iw),D.some(!0)},useTabstopAt:function(e){return!jx(e)&&("button"!==xo(e)||"disabled"!==oa(e,"disabled"))}}),oE.config({channel:wP,updateState:function(e,t){return D.some(t)},initialData:e}),Sg.config({}),wg("execute-on-form",w.concat([yo(wr(),function(e){gg.focusIn(e)})])),DA.config({getRoot:function(){return D.some(k)}}),bg.config({}),Nx({})]),components:[h.asSpec(),p.asSpec(),b.asSpec()]}),_=JP({getRoot:function(){return k},getFooter:function(){return b.get(k)},getBody:function(){return p.get(k)},getFormWrapper:function(){var e=p.get(k);return id.getCurrent(e).getOr(e)}},t.redial,y);return{dialog:k,instanceApi:_}},eB=tinymce.util.Tools.resolve("tinymce.util.URI"),tB=["insertContent","setContent","execCommand","close","block","unblock"],nB=function(e){return P(e)&&-1!==tB.indexOf(e.mceAction)},rB=function(e,t,n,r){var o,a,i,c,s=IP(e.title,r),l=(a={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Mx({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:fs([Qb.config({}),Sg.config({})])})]}],behaviours:fs([gg.config({mode:"acyclic",useTabstopAt:k(jx)})])},NA.parts.body(a)),u=e.buttons.bind(function(e){return 0===e.length?D.none():D.some(KP({buttons:e},r))}),f=UP(function(){return b},jP(function(){return y},r.shared.providers,t)),d=z(z({},e.height.fold(function(){return{}},function(e){return{height:e+"px","max-height":e+"px"}})),e.width.fold(function(){return{}},function(e){return{width:e+"px","max-width":e+"px"}})),m=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],g=new eB(e.url,{base_uri:new eB(window.location.href)}),h=g.protocol+"://"+g.host+(g.port?":"+g.port:""),p=kn(D.none()),v=[wg("messages",[bo(function(){var t=Eb(xn.fromDom(window),"message",function(t){var r,o;g.isSameOrigin(new eB(t.raw.origin))&&(r=t.raw.data,nB(r)?function(e,t,n){switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":var r=!!M(n.ui)&&n.ui;e.execCommand(n.cmd,r,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock()}}(n,b,r):!nB(o=r)&&P(o)&&Ue(o,"mceAction")&&e.onMessage(b,r))});p.set(D.some(t))}),wo(function(){p.get().each(function(e){return e.unbind()})})]),vs.config({channels:((o={})[CP]={onReceive:function(e,t){tc(e.element,"iframe").each(function(e){e.dom.contentWindow.postMessage(t,h)})}},o)})],y=FP({header:s,body:l,footer:u,extraClasses:m,extraBehaviours:v,extraStyles:d},e,f,r),b=(c=function(e){i.getSystem().isConnected()&&e(i)},{block:function(e){if(!R(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");c(function(t){ro(t,uw,{message:e})})},unblock:function(){c(function(e){no(e,fw)})},close:function(){c(function(e){no(e,iw)})},sendMessage:function(e){c(function(t){t.getSystem().broadcastOn([CP],e)})}});return{dialog:i=y,instanceApi:b}},oB=function(e){var t,r,o,a,i=e.backstage,c=e.editor,s=qv(c),l=(r=(t=e).backstage.shared,{open:function(e,n){var o=function(){NA.hide(s),n()},a=_h(eS({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:D.none()},"cancel",t.backstage)),i=OP(),c=EP(o,r.providers),s=xi(RP({lazySink:function(){return r.getSink()},header:TP(i,c),body:DP(e,r.providers),footer:D.some(NP(AP([],[a.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[fo(cw,o)],eventOrder:{}}));NA.show(s);var l=a.get(s);Sg.focus(l)}}),u=(a=(o=e).backstage.shared,{open:function(e,t){var n=function(e){NA.hide(l),t(e)},r=_h(eS({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:D.none()},"submit",o.backstage)),i=eS({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:D.none()},"cancel",o.backstage),c=OP(),s=EP(function(){return n(!1)},a.providers),l=xi(RP({lazySink:function(){return a.getSink()},header:TP(c,s),body:DP(e,a.providers),footer:D.some(NP(AP([],[i,r.asSpec()]))),onEscape:function(){return n(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[fo(cw,function(){return n(!1)}),fo(lw,function(){return n(!0)})],eventOrder:{}}));NA.show(l);var u=r.get(l);Sg.focus(u)}}),f=function(e,t){return tP.openUrl(function(e){var n=rB(e,{closeWindow:function(){NA.hide(n.dialog),t(n.instanceApi)}},c,i);return NA.show(n.dialog),n.instanceApi},e)},d=function(e,t){return tP.open(function(e,n,r){var o=n,a=ZP({dataValidator:r,initialData:o,internalDialog:e},{redial:tP.redial,closeWindow:function(){NA.hide(a.dialog),t(a.instanceApi)}},i);return NA.show(a.dialog),a.instanceApi.setData(o),a.instanceApi},e)},m=function(e,t,r,o){return tP.open(function(e,a,l){var u,f,d,m=Mt(Bt("data",l,a)),g=(u=kn(D.none()),{clear:function(){return u.set(D.none())},set:function(e){return u.set(D.some(e))},isSet:function(){return u.get().isSome()},on:function(e){return u.get().each(e)}}),h=i.shared.header.isPositionedAtTop(),p=function(){return g.on(function(e){sh.reposition(e),$O.refresh(e)})},v=QP({dataValidator:l,initialData:m,internalDialog:e},{redial:tP.redial,closeWindow:function(){g.on(sh.hide),c.off("ResizeEditor",p),g.clear(),r(v.instanceApi)}},i,o),y=xi(sh.sketch(z(z({lazySink:i.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:fs(n([wg("window-manager-inline-events",[fo(Gr(),function(){no(v.dialog,cw)})])],(f=c,d=h,s&&d?[]:[$O.config({contextual:{lazyContext:function(){return D.some(Gi(xn.fromDom(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(e,t){return Nb(n=t,".tox-alert-dialog")||Nb(n,".tox-confirm-dialog");var n}})));return g.set(y),sh.showWithin(y,t,Ci(v.dialog),D.some(Qa())),s&&h||($O.refresh(y),c.on("ResizeEditor",p)),v.instanceApi.setData(m),gg.focusIn(v.dialog),v.instanceApi},e)};return{open:function(e,t,n){return void 0!==t&&"toolbar"===t.inline?m(e,i.shared.anchors.inlineDialog(),n,t.ariaAttrs):void 0!==t&&"cursor"===t.inline?m(e,i.shared.anchors.cursor(),n,t.ariaAttrs):d(e,n)},openUrl:function(e,t){return f(e,t)},alert:function(e,t){l.open(e,function(){t()})},close:function(e){e.close()},confirm:function(e,t){u.open(e,function(e){t(e)})}}};S.add("silver",function(e){var t=CA(e),n=t.uiMothership,r=t.backstage,a=t.renderUI,i=t.getUi;zb(e,r.shared);var c=oB({editor:e,backstage:r});return{renderUI:a,getWindowManagerImpl:b(c),getNotificationManagerImpl:function(){return o(0,{backstage:r},n)},ui:i()}})}();